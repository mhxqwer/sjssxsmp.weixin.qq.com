function e(){import.meta.url,import("_").catch((()=>1))}import"./modulepreload-polyfill.m6yy89my4abee2a4.js";/* empty css                                        */import{P as t,W as i,n,u as o,e as s,w as a,j as r,o as l,M as d,s as c,K as u,a as p,m as h,b as m,c as _,S as f,d as g,f as y,B as w,L as v,H as b,A as S,g as I,C as k,D as T,I as C,h as A,i as E,k as P,l as L,G as D,R,p as B,q as O,r as j,t as M,v as N,x as q,V as W,y as F,z,E as U,F as H,J as V,N as K,O as $,Q as J,T as G,U as X,X as Y,Y as Q,Z,_ as ee,$ as te,a0 as ie,a1 as ne,a2 as oe,a3 as se,a4 as ae,a5 as re,a6 as le,a7 as de,a8 as ce,a9 as ue,aa as pe,ab as he}from"./index.m6yy89my1c2bbdea.js";import{t as me,s as _e}from"./topbar.m6yy89my8cc94a96.js";import fe from"./ext_loading.m6yy89my6bebcff2.js";import{j as ge,a as ye,c as we,D as ve,U as be,b as Se,d as Ie,e as xe,l as ke,g as Te}from"./jsmonitor_report.m6yy89my1e2202de.js";import{C as Ce}from"./class.m6yy89myd1a660bd.js";import{m as Ae,J as Ee}from"./core.m6yy89my45684cc5.js";import{p as Pe,A as Le,g as De,I as Re,V as Be,w as Oe}from"./page_utils.m6yy89my6ea4af03.js";import{e as je,p as Me}from"./page_cls_ctrl.m6yy89mybbe1df6f.js";import{D as Ne}from"./event.m6yy89my1a220d6b.js";import{T as qe}from"./tmpl.m6yy89my1af565c1.js";import{u as We}from"./comm_utils.m6yy89myae732ba1.js";import{d as Fe,c as ze,g as Ue,A as He,a as Ve,h as Ke}from"./render_utils.m6yy89mydd326ff8.js";import{p as $e,o as Je,a as Ge}from"./page_utils.m6yy89my61be664a.js";import{r as Xe,A as Ye}from"./appmsgext.m6yy89my4a244751.js";import{R as Qe,i as Ze}from"./vote.m6yy89my04e8a25d.js";import{u as et}from"./pay_report_utils.m6yy89my85894430.js";import{r as tt,a as it,e as nt,g as ot}from"./utils.m6yy89my88faefa7.js";import{b as st,s as at}from"./set_article_read.m6yy89myd2bca36f.js";import{c as rt,r as lt,a as dt,V as ut,q as pt,k as ht,g as mt,d as _t,l as ft,t as gt,b as yt,i as wt,e as vt,f as bt,h as St,j as It}from"./utils.m6yy89my8a462ac8.js";import{n as xt}from"./_plugin-vue2_normalizer.m6yy89myfc2fb13f.js";import{m as kt}from"./underline_action.m6yy89myae1e2694.js";import{i as Tt,a as Ct,g as At,b as Et,s as Pt,c as Lt,d as Dt,f as Rt}from"./advance.m6yy89myfb3dc70f.js";import{s as Bt,a as Ot}from"./private_share.m6yy89my8f4a0284.js";import{A as jt}from"./a_config.m6yy89my8fba8b26.js";import{L as Mt}from"./like_and_share.m6yy89mydd9dc4dd.js";import{i as Nt,h as qt}from"./mobile_click.m6yy89myceae2661.js";import{F as Wt,V as Ft,a as zt,b as Ut,T as Ht,P as Vt,c as Kt,d as $t,e as Jt}from"./cover_next.m6yy89myc464c5ee.js";import{g as Gt}from"./font_size_utils.m6yy89my83003ee3.js";import{I as Xt}from"./interaction.m6yy89mycba68981.js";import{B as Yt,V as Qt}from"./background_color.m6yy89my1de370b0.js";import{i as Zt}from"./article_bottom_bar.m6yy89my48915ee8.js";import{n as ei}from"./defineProperty-a0a43b76.m6yy89myef20e9dc.js";import"./wxgspeedsdk.m6yy89myf8eb5e85.js";import{__setStar as ti}from"./set_star.m6yy89myf5818eb1.js";import{D as ii,o as ni}from"./img_onload_handler.m6yy89mye9830634.js";import{b as oi,r as si,i as ai}from"./channels.m6yy89mycaf1cd36.js";import{g as ri}from"./get_word_cnt.m6yy89my1a70c97b.js";import{s as li,r as di,h as ci,g as ui,p as pi,m as hi}from"./channel_product_utils.m6yy89my1348d249.js";import{L as mi}from"./storage.m6yy89my52356a02.js";import"./intersection-observer.m6yy89mye16580c9.js";import{_ as _i}from"./teleport.esm.m6yy89myd60569be.js";import"./set_custom_ele.m6yy89my22335218.js";import"./modal.m6yy89myd01ea73f.js";import{i as fi}from"./index.m6yy89mydb3a7c4f.js";import{getImmersiveMode as gi}from"./set_fullscreen_webview.m6yy89my3b224521.js";import"./get_page_read_pos.m6yy89mya01d2c15.js";import"./body_first_observer.m6yy89mya7d0eac4.js";import"./rec_report_key.m6yy89my751c5fbf.js";import"./localstorage.m6yy89myce7fad4d.js";import"./i18n.m6yy89myde033f12.js";import"./loadscript.m6yy89my2014a786.js";import"./moment.m6yy89my07db360f.js";import"./object-73371513.m6yy89my8a1756fb.js";import"./bind_element.m6yy89my817b0eec.js";import"./bind_element.m6yy89my315f665b.js";import"./bind_element.m6yy89my80512f28.js";const yi=[];function wi(){try{!function(){window.location.href.indexOf("clearStorage=1")>=0&&(localStorage.removeItem("max-age-storage-test"),console.log("clear localStorage"));var e=window.user_uin||0;if(0!==e&&Math.floor(e/100)%1e3<1&&(ye({type:"GET",url:"/mp/reportcache?type=1&random="+Math.random()}),(new Image).src="/mp/reportcache?type=2&uin="+uin,localStorage&&null==localStorage.getItem("max-age-storage-test"))){console.log("localStorage empty");try{localStorage.setItem("max-age-storage-test",!0),console.log("localStorage set success")}catch(t){}ye({type:"GET",url:"/mp/reportcache?type=3&random="+Math.random()})}}(),"undefined"==typeof getComputedStyle&&document.body.currentStyle&&(window.getComputedStyle=function(e){return e.currentStyle}),function(){let e=window.user_uin||0;if(!(0!==e&&Math.floor(e/100)%1e3<10))return;let t=document.getElementsByTagName("img"),i=t.length,n=document.getElementById("img-content"),o=n.offsetWidth,s=0,a=0,r=getComputedStyle(n);s=parseInt(r.paddingLeft)+parseInt(r.paddingRight),o-=s,o||(o=window.innerWidth-30);for(let l=0;l<i;++l){if(!t[l].getAttribute("data-src"))continue;let e=1*t[l].getAttribute("data-w")||o,i=1*t[l].getAttribute("data-ratio");i&&i>0&&e>o&&a++}a>0&&yi.push({idkey:28307,order:22,num:a})}(),function(){for(let e=0,t=yi.length;e<t;++e){let t=yi[e];ge.setSum(t.idkey,t.order,t.num)}}()}catch(e){console.error(e)}}let vi=!1;const bi=navigator.userAgent.match(/MicroMessenger\/(\d+)\.(\d+)\.(\d+)/);if(bi){const e=Number(bi[1]),t=Number(bi[2]),i=Number(bi[3]);(e>6||6===e&&t>5||6===e&&5===t&&i>=3)&&(vi=!0)}const Si={tagName:"mp-wxaproduct",isWechat:(Ae.isAndroid||Ae.isIOS)&&Ae.isWechat&&!Ae.isWxWork,isPcWechat:Ae.isWindowsWechat||Ae.isMacWechat,screen_height:We.getInnerHeight(),canJumpOnTap:vi,commonReportData:{},minishopDom:[],appmsgType:1*window.appmsg_type||9},Ii=(e={})=>{const n=e.dom,o=e.minishopInfo;Ne.on(n,"tap",(function(e){e.stopPropagation(),e.preventDefault(),we.report(22042,Object.assign({},Si.commonReportData,{ActionType:2,toWxaAppId:o.appid,CardType:"large"===o.cardtype?1:0,ProductId:o.productId,isMassSend:Si.appmsgType})),((e={})=>{Si.isWechat||Si.isPcWechat?Si.canJumpOnTap?i.jumpUrl({options:{userName:e.username,scene:1058,sceneNote:encodeURIComponent(location.href),relativeURL:e.path},beforeJumpBackupPage:function(){},onJsapiCallback:function(e){"openWeApp:ok"===e.err_msg||console.error(e.err_msg)}}):console.log("cant jumpOnTap"):new t({msg:"请使用微信打开。"})})(o)}),!0),Ne.on(n,"click",(e=>{e.preventDefault(),e.stopPropagation()}),!0)},xi=()=>{for(let e=0;e<Si.minishopDom.length;e++){const t=Si.minishopDom[e];if(1*t.getAttribute("data-hasreport")!=1){const e=document.documentElement.scrollTop||document.body.scrollTop,i=t.getAttribute("data-wxaproduct-productid")||"0",n=t.getAttribute("data-wxaproduct-appid")||"",o=t.getAttribute("data-wxaproduct-cardtype")||"mini";t.clientHeight+t.offsetTop>=e+t.clientHeight/2&&t.clientHeight+t.offsetTop<=e+t.clientHeight/2+Si.screen_height&&(t.setAttribute("data-hasreport",1),we.report(22042,Object.assign({},Si.commonReportData,{ActionType:1,toWxaAppId:n,CardType:"large"===o?1:0,ProductId:i,isMassSend:Si.appmsgType})))}}};Ne.on(window,"scroll",xi);const ki=(e={})=>{if(e.node&&e.data&&e.data.headimg){const t=function(e){const t=e.node,i=e.data;return function(){const e=document.createElement("div");e.innerHTML=qe.tmpl('<# if(cardtype === \'mini\') {#>\n<div role="button" class="appmsg_card_context wx_tap_card minishop_card minishop_card_small js_wx_tap_highlight" data-wxaproduct-productid="<#=productId#>" data-wxaproduct-appid="<#=appid#>" data-wxaproduct-cardtype="<#=cardtype#>">\n  <div class="minishop_card_hd">\n    <i aria-label="商品，" class="minishop_card_thumb" style="background-image:url(<#=headimg#>);"></i>\n  </div>\n  <div class="minishop_card_bd">\n    <div class="minishop_main_context">\n      <strong class="minishop_card_title"><#=title#></strong>\n      <# if(avatar && nickname) { #>\n      <div class="minishop_card_profile weui-flex">\n        <img class="minishop_card_profile_avatar" src="<#=avatar#>" alt="">\n        <strong class="minishop_card_profile_nickname"><#=nickname#></strong>\n      </div>\n      <# } #>\n    </div>\n    <div class="minishop_extra_context weui-flex">\n      <em class="minishop_card_price"><#=price#></em>\n      <button class="weui-btn weui-btn_xmini minishop_card_buy_btn" type="button"><i class="icon_minishop_card_buy"></i>购买</button>\n    </div>\n  </div>\n</div>\n<#} else { #>\n<div role="button" class="appmsg_card_context wx_tap_card minishop_card minishop_card_large js_wx_tap_highlight" data-wxaproduct-productid="<#=productId#>" data-wxaproduct-appid="<#=appid#>" data-wxaproduct-cardtype="<#=cardtype#>">\n  <div class="minishop_card_hd">\n    <i aria-label="商品，" class="minishop_card_thumb" style="background-image:url(<#=headimg#>);"></i>\n  </div>\n  <div class="minishop_card_bd weui-flex__item">\n    <div class="minishop_main_context">\n      <strong class="minishop_card_title"><#=title#></strong>\n      <# if(avatar && nickname) { #>\n      <div class="minishop_card_profile weui-flex">\n        <img class="minishop_card_profile_avatar" src="<#=avatar#>" alt="">\n        <strong class="minishop_card_profile_nickname"><#=nickname#></strong>\n      </div>\n      <# } #>\n    </div>\n    <div class="minishop_extra_context weui-flex">\n      <em class="minishop_card_price"><#=price#></em>\n      <button class="weui-btn weui-btn_xmini minishop_card_buy_btn" type="button"><i class="icon_minishop_card_buy"></i>购买</button>\n    </div>\n  </div>\n</div>\n<# } #>',i,!0).replace(/>\s*</g,"><").replace(/^\s+/,"").replace(/\s+$/,"");const n=e.firstChild;t.parentNode.insertBefore(n,t.nextSibling);const o=t.parentNode.querySelector('[data-preloadingid="'+i.productId+'"]');o&&o.parentNode.removeChild(o),Ii({dom:n,minishopInfo:i}),Si.minishopDom.push(n),xi()}}(e),i=function(){this.onload=null,this.onerror=null,t()},n=new Image;n.onload=i,n.onerror=i,n.src=e.data.headimg}},Ti=e=>{ye({url:"/mp/wapwxaproduct?action=batch_get_product&product_ids=".concat(JSON.stringify({list:e})),type:"GET",dataType:"json",success(e){e&&e.base_resp&&1*e.base_resp.ret==0&&"[object Array]"===Object.prototype.toString.call(e.product_list)&&((e=[])=>{const t=document.querySelectorAll(Si.tagName);for(let i=0,n=t.length;i<n;i++){const n=t[i],o=decodeURIComponent(n.getAttribute("data-wxaproduct-productid")||""),s=e.find((e=>e.product_id===o))||{},a={productId:o,title:n.getAttribute("data-wxaproduct-title")||"",price:decodeURIComponent(n.getAttribute("data-wxaproduct-price")||""),headimg:decodeURIComponent(n.getAttribute("data-wxaproduct-headimg")||""),cardtype:decodeURIComponent(n.getAttribute("data-wxaproduct-cardtype")||""),avatar:s.avatar||"",nickname:s.nickname||"",appid:s.appid||decodeURIComponent(n.getAttribute("data-wxaproduct-appid")||""),path:s.path||"",username:s.username||""};ki({data:a,node:n})}})(e.product_list)},error(t){Si.retry?(Si.retry--,Ti(e)):console.error(t)}})},Ci=(e={})=>{e.minishopCards&&(Si.commonReportData={BizUin:1*Fe(e.biz),MsgId:window.parseInt(e.mid,10)||0,ItemIdx:window.parseInt(e.idx,10)||0,Scene:window.parseInt(e.source,10)||0,SubScene:window.parseInt(e.subscene,10)||0,EnterId:window.parseInt(e.enterid,10)||0},Ti(e.minishopCards.list),xi())},Ai='<span class="qa__card js_qa_card_inner">\n  <# if (qaDeleted) { #>\n    <span class="qa__card-deleted">讨论内容已被删除</span>\n  <# } else { #>\n    <span>\n      <span class="qa__card-hd">\n        <span class="qa__hd-notice"><#=nickname#> 发起了一个读者讨论</span>\n        <span class="qa__hd-question"><#==title#></span>\n      </span>\n      <# if (!answerCount) { #>\n        <# if (isLogin) { #>\n          \x3c!-- <# if (disableAnswerWord) { #>\n            <span class="qa__list-answer qa__list-answer_desc"><#=disableAnswerWord#></span>\n          <# } else { #>\n            <span class="qa__list-answer js_qa_write_answer">参与讨论</span>\n          <# } #> --\x3e\n          <span class="qa__list-answer qa__list-answer_desc">讨论已结束</span>\n        <# } #>\n      <# } else { #>\n        <span>\n          <span class="qa__list-hd">\n            <span class="qa__list-hd-title js_qa_list_head_title">精选讨论内容</span>\n            \x3c!-- <# if (isLogin) { #>\n              <# if (disableAnswerWord) { #>\n                <span class="qa__list-hd-desc"><#=disableAnswerWord#></span>\n              <# } else { #>\n                <span class="qa__list-hd-action js_qa_write_answer">参与讨论</span>\n              <# } #>\n            <# } #> --\x3e\n          </span>\n          <span class="qa__list js_qa_qna_answer_list"><#==answerListStr#></span>\n          <# if (leftAnswerCnt) { #>\n            <p class="qa__list-more js_more_answer_entry" data-count="<#=answerCount#>"><#=leftAnswerCnt#></p>\n          <# } #>\n        </span>\n      <# } #>\n    </span>\n  <# } #>\n</span>',Ei='<div class="qa__list-item js_qa_list_item">\n  \x3c!-- 层主头像 --\x3e\n  <section class="qa__item-avatar">\n    <img src="<#=user_info.headimg#>">\n  </section>\n  <section class="qa__item-bd">\n    <div class="qa__item-info">\n      \x3c!-- 层主昵称 --\x3e\n      <div class="qa__item-nickname">\n        <#=user_info.nickname#>\n      </div>\n      \x3c!-- 点赞 --\x3e\n      <div class="qa__item-action">\n        \x3c!-- span加praised点赞 --\x3e\n        <# if (is_my_answer && canOp) { #>\n          <div class="qa__action js_delete_answer" data-id="<#=answer_id#>"><i class="icon_delete"></i></div>\n        <# } #>\n        \x3c!-- 精选之后的才能点赞 --\x3e\n        <# if (answer_status && isLogin) { #>\n          <div class="qa__action qa__action-praise js_qa_like<# if (my_like_status) { #> praised<# } #>" data-type="1" data-id="<#=answer_id#>">\n            <i class="icon_praise_gray"></i>\n            <span class="js_like_num" data-num="<#=like_num#>">\n              <#=likeNumFormated#>\n            </span>\n          </div>\n        <# } #>\n        <# if (!answer_status) { #>\n          <div class="qa__action qa__action_normal">未精选</div>\n        <# } #>\n      </div>\n    </div>\n\n    \x3c!-- 回答内容 --\x3e\n    <p class="qa__item-content js_qa_item_content"><#=content#></p>\n    \x3c!-- <# if (is_my_answer && canOp) { #>\n    <div class="qa__action qa__action-reply js_write_reply" data-answerid="<#=answer_id#>" data-answersn="<#=answer_sn#>" <# if (replyListHtml) { #>style="display: none;"<# } #>><span>回复</span></div>\n    <# } #> --\x3e\n\n    \x3c!-- 回复 --\x3e\n    <section class="qa__reply">\n      <section class="js_qa_reply_list js_qa_reply_list_<#=answer_id#>">\n        <#=replyListHtml#>\n      </section>\n      <# if (replyListHtml && leftReplyCount) { #>\n        <p class="qa__reply-more js_get_more_reply js_get_more_reply_<#=answer_id#>" data-answerid="<#=answer_id#>" data-answersn="<#=answer_sn#>">\n          <#=leftReplyTips#>\n        </p>\n      <# } #>\n      \x3c!-- <# if (is_my_answer && canOp) { #>\n      <div class="qa__action qa__action-reply js_write_reply" data-answerid="<#=answer_id#>" data-answersn="<#=answer_sn#>" <# if (!replyListHtml) { #>style="display: none;"<# } #>><span>回复</span></div>\n      <# } #> --\x3e\n    </section>\n  </section>\n</div>',Pi='<section class="qa__reply-item js_qa_reply_item<# if (is_my_reply) { #> js_qa_my_reply<# } #>">\n  <div class="qa__reply-hd">\n    <div class="qa__reply-nickname">\n      <# if (is_biz_reply) { #>\n        作者\n      <# } else { #>\n        <#=user_info.nickname#>\n      <# } #>\n    </div>\n    <div class="qa__item-action">\n      <# if (is_my_reply && canOp) { #>\n        <div class="qa__action js_delete_reply" data-id="<#=reply_id#>"><i class="icon_delete"></i></div>\n      <# } #>\n      \x3c!-- 精选之后的才能点赞 --\x3e\n      <# if (replyStatus && isLogin) { #>\n        <div class="qa__action qa__action-praise js_qa_like<# if (my_like_status) { #> praised<# } #>" data-type="2" data-id="<#=reply_id#>">\n          <i class="icon_praise_gray"></i>\n          <span class="js_like_num" data-num="<#=like_num#>">\n            <#=likeNumFormated#>\n          </span>\n        </div>\n      <# } #>\n      <# if (!replyStatus) { #>\n        <div class="qa__action qa__action_normal">未精选</div>\n      <# } #>\n    </div>\n  </div>\n  <p class="qa__reply-content js_qa_reply_content"><#=content#></p>\n</section>',Li='<div class="qa__modal-reply">\n  <div class="qa__modal-reply-msg js_reply_top_content"></div>\n  <div class="frm_textarea_box_wrp">\n    <span class="frm_textarea_box" style="position: relative; display: block;">\n      <div style="position: relative; height: 9.6em; overflow: hidden; font-size: 17px;">\n        <textarea class="frm_textarea js_qa_input" placeholder="内容被公众号精选后，将对所有人可见。" style="height: 9.6em; width: 100%; border: none; outline: none;"></textarea>\n      </div>\n      <div class="emotion_tool">\n        <span class="emotion_switch" style="display:none;"></span>\n        <span id="js_qa_emotion_switch" class="pic_emotion_switch_wrp">\n          <img class="pic_default" src="<#=window.icon_emotion_switch#>" alt="">\n          <img class="pic_active" src="<#=window.icon_emotion_switch_active#>" alt="">\n          <img class="pic_default_primary" src="<#=window.icon_emotion_switch_primary#>" alt="">\n          <img class="pic_active_primary" src="<#=window.icon_emotion_switch_active_primary#>" alt="">\n        </span>\n      </div>\n    </span>\n  </div>\n  <div class="emotion_panel" id="js_qa_emotion_panel">\n    <span class="emotion_panel_arrow_wrp" id="js_qa_emotion_panel_arrow_wrp">\n      <i class="emotion_panel_arrow arrow_out"></i>\n      <i class="emotion_panel_arrow arrow_in"></i>\n    </span>\n    <div class="emotion_list_wrp" id="js_qa_emotion_slide_wrapper"></div>\n    <ul class="emotion_navs" id="js_qa_emotion_navbar"></ul>\n  </div>\n</div>\n<div class="qa__list-wrp">\n  <div class="qa__list-hd js_qa_write_head" style="display: none;">\n    <span class="qa__list-hd-title">我的讨论内容</span>\n  </div>\n  <div class="qa__list js_qa_qna_answer_list"></div>\n</div>\n\n<div class="js_loading_toast" style="display: none;">\n  <div class="weui-mask_transparent"></div>\n  <div class="weui-toast">\n    <i class="weui-loading weui-icon_toast"></i>\n    <p class="weui-toast__content js_loading_content">正在加载</p>\n  </div>\n</div>\n\n<div class="js_sended_toast" style="display: none;">\n  <div class="weui-mask_transparent"></div>\n  <div class="weui-toast">\n    <i class="weui-icon-success-no-circle weui-icon_toast"></i>\n    <p class="weui-toast__content" id="js_toast_msg">已发送</p>\n  </div>\n</div>\n\n<div class="qa__toast-alert js_alert_toast" style="display: none;">\n  <div class="weui-mask_transparent"></div>\n  <div class="weui-toast">\n    <i class=" qa__icon-alert"></i>\n    <p class="weui-toast__content js_alert_toast_word"></p>\n  </div>\n</div>',Di="weui-btn_disabled",Ri="page_no_scroll",Bi="".concat(screen.height/4*3,"px"),Oi={top:ve.os.pc?"20%":"".concat(screen.height/4-(screen.height-window.innerHeight),"px"),btnText:"提交",hasHeader:!0,clickMask2Hide:!0,animationType:"bottom",scroll2Hide:!0,sideslip2Hide:!0};function ji(e,t,i,n){i=n?"".concat(i,"px"):i,e.style[t]=i}class Mi{constructor(e,t={}){t=Object.assign({},Oi,t);const i=document.createElement("div");i.innerHTML=qe.tmpl('<div class="wx_bottom_modal_wrp legacy <#=extClass#>">\n  <div\n    class="weui-half-screen-dialog wx_bottom_modal js_bottom_modal_content"\n    role="dialog"\n    aria-modal="true"\n    aria-hidden="true"\n    tabindex="0"\n    <# if (!autoHeight) { #>\n      style="max-height: none;"\n    <# } else { #>\n      style="max-height: <#=maxHeight#>;"\n    <# } #>\n  >\n    <# if (hasHeader) { #>\n      <div class="weui-half-screen-dialog__hd__wrp">\n        <div class="weui-half-screen-dialog__hd js_bottom_modal_hd">\n          <div class="weui-half-screen-dialog__hd__side">\n            <button class="weui-btn_icon js_close_bottom_modal weui-wa-hotarea">关闭<i class="weui-icon-half-screen-close"></i></button>\n          </div>\n\n          <div class="weui-half-screen-dialog__hd__main">\n            <strong class="weui-half-screen-dialog__title js_bottom_modal_title">标题</strong>\n          </div>\n\n          <div class="weui-half-screen-dialog__hd__side">\n            <# if (hasBtn) { #>\n              <# if (btnSlot) { #>\n                <div role="button" class="js_submit_bottom_modal weui-wa-hotarea">\n                  <#==btnSlot#>\n                </div>\n              <# } else { #>\n                <button class="weui-btn weui-btn_primary weui-btn_xmini js_submit_bottom_modal weui-wa-hotarea"><#=btnText#></button>\n              <# } #>\n            <# } #>\n            <button class="weui-btn_icon" style="display:none;">更多<i class="weui-icon-more"></i></button>\n          </div>\n        </div>\n      </div>\n    <# } #>\n    <div class="weui-half-screen-dialog__bd js_bottom_modal_bd">\n      <div role="alert" class="wx_bottom_modal_msg_wrp js_modal_loading" style="display: none;">\n        <div class="wx_bottom_modal_msg">\n          <i class="weui-loading" role="img" aria-label="加载中"></i>\n        </div>\n      </div>\n      \x3c!-- 上下拉加载loading --\x3e\n      <div role="alert" class="weui-loadmore js_pull_loading" style="display: none;">\n        <i class="weui-loading"></i>\n        <span class="weui-loadmore__tips">正在加载</span>\n      </div>\n\n      \x3c!-- 加载完成的dom，插到js_bottom_modal_bd下 --\x3e\n      <div role="option" class="weui-loadmore weui-loadmore_line weui-loadmore_dot js_modal_end_line" style="display: none;">\n        <div class="weui-hidden_abs">已无更多数据</div>\n        <span class="weui-loadmore__tips"></span>\n      </div>\n    </div>\n    <# if (hasFooter) { #>\n      <div class="weui-half-screen-dialog__ft js_bottom_modal_ft"></div>\n    <# } #>\n  </div>\n  <# if (hasMask) { #>\n    \x3c!-- 透明mask，用于防止点透 --\x3e\n    <div class="wx_bottom_modal_mask_fixed js_bottom_modal_mask_not_click"></div>\n\n    \x3c!-- 有底色的mask --\x3e\n    <div class="weui-mask wx_bottom_modal_mask js_bottom_modal_mask"></div>\n  <# } #>\n</div>',{hasBtn:t.hasBtn,btnText:t.btnText,extClass:t.extClass||"",hasMask:!t.removeMask,isTopic:!!t.isTopic,hasHeader:t.hasHeader,hasFooter:!!t.footerEl,btnSlot:t.btnSlot,autoHeight:t.autoHeight,maxHeight:Bi});const n=i.firstChild;this.scrollLock=!1,this.curScrollTop=0,this.touches={startX:0,startY:0,curX:0,curY:0,isScreenLeft:!1,direction:"",times:0},this.opt=t,this.rootEle=n,this.contentEle=e,this.contentAreaWrp=n.getElementsByClassName("js_bottom_modal_bd")[0],this.contentAreaWrp.appendChild(e),this.contentArea=n.getElementsByClassName("js_bottom_modal_content")[0],this.loading=this.rootEle.getElementsByClassName("js_modal_loading")[0],this.pullLoading=this.rootEle.getElementsByClassName("js_pull_loading")[0],this.endLine=this.rootEle.getElementsByClassName("js_modal_end_line")[0],this.enableGesture=!1,this.triggerEl=null,this.isAutoFocus=!0,t.removeMask||(this.maskEle=n.getElementsByClassName("js_bottom_modal_mask")[0],this.maskNotClick=n.getElementsByClassName("js_bottom_modal_mask_not_click")[0],t.transparentMask&&ji(this.maskEle,"opacity",0)),t.hasHeader&&(this.headAreaWrp=n.getElementsByClassName("js_bottom_modal_hd")[0],this.submitBtn=this.headAreaWrp.getElementsByClassName("js_submit_bottom_modal")[0],this.closeBtn=this.headAreaWrp.getElementsByClassName("js_close_bottom_modal")[0],this.setTitle(t.title)),t.footerEl&&(this.footAreaWrp=n.querySelector(".js_bottom_modal_ft"),this.footAreaWrp.appendChild(t.footerEl)),"right"===t.animationType&&this.rootEle.classList.add("wx_bottom_modal_right"),document.body.appendChild(n),t.cb&&t.cb(),this.bindEvent()}bindEvent(){this.maskEle&&(this.opt.clickMask2Hide&&Ne.tap(this.maskEle,(()=>{this.hide()})),Ne.on(this.contentArea,"transitionend",(e=>{e.target!==this.contentArea||"transform"!==e.propertyName&&"-ms-transform"!==e.propertyName||(""!==this.contentArea.style.transform?this.contentArea.style.removeProperty("transform"):this.getShowStatus()?"function"==typeof this.opt.onShowAfterAnimation&&this.opt.onShowAfterAnimation():(ji(this.maskNotClick,"visibility","hidden"),!this.opt.autoHeight&&ji(this.contentArea,"top",this.opt.top)))})),Ne.tap(this.maskNotClick,(()=>setTimeout((()=>{this.hide(),ji(this.maskNotClick,"visibility","hidden"),!this.opt.autoHeight&&ji(this.contentArea,"top",this.opt.top)}),300))),Ne.on(this.maskEle,"touchmove",(e=>{e.preventDefault()}))),this.headAreaWrp&&(Ne.on(this.headAreaWrp,"touchstart",(e=>this.onTouchStart(e))),Ne.on(this.headAreaWrp,"touchmove",(e=>{e.preventDefault();const t=e.changedTouches[0];this.getTouchDirection(t)&&this.moveByDirection(t)})),Ne.on(this.headAreaWrp,"touchend",(e=>this.onTouchEnd(e)))),this.footAreaWrp&&(Ne.on(this.footAreaWrp,"touchstart",(e=>this.onTouchStart(e))),Ne.on(this.footAreaWrp,"touchmove",(e=>{e.preventDefault();const t=e.changedTouches[0];this.getTouchDirection(t)&&this.moveByDirection(t)})),Ne.on(this.footAreaWrp,"touchend",(e=>this.onTouchEnd(e)))),this.closeBtn&&Ne.on(this.closeBtn,"click",(()=>{this.hide()})),this.submitBtn&&Ne.on(this.submitBtn,"click",(()=>{Ce.hasClass(this.submitBtn,Di)||this.opt.btnClickCb&&this.opt.btnClickCb()})),Ne.on(this.contentAreaWrp,"scroll",(()=>{this.checkReachBoundary(),this.contentAreaWrp.scrollTop>0?Ce.addClass(this.contentArea,"weui-half-screen-dialog_headline"):Ce.removeClass(this.contentArea,"weui-half-screen-dialog_headline")})),this.headAreaWrp&&Ne.tap(this.headAreaWrp.getElementsByClassName("js_bottom_modal_title")[0],(()=>{this.opt.titleClickCb&&this.opt.titleClickCb()})),Ne.on(this.contentAreaWrp,"touchstart",(e=>this.onTouchStart(e))),Ne.on(this.contentAreaWrp,"touchmove",(e=>{const t=e.changedTouches[0];if(this.getTouchDirection(t)){if("Y"===this.touches.direction){const n=this.contentAreaWrp,o=t.pageY,s=o-this.touches.startY,a=n.scrollTop<=0&&s>0,r=(i=n,Math.ceil(i.scrollTop+i.offsetHeight)>=i.scrollHeight&&s<0);a||r?(a&&!this.opt.onPullDownLoad&&this.move(o),e.preventDefault()):this.resetMovement(),this.touches.curY=o}else e.preventDefault(),this.moveByDirection(t)}var i})),Ne.on(this.contentAreaWrp,"touchend",(e=>this.onTouchEnd(e))),Ne.on(window,"unload",(()=>{this.opt.removeMask||n.hide()}))}checkReachBoundary(e=!0,t=!0){this.scrollLock&&0!==this.contentAreaWrp.scrollTop||(this.scrollLock=!0,setTimeout((()=>{this.scrollLock=!1}),50),e&&!this.pullingDownLock&&this.contentAreaWrp.scrollTop<=0&&(this.opt.onPullDownLoad&&this.opt.onPullDownLoad(),this.pullingDownLock=!0),setTimeout((()=>{t&&!this.pullingUpLock&&this.contentAreaWrp.scrollTop+this.contentAreaWrp.offsetHeight+100>this.contentEle.offsetHeight&&(this.opt.onPullUpLoad&&this.opt.onPullUpLoad(),this.pullingUpLock=!0)}),100),this.opt.onScroll&&this.opt.onScroll(this.contentAreaWrp.scrollTop>this.curScrollTop?"up":"down"),this.curScrollTop=this.contentAreaWrp.scrollTop)}onTouchStart(e){const t=e.touches[0];this.touches={startX:t.pageX,startY:t.pageY,curX:t.pageX,curY:t.pageY,isScreenLeft:this.enableGesture&&t.pageX<=30,direction:"",times:0},this.contentArea.style.transition="none"}onTouchEnd(e){const t=this.touches.direction,i="X"===t?100:this.contentArea.offsetHeight/4,n=e.changedTouches[0]["page".concat(t)]-this.touches["start".concat(t)],o=this.contentArea.dataset;this.contentArea.style.removeProperty("transition"),o.distance&&(n>i?this.hide():this.contentArea.style.transform="translateY(0)",delete o.distance)}getTouchDirection(e){if(this.touches.direction)return!0;if(!this.touches.isScreenLeft)return this.touches.direction="Y",!0;this.touches.times++;const t=Math.abs(e.pageX-this.touches.startX),i=Math.abs(e.pageY-this.touches.startY);return this.touches.times>=3?(this.touches.direction=t>=i?"X":"Y",!0):t>=5&&t>=i?(this.touches.direction="X",!0):i>=5&&(this.touches.direction="Y",!0)}moveByDirection(e){const t=this.touches.direction,i=e["page".concat(t)];i-this.touches["start".concat(t)]>0?this.move(i):this.resetMovement(),this.touches["cur".concat(t)]=i}move(e){if(this.opt.sideslip2Hide&&"X"===this.touches.direction||this.opt.scroll2Hide&&"Y"===this.touches.direction){const t=this.contentArea.dataset;t.distance=1*(t.distance||0)+e-this.touches["cur".concat(this.touches.direction)],this.contentArea.style.transform="translateY(".concat(t.distance,"px)")}}resetMovement(){delete this.contentArea.dataset.distance,this.contentArea.style.removeProperty("transform")}show(e,t,i,s=!0){Ce.addClass(document.body,Ri),this.triggerEl=i||window.event&&window.event.target,this.isAutoFocus=s,this.getShowStatus()||(e||this.opt.autoHeight||(ji(this.contentArea,"top",this.opt.top),console.log(this.contentArea.offsetHeight)),ji(this.contentArea,"visibility","visible"),Ce.addClass(this.rootEle,"wx_bottom_modal_show"),this.setAriaHidden(!1),this.contentArea.focus(),this.maskEle&&this.opt.clickMask2Hide&&ji(this.maskNotClick,"visibility","visible"),this.opt.removeMask||n.show({alpha:this.opt.transparentMask?0:.6,callback:e=>{e&&"function"==typeof this.opt.onShowNavShadow&&this.opt.onShowNavShadow()},onClick:()=>{this.hide()}}),this.opt.sideslip2Hide&&(ve.os.ios?Ee.invoke("handleDeviceInfo",{action:"disableInteractivePop",disable:!0},(e=>{/:ok$/.test(e.err_msg)&&(this.enableGesture=!0)})):o.disable({onGoBack:()=>{this.hide()},onDisable:()=>{this.enableGesture=!0},onEnable:()=>{this.enableGesture=!1}})),e&&(Ce.addClass(this.rootEle,"wx_bottom_modal_form"),ji(this.contentArea,"top","25px")),setTimeout((()=>{e||"right"===this.opt.animationType&&(ji(this.contentArea,"-ms-transform","translateX(0)"),ji(this.contentArea,"transform","translateX(0)"))})),e&&(setTimeout((()=>{"bottom"===this.opt.animationType?ji(this.contentArea,"top","100%"):ji(this.contentArea,"top",this.opt.top),console.log(this.contentArea.offsetHeight),Ce.removeClass(this.rootEle,"wx_bottom_modal_form"),setTimeout((()=>{ji(this.contentArea,"top",this.opt.top),"right"===this.opt.animationType&&(ji(this.contentArea,"-ms-transform","translateX(0)"),ji(this.contentArea,"transform","translateX(0)"))}))}),50),ve.os.ios?t.focus():(this.tmpInputEle||(this.tmpInputEle=t.cloneNode(!0)),this.tmpInputEle.style.opacity=0,this.tmpInputEle.style.position="fixed",this.tmpInputEle.style.top=0,this.tmpInputEle.style.zIndex="-1",document.body.appendChild(this.tmpInputEle),setTimeout((()=>{t.focus(),this.opt.makeInputEleBigger&&this.opt.makeInputEleBigger(),document.body.removeChild(this.tmpInputEle)}),300),this.tmpInputEle.focus()),ve.os.ios&&!this.hasBindInputEvent&&this.opt.makeFakeInputEle&&this.opt.removeInputEle&&(this.hasBindInputEvent=!0,Ne.on(t,"focus",(()=>{setTimeout((()=>{t.style.opacity=1,this.opt.removeInputEle()}),50)})),Ne.on(t,"blur",(()=>{this.opt.makeFakeInputEle(),t.style.opacity=0})))),this.opt.onShow&&this.opt.onShow())}hide(e){Ce.removeClass(document.body,Ri),e&&ji(this.maskNotClick,"visibility","hidden"),this.getShowStatus()&&(this.contentArea.style.removeProperty("-ms-transform"),this.contentArea.style.removeProperty("transform"),Ce.removeClass(this.rootEle,"wx_bottom_modal_show"),this.setAriaHidden(!0),this.isAutoFocus&&function(e){if(!(e&&e instanceof HTMLElement))return!1;const t=window.getComputedStyle(e);return 0!==t.width&&0!==t.height&&0!==t.opacity&&"none"!==t.display&&"hidden"!==t.visibility&&null!==e.offsetParent}(this.triggerEl)&&(this.triggerEl.setAttribute("tabindex","0"),this.triggerEl.focus()),this.opt.removeMask||n.hide(),this.opt.sideslip2Hide&&(ve.os.ios?Ee.invoke("handleDeviceInfo",{action:"disableInteractivePop",disable:!1},(e=>{/:ok$/.test(e.err_msg)&&(this.enableGesture=!1)})):o.enable({onEnable:()=>{this.enableGesture=!1}})),this.opt.onHide&&this.opt.onHide())}disableBtn(){this.submitBtn&&Ce.addClass(this.submitBtn,Di)}enableBtn(){this.submitBtn&&Ce.removeClass(this.submitBtn,Di)}finishPullUpLoad(){this.pullingUpLock=!1}finishPullDownLoad(){this.pullingDownLock=!1}setTitle(e){this.headAreaWrp&&("string"==typeof e?this.headAreaWrp.getElementsByClassName("js_bottom_modal_title")[0].innerHTML=e:"object"==typeof e&&e.innerHTML&&(this.headAreaWrp.getElementsByClassName("js_bottom_modal_title")[0].innerHTML=e.innerHTML))}scrollTo(...e){this.contentAreaWrp.scrollTo(...e)}getRootEle(){return this.rootEle}getBdEle(){return this.contentAreaWrp}getScrollEle(){return this.contentAreaWrp}setCloseBtnStyle(e){if(this.closeBtn){const t=this.closeBtn.getElementsByTagName("i")[0],i="weui-icon-close-thin",n="weui-icon-back-arrow-thin";"back"===e?(Ce.removeClass(t,i),Ce.addClass(t,n)):(Ce.removeClass(t,n),Ce.addClass(t,i))}}getShowStatus(){return Ce.hasClass(this.rootEle,"wx_bottom_modal_show")}showLoading(){ji(this.loading,"display","block")}hideLoading(){ji(this.loading,"display","none")}showPullUpLoading(){this.contentAreaWrp.appendChild(this.pullLoading),ji(this.pullLoading,"display","block")}hidePullUpLoading(){ji(this.pullLoading,"display","none")}showPullDownLoading(){this.contentAreaWrp.insertBefore(this.pullLoading,this.contentAreaWrp.firstChild),ji(this.pullLoading,"display","block")}hidePullDownLoading(){ji(this.pullLoading,"display","none")}showEndLine(){this.contentAreaWrp.appendChild(this.endLine),ji(this.endLine,"display","block")}setAriaHidden(e){this.contentArea.setAttribute("aria-hidden",e.toString())}disablePullDownLoad(){this.opt.onPullDownLoad=null}}function Ni(e,t,i=0){return e.getElementsByClassName(t)[i]}const qi=document.getElementsByTagName("mp-qa")[0];let Wi,Fi,zi,Ui,Hi,Vi;const Ki={};let $i,Ji,Gi,Xi,Yi=0,Qi=0,Zi=0,en="";const tn=10,nn="answerList",on="myAnswerList",an="praised",rn="modalWriteAnswerClass",ln="25px",dn={__biz:qi&&qi.dataset.bizuin,question_id:qi&&qi.dataset.id,qna_sn:qi&&function(e){let t;if(window.qnaCardData)try{t=JSON.parse(window.qnaCardData);const i=t.list;if(i&&i.length)for(let t=0;t<i.length;t++)if(e===i[t].question_id)return i[t].qna_sn}catch(i){console.error(i)}return""}(qi.dataset.id)},cn={};function un(e){e&&(e.style.display="none")}function pn(e){e&&(e.style.display="block")}function hn(e,t){a.jsmonitor({id:223326,key:e,value:t})}function mn(){window.weui.topTips("系统错误，请稍后再试")}function _n(e={}){we.report(20883,Object.assign({Device:ve.os.ios?1:ve.os.android?2:-1,MsgId:1*dn.mid,ItemIdx:1*dn.idx,BizUin:Ki.biz,ItemShowType:1*Ki.itemShowType,SessionId:Ki.sessionId,EnterId:1*Ki.enterId,Scene:1*Ki.scene,SubScene:1*Ki.subScene,QaId:qi.dataset.id},e))}function fn(e,t,i){const n={replyListHtml:"",replyList:document.createDocumentFragment()};return e&&e.reply_list&&e.reply_list.length&&(n.leftReplyCount=e.left_reply_cnt,n.leftReplyTips="余下#value#条回复".replace("#value#",e.left_reply_cnt),e.reply_list.forEach((e=>{e.canOp=i,e.content=e.content.htmlEncode(),e.content=s.encode(e.content),e.likeNumFormated=$e.formatReadNum(e.like_num),e.replyStatus=void 0===e.reply_status?1:e.reply_status,e.isLogin=Wi;const t=document.createElement("div");t.innerHTML=qe.tmpl(Pi,e,!1),n.replyListHtml+=t.innerHTML,n.replyList.appendChild(t.firstChild)}))),n}function gn(e,t,i=""){const n={answerListHtml:"",fragment:document.createDocumentFragment()};return e.forEach((e=>{e.likeNumFormated=$e.formatReadNum(e.like_num),e.canOp=t,e.answer_sn=e.answer_sn||"",e.content=e.content.htmlEncode(),e.oriContent=e.content,e.content=s.encode(e.content),e.isLogin=Wi;const i=fn(e.reply_info,e.answer_id,t);Object.assign(e,i);const o=document.createElement("div");o.innerHTML=qe.tmpl(Ei,e,!1),n.answerListHtml+=o.innerHTML,n.fragment.appendChild(o.firstChild)})),i===on?Qi+=tn:i===nn&&(Yi+=tn),n}function yn(e={}){const t=Object.assign({action:e.action,limit:tn,offset:e.offset},dn);ye({url:be.join("/mp/qna",t),dataType:"json",success(t){let i;t&&(i=t.qna_info?t.qna_info.answer_info:t.answer_info,e.successCb(i,t))},complete(){e.complete&&e.complete()}})}function wn(e,t){let i=0;for(;e.offsetParent&&e!==t;)i+=e.offsetTop,e=e.offsetParent;return i}function vn(e,t,i){const n=e.dataset.answerid,o=i?wn(e,zi.getScrollEle()):0;ye({url:be.join("/mp/qna",Object.assign({action:"get_more_reply",answer_id:n,answer_sn:e.dataset.answersn,limit:10},dn)),dataType:"json",success(t){if(t&&t.reply_info&&t.reply_info.reply_list&&t.reply_info.reply_list.length){const n=fn(t.reply_info,0,!0);n.replyListHtml?(Ni(e.parentNode,"js_qa_reply_list").appendChild(n.replyList),n.leftReplyCount?e.innerHTML=n.leftReplyTips:un(e),i&&zi.scrollTo(0,o-48)):un(e)}}})}function bn(e){const t=Ni(Ui,"js_get_more_reply_".concat(e));t&&vn(t,0,!0)}function Sn(){return Ni(Vi,"js_qa_input")}function In(){const e=Sn();return(e.value||e.innerHTML).trim()}function xn(){In()?Hi.enableBtn():Hi.disableBtn()}function kn(e={}){yn({action:e.action,offset:e.offset,successCb(t,i){if(t&&t.answer_list&&t.answer_list.length){let i,n;"get_my_answer"===e.action?(i=on,n=Vi,pn(Ni(Vi,"js_qa_write_head"))):(i=nn,n=Ui);Ni(n,"js_qa_qna_answer_list").appendChild(gn(t.answer_list,!0,i).fragment)}e.cb&&e.cb(t,i)}})}function Tn(){if(!Vi)return;const e="回复: #value#".replace("#value#",s.encode(en)),t=Ni(Vi,"js_reply_top_content");$i?(t.innerHTML=e,pn(t)):un(t)}function Cn(e){Ni(Vi,"js_alert_toast_word").innerHTML=e,pn(Ni(Vi,"js_alert_toast")),setTimeout((()=>{un(Ni(Vi,"js_alert_toast"))}),800)}function An(){let e=0;const t=Ui.getElementsByClassName("js_qa_list_item");for(let i=0;i<t.length&&t[i].getBoundingClientRect().y<We.getInnerHeight();i++)e++;e>Zi&&(Zi=e)}function En(e,t){if(zi)return zi.show(),void(e&&t&&bn(t));let i;Ui=qi.firstChild.cloneNode(!0);const n=Ni(Ui,"qa__list-more"),o=Ni(Ui,"js_qa_write_answer");n&&un(n),o&&Ce.addClass(o,rn),Ni(Ui,"js_qa_qna_answer_list").innerHTML="",zi=new Mi(Ui,{title:"读者讨论",extClass:"qa__card",onPullUpLoad(){i>0&&(zi.showPullUpLoading(),kn({action:"get_more_answer",offset:Yi,cb(e,t){zi.hidePullUpLoading(),e.left_answer_cnt||0!==t.base_resp.ret?zi.finishPullUpLoad():zi.showEndLine()}}))},cb(){kn({action:"get_more_answer",offset:Yi,cb(n){if(e&&t)bn(t);else{const e=Fi.dataset.count,t=wn(Ni(Ui,"js_qa_list_item",e),zi.getScrollEle());zi.scrollTo(0,t-96)}i=n.left_answer_cnt,i||zi.showEndLine()}})},onScroll(){An()},onHide(){An(),_n({EventType:3,Exposure:Zi}),Zi=0}}),zi.show(),Ne.on(Ui,"tap",".js_get_more_reply",(e=>{vn(e.delegatedTarget)}))}function Pn(e){let t;const i=$i?"写回复":"参与讨论";if(Hi)return Tn(),Hi.setTitle(i),e?Hi.setCloseBtnStyle("back"):Hi.setCloseBtnStyle("close"),void Hi.show(!0,Sn());Vi=document.createElement("div"),Vi.innerHTML=qe.tmpl(Li,{}),Hi=new Mi(Vi,{title:i,top:ln,extClass:"qa__card qa__card_write",hasBtn:!0,disableTransition:!0,onPullUpLoad(){t>0&&(Hi.showPullUpLoading(),kn({action:"get_my_answer",offset:Qi,cb(e,t){Hi.hidePullUpLoading(),e.left_answer_cnt||0!==t.base_resp.ret?Hi.finishPullUpLoad():Hi.showEndLine()}}))},onHide(){Sn().blur()},onScroll(e){"up"===e&&Sn().blur()},cb(){kn({action:"get_my_answer",offset:Qi,cb(e){t=e.left_answer_cnt,t||Hi.showEndLine()}})},btnClickCb(){Hi.disableBtn();const e=$i?"add_reply":"add_answer";pn(Ni(Vi,"js_loading_toast")),ye({url:"/mp/qna?action=".concat(e),type:"POST",dataType:"json",data:Object.assign({answer_id:Gi,answer_sn:Xi,content:In(),my_reply_cnt:Ji+1,ignore_tips:1},dn),success(e){if(e&&e.base_resp&&0===e.base_resp.ret){if(pn(Ni(Vi,"js_sended_toast")),setTimeout((()=>{un(Ni(Vi,"js_sended_toast"))}),800),Sn().value="",Hi.disableBtn(),$i&&e.reply_info&&e.reply_info.reply_list){const t=fn(e.reply_info,0,!0).replyList,i=Ni(Vi,"js_qa_reply_list_".concat(Gi));i.appendChild(t.cloneNode(!0)),pn(Ni(i.parentNode,"js_write_reply")),un(Ni(i.parentNode.parentNode,"js_write_reply"))}else if(!$i&&e.answer_info&&e.answer_info.answer_list){const t=Ni(Vi,"js_qa_qna_answer_list");t.insertBefore(gn(e.answer_info.answer_list,!0).fragment,t.firstChild),pn(Ni(Vi,"js_qa_write_head"))}}else Hi.enableBtn(),168003===e.base_resp.ret||168007===e.base_resp.ret?Cn("内容涉嫌违反平台协议或法规政策"):168004===e.base_resp.ret?Cn("关注该公众号才能参与讨论"):168005===e.base_resp.ret?Cn("关注该公众号3天及以上才能参与讨论"):168008===e.base_resp.ret||168009===e.base_resp.ret?Cn("字数不能多于"+($i?140:600)):mn()},error(){mn(),Hi.enableBtn()},complete(){un(Ni(Vi,"js_loading_toast")),Sn().blur()}})},makeFakeInputEle(){const e=Sn(),t=e.cloneNode();t.id="tmp_input",t.style.top=0,t.style.position="absolute",e.parentNode.insertBefore(t,e),t.value=e.value,t.scrollTop=e.scrollTop},removeInputEle(){const e=document.getElementById("tmp_input");e&&e.parentNode.removeChild(e)},makeInputEleBigger(){const e=Sn(),t="1000px";e.style.borderTop="solid ".concat(t," transparent"),e.style.position="relative",e.style.top="-".concat(t)}}),Tn(),Hi.disableBtn(),e?Hi.setCloseBtnStyle("back"):Hi.setCloseBtnStyle("close"),Hi.show(!0,Sn()),function(){const e=Sn();Ne.on(Vi,"tap",".js_get_more_reply",(e=>{vn(e.delegatedTarget)})),Ne.on(e,"input",xn),Ne.on(e,"tap",(()=>{Hi.scrollTo(0,0)}))}(),new s.Emotion({emotionPanel:r("#js_qa_emotion_panel"),inputArea:r(Sn()),emotionPanelArrowWrp:r("#js_qa_emotion_panel_arrow_wrp"),emotionSwitcher:r("#js_qa_emotion_switch"),emotionSlideWrapper:r("#js_qa_emotion_slide_wrapper"),emotionNavBar:r("#js_qa_emotion_navbar"),inputEmotion(){xn()}})}const Ln={renderQaCard:function(e={}){qi&&(dn.mid=e.mid,dn.idx=e.idx,Ki.userUin=e.userUin,Ki.biz=e.biz,Ki.itemShowType=e.itemShowType,Ki.enterId=e.enterId,Ki.scene=e.scene,Ki.subScene=e.subScene,Ki.sessionId=e.sessionId,Wi=e.isLogin,yn({action:"get_qna_info",successCb(e,t){let i,n,o,a;const r=t.base_resp.ret,d=168001===r,c=t.qna_info&&t.qna_info.question_info;d?qi.innerHTML=qe.tmpl(Ai,{qaDeleted:d}):0===r&&("1"===be.getQuery("js_my_answer")&&(Pn(),hn(4)),e&&e.answer_list&&e.answer_list.length&&(o=gn(e.answer_list,!1).answerListHtml,n=e.answer_list.length,e.left_answer_cnt&&(i="余下#value#条讨论内容".replace("#value#",e.left_answer_cnt))),1===c.can_answer_type&&0===t.qna_info.is_fans?a="作者已设置关注后才可参与讨论":2===c.can_answer_type&&0===t.qna_info.is_fans_days&&(a="作者已设置关注7天后才可参与讨论"),qi.innerHTML=qe.tmpl(Ai,{qaDeleted:d,answerCount:n,leftAnswerCnt:i,answerListStr:o,disableAnswerWord:a,title:s.encode(c.question_title.htmlEncode()),nickname:c.biz_info.nickname,isLogin:Wi}),Fi=Ni(qi,"js_more_answer_entry"),function(){let e;function t(){if(e)return;const t=qi.firstChild,i=l.getOffset(t).offsetTop,n=We.getScrollTop();n+We.getInnerHeight()>=i&&n<=i+t.offsetHeight&&(_n({EventType:1}),hn("0"),e=!0)}Ne.on(qi,"tap",".js_get_more_reply",(e=>{const t=e.delegatedTarget.dataset.answerid;cn[t]?En():(En(!0,t),cn[t]=!0)})),Ne.on(document.body,"click",".js_qa_write_answer",(e=>{$i=!1,Pn(Ce.hasClass(e.delegatedTarget,rn)),hn(2)})),Ne.on(document.body,"click",".js_write_reply",(e=>{const t=e.delegatedTarget,i=t.parentNode.parentNode;if(Gi=t.dataset.answerid,Xi=t.dataset.answersn,i){const e=i.getElementsByClassName("js_qa_reply_content");Ji=i.getElementsByClassName("js_qa_my_reply").length,en=e.length?e[e.length-1].innerHTML:Ni(i,"js_qa_item_content").innerHTML}$i=Gi,$i&&(Pn(!0),hn(3))})),Ne.on(Fi,"click",(()=>{En(),_n({EventType:2}),hn(1)})),Ne.on(document.body,"tap",".js_qa_like",(e=>{const t=e.delegatedTarget,i=Ce.hasClass(t,an);Ce.toggleClass(t,an);const n=Ni(t,"js_like_num");let o=(parseInt(n.dataset.num,10)||0)+(i?-1:1);o=o>=0?o:0,n.innerHTML=$e.formatReadNum(o),n.dataset.num=o,hn("2"===t.dataset.type?6:5),ye({url:"/mp/qna?action=like",type:"POST",data:Object.assign({like_type:t.dataset.type,op:i?2:1,answer_id:t.dataset.id,reply_id:t.dataset.id},dn)})})),Ne.on(document.body,"tap",".js_delete_answer",(e=>{const t=e.delegatedTarget;hn(7),setTimeout((()=>{window.weui.confirm("确定删除讨论内容吗？",{buttons:[{label:"取消",type:"default"},{label:"删除",type:"primary",onClick(){ye({url:"/mp/qna?action=del_answer",type:"POST",dataType:"json",data:Object.assign({answer_id:t.dataset.id},dn),success(e){if(e&&e.base_resp&&0===e.base_resp.ret){const e=t.parentNode.parentNode.parentNode.parentNode;e&&Ce.hasClass(e,"js_qa_list_item")&&e.parentNode.removeChild(e)}else mn()}})}}]})}),50)})),Ne.on(document.body,"tap",".js_delete_reply",(e=>{const t=e.delegatedTarget;hn(8),setTimeout((()=>{window.weui.confirm("确定删除回复吗？",{buttons:[{label:"取消",type:"default"},{label:"删除",type:"primary",onClick(){ye({url:"/mp/qna?action=del_reply",type:"POST",dataType:"json",data:Object.assign({reply_id:t.dataset.id},dn),success(e){if(e&&e.base_resp&&0===e.base_resp.ret){const e=t.parentNode.parentNode.parentNode;if(e&&Ce.hasClass(e,"js_qa_reply_item")){const t=e.parentNode;t.removeChild(e),t.children.length||(un(t.parentNode),un(Ni(t.parentNode,"js_write_reply")),pn(Ni(t.parentNode.parentNode,"js_write_reply")))}}else mn()}})}}]})}),50)})),We.bindDebounceScrollEvent(t),t()}())}}))}},Dn=function(e,t){let i=!1,n=e;if(e===t)i=!0;else for(;n.parentNode&&(n=n.parentNode,1!==n.nodeType||"body"!==n.tagName.toLowerCase());)if(n===t){i=!0;break}return i},Rn=function(e){this.biz=e.biz,this.logid=e.logid,this.baseData=e.baseData,this.isPaySubscribe=e.isPaySubscribe,this.container=e.container,this.totalLength=this.container.innerText.length,this.initEvent()};Rn.prototype.initEvent=function(){Ne.on(document,"copy",(()=>{const e=[].concat(this.baseData),t=this.getContentData().trim();t.length&&(e.push(this.totalLength),e.push(""),e.push(t.length),e.push(this.isPaySubscribe),this.report(e.join(",")))}))},Rn.prototype.getContentData=function(){const e=document.getSelection(),t=this.container;let i="";if(e&&e.rangeCount){const n=e.getRangeAt(0);if(!n.collapsed){const o=n.startContainer,s=n.startOffset,a=n.endContainer,r=n.endOffset,l=Dn(o,t),d=Dn(a,t);if(l&&d)i=n.toString();else if(l||d){const e=document.createRange();e.setStart(o,s),e.setEnd(a,r),!d&&e.setEndAfter(t),!l&&e.setStartBefore(t),i=e.toString()}else if(e.containsNode&&e.containsNode(t,!0)){const e=document.createRange();e.setEndAfter(t),e.setStartBefore(t),i=e.toString()}}}return i},Rn.prototype.report=function(e){const t=this.biz,i=this.logid;ye({url:"/mp/webcommreport?action=report&report_useruin=1&__biz="+t,type:"POST",data:{logid:i,buffer:e},async:!1,timeout:2e3})};let Bn=null;if(window.parent!==window){let e=function(e){let t;console.log("[IFRAME RECEIVE MESSAGE]: ",e),e.origin?t=e.origin:e.originalEvent&&(t=e.originalEvent.origin),/^http(s)?\:\/\/finance\.qq\.com$/.test(t)&&/^http(s)?\:\/\/gu\.qq\.com$/.test(t)&&/^http(s)?\:\/\/wzq\.tenpay\.com$/.test(t)&&e.source&&(e.data,document.getElementsByTagName("body")[0],document.getElementById("activity-name"),document.getElementById("meta_content"),document.getElementById("page-content"))};document.getElementsByTagName("html")[0].style.width="1px",document.getElementsByTagName("html")[0].style.minWidth="100%",document.getElementById("js_content"),document.getElementById("img-content");let t=document.getElementById("page-content");document.getElementsByClassName("rich_media_area_extra")[0].style.display="none",Bn=function(e){if(!t)return;console.info("postPageHeightMessage");let i=getComputedStyle(t);["http://finance.qq.com","http://gu.qq.com","https://gu.qq.com","https://wzq.tenpay.com","https://www.tentrees.cn/","https://sticker.weixin.qq.com"].forEach((t=>{window.parent.postMessage({name:e,data:parseFloat(i.height)},t)}))},Bn("pageHeight"),window.addEventListener("message",e,!1)}const On=Bn,jn={copyright_top:0};function Mn(e){let t=["/mp/copyrightreport?action=report&biz=",biz,"&scene=",e.scene,"&user_uin=",user_uin,"&uin=",uin,"&key=",key,"&pass_ticket=",pass_ticket,"&mid=",window.mid,"&idx=",window.idx,"&source_biz=",window.source_biz,"&source_mid=",window.source_mid,"&source_idx=",window.source_idx,"&card_version=2","&show_appmsg_scene=",window.source,"&session_id=",window.sessionid,"&has_recommend_msg=",window.hasRecommendMsg,"&reprint_type=",window.reprint_type,"&t=",Math.random()].join("");window.isSg&&(t+="&from=sougou"),(new Image).src=t.substr(0,1024)}function Nn(){(window.pageYOffset||document.documentElement.scrollTop)+We.getInnerHeight()>jn.copyright_top&&(Mn({scene:"1",card_pos:"0"}),Ne.off(window,"scroll",Nn),Nn=jn.copyright_top=null)}function qn(e){return document.getElementById(e)}const Wn={card_click_report:Mn,card_pv_report:function(){if("2"==__appmsgCgiData.copyright_stat){let e=qn("copyright_info"),t=qn("js_article");for(;e&&t!==e;)jn.copyright_top+=e.offsetTop,e=e.offsetParent;Ne.on(window,"scroll",Nn),Nn()}}},Fn=document.getElementById("js_tags_preview_toast");let zn=null;const Un={init(e){if(1===window.reprint_style||2===window.reprint_style||3===window.reprint_style||1*e.dataset.len==0)return;const t=e=>{if(window.is_temp_url)Fn&&(Fn.style.display="",zn&&clearTimeout(zn),zn=setTimeout((()=>{Fn.style.display="none",zn=null}),3e3));else{const t={};let i=e.url;t.scene=window.source,t.subscene=window.subscene,t.sessionid=window.sessionid,t.enterid=window.enterid;let n=0;window.isPayTopic&&(n=0===window.isPaid?1:2),rt({eventType:2,albumId:e.album_id,albumType:0,tagSrc:e.tag_source,canPaid:window.isPayTopic,price:window.isPayTopic?window.payTopicPrice:0,ifPaid:n}),Pe.goUrl(i,Object.assign({},t,{scene:173,from_msgid:window.mid,from_itemidx:window.idx,count:3,nolastread:1}))}};if(Ce.hasClass(e,"js_single")){const i=e.querySelector(".js_tag").dataset;Ne.on(e,"click",(()=>t(i)))}else Ne.on(e,"click",(i=>{let n=i.target;n&&n!==e&&!Ce.hasClass(n,"js_tag")&&(n=n.parentNode),n&&Ce.hasClass(n,"js_tag")&&t(n.dataset)}));const i=t=>{const n=We.getInnerHeight()+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop);e.offsetTop<n?("function"!=typeof t&&Ne.off(window,"scroll",i),Array.prototype.forEach.call(e.getElementsByClassName("js_tag"),(e=>{const t=e.dataset;let i=0;window.isPayTopic&&(i=0===window.isPaid?1:2),rt({eventType:1,albumId:t.album_id,albumType:0,tagSrc:t.tag_source,canPaid:window.isPayTopic,price:window.isPayTopic?window.payTopicPrice:0,ifPaid:i})}))):"function"==typeof t&&t()};i((()=>{Ne.on(window,"scroll",i)}))}};const Hn=xt({name:"mp-album",filters:{htmlDecode:e=>"".concat(e).html(!1)},props:{albumTags:{type:Array,default:()=>[]}},computed:{showAlbum(){return this.albumTags.length>0}},mounted(){Un.init(this.$refs.albumArea)}},(function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.showAlbum,expression:"showAlbum"}],ref:"albumArea",staticClass:"article-tag__list",attrs:{"data-len":e.albumTags.length}},[t("div",{staticClass:"article-tags"},e._l(e.albumTags,(function(i,n){return t("div",{key:n,staticClass:"article-tag__item-wrp js_tag weui-wa-hotarea js_wx_tap_highlight wx_tap_link",attrs:{"data-url":i.link.htmlDecode()||"/mp/publictag?action=get&tag_id=".concat(i.tagId,"&start=0"),"data-tag_id":i.tagId,"data-album_id":i.albumId,"data-tag_source":i.tagSource,role:"link",tabindex:"0"}},[t("span",{staticClass:"article-tag__item"},[t("i",{staticClass:"weui-icon-album"}),e._v(e._s(e._f("htmlDecode")(i.title)))]),i.size>0?t("span",{staticClass:"article-tag__item-num"},[t("span",{attrs:{id:""}},[e._v(e._s(i.size))])]):e._e()])})),0)])}),[],!1,null,null,null,null).exports,Vn=[2390745668,3099420829,3872121626,3203738065,3072206507,3566970574,3002803029,3099387730,3559965496,3525314097,2390323860,3084276724,3289028514,3003793452,3003972371,2398512110,3071748654,3233018348,3095049467,3076061592,3273032305,3264278949,3086344434,3014829842,3294546013,2058310401,2397841479,2397640820,3282179238,3072107639,3521076442,3554888231,2397274880,2394106525,3077726226,2103095721,3593723769,2395186785,2393698643,3944000110,2397445840,2394144447,3082139483,3070806332,3016714421,3006879186,3213574124,3221398587,3078448935,3591999034,3551390431],Kn=["testrd","otherrd"];let $n=0;try{$n=1*window.atob(window.biz)}catch(Mu){}let Jn={report_action:2,share_type:5};function Gn(e,t,i){let n="",o="";try{""!=tid&&(o="tid="+tid+"&aid=54");let s=e.split("?")[1]||"";if(s=s.split("#")[0],""==s);else{let a=[s,"mpshare=1","scene="+t,"srcid="+srcid,"sharer_shareinfo="+i],r=be.getQuery("sharer_shareinfo_first")||be.getQuery("sharer_shareinfo");if(r?a.push("sharer_shareinfo_first="+r):a.push("sharer_shareinfo_first="+i),""!=o&&a.push(o),s=a.join("&"),2===t&&Vn&&Vn.indexOf($n)>-1){let t=Math.floor(Math.random()*Kn.length),i=Kn[t];n=e.split("?")[0]+"?"+s+"&testtype=".concat(i)+"#"+(e.split("#")[1]||"")}else n=e.split("?")[0]+"?"+s+"#"+(e.split("#")[1]||"")}}catch(Mu){n=""}return n||(n=location.href+"#wechat_redirect",ge.setLogs({id:28307,key:47,value:1,log:"[share_link]["+encodeURIComponent(location.href)+"]["+encodeURIComponent(e)+"]["+encodeURIComponent(msg_link)+"]"})),n}Ee.call("hideToolbar"),Ee.call("showOptionMenu");let Xn=msg_title.htmlDecode(),Yn="",Qn=cdn_url_1_1||msg_cdn_url||ori_head_img_url||round_head_img,Zn=Qn,eo=msg_link.htmlDecode(),to=msg_desc.htmlDecode();function io(e,t,i,n,o=0){Le.shareReport({link:e,action_type:i,sharer_shareinfo:n,share_source:window.customShareSource||(0===o?1:2)})}function no(e,t){return e.isCDN()&&(e=be.addWxfrom(e,t)),e}to=to||" ",to=to.replace(/<br\/>/g,"\n"),idx>1&&document.getElementById("js_content")&&ct<1446652800&&(to=document.getElementById("js_content").innerHTML.replace(/<\/?[^>]*\/?>/g,"").htmlDecode().replace(/^(\s*)|(\s*)$/g,"").substr(0,54)),window.isPayTopic&&(to="收录于付费合集"+window.payTopicTitle||""),Qn=Qn.compressCDNImgSize(),Zn=Zn.compressCDNImgSize(),malicious_title_reason_id&&(Xn=d.maliciousTitleMap[malicious_content_type][malicious_title_reason_id]||Xn,to=d.maliciousDescMap[malicious_content_type][malicious_title_reason_id]||to,1!=malicious_content_type&&(Qn="https://mmbiz.qlogo.cn/mmbiz_png/cVgP5bCElFiayFgbgEB9iaDt7hLicfz9RrXGM0LpaQ0TUic2gP7lbbqU3jCD8ibonicgIa3p99yjx1f1P26HChraeRUg/0?wx_fmt=png")),("1"==is_limit_user||window.cps_article_data)&&Ee.call("hideOptionMenu"),window.is_temp_url&&Ee.invoke("hideMenuItems",{menuList:["menuItem:share:timeline","menuItem:share:qq","menuItem:share:weiboApp","menuItem:share:facebook","menuItem:share:qzone","menuitem:share:weibo","menuItem:share:WeiboApp","menuItem:share:QZone","menuitem:facebook","menuItem:copyUrl","menuItem:share:email","menuitem:copy_url","menuitem:share:haokan"]},(function(e){}));let oo="https://res.wx.qq.com/op_res/Fwh9olR917lxUMxpJVM5sCCyrQOJSm68IEt-HfL7vpc5-_etzmyuLg1kPdU6RNRX";function so(){let e=kt(window.user_uin+"_"+Date.now());if(window.is_wash)return{img_url:oo,img_width:"640",img_height:"640",link:Gn(eo,2,e),desc:"",title:"原文存在洗稿行为，你可以阅读以下原创作者的内容"};{let t=Qn;Ae.isIOS||(t=no(Qn,"2"));let i={img_url:t,img_width:"640",img_height:"640",link:eo,desc:to,title:Xn};if(window.customShareInfo&&"object"==typeof window.customShareInfo&&Object.assign(i,window.customShareInfo),"string"==typeof i.forbid_msg){let e=i.forbid_msg.replace("#op#","分享");return void(window.weui||window).alert(e)}return i.link=Gn(i.link,2,e),i}}function ao(){const e=function(){let e=kt(window.user_uin+"_"+Date.now());if(window.is_wash)return{img_url:oo,img_width:"640",img_height:"640",link:Gn(eo,type,e),desc:"你可以阅读以下原创作者的内容",title:"原文存在洗稿行为"};{let t=1,i=no(Qn,"1");1==malicious_content_type&&(i="https://mmbiz.qlogo.cn/mmbiz_png/cVgP5bCElFiayFgbgEB9iaDt7hLicfz9RrXGM0LpaQ0TUic2gP7lbbqU3jCD8ibonicgIa3p99yjx1f1P26HChraeRUg/0?wx_fmt=png");let n={appid:Yn,img_url:i,img_width:"640",img_height:"640",link:eo,desc:to,title:Xn};if(window.customShareInfo&&"object"==typeof window.customShareInfo&&Object.assign(n,window.customShareInfo),"string"==typeof n.forbid_msg){let e=n.forbid_msg.replace("#op#","分享");return void(window.weui||window).alert(e)}return n.link=Gn(n.link,t,e),n}}();e&&Ee.invoke("shareCustomContent",{friend:e,timeline:so()},(t=>{console.info("shareCustomContent res",t);let i=kt(window.user_uin+"_"+Date.now());io(eo,0,1,i,2),c.commit("mp-related-article/setSources","share"),e.vid&&(Jn=Object.assign(Jn,{vid:e.vid,share_type:2}),u.reportKanData(Jn))}))}const ro={itemClassName:"album_read_directory_item",albumId:window.appmsg_album_info.id,pageCount:10,isPC:Ae.isWindows||Ae.isMac&&!Ae.isIOS,isInsertBlock:!1};let lo;const co="&cur_album_id=".concat(ro.albumId),uo=document.createElement("div");function po(){const e=document.createElement("div"),t=document.createElement("span");return t.setAttribute("role","option"),t.innerHTML='<span aria-label="合集：">#</span>'.concat(window.appmsg_album_info.title),e.appendChild(t),e.innerHTML}function ho(){const e=document.createElement("div");e.style.position="relative",e.style.cursor="pointer",e.setAttribute("role","listbox");let t,i,n,o,s,a=[],r=!0,l=!0,d=1;function c(e,a=!1,r=!0){const l=document.createDocumentFragment();if(i)if(a){d=1;for(let t=0;t<e.length;t++)if(e[t].msgid.toString()===window.appmsgid.toString()&&e[t].itemidx.toString()===window.idx.toString()){d=t;break}e.forEach(((e,i)=>{e.index=n?t-(i-d):t+(i-d)}))}else r?e.forEach(((e,t)=>{e.index=n?s.index-t-1:s.index+t+1})):e.forEach(((t,i)=>{t.index=n?o.index+(e.length-i):o.index-(e.length-i)}));return e.forEach((e=>{const t=document.createElement("div");if(Ce.addClass(t,ro.itemClassName),e.msgid.toString()===window.mid.toString()&&e.itemidx.toString()===window.idx.toString()?Ce.addClass(t,"album_read_directory_current"):1===e.user_read_status&&(Ce.addClass(t,"album_read_directory_disabled"),Ce.addClass(t,"js_wx_tap_highlight"),Ce.addClass(t,"wx_tap_cell")),i){const i=document.createElement("span");i.className="album_read_directory_item_index",i.innerText="".concat(e.index,"."),t.appendChild(i)}const n=document.createElement("span");n.className="album_read_directory_title_wrp";const o=document.createElement("span");o.className="album_read_directory_title_wrp",o.innerText=e.title,n.appendChild(o),t.setAttribute("data-url",e.url),t.setAttribute("role","option");const s=document.createElement("span");if(e.is_paid){const e="已付费";Ce.addClass(s,"wx_icon_pay_tag"),Ce.addClass(s,"wx_icon_pay_tag_paid"),s.innerText=e,n.appendChild(s)}else if(e.is_pay_subscribe){const e="付费";Ce.addClass(s,"wx_icon_pay_tag"),s.innerText=e,n.appendChild(s)}t.appendChild(n),l.appendChild(t)})),l}function u(e){1*e.reverse_continue_flag||(r=!1,lo.disablePullDownLoad()),1*e.continue_flag||(l=!1)}const p={extClass:"album_read_directory weui-half-screen-dialog_fold",hasBtn:!0,btnSlot:'<div id="js_topic_detail" class="weui-btn__word-wrp">\n                  <span class="weui-btn__word">详情</span>\n                  <i class="weui_right_arrow"></i>\n                </div>',title:po(),btnClickCb(){lt({ActionType:6}),dt(15),function(){const e=window.appmsg_album_info;if(e.link){const t=e.link.replace("#wechat_redirect","&subscene=159&subscene=".concat(window.source,"&scenenote=").concat(encodeURIComponent(window.location.href),"&nolastread=1#wechat_redirect"));Je.openUrlWithExtraWebview(t.htmlDecode())}}()},cb(){var a;a=a=>{lo.hideLoading(),n=a.base_info.is_reverse,t=a.base_info.cur_article_num,i=a.base_info.is_numbered,e.appendChild(c(a.article_list,!0)),o=a.article_list[0],s=a.article_list[a.article_list.length-1],u(a),l||lo.showEndLine(),r&&(e.firstChild.parentNode.insertBefore(uo,e.firstChild),ro.isInsertBlock=!0,lo.scrollTo(0,e.firstChild.offsetTop+1));const p=e.childNodes[d];setTimeout((()=>{p.offsetTop+p.clientHeight>lo.contentAreaWrp.clientHeight&&lo.scrollTo(0,e.offsetHeight)}),200)},ye({type:"GET",url:"/mp/appmsgalbum?action=paging&__biz=".concat(window.biz,"&album_id=").concat(ro.albumId,"&cur_msgid=").concat(window.appmsgid,"&cur_itemidx=").concat(window.idx,"&count=").concat(ro.pageCount),timeout:5e3,dataType:"json",success:function(e){e.base_resp&&0===e.base_resp.ret&&a(e.getalbum_resp)},error(){console.log("[error]")}})},onShow(){lt({ActionType:4}),dt(14)},onPullUpLoad(){l&&(lo.showPullUpLoading(),ye({type:"GET",url:"/mp/appmsgalbum?action=paging&__biz=".concat(window.biz,"&album_id=").concat(ro.albumId,"&begin_msgid=").concat(s.msgid,"&begin_itemidx=").concat(s.itemidx,"&count=").concat(ro.pageCount),timeout:5e3,dataType:"json",success:function(t){lo.hidePullUpLoading();if(0===(t.base_resp&&1*t.base_resp.ret)){const i=t.getalbum_resp.article_list;u(t.getalbum_resp),e.appendChild(c(i,!1,!0)),a=a.concat(i),lo.finishPullUpLoad(),s=a[a.length-1],1*t.getalbum_resp.continue_flag||lo.showEndLine()}},error:function(){}}))},onPullDownLoad(){r&&(ro.isInsertBlock&&(uo.parentNode.removeChild(uo),ro.isInsertBlock=!1),lo.showPullDownLoading(),ye({type:"GET",url:"/mp/appmsgalbum?action=paging&__biz=".concat(window.biz,"&album_id=").concat(ro.albumId,"&begin_msgid=").concat(o.msgid,"&begin_itemidx=").concat(o.itemidx,"&count=").concat(ro.pageCount,"&isbackward=1"),timeout:5e3,dataType:"json",success:function(t){lo.hidePullDownLoading();if(0===(t.base_resp&&1*t.base_resp.ret)){const i=t.getalbum_resp.article_list,n=t.getalbum_resp.continue_flag;t.getalbum_resp.continue_flag=t.getalbum_resp.reverse_continue_flag,t.getalbum_resp.reverse_continue_flag=n,u(t.getalbum_resp);const s=c(i,!1,!1),r=e.firstChild;e.insertBefore(s,r),a=i.concat(a),lo.scrollTo(0,r.offsetTop-62),setTimeout((()=>{lo.finishPullDownLoad()}),500),o=a[0]}},error:function(){}}))}};var h;window.appmsg_album_info.size<=4&&(p.top="".concat(screen.height/2-(screen.height-window.innerHeight),"px")),lo=new Mi(e,p),lo.showLoading(),!ro.isPC&&lo.show(),(h=e)&&Ne.on(h,"click",".".concat(ro.itemClassName),(e=>{const t=e.delegatedTarget;if(Ce.hasClass(t,"album_read_directory_current"))return;let i;i=t.dataset.url.includes("#")?t.dataset.url.replace("#","".concat(co,"&scene=190#")):t.dataset.url+"".concat(co,"&scene=190"),lt({ActionType:5,Url:i}),Pe.jumpUrl(i,!0,{useFastLoad:!0}),Ce.addClass(t,"album_read_directory_disabled")}))}uo.style.height="1px";const mo=e=>new RegExp("^".concat(location.protocol,"//")).test(e)?e:e.replace(/^.*\/\//,"".concat(location.protocol,"//"));const _o=xt({name:"mp-keep-read",components:{[p.name]:p},data:()=>({isPC:Ae.isWindows||Ae.isMac&&!Ae.isIOS}),computed:{...h({appmsgAlbumInfo:e=>e.cgiData.appmsg_album_info,appmsgAlbumExtInfo:e=>{var t,i;return(null==(t=e.extRes)?void 0:t.appmsg_album_extinfo)||(null==(i=e.cgiData)?void 0:i.appmsg_atricle_album_info)}}),showCard(){return this.appmsgAlbumExtInfo&&(this.appmsgAlbumExtInfo.pre_article_link||this.appmsgAlbumExtInfo.next_article_link)}},watch:{appmsgAlbumExtInfo:{handler(){this.showCard&&this.$nextTick((()=>{this.initExposeReport()}))},immediate:!0}},methods:{onShow(){!ve.os.pc&&document.body.classList.add("page_no_scroll")},onHide(){!ve.os.pc&&document.body.classList.remove("page_no_scroll")},showBottomModal(){lo?!this.isPC&&lo.show():ho(),this.isPC&&(this.$refs.albumKeepRead.style.overflow="visible",lo.contentAreaWrp.style.height="355px",lo.endLine.childNodes[3].style.background="var(--weui-BG-5)",this.$refs.pcPopoverContent.appendChild(lo.contentAreaWrp))},jumpPrev(){let e;lt({ActionType:2,SubActionType:1}),dt(12),e=this.appmsgAlbumExtInfo.pre_article_link.includes("#")?this.appmsgAlbumExtInfo.pre_article_link.replace("#","".concat(co,"&scene=189#")):this.appmsgAlbumExtInfo.pre_article_link+"".concat(co,"&scene=189"),location.href=mo(e.replace(/&amp;/g,"&"))},jumpNext(){let e;lt({ActionType:2,SubActionType:2}),dt(13),e=this.appmsgAlbumExtInfo.next_article_link.includes("#")?this.appmsgAlbumExtInfo.next_article_link.replace("#","".concat(co,"&scene=189#")):this.appmsgAlbumExtInfo.next_article_link+"".concat(co,"&scene=189"),location.href=mo(e.replace(/&amp;/g,"&"))},gotoAlbumInfo(){if(lt({ActionType:6}),dt(15),this.appmsgAlbumInfo.link){const e=this.appmsgAlbumInfo.link.replace("#wechat_redirect","&subscene=159&subscene=".concat(window.source,"&scenenote=").concat(encodeURIComponent(window.location.href),"&nolastread=1#wechat_redirect"));Je.openUrlWithExtraWebview(e.htmlDecode())}},initExposeReport(){let e;const{albumKeepRead:t}=this.$refs,i=t&&t.offsetHeight/2||0;function n(){if(e)return;const n=l.getOffset(t).offsetTop||0,o=We.getScrollTop();o+We.getInnerHeight()>=n+i&&o<=n+i&&(lt({ActionType:1}),dt(11),e=!0)}We.bindDebounceScrollEvent(n),n()}}},(function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.showCard,expression:"showCard"}],ref:"albumKeepRead",staticClass:"appmsg_card_context album_read_card"},[e.showCard?[t("div",{staticClass:"album_read_hd weui-flex",attrs:{role:"button"},on:{click:function(t){return t.stopPropagation(),e.showBottomModal.apply(null,arguments)}}},[e.isPC?t("mp-popover",{attrs:{"wrp-class":"popover-wrp-class","ext-class":"popover-ext-class"},on:{show:e.onShow,hide:e.onHide}},[t("div",{staticClass:"album_read_source",attrs:{slot:"target"},slot:"target"},[t("span",{staticClass:"wx_tap_link js_album_directory__name"},[e._v(e._s(e.appmsgAlbumInfo.title.htmlDecode())+" · 目录")]),t("i",{staticClass:"weui-icon-read"})]),t("div",{staticClass:"album_name_title",attrs:{slot:"title"},on:{click:function(t){return t.stopPropagation(),e.gotoAlbumInfo.apply(null,arguments)}},slot:"title"},[e._v("#"+e._s(e.appmsgAlbumInfo.title.htmlDecode()))]),t("div",{ref:"pcPopoverContent"})]):t("div",{staticClass:"album_read_source"},[t("span",{staticClass:"wx_tap_link js_album_directory__name"},[e._v(e._s(e.appmsgAlbumInfo.title.htmlDecode())+" · 目录")]),t("i",{staticClass:"weui-icon-read"})])],1),t("div",{staticClass:"album_read_bd weui-flex"},[e.appmsgAlbumExtInfo.pre_article_link?t("span",{staticClass:"album_read_nav_item album_read_nav_prev weui-flex__item wx_tap_link js_wx_tap_highlight",attrs:{role:"button"},on:{click:e.jumpPrev}},[t("span",{staticClass:"album_read_nav_inner"},[t("span",{staticClass:"album_read_nav_btn"},[e._v("上一篇")]),t("span",{staticClass:"album_read_nav_title"},[t("span",{staticClass:"album_read_nav_title_inner"},[e._v(e._s(e.appmsgAlbumExtInfo.pre_article_title.htmlDecode()||""))])])])]):e._e(),e.appmsgAlbumExtInfo.next_article_link?t("span",{staticClass:"album_read_nav_item album_read_nav_next weui-flex__item wx_tap_link js_wx_tap_highlight",attrs:{role:"button"},on:{click:e.jumpNext}},[t("span",{staticClass:"album_read_nav_inner"},[t("span",{staticClass:"album_read_nav_btn"},[e._v("下一篇")]),t("span",{staticClass:"album_read_nav_title"},[t("span",{staticClass:"album_read_nav_title_inner"},[e._v(e._s(e.appmsgAlbumExtInfo.next_article_title.htmlDecode()||""))])])])]):e._e()])]:e._e()],2)}),[],!1,null,null,null,null).exports;const fo=xt({name:"mp-pay-btn",props:{buttonText:{type:String,default:"微信豆兑换"}},computed:{...h(["cgiData"]),...h("mp-pay-read",["loading","isInMiniProgram"])},methods:{...m("mp-pay-read",["payFunc"])}},(function(){var e=this,t=e._self._c;return t("button",{ref:"payPanelBtn",staticClass:"js_pay_btn js_article_bottom weui-btn weui-btn_loading",class:{btn_disabled:e.isInMiniProgram},on:{click:e.payFunc}},[e.loading?t("div",{staticClass:"js_button_loading"},[e._m(0),e._v(" 加载中 ")]):t("div",[t("i",{staticClass:"pay__icon-wecoin"}),t("span",{staticClass:"price js_pay_fee",attrs:{id:"js_pay_fee_normal"}},[e._v(e._s(e.cgiData.wecoin_amount))]),e._v(" "+e._s(e.buttonText)+" ")])])}),[function(){var e=this._self._c;return e("span",{staticClass:"weui-primary-loading weui-primary-loading_transparent"},[e("i",{staticClass:"weui-primary-loading__dot"})])}],!1,null,null,null,null).exports,go=8+window.parseInt(window.getComputedStyle(document.documentElement).getPropertyValue("--sab"));let yo=0,wo=0,vo=!1,bo=0;const So=window.scrollY,Io=window.innerHeight/3,xo={name:"mp-pay-gift",data:()=>({giftBarTitleText:"可赠送给一位朋友免费阅读"}),computed:{...h(["cgiData"]),...h("mp-pay-read",["paySubscribeInfo"])},mounted(){const e=window.localStorage.getItem("paySuc"),t=this.$refs.giftBar.getBoundingClientRect().top;"1"===e&&t>window.innerHeight?(window.localStorage.setItem("paySuc","0"),this.$refs.giftBar.className="pay__gift-send show",this.giftBarTitleText="已兑换，可赠送给一位朋友",_.reportSend(2),Ne.on(window,"scroll",this.scrollHandler),Ne.on(this.$refs.giftBar,"touchstart",this.touchStartHandler),Ne.on(this.$refs.giftBar,"touchmove",this.touchMoveHandler),Ne.on(this.$refs.giftBar,"touchend",this.touchEndHandler)):!Ce.hasClass(this.$refs.giftBar,"show")&&t<=window.innerHeight&&(this.$refs.giftBar.className="pay__gift-send pay__gift-send_static",_.reportSend(4))},beforeDestroy(){Ne.off(window,"scroll",this.scrollHandler)},methods:{present(){if(ve.os.iphone||ve.os.ipad||ve.os.android){let e=this.paySubscribeInfo.gift_url.html(),t="";const i=e.indexOf("#");-1!==i&&(t=e.substring(i),e=e.substring(0,i)),Ce.hasClass(this.$refs.giftBar,"pay__gift-send_static")?_.reportSend(5):_.reportSend(3),Pe.goUrl("".concat(e,"&sessionid=").concat(this.cgiData.sessionid,"&enterid=").concat(this.cgiData.enterid,"&scene=").concat(this.cgiData.source,"&subscene=").concat(this.cgiData.subscene,"&biz=").concat(this.cgiData.biz,"&mid=").concat(this.cgiData.mid,"&idx=").concat(this.cgiData.idx).concat(t))}else window.weui.alert("请使用移动端微信打开")},touchStartHandler(e){Ce.hasClass(this.$refs.giftBar,"show")&&(vo=!0,bo=e.touches[0].clientY,yo=wo)},touchMoveHandler(e){e.preventDefault();const t=e.touches[0].clientY-bo;Ce.hasClass(this.$refs.giftBar,"show")&&vo&&(t+yo>=0&&t+yo<=go?(this.$refs.giftBar.style.transform="translate3d(0, ".concat(t+yo,"px, 0)"),wo=t+yo):t+yo>go?(this.$refs.giftBar.style.transform="translate3d(0, ".concat(go,"px, 0)"),wo=go):t+yo<0&&(this.$refs.giftBar.style.transform="translate3d(0, 0, 0)",wo=0))},touchEndHandler(){vo=!1,Ce.hasClass(this.$refs.giftBar,"show")&&wo===go&&(this.$refs.giftBar.className="pay__gift-send",Ne.off(this.$refs.giftBar,"touchstart",this.touchStartHandler),Ne.off(this.$refs.giftBar,"touchmove",this.touchMoveHandler),Ne.off(this.$refs.giftBar,"touchend",this.touchEndHandler))},scrollHandler(){const e=document.getElementById("js_pay_wall_wrap").getBoundingClientRect();e.top+e.height-48<=window.innerHeight?(this.giftBarTitleText="可赠送给一位朋友免费阅读",this.$refs.giftBar.className="pay__gift-send pay__gift-send_static",this.$refs.giftBar.style.transform="translate3d(0, 0, 0)",Ne.off(this.$refs.giftBar,"touchstart",this.touchStartHandler),Ne.off(this.$refs.giftBar,"touchmove",this.touchMoveHandler),Ne.off(this.$refs.giftBar,"touchend",this.touchEndHandler),Ne.off(window,"scroll",this.scrollHandler),_.reportSend(4)):window.scrollY-So>Io&&(this.$refs.giftBar.className="pay__gift-send")}}};const ko=xt(xo,(function(){var e=this,t=e._self._c;return t("div",{ref:"giftBar",staticClass:"pay__gift-send_static pay__gift-send",attrs:{id:"js_pay_gift_bar"}},[t("div",{staticClass:"pay__gift-send-content"},[t("div",{staticClass:"pay__gift-send-title",attrs:{id:"js_pay_gift_bar_title"}},[e._v(" "+e._s(e.giftBarTitleText)+" ")])]),t("div",{staticClass:"pay__gift-send-btn",attrs:{id:"js_send_pay_gift"},on:{click:e.present}},[e._v("去赠送")])])}),[],!1,null,null,null,null).exports;const To=xt({name:"mp-pay-read-qrcode",computed:{src(){if(ve.os.pc){return"/mp/paysubqrcode?action=get_article_qrcode&__biz=".concat(window.biz,"&mid=").concat(window.mid,"&idx=").concat(window.idx,"&sn=").concat(window.sn,"#wechat_redirect")}return""}}},(function(){var e=this,t=e._self._c;return t("div",{staticClass:"pay__notice-qrcode js_pay_qrcode_wrap js_pay_fee_display"},[t("div",{staticClass:"pay__qrcode-wrp"},[t("img",{staticClass:"js_pay_qrcode",attrs:{src:e.src}})]),t("div",{staticClass:"pay__qrcode-title"},[e._v("微信扫一扫付费阅读本文")])])}),[],!1,null,null,null,null).exports;const Co=xt({name:"mp-pay-read-bottom",components:{[To.name]:To,[fo.name]:fo,[f.name]:f},props:{payTopicNoticeText:{type:String,default:""},visible:{type:Boolean}},data:()=>({addLargeFontStyle:!1,bottomHeight:0,showBottomBar:!!window.is_login}),computed:{...h(["cgiData"]),...h("mp-pay-read",["wecoinText","loading","payReadBottomVisible"]),...h("mp-stream",["articleFoldStatus"]),...g("mp-pay-read",["topicLink"]),...g("mp-stream",["hasInteractData","recommendShow","recommendGray","recommendFriendNum","friendSeenInfo","showFriendSeen","hasRecommended"]),payBtnText(){return this.showBottomBar?"读全文":"微信豆兑换"},streamFriendsShow(){return!!(0!==this.showFriendSeen&&this.recommendShow&&1!==this.recommendGray&&this.recommendFriendNum>0)}},watch:{articleFoldStatus(e){!e&&this.showBottomBar&&this.$nextTick((()=>{this.judgeHeight("100")}))},hasInteractData(){this.$nextTick((()=>{this.judgeHeight("100")}))}},created(){this.unwatchVisible=this.$watch("visible",(e=>{var t,i,n;if(e){const e=null==(i=null==(t=this.$refs.button)?void 0:t.$el)?void 0:i.getBoundingClientRect().height,o=null==(n=this.$refs.content)?void 0:n.getBoundingClientRect().height;this.addLargeFontStyle=o/e>108/52,this.unwatchVisible()}}))},mounted(){this.showBottomBar&&(Ee.on("menu:setfont",(e=>{this.judgeHeight(e.fontScale)})),this.$nextTick((()=>{this.judgeHeight("100")})))},methods:{...y("mp-stream",["setStreamFriendsListStatus"]),...m("mp-pay-read",["goBuyTopic"]),getBottomBarHeight(){const e=document.getElementById("js_article_bottom_bar");return e?Math.floor(null==e?void 0:e.getBoundingClientRect().height):0},judgeHeight(e="100"){setTimeout((()=>{var t,i,n;let o=!1;if("100"===e){const e=null==(i=null==(t=this.$refs.button)?void 0:t.$el)?void 0:i.getBoundingClientRect().height;o=(null==(n=this.$refs.content)?void 0:n.getBoundingClientRect().height)/e>.7}this.addLargeFontStyle=1*e>=140||o,this.bottomHeight=this.getBottomBarHeight()}),100)},streamFriendsClick(){this.setStreamFriendsListStatus(!0)}}},(function(){var e=this,t=e._self._c;return 1!==e.cgiData.isPayTopic?t("div",{staticClass:"pay pay__notice",class:{pay__notice_largeFont:e.addLargeFontStyle,"pay__notice_new pay_new":e.showBottomBar,pay__notice_hiden:e.articleFoldStatus},style:{bottom:e.bottomHeight+"px"},attrs:{id:"js_pay_panel_bottom"}},[t("div",{staticClass:"pay__notice-intro"},[e.streamFriendsShow?t("mp-stream-friends",{attrs:{isPayArticle:!0,showFriendSeen:e.showFriendSeen,likeTipsInfo:e.friendSeenInfo,recommendFriendNum:e.recommendFriendNum,isRecommended:e.hasRecommended,payReadBottomVisible:e.payReadBottomVisible},on:{"stream-friends-click":e.streamFriendsClick}}):t("div",{ref:"content",staticClass:"pay__intro-content"},[t("p",{staticClass:"pay__notice-title"},[e._v(" 可试读"+e._s(e.cgiData.preview_percent)+"% ")]),t("div",{staticClass:"pay__notice-desc",attrs:{id:"js_pay_panel_bottom_wecoin_tips"}},[e._v(" "+e._s(e.wecoinText)+" ")])]),t("div",{staticClass:"pay__notice-btn-wrp",style:{width:"".concat(e.streamFriendsShow&&!e.payReadBottomVisible?"0":""),opacity:"".concat(e.streamFriendsShow&&!e.payReadBottomVisible?"0":1)}},[t("mp-pay-btn",{ref:"button",attrs:{"button-text":e.payBtnText}}),t("mp-pay-read-qrcode")],1)],1)]):t("div",{staticClass:"pay pay__notice pay__topic-notice",class:{"pay_new pay__notice_new":e.showBottomBar,pay__notice_hiden:e.articleFoldStatus},style:{bottom:e.bottomHeight+"px"},attrs:{id:"js_pay_topic_panel_bottom"}},[t("div",{staticClass:"pay__notice-intro"},[e.streamFriendsShow?t("mp-stream-friends",{attrs:{isPayArticle:!0,showFriendSeen:e.showFriendSeen,likeTipsInfo:e.friendSeenInfo,recommendFriendNum:e.recommendFriendNum,isRecommended:e.hasRecommended,payReadBottomVisible:e.payReadBottomVisible},on:{"stream-friends-click":e.streamFriendsClick}}):t("div",{staticClass:"pay__intro-content"},[t("div",{staticClass:"pay__notice-desc"},[e._v(" "+e._s(e.payTopicNoticeText)+" ")]),e.showBottomBar?e._e():t("p",{staticClass:"pay__notice-title"},[e._v(e._s(e.cgiData.payTopicTitle))])]),t("div",{staticClass:"pay__notice-btn-wrp",style:{width:"".concat(e.streamFriendsShow&&!e.payReadBottomVisible?"0":""),opacity:"".concat(e.streamFriendsShow&&!e.payReadBottomVisible?"0":1)}},[t("button",{staticClass:"js_pay_topic_btn weui-btn",class:{btn_disabled:e.cgiData.payTopicRemoveFlag>0},attrs:{"data-url":e.topicLink},on:{click:e.goBuyTopic}},[e._v(" 合集详情 ")]),t("mp-pay-read-qrcode")],1)],1)])}),[],!1,null,null,null,null).exports;const Ao=xt({name:"mp-buy-wecoin-btn",computed:{...h("mp-pay-read",["wecoinRemain"])}},(function(){var e=this,t=e._self._c;return t("div",{staticClass:"pay__wecoin-entry"},[t("i",{staticClass:"pay__icon-wecoin"}),t("span",{staticClass:"price",attrs:{id:"js_wecoin_remain"}},[e._v(e._s(e.wecoinRemain))])])}),[],!1,null,null,null,null).exports;const Eo=xt({name:"mp-pay-edu-tips",components:{[w.name]:w},computed:{...h(["cgiData"]),...h("mp-pay-read",["payEduTips"]),top:()=>window.innerHeight-467},methods:{...y("mp-pay-read",["setWecoinRemain","setPayLock","setPayEduTips"]),hideEduTipsCb(){this.$refs.bottomModal.hide(),v.show(),Ee.invoke("getWCCoinBalance",{},(e=>{v.hide(),e&&e.err_msg&&e.err_msg.indexOf("ok")>-1?(this.setWecoinRemain(e.balance),this.$emit("show-confirm")):this.setPayLock(!1)})),this.setPayEduTips({...this.payEduTips,firstWecoinRecharge:0})},show(){this.$refs.bottomModal.show()}}},(function(){var e=this,t=e._self._c;return t("mp-bottom-modal",{ref:"bottomModal",attrs:{"ext-class":"pay__edu-modal","has-header":!1,top:"".concat(e.top,"px")},on:{hide:e.hideEduTipsCb},scopedSlots:e._u([{key:"footer",fn:function(){return[t("a",{staticClass:"weui-btn weui-btn_default",on:{click:e.hideEduTipsCb}},[e._v("我知道了")])]},proxy:!0}])},[t("div",{staticClass:"pay__wecoin-edu-profile"},[t("div",{staticClass:"pay__wecoin-edu-title"},[e._v(" 可在「我>个人信息>微信豆」页面，查看微信豆消费明细。 ")]),t("div",{staticClass:"pay__wecoin-edu-pic"},[t("div",{staticClass:"pay__wecoin-edu-avatar"},[t("img",{attrs:{src:e.payEduTips&&e.payEduTips.userImgUrl}})]),t("div",{staticClass:"pay__wecoin-edu-nic"},[e._v(" "+e._s(e.payEduTips&&e.payEduTips.userNickname)+" ")])])])])}),[],!1,null,null,null,null).exports;const Po=xt({name:"mp-pay-confirm",components:{[w.name]:w,[Eo.name]:Eo,[Ao.name]:Ao},props:{title:{type:String,default:""}},data:()=>({agreeStat:!1}),computed:{...h(["cgiData"]),...h("mp-pay-read",["wecoinRemain","payEduTips","encodeRespBuff"]),needTopup(){return this.wecoinRemain<this.cgiData.wecoin_amount},btnDisabled(){return this.needTopup&&!1===this.agreeStat},wecoinTitle(){return this.needTopup?"微信豆不足，兑换全文还需":"兑换全文"},wecoinPrice(){return this.needTopup?this.cgiData.wecoin_amount-this.wecoinRemain:this.cgiData.wecoin_amount},wecoinTips(){return"售价 ".concat(this.wecoinPrice/10,"元")}},methods:{...y("mp-pay-read",["setPayLock","setWecoinRemain"]),...m("mp-pay-read",["paySuc","pollCheck"]),onLinkClick(e){e&&e.preventDefault(),et.reportPayAppmsg(17),Ee.invoke("openUrlWithExtraWebview",{url:"https://kf.qq.com/touch/product/WXDB_app.html",openType:1})},onTermClick(e){"A"===e.target.tagName&&Ee.invoke("openUrlWithExtraWebview",{url:this.cgiData.paySubscribeInfo.agreement_url.htmlDecode(),openType:1})},onTermCheckboxToggle(e){const{footerBtn:t}=this.$refs;e.target.checked?t.removeAttribute("disabled"):t.setAttribute("disabled","disabled")},show(){this.$refs.bottomModal.show()},hide(){this.$refs.bottomModal.hide()},onFooterBtnClick(){if(this.$refs.footerBtn.getAttribute("disabled"))return;const{wecoin_amount:e}=this.cgiData;Se.log("[Appmsg] pay process 5 wecoinAmountRemain=".concat(this.wecoinRemain," wecoin_amount=").concat(e)),this.needTopup?(this.hide(),setTimeout((()=>{et.reportPayAppmsg(19),Se.log("[Appmsg] pay process 6.1 buyWCCoin");const e=e=>{v.hide(),e&&e.err_msg&&e.err_msg.indexOf("ok")>-1&&(this.setWecoinRemain(e.balance),this.needTopup?this.show():this.consumeWCCoin())},t={businessId:2,scene:4,panelShowType:"present",diffWecoinCount:this.cgiData.wecoin_amount>this.wecoinRemain?this.cgiData.wecoin_amount-this.wecoinRemain:0};Ae.isAndroid&&Ae.gtVersion("8.0.18",!0)&&(t.mode=2,t.agreementVersion=this.cgiData.paySubscribeInfo.agreement_version,t.customCount=this.cgiData.wecoin_amount-this.wecoinRemain,t.productId=this.cgiData.paySubscribeInfo.recharge_product_id),Ee.invoke("buyWCCoin",t,(t=>{console.log(t),t&&t.err_msg&&(t.err_msg.indexOf("ok")>-1?Ae.isIOS&&Ae.ltVersion("8.0.17")||Ae.isAndroid&&Ae.ltVersion("8.0.17")?this.payEduTips.firstWecoinRecharge?this.$refs.eduTipsModal.show():(v.show(),Ee.invoke("getWCCoinBalance",{},e)):Ee.invoke("showWCCoinFirstBuyCoinTips",{alwaysDarkMode:!1},(()=>{v.show(),Ee.invoke("getWCCoinBalance",{},e)})):t.err_msg.indexOf("cancel")>-1&&this.show())}))}),250)):(this.hide(),this.consumeWCCoin())},consumeWCCoin(){const{encodeRespBuff:e}=this;Se.log("[Appmsg] pay process 3 can_use_wecoin=".concat(this.cgiData.can_use_wecoin)),Se.log("[Appmsg] pay process 4 on payBtn tap"),v.show();const t=Math.round(new Date/1e3);Ee.invoke("consumeWCCoin",{buff:e,businessId:2},(i=>{console.log("consumeWCCoin res",i),this.setPayLock(!1),i&&i.err_msg&&i.err_msg.indexOf("ok")>-1?(et.reportPay(t,1,e),this.pollCheck()):i&&i.err_msg&&i.err_msg.indexOf("fail")>-1&&(et.reportPay(t,3,e,i.err_msg,i.err_code,i.err_domain),window.weui.alert("兑换失败，请稍后再试"))}))},buyWecoin(){this.hide();const e=e=>{v.hide(),e&&e.err_msg&&e.err_msg.indexOf("ok")>-1&&(this.setWecoinRemain(e.balance),this.show())};setTimeout((()=>{et.reportPayAppmsg(14);const t=this.needTopup?this.cgiData.wecoin_amount-this.wecoinRemain:0;Ee.invoke("buyWCCoin",{businessId:2,scene:3,panelShowType:"present",diffWecoinCount:t},(t=>{console.log(t),t&&t.err_msg&&(t.err_msg.indexOf("ok")>-1?Ae.isIOS&&Ae.ltVersion("8.0.17")||Ae.isAndroid&&Ae.ltVersion("8.0.17")?this.payEduTips.firstWecoinRecharge?this.$refs.eduTipsModal.show():(v.show(),Ee.invoke("getWCCoinBalance",{},e)):Ee.invoke("showWCCoinFirstBuyCoinTips",{alwaysDarkMode:!1},(()=>{v.show(),Ee.invoke("getWCCoinBalance",{},e)})):t.err_msg.indexOf("cancel")>-1&&this.show())}))}),250)}}},(function(){var e=this,t=e._self._c;return t("div",[t("mp-bottom-modal",{ref:"bottomModal",attrs:{"ext-class":"pay__bottom-modal","has-btn":"","auto-height":""},on:{submit:e.buyWecoin,hide:function(t){return e.setPayLock(!1)}},scopedSlots:e._u([{key:"btn",fn:function(){return[t("mp-buy-wecoin-btn")]},proxy:!0},{key:"footer",fn:function(){return[t("div",[e.needTopup?t("div",{ref:"footerTerm",staticClass:"pay__wecoin-term weui-cells_checkbox",attrs:{id:"js_wecoin_term"},on:{click:e.onTermClick}},[t("label",{attrs:{for:"js_wecoin_term_check"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.agreeStat,expression:"agreeStat"}],ref:"wecoinCheck",staticClass:"weui-check",attrs:{id:"js_wecoin_term_check",type:"checkbox"},domProps:{checked:Array.isArray(e.agreeStat)?e._i(e.agreeStat,null)>-1:e.agreeStat},on:{change:function(t){var i=e.agreeStat,n=t.target,o=!!n.checked;if(Array.isArray(i)){var s=e._i(i,null);n.checked?s<0&&(e.agreeStat=i.concat([null])):s>-1&&(e.agreeStat=i.slice(0,s).concat(i.slice(s+1)))}else e.agreeStat=o}}}),t("i",{staticClass:"weui-icon-checked"}),e._v("同意"),t("a",{attrs:{href:"javascript:;"}},[e._v("《微信豆充值协议》")])])]):e._e(),t("div",{staticClass:"weui-half-screen-dialog__btn-area"},[t("a",{ref:"footerBtn",staticClass:"weui-btn weui-btn_primary",attrs:{disabled:e.btnDisabled},on:{click:e.onFooterBtnClick}},[e._v(e._s(e.needTopup?"去充值":"兑换"))])]),t("div",{staticClass:"weui-half-screen-dialog__attachment-wrp",on:{click:e.onLinkClick}},[t("a",{staticClass:"weui-half-screen-dialog__attachment-link",attrs:{href:"javascript:;"}},[e._v("常见问题")])])])]},proxy:!0}])},[t("div",{staticClass:"pay__wecoin"},[t("div",{staticClass:"pay__wecoin-title",staticStyle:{"font-weight":"normal"},attrs:{id:"js_wecoin_title"}},[e._v(" "+e._s(e.wecoinTitle)+" ")]),t("div",{staticClass:"pay__wecoin-content pay__wecoin-content-price"},[t("i",{staticClass:"pay__icon-wecoin"}),t("span",{staticClass:"price",attrs:{id:"js_wecoin_price"}},[e._v(e._s(e.wecoinPrice))])]),t("div",{ref:"wecoinTipsDom",staticClass:"pay__wecoin-tips",attrs:{id:"js_wecoin_tips"}},[e._v(" "+e._s(e.wecoinTips)+" ")])])]),t("mp-pay-edu-tips",{ref:"eduTipsModal",on:{"show-confirm":function(t){return e.$refs.bottomModal.show()}}})],1)}),[],!1,null,null,null,null).exports;const Lo=xt({name:"mp-wecoin-tips",components:{[w.name]:w},computed:{...h("mp-pay-read",["wecoinText"]),top:()=>innerHeight-375},methods:{onQuestionClick(e){e&&e.preventDefault(),et.reportPayAppmsg(17),Ee.invoke("openUrlWithExtraWebview",{url:"https://kf.qq.com/touch/product/WXDB_app.html",openType:1}),this.$refs.bottomModal.hide()},show(){this.$refs.bottomModal.show()}}},(function(){var e=this,t=e._self._c;return t("mp-bottom-modal",{ref:"bottomModal",attrs:{"ext-class":"pay__wecoin-edu-modal",top:"".concat(e.top,"px")},scopedSlots:e._u([{key:"footer",fn:function(){return[t("a",{staticClass:"pay__wecoin-edu-link",on:{click:e.onQuestionClick}},[e._v("常见问题")])]},proxy:!0}])},[t("div",{staticClass:"pay__wecoin-edu"},[t("div",{staticClass:"pay__wecoin-title"},[t("div",{staticClass:"pay__icon-wecoin"}),t("div",[e._v("付费内容需用微信豆兑换")])]),t("div",{staticClass:"pay__wecoin-edu-desc"},[e._v(" 微信豆是用于兑换微信内虚拟物品和服务的道具。 "),t("span",[e._v(e._s(e.wecoinText))]),e._v(" 微信豆还可用于兑换直播间的虚拟礼物等。 ")])])])}),[],!1,null,null,null,null).exports;const Do=xt({name:"mp-pay-read",components:{[Co.name]:Co,[To.name]:To,[Po.name]:Po,[fo.name]:fo,[Lo.name]:Lo,[ko.name]:ko,[b.name]:b},data:()=>({iapPriceInfo:null,showBottomBar:!!window.is_login}),computed:{...h(["cgiData","extRes"]),...h("mp-pay-read",["wecoinText","payLock","wecoinRemain","loading","isInMiniProgram","paySubscribeInfo","payReadBottomVisible"]),...g("mp-stream",["recommendShow","recommendGray","recommendFriendNum","showFriendSeen"]),...g("mp-pay-read",["isPaidLSKey","topicLink"]),contentTextLen(){var e;return 1*(null==(e=this.cgiData.payforread_info)?void 0:e.content_plain_text_len)},canGift(){return!!this.paySubscribeInfo&&this.cgiData.payGiftsCount-this.paySubscribeInfo.gifted_count>0},payFee(){var e;return(1*(null==(e=this.cgiData.payforread_info)?void 0:e.fee)/100).toFixed(2)},isPaid(){return this.cgiData.isPaid},previewPercent(){return this.cgiData.preview_percent},payTopicNoticeText(){return 0===this.previewPercent?"兑换合集后可阅读全文":"兑换合集后可阅读剩余".concat(100-this.previewPercent,"%")},payTopicFreqText(){const e=this.cgiData.payTopicCount,t=this.cgiData.payTopicTotalCount;return e<t?"已发表".concat(e,"个")+" "+"计划发表".concat(t,"个"):"已完结 共".concat(e,"个")},payTopicList(){return this.cgiData.payTopicArticleTitles?this.cgiData.payTopicArticleTitles.slice(0,4):[]},previewTipsText:()=>/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)?"付费后可赠送给一位朋友免费阅读 (1元 = 7微信豆)":"付费后可赠送给一位朋友免费阅读 (1元 = 10微信豆)",tempkey(){return this.cgiData.tempkey},payFeeNormalText(){const{wecoin_amount:e,fee:t}=this.cgiData;return e>0?e:t/10},payTotalSummary(){var e;const t=this.extRes.reward_total_count?"，".concat(Pe.formatNum(this.extRes.reward_total_count)," 人喜欢"):"";return"".concat(Pe.formatNum(null==(e=this.paySubscribeInfo)?void 0:e.pay_cnt)," 人付费")+t},avatarList(){return this.paySubscribeInfo?this.cgiData.isPaid&&!this.cgiData.payFreeGift?[Object.assign({},this.paySubscribeInfo.my_head_img_info,{reward_status:this.paySubscribeInfo.my_reward_status}),...this.paySubscribeInfo.pay_head_img_infos||[]]:this.paySubscribeInfo.pay_head_img_infos||[]:[]},payBtnText(){return this.showBottomBar?"读全文":"微信豆兑换"},streamFriendsShow(){return!!(0!==this.showFriendSeen&&this.recommendShow&&1!==this.recommendGray&&this.recommendFriendNum>0)}},watch:{extRes(e){e.pay_subscribe_info&&(this.setPayEduTips({firstWecoinRecharge:1*e.pay_subscribe_info.first_wecoin_recharge,userImgUrl:e.pay_subscribe_info.user_img_url,userNickname:e.pay_subscribe_info.user_nick_name}),this.setPayGlobal({enable_custom_recharge:e.pay_subscribe_info.enable_custom_recharge,agreement_url:e.pay_subscribe_info.agreement_url,agreement_version:e.pay_subscribe_info.agreement_version,agreement_status:e.pay_subscribe_info.agreement_status,recharge_product_id:e.pay_subscribe_info.recharge_product_id,price:e.pay_subscribe_info.price}),e.pay_subscribe_info.wecoin_tips&&(Ae.isIOS||Ae.isAndroid)&&!Ae.isWxWork&&this.$refs.wecoinTipsModal.show())},payReadBottomVisible(e){null===e&&this.togglePayPanelBottom()}},created(){this.iapPriceInfo=this.cgiData.iapPriceInfo},mounted(){Se.log("[Appmsg] pay process 1 isPaySubscribe=".concat(this.cgiData.isPaySubscribe)),Ee.on("onScreenShot",(()=>{et.reportPayAppmsg(6),ge.setSum(114217,15,1)}));const e=Ae.isWindows||Ae.isMac&&!Ae.isIOS,t=document.getElementById("js_content"),i=e=>{"IMG"===e.target.tagName&&e.preventDefault()};e&&(t.addEventListener("dragstart",i),Ae.isWechat||t.addEventListener("contextmenu",i)),Se.log("[Appmsg] pay process 2 isPaid=".concat(this.isPaid)),this.isPaid||this.initPay()},beforeDestroy(){Ne.off(this.cgiData,"scroll",this.togglePayPanelBottom)},methods:{...y("mp-pay-read",["setPayEduTips","setPayGlobal","setConfirmModal","setPayReadBottomVisible"]),...m("mp-pay-read",["goBuyTopic"]),initPay(){const e=document.getElementById("js_pay_panel");Ae.isAndroid&&"1"===localStorage.getItem(this.isPaidLSKey)&&et.report110809(30),this.cgiData.jump2pay&&Ne.on(window,"load",(()=>{window.scrollTo(0,e.getBoundingClientRect().top-We.getInnerHeight()/3)})),this.setConfirmModal(this.$refs.payConfirm),this.togglePayPanelBottom(),Ne.on(window,"scroll",this.togglePayPanelBottom)},togglePayPanelBottom(){const e=this.$refs.payReadBottom.$el,t=this.cgiData.isPayTopic?document.getElementById("js_pay_topic_btn"):this.$refs.payBtn.$el,{top:i}=t.getBoundingClientRect(),n=window.getComputedStyle(e);if(i+(40+parseInt(n.paddingTop,10)+parseInt(n.paddingBottom,10))>this.cgiData.innerHeight){if(1*this.cgiData.previewPercent==0)return;if(this.cgiData.isRemovedFromPayTopic&&!this.cgiData.isPaid)return;this.setPayReadBottomVisible(!0)}else this.setPayReadBottomVisible(!1),window.is_finished_preview=1},toPayDetail(){Pe.goUrl("/mp/paysub?action=evaluate_show_page&__biz=".concat(this.cgiData.biz,"&product_type=").concat(this.cgiData.productPayPackage.product_type,"&product_id=").concat(this.cgiData.productPayPackage.product_id,"&sn=").concat(this.cgiData.sn,"&link=").concat(encodeURIComponent(this.cgiData.msg_link),"&from_scene=").concat(this.cgiData.source,"&from_subscene=").concat(this.cgiData.subscene,"&is_fans=").concat(this.cgiData.isFans))}}},(function(){var e=this,t=e._self._c;return t("div",[e.isPaid?[e.paySubscribeInfo&&e.paySubscribeInfo.pay_cnt?t("mp-headimg-wall",{staticClass:"pay__detail-wrp",attrs:{type:"pay","total-count":e.paySubscribeInfo.pay_cnt,"total-summary":e.payTotalSummary,"head-imgs":e.avatarList},on:{"click-summary":e.toPayDetail}}):e._e(),e.canGift?t("mp-pay-gift"):e._e()]:[e.previewPercent>0?t("div",{staticClass:"pay__mask_static"}):e._e(),t("div",{staticClass:"pay pay__static",class:{pay_new:e.showBottomBar},attrs:{id:"js_pay_panel"}},[1===e.cgiData.isPayTopic&&e.cgiData.payTopicRemoveFlag>0?t("div",{staticClass:"pay__topic-tips"},[e._v(" "+e._s(1===e.cgiData.payTopicRemoveFlag?"此内容已从合集中移除，不支持付费":"付费合集已被作者删除，不支持付费")+" ")]):e._e(),t("div",{directives:[{name:"show",rawName:"v-show",value:!(1!==e.cgiData.isPayTopic||2===e.cgiData.payTopicRemoveFlag),expression:"!(cgiData.isPayTopic !== 1 || cgiData.payTopicRemoveFlag === 2)"}],staticClass:"pay__topic"},[t("div",{staticClass:"pay__topic-hd"},[e._v(" "+e._s(e.payTopicNoticeText)+" ")]),t("div",{staticClass:"pay__topic-bd"},[t("div",{staticClass:"pay__topic-main"},[t("div",{staticClass:"pay__topic-main-wrp"},[t("div",{staticClass:"pay__topic-title"},[e._v(e._s(e.cgiData.payTopicTitle))]),t("div",{staticClass:"pay__topic-meta"},[t("span",{attrs:{id:"js_pay_topic_freq"}},[e._v(" "+e._s(e.payTopicFreqText)+" ")])])]),t("a",{class:"weui-btn weui-btn_mini ".concat(e.cgiData.payTopicRemoveFlag>0&&!e.isPaid?"weui-btn_disabled":"weui-btn_primary"," weui-wa-hotarea pay__topic-btn"),attrs:{id:"js_pay_topic_btn","data-url":e.topicLink,href:"javascript:;"},on:{click:e.goBuyTopic}},[e._v(" 合集详情 ")])]),t("ul",{staticClass:"pay__topic-list"},e._l(e.payTopicList,(function(i,n){return t("li",{key:i},[e._v(e._s(n+1)+". "+e._s(i))])})),0)])]),t("div",{directives:[{name:"show",rawName:"v-show",value:1!==e.cgiData.isPayTopic,expression:"cgiData.isPayTopic !== 1"}],staticClass:"pay__main"},[e.cgiData.payDesc&&0===e.previewPercent?t("div",{staticClass:"pay__head-notice"},[e._v(" 正文需付费后才可阅读 ")]):e._e(),t("div",{staticClass:"pay__notice-btn-wrp",class:{"pay__notice-btn-lg":e.showBottomBar}},[t("mp-pay-btn",{ref:"payBtn",attrs:{"button-text":e.payBtnText}}),0!==e.cgiData.payGiftsCount?t("div",{staticClass:"pay__preview-tips",attrs:{id:"js_pay_preview_tips"}},[e._v(" "+e._s(e.previewTipsText)+" ")]):t("div",{staticClass:"pay__preview-tips",attrs:{id:"js_pay_wecoin_tips"}},[e._v(" "+e._s(e.wecoinText)+" ")]),e.tempkey?t("div",{staticClass:"pay__preview-tips js_pay_fee_display"},[e._v(" 预览状态下不会扣费 ")]):e._e(),t("mp-pay-read-qrcode")],1)]),e.paySubscribeInfo&&e.paySubscribeInfo.pay_cnt?t("mp-headimg-wall",{staticClass:"pay__detail-wrp",attrs:{type:"pay","total-count":e.paySubscribeInfo.pay_cnt,"total-summary":e.payTotalSummary,"head-imgs":e.avatarList},on:{"click-summary":e.toPayDetail}}):e._e()],1),t("transition",{attrs:{name:"fade"}},[t("mp-pay-read-bottom",{directives:[{name:"show",rawName:"v-show",value:e.payReadBottomVisible||e.streamFriendsShow,expression:"payReadBottomVisible || streamFriendsShow"}],ref:"payReadBottom",attrs:{visible:e.payReadBottomVisible,"pay-topic-notice-text":e.payTopicNoticeText}})],1),t("mp-pay-confirm",{ref:"payConfirm"})],t("mp-wecoin-tips",{ref:"wecoinTipsModal"})],2)}),[],!1,null,"10a873dd",null,null).exports;const Ro=xt({name:"mp-sponsor-ad",components:{[S.name]:S},data:()=>({posType:jt.AD_POS.POS_SPONSOR}),methods:{handleAdFrameMessage(e){e===jt.FRAME_READY&&I.report115849(63)}}},(function(){var e=this;return(0,e._self._c)("mp-ad-frame",{attrs:{"pos-type":e.posType},on:{"ad-frame-message":e.handleAdFrameMessage}})}),[],!1,null,null,null,null).exports,Bo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkJDQzA1MTVGNkE2MjExRTRBRjEzODVCM0Q0NEVFMjFBIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkJDQzA1MTYwNkE2MjExRTRBRjEzODVCM0Q0NEVFMjFBIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QkNDMDUxNUQ2QTYyMTFFNEFGMTM4NUIzRDQ0RUUyMUEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QkNDMDUxNUU2QTYyMTFFNEFGMTM4NUIzRDQ0RUUyMUEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6p+a6fAAAAD0lEQVR42mJ89/Y1QIABAAWXAsgVS/hWAAAAAElFTkSuQmCC",Oo=ii.attr,jo=ii.setProperty;let Mo=!1,No=!1,qo=!1;const Wo={img:function(e,t){const i=this;e.loader.onerror=function(){const t=!!i.onerror&&i.onerror(this.src,this,e.placeholder,e.type);t&&(this.src=t)},e.loader.onload=function(){if(ni(this,e.placeholder),e.placeholder.getAttribute("data-ratio")&&parseFloat(e.placeholder.getAttribute("data-ratio"),10)!==this.naturalHeight/this.naturalWidth&&(window.__addIdKeyReport&&window.__addIdKeyReport(330742,4),Mo||window.__addIdKeyReport&&window.__addIdKeyReport(330742,5),window.create_time&&window.create_time>1682352e3&&(window.__addIdKeyReport&&window.__addIdKeyReport(330742,18),Math.abs(parseFloat(e.placeholder.getAttribute("data-ratio"),10)-this.naturalHeight/this.naturalWidth)*e.placeholder.getBoundingClientRect().width<=1?window.__addIdKeyReport&&window.__addIdKeyReport(330742,6):(!qo&&window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&Math.random()<.1&&window.WX_BJ_REPORT.BadJs.report("wrong img ratio page",location.href),!qo&&window.__addIdKeyReport&&window.__addIdKeyReport(330742,19),qo=!0)),Mo=!0),parseFloat(e.placeholder.getAttribute("data-ratio"),10)||window.__addIdKeyReport&&window.__addIdKeyReport(330742,8),e.placeholder.getBoundingClientRect().width||window.__addIdKeyReport&&(Ae.isIOS&&window.__addIdKeyReport(330742,12),Ae.isAndroid&&window.__addIdKeyReport(330742,13),Ae.isWindows&&window.__addIdKeyReport(330742,14),Ae.isMac&&window.__addIdKeyReport(330742,15)),parseFloat(e.placeholder.getAttribute("data-ratio"),10)!==this.naturalHeight/this.naturalWidth){const t=e.placeholder.getBoundingClientRect().bottom;t<window.innerHeight&&(Ae.isIOS||t>0&&Ae.isAndroid)&&(window.__addIdKeyReport&&window.__addIdKeyReport(330742,9),!No&&window.__addIdKeyReport&&window.__addIdKeyReport(330742,10),No=!0)}e.placeholder=this,i.onload&&i.onload(this.src,this,e.type),this.onload=null},Oo(e.loader,"src",t),e.show=!0},bg:function(e,t){const i=this,n=t=>{const n='url("data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==")',o=e.placeholder.style.backgroundImage.replace(n,'url("'.concat(t,'")'));"string"==typeof e.placeholder.dataset.style&&(e.placeholder.dataset.style=e.placeholder.dataset.style.replace(n,'url("'.concat(t,'")'))),e.placeholder.style.backgroundImage=o,e.placeholder.classList.remove("wx_imgbc_placeholder"),window.Darkmode.updateStyle(e.placeholder,{"background-image":o}),i.onload&&i.onload(t,e.placeholder,e.type),e.loader.onload=null};e.loader.onerror=function(){const t=!!i.onerror&&i.onerror(this.src,this,e.placeholder,e.type);t?this.src=t:n(e.src)},e.loader.onload=function(){n(this.src)},Oo(e.loader,"src",t),e.show=!0}};function Fo(){const e=Date.now(),t=window.pageYOffset||document.documentElement.scrollTop,i=new IntersectionObserver((n=>{const o=[];n.forEach((e=>{const{target:t,isIntersecting:n}=e;if(n){const e=this.images.find((e=>e.placeholder===t));if(e){const{type:n}=e;let s=e.src;const a=1*e.placeholder.dataset.secLoadStatus;if(!s||1===a)return;if(e.show||2!==a||(e.show=!0,o.push(s)),Ae.isWp&&"img"===e.type&&1*e.placeholder.width>window.sw&&(e.placeholder.width=this.sw),e.show)return void i.unobserve(t);this.changeSrc&&(s=this.changeSrc(s,e.loader,e.placeholder,e.type)),"function"==typeof Wo[n]&&Wo[n].call(this,e,s),o.push(s),i.unobserve(t)}}})),o.length>0&&this.detect&&this.detect({time:e,scrollTop:t,loadList:o})}));this.images.forEach((e=>i.observe(e.placeholder)))}function zo(e){const t=this.images;if(!t||t.length<=0)return!1;const i=window.pageYOffset||document.documentElement.scrollTop,n=window.innerHeight||document.documentElement.clientHeight;let o=this.offset||60,s=0;if("wifi"===window.networkType){const e={bottom:1,top:1};let t;t=window.svr_time?new Date(1e3*window.svr_time):new Date;const i=t.getHours();i>=20&&i<23&&(e.bottom=.5,e.top=0),o=Math.max(e.bottom*n,o),s=Math.max(e.top*n,s)}const a=Date.now(),r=[],l=this.sw,d=this;for(let c=0,u=t.length;c<u;c++){const i=t[c];let a=i.src;const u=1*i.placeholder.dataset.secLoadStatus;if(!a||1===u)continue;if(i.show||2!==u||(i.show=!0,r.push(a)),Ae.isWp&&"img"===i.type&&1*i.placeholder.width>l&&(i.placeholder.width=l),i.show)continue;const p=d.getImgRect&&d.getImgRect(i.placeholder)||i.placeholder.getBoundingClientRect();let h=s,m=o;(a.match(/\:\/\/[^\/]+\/mmbiz\//)&&a.indexOf("wx_fmt=gif")>-1||a.match(/\:\/\/[^\/]+\/mmbiz_gif\//))&&(h=0,m=60),(p.top<=0&&p.top+p.height+h>=0||p.top>0&&p.top<n+m||1===e||2===e&&"img"===i.type||3===e&&"bg"===i.type)&&(d.inImgRead&&(p.top<=0&&p.top+p.height>=0||p.top>0&&p.top<n)&&d.inImgRead(a,window.networkType),d.changeSrc&&(a=d.changeSrc(a,i.loader,i.placeholder,i.type)),"function"==typeof Wo[i.type]&&Wo[i.type].call(this,i,a),r.push(a))}r.length>0&&this.detect&&this.detect({time:a,loadList:r,scrollTop:i})}function Uo(){const e=document.getElementsByTagName("img"),t=document.querySelectorAll("[data-lazy-bgimg]"),i=[],n=this.container,o=this.attrKey||"data-src",s=n.offsetWidth;let a=0;const r=this.imgOccupied||!1,l=this.crossOrigin||!1;n.currentStyle?a=n.currentStyle.width:"undefined"!=typeof getComputedStyle&&(a=getComputedStyle(n).width),this.sw=1*a.replace("px","");for(let c=0,u=e.length;c<u;c++){const t=e.item(c),n=Oo(t,o);if(!n)continue;const a=Oo(t,"src");if(a&&a.indexOf("data:image/svg+xml")<0&&!t.dataset.secLoadStatus)continue;let d=100;if(t.dataset&&t.dataset.ratio){const e=1*t.dataset.ratio;let i=1*t.dataset.w||s;"number"==typeof e&&e>0&&(i=i<=s?i:s,d=i*e,r||(t.style.width&&t.setAttribute("_width",t.style.width),jo(t,"width",i+"px","important"),jo(t,"visibility","visible","important"),t.setAttribute("src",Bo)))}r||jo(t,"height",d+"px","important"),l&&-1===n.indexOf("mmsns.qpic.cn")&&!(n.match(/\:\/\/[^\/]+\/mmbiz\//)&&n.indexOf("wx_fmt=gif")>-1||n.match(/\:\/\/[^\/]+\/mmbiz_gif\//))&&(t.crossOrigin="anonymous"),t.alt||(t.alt="图片"),i.push({type:"img",placeholder:t,loader:t.cloneNode(),src:n,height:d,show:!1})}for(let c=0,u=t.length;c<u;c++){const e=t.item(c),n=Oo(e,"data-lazy-bgimg");if(!n)continue;const o=e.style.backgroundImage;o&&o.indexOf("data:image/gif;base64")<0&&!e.dataset.secLoadStatus||i.push({type:"bg",placeholder:e,loader:new Image,src:n,show:!1})}window.__lazyload_detected=!0,this.images=i,window.IntersectionObserver&&Fo.call(this);const d=n.querySelector('animate[attributeName="y"]')||n.querySelector('animateTransform[attributeName="transform"]')||n.querySelector("animateMotion");zo.call(this,d?3:0)}function Ho(){this.throttle||(this.throttle=!0,setTimeout((()=>{zo.call(this),this.throttle=!1}),500))}function Vo(e){setTimeout((()=>Uo.call(e)),0),Ne.on(window,"scroll",(()=>Ho.call(e))),Ne.on(document,"touchmove",(()=>Ho.call(e))),Ee.invoke("getUserConfig",{},(t=>{t.isAccessibilityMode?(window.localStorage.setItem("isMpUserAccessibility","1"),zo.call(e,1)):window.localStorage.removeItem("isMpUserAccessibility")})),Ae.isIOS&&Ae.getInner()>="18001B00"&&Ee.on("onScreenShot",(()=>{zo.call(e,1)}))}const Ko=ve.os.pc;const $o=xt({name:"mp-added-info",components:{[k.name]:k,[T.name]:T,[w.name]:w,Intersect:C},data(){const e=document.getElementById("js_article_bottom_bar");return{deviceIsPc:Ko,showDrawer:!1,list:[],total:0,overviewCount:0,notHideDialogWhenPageHide:!1,bottomWriteHeight:e?e.offsetHeight:0}},computed:{...h(["cgiData"]),...h("mp-comment",["commentStatus","notHideReplayDialogWhenPageHide"]),...g("mp-comment",["commentEnabled"]),overviewList(){return this.list.slice(0,this.overviewCount)},intersectMarin(){return this.bottomWriteHeight?"0px 0px -".concat(this.bottomWriteHeight,"px 0px"):"0px"}},watch:{commentStatus(e){if(!(this.overviewCount>0))switch(e){case 1:this.overviewCount=1;break;case 0:this.overviewCount=3;break;case-1:!this.commentEnabled&&(this.overviewCount=3)}}},created(){this.hideAfterAnimationCB=null,"0"!==this.cgiData.extra_comment_id&&(new A({comment_id:this.cgiData.extra_comment_id,appmsgid:this.cgiData.appmsgid,idx:this.cgiData.idx,item_show_type:this.cgiData.item_show_type||0,biz:this.cgiData.biz}),this.getData(),Ae.isIOS&&document.addEventListener("visibilitychange",this.onVisibilitychange))},beforeDestroy(){"0"!==this.cgiData.extra_comment_id&&Ae.isIOS&&document.removeEventListener("visibilitychange",this.onVisibilitychange)},methods:{...y("mp-comment",["setNotHideReplayDialogWhenPageHide"]),report33250(e){we.report(33250,{BizUin:window.biz||"",AppMsgId:window.parseInt(window.mid,10)||0,AppMsgItemIdx:window.parseInt(window.idx,10)||0,Scene:1*window.source||0,EnterId:window.parseInt(window.enterid,10)||0,ExtraCommentId64Bit:this.cgiData.extra_comment_id,opType:e})},expose(){this.report33250(this.total>this.overviewCount?0:1)},showDialog(){this.report33250(2),this.deviceIsPc?(this.$refs.pcCommentList.resetPcDropDown(),this.showDrawer=!0):this.$refs.dialog.show()},goEditPage(){this.report33250(3),Ge("/publicpoc/article_extra_msg?action=getappmsginfo&url=".concat(encodeURIComponent(window.location.href))),this.setNotHideReplayDialogWhenPageHide(!0)},goGuidencesPage(){Ge("/s?__biz=Mzg4NDYwOTcyNA==&mid=2247517238&idx=1&sn=6d69c9c9fe2c99c2a0ea7c676fd78357&chksm=cfb743e5f8c0caf3ab40828bd598cb636a4ac5be911a805ed7ad4103a6641613d19b3f8b4239#rd"),this.setNotHideReplayDialogWhenPageHide(!0)},getData(){ye({url:be.join("/mp/appmsg_comment",{action:"getextracomment",appmsgid:this.cgiData.appmsgid,idx:this.cgiData.idx,comment_id:this.cgiData.extra_comment_id,offset:0,limit:100},!0),dataType:"json",success:e=>{e.base_resp&&0===e.base_resp.ret&&(this.list=e.extra_comment,this.total=e.total_cnt)}})},remove(e){let t=-1;this.list.some(((i,n)=>{if(i.content_id===e)return t=n,!0}))&&(this.list.splice(t,1),!this.list.length&&this.$refs.dialog.getShowStatus()?(this.hideAfterAnimationCB=()=>{this.total=0},this.$refs.dialog.hide()):this.total--)},exposeCommentItem(e){var t;E({content_id:e.content_id||"",is_elected_comment:e.is_elected||0,is_friend_comment:0,scene:1,identity_type:e.identity_type,identity_name:e.identity_name,is_from_me:1*e.is_from_me,is_from:e.is_from||0,like_num:e.like_num||0,reply_list:(null==(t=e.reply_new)?void 0:t.reply_list)||[]})},onHideAfterAnimation(){"function"==typeof this.hideAfterAnimationCB&&(this.hideAfterAnimationCB(),this.hideAfterAnimationCB=null)},onVisibilitychange(){this.$refs.dialog&&this.$refs.dialog.getShowStatus()&&("hidden"===document.visibilityState?!this.notHideDialogWhenPageHide&&!this.notHideReplayDialogWhenPageHide&&this.$refs.dialog.hide():(this.notHideDialogWhenPageHide||this.notHideReplayDialogWhenPageHide)&&(n.show({alpha:.6,mode:"replace",onClick:()=>{this.$refs.dialog.hide()}}),this.notHideDialogWhenPageHide=!1,this.setNotHideReplayDialogWhenPageHide(!1)))}}},(function(){var e=this,t=e._self._c;return e.total?t("div",{staticClass:"wx_added_info_container"},[t("div",{staticClass:"appmsg_card_context wx_added_info_card"},[t("intersect",{attrs:{threshold:[1],"root-margin":e.intersectMarin},on:{"~enter":function(t){return e.expose.apply(null,arguments)}}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.overviewList.length,expression:"overviewList.length"}]},[t("div",{staticClass:"wx_added_info_card_bd"},[t("div",{staticClass:"wx_added_info_card_title"},[e._v("此内容存在争议，以下为第三方补充信息")]),t("mp-comment-list",{attrs:{folder:"",type:"addedInfo","comment-id":e.cgiData.extra_comment_id,list:e.overviewList,"bottom-write-height":e.bottomWriteHeight},on:{remove:e.remove,"expose-item":e.exposeCommentItem}})],1),t("div",{staticClass:"js_wx_tap_highlight wx_tap_cell wx_added_info_card_ft",on:{click:e.showDialog}},[t("div",{staticClass:"wx_added_info_card_ft_title"},[e._v("全部")]),t("div",{staticClass:"wx_added_info_card_ft_tips"},[e._v(e._s(e.total)+"条")])])])]),e.deviceIsPc?t("mp-drawer",{attrs:{"scroll-selector":".drawer_added_info_main"},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("补充信息")]},proxy:!0}],null,!1,3048128595),model:{value:e.showDrawer,callback:function(t){e.showDrawer=t},expression:"showDrawer"}},[t("div",{staticClass:"drawer_added_info_container"},[t("div",{staticClass:"drawer_added_info_main"},[t("mp-comment-list",{ref:"pcCommentList",attrs:{type:"addedInfo","comment-id":e.cgiData.extra_comment_id,list:e.list},on:{"go-resource":function(t){e.notHideDialogWhenPageHide=!0},remove:e.remove,"expose-item":e.exposeCommentItem}}),t("div",{staticClass:"weui-loadmore weui-loadmore_default weui-loadmore_line weui-loadmore_dot"},[t("span",{staticClass:"weui-loadmore__tips",staticStyle:{"background-color":"transparent"}})])],1)])]):t("mp-bottom-modal",{ref:"dialog",attrs:{"ext-class":"discuss_more_dialog_wrp weui-half-screen-dialog_wrp added_info_dialog","has-btn":"","close-btn-type":"fold","hide-when-scroll-down":"","hide-when-sideslip":""},on:{submit:e.goEditPage,"hide-after-animation":e.onHideAfterAnimation},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("补充信息")]},proxy:!0},{key:"btn",fn:function(){return[t("a",{staticClass:"weui-link",attrs:{href:"javascript:;"}},[e._v("去补充")])]},proxy:!0}],null,!1,2038421654)},[t("div",{staticClass:"discuss_more_dialog_content"},[t("mp-comment-list",{attrs:{type:"addedInfo","comment-id":e.cgiData.extra_comment_id,list:e.list},on:{"go-resource":function(t){e.notHideDialogWhenPageHide=!0},remove:e.remove,"expose-item":e.exposeCommentItem}}),t("div",{staticClass:"wx_added_info_guidences"},[t("a",{attrs:{href:"javascript:;"},on:{click:e.goGuidencesPage}},[e._v("「补充信息」功能说明")])])],1)])],1)]):e._e()}),[],!1,null,null,null,null).exports;const Jo=xt({name:"mp-keyword-ad",components:{[S.name]:S},props:{keywordAdData:{type:Object,default:()=>({})},exPageData:{type:Object,default:()=>({})}},data:()=>({posType:jt.AD_POS.POS_AD_KEYWORD}),methods:{handleAdFrameLoad(){this.$emit("ad-load")},handleAdFrameMessage(e){e===jt.CHANGE_FRAME_STYLE||e===jt.FRAME_READY&&I.report392147(0)},onAdDataChange(e){this.$emit("ad-data-change",e)}}},(function(){var e=this;return(0,e._self._c)("mp-ad-frame",{attrs:{"pos-type":e.posType,"keyword-ad-data":e.keywordAdData,"ex-page-data":e.exPageData},on:{"ad-frame-load":e.handleAdFrameLoad,"ad-frame-message":e.handleAdFrameMessage,"ad-data-change":e.onAdDataChange}})}),[],!1,null,null,null,null).exports;const Go=xt({name:"mp-ad-keyword-bottom-modal",components:{[w.name]:w,[Jo.name]:Jo},data:()=>({observer:null,topHeight:"".concat(.33*We.getInnerHeight(),"px"),exPageData:{bodyScrollTop:0,screenHeight:0,adOffsetTop:0},debounceScroll:null}),computed:{...h("mp-adv-keyword",["show","keywordItem","reportData","keywordAdData","keywordDesc"])},created(){this.$watch("show",(function(e){e&&this.showBottomModal()})),this.debounceScroll=Pe.debounce(this.handleScroll,100)},mounted(){this.observer=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&tt({eventType:4,keyword:this.keywordItem.keyword,...this.reportData})}))})),this.exPageData.screenHeight=Math.floor(We.getInnerHeight()*(1-.33)-this.calFooterBoxHeight()-this.calTopBarHeight())},beforeDestroy(){this.observer&&this.observer.disconnect(),this.debounceScroll=null},methods:{...y("mp-adv-keyword",["setShow","setKeywordAdData","setKeywordDescription"]),showBottomModal(){this.getKeywordAd(),this.getKeywordBaikeInfo(this.keywordItem),this.$refs.bottomModal.show(),tt({eventType:3,keyword:this.keywordItem.keyword,...this.reportData})},onHide(){this.setShow(!1),tt({eventType:6,keyword:this.keywordItem.keyword,...this.reportData})},handleScroll(e,t){var i;const n=null==(i=this.$refs.adCard)?void 0:i.$el;this.exPageData.bodyScrollTop=Math.floor(t.scrollTop),n&&(this.exPageData.adOffsetTop=this.updateAdOffset(n)+this.exPageData.bodyScrollTop,this.postMessageToAdFrame(jt.PAGE_SCROLL_ACTION,{hasVideoPlayingInScreen:!1,...this.exPageData},n))},goSouyisou(){tt({eventType:7,keyword:this.keywordItem.keyword,...this.reportData}),setTimeout((()=>{Ee.invoke("openWXSearchPage",{query:this.keywordItem.keyword})}))},postMessageToAdFrame(e,t,i){const n=i.contentWindow;n&&I.postMessage(n,e,t,jt.AD_FRAME_DOMAIN)},adCardClick(){tt({eventType:5,keyword:this.keywordItem.keyword,...this.reportData})},getKeywordAd(){const e=P(),t=L(),i=this;ye({url:t,data:Object.assign(e,{pos_type_list:JSON.stringify([12]),article_keyword:this.keywordItem.keyword,is_need_ad:1}),type:"POST",dataType:"json",rtId:27613,rtKey:50,rtDesc:Xe,async:!0,success(e){Se.log("[Appmsg] success get adkeywords data"),console.log("elissali getappmsgad res",e),0===(null==e?void 0:e.ret)&&(i.setKeywordAdData(e),i.exPageData.adOffsetTop=i.updateAdOffset(i.$refs.adCardDiv)+i.exPageData.bodyScrollTop)},error(e){Se.log("[Appmsg] get adkeywords data error"),console.error("getappmsgad err",e)}})},getKeywordBaikeInfo(e){const t=this;ye({url:"/mp/adkeyword",data:{action:"get_adkeyword_abstract",bizuin:window.biz?parseInt(window.atob(window.biz),10):0,appmsgid:1*window.mid||0,idx:1*window.idx||0,scene:window.scene,request_id:Date.now(),keyword:e.keyword,idx_range:e.idx_range_list[0],s1s_stat_info:e.s1s_context_info,s1s_context_info:e.s1s_context_info},usePb:!0,success(e){try{const i=JSON.parse(e);0===i.base_resp.ret&&t.setKeywordDescription(i.abstract_resp)}catch(i){}},error(e){console.log("getKeywordBaikeInfo err",e)}})},adLoad(){this.observer.observe(this.$refs.adCard.$el)},updateAdOffset(e){const t=this.$refs.bottomModal.$el.querySelector("#contentAreaWrp");return Math.floor(e.getBoundingClientRect().top-t.getBoundingClientRect().top)},calFooterBoxHeight(){const e=this.$refs.footerBox;let t=101;return e.parentElement&&(t=e.parentElement.getBoundingClientRect().height),t},calTopBarHeight(){const e=this.$refs.bottomModal.$el.querySelector(".weui-half-screen-dialog__hd__wrp");let t=64;return e&&(t=e.getBoundingClientRect().height),t}}},(function(){var e=this,t=e._self._c;return t("div",{staticClass:"adv_keyword_bottom_modal"},[t("mp-bottom-modal",{ref:"bottomModal",attrs:{top:e.topHeight,"auto-height":!!e.keywordAdData,"hide-when-sideslip":"","close-btn-type":"fold","ext-class":"ad_keyword_bottom_modal_wrap","content-area-class":"bottom_modal_content_area","content-wrap-class":"bottom_modal_content_wrap"},on:{hide:e.onHide,scroll:e.debounceScroll},scopedSlots:e._u([{key:"footer",fn:function(){return[t("p",{ref:"footerBox",staticClass:"adv_keyword_search",on:{click:e.goSouyisou}},[t("a",{staticClass:"js_wx_tap_highlight wx_tap_link"},[e._v("搜索"+e._s("「".concat(e.keywordItem.keyword,"」"))+"网络结果")])])]},proxy:!0}])},[t("h1",{staticClass:"adv_keyword_title"},[e._v(e._s(e.keywordItem.keyword))]),t("p",{staticClass:"adv_keyword_desc"},[e._v(e._s(e.keywordDesc.abstract))]),t("div",{ref:"adCardDiv"},[e.keywordAdData?t("mp-keyword-ad",{ref:"adCard",attrs:{"keyword-ad-data":e.keywordAdData,"ex-page-data":e.exPageData},on:{"ad-load":e.adLoad}}):e._e()],1)])],1)}),[],!1,null,"99f2b645",null,null).exports;const Xo=xt({components:{[Hn.name]:Hn,[$o.name]:$o,[D.name]:D,[R.name]:R,[Do.name]:Do,[_o.name]:_o,[Ro.name]:Ro,[Mt.name]:Mt,[Go.name]:Go},data:()=>({showBottomBar:!!window.is_login,hasExtLoadDone:!!window.ext_complete_success}),computed:{...h(["cgiData"]),...h({statStyle:e=>{var t;return 3===(null==(t=e.extRes.appmsgstat)?void 0:t.style)?1:0}}),reprintStyle(){return this.cgiData.reprint_style},showReward(){return 0===this.cgiData.is_pay_subscribe||1===this.cgiData.isPaid},isPaySubscribe(){return 1*this.cgiData.is_pay_subscribe==1},albumTags(){return this.cgiData.publicTagInfo},showGongYi(){var e;return!!(null==(e=this.cgiData.yqj_info)?void 0:e.yqj_did)&&(!!this.cgiData.is_login||Nt())}},created(){je.on("ext-complete-success",(()=>{this.hasExtLoadDone=!0;const e=document.getElementById("js_temp_bottom_area");e&&(e.style.display="none")})),Ee.on("onScreenShot",(()=>{ge.setSum(114217,17,1)}))},methods:{onShare(){ao()}}},(function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"content_bottom_area"}},[e.reprintStyle?e._e():[t("mp-sponsor-ad"),e._v(" "),e.showGongYi&&e.showReward?t("mp-gongyi"):e._e()],t("mp-added-info"),e._v(" "),e.reprintStyle?e._e():[e.showReward&&!e.showGongYi?t("mp-reward",{attrs:{"show-author":""}}):e._e(),e._v(" "),e.isPaySubscribe&&!e.reprintStyle?t("mp-pay-read"):e._e()],t("mp-album",{attrs:{"album-tags":e.albumTags}}),e._v(" "),t("mp-keep-read"),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.hasExtLoadDone,expression:"hasExtLoadDone"}],staticClass:"rich_media_tool_area"},[t("mp-like-read-area",{attrs:{"stat-style":e.statStyle,"show-bottom-bar":e.showBottomBar},on:{share:e.onShare}})],1),t("mp-ad-keyword-bottom-modal")],2)}),[],!1,null,null,null,null).exports,Yo=window.Vue;const Qo=(Zo=["157","169","262"],1===window.show_related_article||Zo.indexOf(window.source)>-1||Zo.indexOf(window.subscene)>-1);var Zo,es={exports:{}};es.exports=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)},t=function(){return(t=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function i(e,t,i){if(i||2===arguments.length)for(var n,o=0,s=t.length;o<s;o++)!n&&o in t||((n=n||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:ze,o=Object.keys,s=Array.isArray;function a(e,t){return"object"!=typeof t||o(t).forEach((function(i){e[i]=t[i]})),e}"undefined"==typeof Promise||n.Promise||(n.Promise=Promise);var r=Object.getPrototypeOf,l={}.hasOwnProperty;function d(e,t){return l.call(e,t)}function c(e,t){"function"==typeof t&&(t=t(r(e))),("undefined"==typeof Reflect?o:Reflect.ownKeys)(t).forEach((function(i){p(e,i,t[i])}))}var u=Object.defineProperty;function p(e,t,i,n){u(e,t,a(i&&d(i,"get")&&"function"==typeof i.get?{get:i.get,set:i.set,configurable:!0}:{value:i,configurable:!0,writable:!0},n))}function h(e){return{from:function(t){return e.prototype=Object.create(t.prototype),p(e.prototype,"constructor",e),{extend:c.bind(null,e.prototype)}}}}var m=Object.getOwnPropertyDescriptor,_=[].slice;function f(e,t,i){return _.call(e,t,i)}function g(e,t){return t(e)}function y(e){if(!e)throw new Error("Assertion Failed")}function w(e){n.setImmediate?setImmediate(e):setTimeout(e,0)}function v(e,t){if("string"==typeof t&&d(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var i=[],n=0,o=t.length;n<o;++n){var s=v(e,t[n]);i.push(s)}return i}var a=t.indexOf(".");if(-1!==a){var r=e[t.substr(0,a)];return null==r?void 0:v(r,t.substr(a+1))}}function b(e,t,i){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){y("string"!=typeof i&&"length"in i);for(var n=0,o=t.length;n<o;++n)b(e,t[n],i[n])}else{var a,r,l=t.indexOf(".");-1!==l?(a=t.substr(0,l),""===(r=t.substr(l+1))?void 0===i?s(e)&&!isNaN(parseInt(a))?e.splice(a,1):delete e[a]:e[a]=i:b(l=(l=e[a])&&d(e,a)?l:e[a]={},r,i)):void 0===i?s(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=i}}function S(e){var t,i={};for(t in e)d(e,t)&&(i[t]=e[t]);return i}var I=[].concat;function x(e){return I.apply([],e)}var k="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(x([8,16,32,64].map((function(e){return["Int","Uint","Float"].map((function(t){return t+e+"Array"}))})))).filter((function(e){return n[e]})),T=new Set(k.map((function(e){return n[e]}))),C=null;function A(e){return C=new WeakMap,e=function e(t){if(!t||"object"!=typeof t)return t;var i=C.get(t);if(i)return i;if(s(t)){i=[],C.set(t,i);for(var n=0,o=t.length;n<o;++n)i.push(e(t[n]))}else if(T.has(t.constructor))i=t;else{var a,l=r(t);for(a in i=l===Object.prototype?{}:Object.create(l),C.set(t,i),t)d(t,a)&&(i[a]=e(t[a]))}return i}(e),C=null,e}var E={}.toString;function P(e){return E.call(e).slice(8,-1)}var L="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator",D="symbol"==typeof L?function(e){var t;return null!=e&&(t=e[L])&&t.apply(e)}:function(){return null};function R(e,t){return 0<=(t=e.indexOf(t))&&e.splice(t,1),0<=t}var B={};function O(e){var t,i,n,o;if(1===arguments.length){if(s(e))return e.slice();if(this===B&&"string"==typeof e)return[e];if(o=D(e)){for(i=[];!(n=o.next()).done;)i.push(n.value);return i}if(null==e)return[e];if("number"!=typeof(t=e.length))return[e];for(i=new Array(t);t--;)i[t]=e[t];return i}for(t=arguments.length,i=new Array(t);t--;)i[t]=arguments[t];return i}var j="undefined"!=typeof Symbol?function(e){return"AsyncFunction"===e[Symbol.toStringTag]}:function(){return!1},M=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(re=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"]),N={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function q(e,t){this.name=e,this.message=t}function W(e,t){return e+". Errors: "+Object.keys(t).map((function(e){return t[e].toString()})).filter((function(e,t,i){return i.indexOf(e)===t})).join("\n")}function F(e,t,i,n){this.failures=t,this.failedKeys=n,this.successCount=i,this.message=W(e,t)}function z(e,t){this.name="BulkError",this.failures=Object.keys(t).map((function(e){return t[e]})),this.failuresByPos=t,this.message=W(e,this.failures)}h(q).from(Error).extend({toString:function(){return this.name+": "+this.message}}),h(F).from(q),h(z).from(q);var U=M.reduce((function(e,t){return e[t]=t+"Error",e}),{}),H=q,V=M.reduce((function(e,t){var i=t+"Error";function n(e,n){this.name=i,e?"string"==typeof e?(this.message="".concat(e).concat(n?"\n "+n:""),this.inner=n||null):"object"==typeof e&&(this.message="".concat(e.name," ").concat(e.message),this.inner=e):(this.message=N[t]||i,this.inner=null)}return h(n).from(H),e[t]=n,e}),{});V.Syntax=SyntaxError,V.Type=TypeError,V.Range=RangeError;var K=re.reduce((function(e,t){return e[t+"Error"]=V[t],e}),{}),$=M.reduce((function(e,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=V[t]),e}),{});function J(){}function G(e){return e}function X(e,t){return null==e||e===G?t:function(i){return t(e(i))}}function Y(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function Q(e,t){return e===J?t:function(){var i=e.apply(this,arguments);void 0!==i&&(arguments[0]=i);var n=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var s=t.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?Y(n,this.onsuccess):n),o&&(this.onerror=this.onerror?Y(o,this.onerror):o),void 0!==s?s:i}}function Z(e,t){return e===J?t:function(){e.apply(this,arguments);var i=this.onsuccess,n=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),i&&(this.onsuccess=this.onsuccess?Y(i,this.onsuccess):i),n&&(this.onerror=this.onerror?Y(n,this.onerror):n)}}function ee(e,t){return e===J?t:function(i){var n=e.apply(this,arguments);a(i,n);var o=this.onsuccess,s=this.onerror;return this.onsuccess=null,this.onerror=null,i=t.apply(this,arguments),o&&(this.onsuccess=this.onsuccess?Y(o,this.onsuccess):o),s&&(this.onerror=this.onerror?Y(s,this.onerror):s),void 0===n?void 0===i?void 0:i:a(n,i)}}function te(e,t){return e===J?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function ie(e,t){return e===J?t:function(){var i=e.apply(this,arguments);if(i&&"function"==typeof i.then){for(var n=this,o=arguments.length,s=new Array(o);o--;)s[o]=arguments[o];return i.then((function(){return t.apply(n,s)}))}return t.apply(this,arguments)}}$.ModifyError=F,$.DexieError=q,$.BulkError=z;var ne="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function oe(e){ne=e}var se={},ae=100,re=(k="undefined"==typeof Promise?[]:function(){var e=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[e,r(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,r(t),e]}())[0],le=(M=k[1],k=k[2],M=M&&M.then,re&&re.constructor),de=!!k,ce=function(e,t){ye.push([e,t]),pe&&(queueMicrotask(Ae),pe=!1)},ue=!0,pe=!0,he=[],me=[],_e=G,fe={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:J,pgp:!1,env:{},finalize:J},ge=fe,ye=[],we=0,ve=[];function be(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=ge;if("function"!=typeof e){if(e!==se)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&xe(this,this._value))}this._state=null,this._value=null,++t.ref,function e(t,i){try{i((function(i){if(null===t._state){if(i===t)throw new TypeError("A promise cannot be resolved with itself.");var n=t._lib&&Ee();i&&"function"==typeof i.then?e(t,(function(e,t){i instanceof be?i._then(e,t):i.then(e,t)})):(t._state=!0,t._value=i,ke(t)),n&&Pe()}}),xe.bind(null,t))}catch(n){xe(t,n)}}(this,e)}var Se={get:function(){var e=ge,t=Ne;function i(i,n){var o=this,s=!e.global&&(e!==ge||t!==Ne),a=s&&!Ue(),r=new be((function(t,r){Te(o,new Ie(Ge(i,e,s,a),Ge(n,e,s,a),t,r,e))}));return this._consoleTask&&(r._consoleTask=this._consoleTask),r}return i.prototype=se,i},set:function(e){p(this,"then",e&&e.prototype===se?Se:{get:function(){return e},set:Se.set})}};function Ie(e,t,i,n,o){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=i,this.reject=n,this.psd=o}function xe(e,t){var i,n;me.push(t),null===e._state&&(i=e._lib&&Ee(),t=_e(t),e._state=!1,e._value=t,n=e,he.some((function(e){return e._value===n._value}))||he.push(n),ke(e),i&&Pe())}function ke(e){var t=e._listeners;e._listeners=[];for(var i=0,n=t.length;i<n;++i)Te(e,t[i]);var o=e._PSD;--o.ref||o.finalize(),0===we&&(++we,ce((function(){0==--we&&Le()}),[]))}function Te(e,t){if(null!==e._state){var i=e._state?t.onFulfilled:t.onRejected;if(null===i)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++we,ce(Ce,[i,e,t])}else e._listeners.push(t)}function Ce(e,t,i){try{var n,o=t._value;!t._state&&me.length&&(me=[]),n=ne&&t._consoleTask?t._consoleTask.run((function(){return e(o)})):e(o),t._state||-1!==me.indexOf(o)||function(e){for(var t=he.length;t;)if(he[--t]._value===e._value)return he.splice(t,1)}(t),i.resolve(n)}catch(s){i.reject(s)}finally{0==--we&&Le(),--i.psd.ref||i.psd.finalize()}}function Ae(){Je(fe,(function(){Ee()&&Pe()}))}function Ee(){var e=ue;return pe=ue=!1,e}function Pe(){var e,t,i;do{for(;0<ye.length;)for(e=ye,ye=[],i=e.length,t=0;t<i;++t){var n=e[t];n[0].apply(null,n[1])}}while(0<ye.length);pe=ue=!0}function Le(){var e=he;he=[],e.forEach((function(e){e._PSD.onunhandled.call(null,e._value,e)}));for(var t=ve.slice(0),i=t.length;i;)t[--i]()}function De(e){return new be(se,!1,e)}function Re(e,t){var i=ge;return function(){var n=Ee(),o=ge;try{return Ke(i,!0),e.apply(this,arguments)}catch(s){t&&t(s)}finally{Ke(o,!1),n&&Pe()}}}c(be.prototype,{then:Se,_then:function(e,t){Te(this,new Ie(null,null,e,t,ge))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=e,i=arguments[1];return"function"==typeof t?this.then(null,(function(e){return(e instanceof t?i:De)(e)})):this.then(null,(function(e){return(e&&e.name===t?i:De)(e)}))},finally:function(e){return this.then((function(t){return be.resolve(e()).then((function(){return t}))}),(function(t){return be.resolve(e()).then((function(){return De(t)}))}))},timeout:function(e,t){var i=this;return e<1/0?new be((function(n,o){var s=setTimeout((function(){return o(new V.Timeout(t))}),e);i.then(n,o).finally(clearTimeout.bind(null,s))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&p(be.prototype,Symbol.toStringTag,"Dexie.Promise"),fe.env=$e(),c(be,{all:function(){var e=O.apply(null,arguments).map(He);return new be((function(t,i){0===e.length&&t([]);var n=e.length;e.forEach((function(o,s){return be.resolve(o).then((function(i){e[s]=i,--n||t(e)}),i)}))}))},resolve:function(e){return e instanceof be?e:e&&"function"==typeof e.then?new be((function(t,i){e.then(t,i)})):new be(se,!0,e)},reject:De,race:function(){var e=O.apply(null,arguments).map(He);return new be((function(t,i){e.map((function(e){return be.resolve(e).then(t,i)}))}))},PSD:{get:function(){return ge},set:function(e){return ge=e}},totalEchoes:{get:function(){return Ne}},newPSD:We,usePSD:Je,scheduler:{get:function(){return ce},set:function(e){ce=e}},rejectionMapper:{get:function(){return _e},set:function(e){_e=e}},follow:function(e,t){return new be((function(i,n){return We((function(t,i){var n=ge;n.unhandleds=[],n.onunhandled=i,n.finalize=Y((function(){var e,n=this;e=function(){0===n.unhandleds.length?t():i(n.unhandleds[0])},ve.push((function t(){e(),ve.splice(ve.indexOf(t),1)})),++we,ce((function(){0==--we&&Le()}),[])}),n.finalize),e()}),t,i,n)}))}}),le&&(le.allSettled&&p(be,"allSettled",(function(){var e=O.apply(null,arguments).map(He);return new be((function(t){0===e.length&&t([]);var i=e.length,n=new Array(i);e.forEach((function(e,o){return be.resolve(e).then((function(e){return n[o]={status:"fulfilled",value:e}}),(function(e){return n[o]={status:"rejected",reason:e}})).then((function(){return--i||t(n)}))}))}))})),le.any&&"undefined"!=typeof AggregateError&&p(be,"any",(function(){var e=O.apply(null,arguments).map(He);return new be((function(t,i){0===e.length&&i(new AggregateError([]));var n=e.length,o=new Array(n);e.forEach((function(e,s){return be.resolve(e).then((function(e){return t(e)}),(function(e){o[s]=e,--n||i(new AggregateError(o))}))}))}))})));var Be={awaits:0,echoes:0,id:0},Oe=0,je=[],Me=0,Ne=0,qe=0;function We(e,t,i,n){var o=ge,s=Object.create(o);return s.parent=o,s.ref=0,s.global=!1,s.id=++qe,fe.env,s.env=de?{Promise:be,PromiseProp:{value:be,configurable:!0,writable:!0},all:be.all,race:be.race,allSettled:be.allSettled,any:be.any,resolve:be.resolve,reject:be.reject}:{},t&&a(s,t),++o.ref,s.finalize=function(){--this.parent.ref||this.parent.finalize()},n=Je(s,e,i,n),0===s.ref&&s.finalize(),n}function Fe(){return Be.id||(Be.id=++Oe),++Be.awaits,Be.echoes+=ae,Be.id}function Ue(){return!!Be.awaits&&(0==--Be.awaits&&(Be.id=0),Be.echoes=Be.awaits*ae,!0)}function He(e){return Be.echoes&&e&&e.constructor===le?(Fe(),e.then((function(e){return Ue(),e}),(function(e){return Ue(),Ye(e)}))):e}function Ve(){var e=je[je.length-1];je.pop(),Ke(e,!1)}function Ke(e,t){var i,o=ge;(t?!Be.echoes||Me++&&e===ge:!Me||--Me&&e===ge)||queueMicrotask(t?function(e){++Ne,Be.echoes&&0!=--Be.echoes||(Be.echoes=Be.awaits=Be.id=0),je.push(ge),Ke(e,!0)}.bind(null,e):Ve),e!==ge&&(ge=e,o===fe&&(fe.env=$e()),de&&(i=fe.env.Promise,t=e.env,(o.global||e.global)&&(Object.defineProperty(n,"Promise",t.PromiseProp),i.all=t.all,i.race=t.race,i.resolve=t.resolve,i.reject=t.reject,t.allSettled&&(i.allSettled=t.allSettled),t.any&&(i.any=t.any))))}function $e(){var e=n.Promise;return de?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(n,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function Je(e,t,i,n,o){var s=ge;try{return Ke(e,!0),t(i,n,o)}finally{Ke(s,!1)}}function Ge(e,t,i,n){return"function"!=typeof e?e:function(){var o=ge;i&&Fe(),Ke(t,!0);try{return e.apply(this,arguments)}finally{Ke(o,!1),n&&queueMicrotask(Ue)}}}function Xe(e){Promise===le&&0===Be.echoes?0===Me?e():enqueueNativeMicroTask(e):setTimeout(e,0)}-1===(""+M).indexOf("[native code]")&&(Fe=Ue=J);var Ye=be.reject,Qe=String.fromCharCode(65535),Ze="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",et="String expected.",tt=[],it="__dbnames",nt="readonly",ot="readwrite";function st(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var at={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function rt(e){return"string"!=typeof e||/\./.test(e)?function(e){return e}:function(t){return void 0===t[e]&&e in t&&delete(t=A(t))[e],t}}function lt(){throw V.Type()}function dt(e,t){try{var i=ct(e),n=ct(t);if(i!==n)return"Array"===i?1:"Array"===n?-1:"binary"===i?1:"binary"===n?-1:"string"===i?1:"string"===n?-1:"Date"===i?1:"Date"!==n?NaN:-1;switch(i){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return function(e,t){for(var i=e.length,n=t.length,o=i<n?i:n,s=0;s<o;++s)if(e[s]!==t[s])return e[s]<t[s]?-1:1;return i===n?0:i<n?-1:1}(ut(e),ut(t));case"Array":return function(e,t){for(var i=e.length,n=t.length,o=i<n?i:n,s=0;s<o;++s){var a=dt(e[s],t[s]);if(0!==a)return a}return i===n?0:i<n?-1:1}(e,t)}}catch(o){}return NaN}function ct(e){var t=typeof e;return"object"!=t?t:ArrayBuffer.isView(e)||"ArrayBuffer"===(e=P(e))?"binary":e}function ut(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var pt=(ht.prototype._trans=function(e,t,i){var n=this._tx||ge.trans,o=this.name,s=ne&&"undefined"!=typeof console&&console.createTask&&console.createTask("Dexie: ".concat("readonly"===e?"read":"write"," ").concat(this.name));function a(e,i,n){if(!n.schema[o])throw new V.NotFound("Table "+o+" not part of transaction");return t(n.idbtrans,n)}var r=Ee();try{var l=n&&n.db._novip===this.db._novip?n===ge.trans?n._promise(e,a,i):We((function(){return n._promise(e,a,i)}),{trans:n,transless:ge.transless||ge}):function e(t,i,n,o){if(t.idbdb&&(t._state.openComplete||ge.letThrough||t._vip)){var s=t._createTransaction(i,n,t._dbSchema);try{s.create(),t._state.PR1398_maxLoop=3}catch(a){return a.name===U.InvalidState&&t.isOpen()&&0<--t._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),t.close({disableAutoOpen:!1}),t.open().then((function(){return e(t,i,n,o)}))):Ye(a)}return s._promise(i,(function(e,t){return We((function(){return ge.trans=s,o(e,t,s)}))})).then((function(e){if("readwrite"===i)try{s.idbtrans.commit()}catch(t){}return"readonly"===i?e:s._completion.then((function(){return e}))}))}if(t._state.openComplete)return Ye(new V.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return Ye(new V.DatabaseClosed);t.open().catch(J)}return t._state.dbReadyPromise.then((function(){return e(t,i,n,o)}))}(this.db,e,[this.name],a);return s&&(l._consoleTask=s,l=l.catch((function(e){return console.trace(e),Ye(e)}))),l}finally{r&&Pe()}},ht.prototype.get=function(e,t){var i=this;return e&&e.constructor===Object?this.where(e).first(t):null==e?Ye(new V.Type("Invalid argument to Table.get()")):this._trans("readonly",(function(t){return i.core.get({trans:t,key:e}).then((function(e){return i.hook.reading.fire(e)}))})).then(t)},ht.prototype.where=function(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if(s(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=o(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);var i=this.schema.indexes.concat(this.schema.primKey).filter((function(e){if(e.compound&&t.every((function(t){return 0<=e.keyPath.indexOf(t)}))){for(var i=0;i<t.length;++i)if(-1===t.indexOf(e.keyPath[i]))return!1;return!0}return!1})).sort((function(e,t){return e.keyPath.length-t.keyPath.length}))[0];if(i&&this.db._maxKey!==Qe){var n=i.keyPath.slice(0,t.length);return this.where(n).equals(n.map((function(t){return e[t]})))}!i&&ne&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var a=this.schema.idxByName,r=this.db._deps.indexedDB;function l(e,t){return 0===r.cmp(e,t)}n=(d=t.reduce((function(t,i){var n=t[0],o=t[1],r=(t=a[i],e[i]);return[n||t,n||!t?st(o,t&&t.multi?function(e){return e=v(e,i),s(e)&&e.some((function(e){return l(r,e)}))}:function(e){return l(r,v(e,i))}):o]}),[null,null]))[0];var d=d[1];return n?this.where(n.name).equals(e[n.keyPath]).filter(d):i?this.filter(d):this.where(t).equals("")},ht.prototype.filter=function(e){return this.toCollection().and(e)},ht.prototype.count=function(e){return this.toCollection().count(e)},ht.prototype.offset=function(e){return this.toCollection().offset(e)},ht.prototype.limit=function(e){return this.toCollection().limit(e)},ht.prototype.each=function(e){return this.toCollection().each(e)},ht.prototype.toArray=function(e){return this.toCollection().toArray(e)},ht.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},ht.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,s(e)?"[".concat(e.join("+"),"]"):e))},ht.prototype.reverse=function(){return this.toCollection().reverse()},ht.prototype.mapToClass=function(t){var i,n=this.db,o=this.name;function s(){return null!==i&&i.apply(this,arguments)||this}(this.schema.mappedClass=t).prototype instanceof lt&&(function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}(s,i=t),Object.defineProperty(s.prototype,"db",{get:function(){return n},enumerable:!1,configurable:!0}),s.prototype.table=function(){return o},t=s);for(var a=new Set,l=t.prototype;l;l=r(l))Object.getOwnPropertyNames(l).forEach((function(e){return a.add(e)}));function d(e){if(!e)return e;var i,n=Object.create(t.prototype);for(i in e)if(!a.has(i))try{n[i]=e[i]}catch(o){}return n}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=d,this.hook("reading",d),t},ht.prototype.defineClass=function(){return this.mapToClass((function(e){a(this,e)}))},ht.prototype.add=function(e,t){var i=this,n=this.schema.primKey,o=n.auto,s=n.keyPath,a=e;return s&&o&&(a=rt(s)(e)),this._trans("readwrite",(function(e){return i.core.mutate({trans:e,type:"add",keys:null!=t?[t]:null,values:[a]})})).then((function(e){return e.numFailures?be.reject(e.failures[0]):e.lastResult})).then((function(t){if(s)try{b(e,s,t)}catch(i){}return t}))},ht.prototype.update=function(e,t){return"object"!=typeof e||s(e)?this.where(":id").equals(e).modify(t):void 0===(e=v(e,this.schema.primKey.keyPath))?Ye(new V.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t)},ht.prototype.put=function(e,t){var i=this,n=this.schema.primKey,o=n.auto,s=n.keyPath,a=e;return s&&o&&(a=rt(s)(e)),this._trans("readwrite",(function(e){return i.core.mutate({trans:e,type:"put",values:[a],keys:null!=t?[t]:null})})).then((function(e){return e.numFailures?be.reject(e.failures[0]):e.lastResult})).then((function(t){if(s)try{b(e,s,t)}catch(i){}return t}))},ht.prototype.delete=function(e){var t=this;return this._trans("readwrite",(function(i){return t.core.mutate({trans:i,type:"delete",keys:[e]})})).then((function(e){return e.numFailures?be.reject(e.failures[0]):void 0}))},ht.prototype.clear=function(){var e=this;return this._trans("readwrite",(function(t){return e.core.mutate({trans:t,type:"deleteRange",range:at})})).then((function(e){return e.numFailures?be.reject(e.failures[0]):void 0}))},ht.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",(function(i){return t.core.getMany({keys:e,trans:i}).then((function(e){return e.map((function(e){return t.hook.reading.fire(e)}))}))}))},ht.prototype.bulkAdd=function(e,t,i){var n=this,o=Array.isArray(t)?t:void 0,s=(i=i||(o?void 0:t))?i.allKeys:void 0;return this._trans("readwrite",(function(t){var i=(r=n.schema.primKey).auto;if((r=r.keyPath)&&o)throw new V.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new V.InvalidArgument("Arguments objects and keys must have the same length");var a=e.length,r=r&&i?e.map(rt(r)):e;return n.core.mutate({trans:t,type:"add",keys:o,values:r,wantResults:s}).then((function(e){var t=e.numFailures,i=e.results,o=e.lastResult;if(e=e.failures,0===t)return s?i:o;throw new z("".concat(n.name,".bulkAdd(): ").concat(t," of ").concat(a," operations failed"),e)}))}))},ht.prototype.bulkPut=function(e,t,i){var n=this,o=Array.isArray(t)?t:void 0,s=(i=i||(o?void 0:t))?i.allKeys:void 0;return this._trans("readwrite",(function(t){var i=(r=n.schema.primKey).auto;if((r=r.keyPath)&&o)throw new V.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new V.InvalidArgument("Arguments objects and keys must have the same length");var a=e.length,r=r&&i?e.map(rt(r)):e;return n.core.mutate({trans:t,type:"put",keys:o,values:r,wantResults:s}).then((function(e){var t=e.numFailures,i=e.results,o=e.lastResult;if(e=e.failures,0===t)return s?i:o;throw new z("".concat(n.name,".bulkPut(): ").concat(t," of ").concat(a," operations failed"),e)}))}))},ht.prototype.bulkUpdate=function(e){var t=this,i=this.core,n=e.map((function(e){return e.key})),o=e.map((function(e){return e.changes})),s=[];return this._trans("readwrite",(function(a){return i.getMany({trans:a,keys:n,cache:"clone"}).then((function(r){var l=[],d=[];e.forEach((function(e,i){var n=e.key,o=e.changes,a=r[i];if(a){for(var c=0,u=Object.keys(o);c<u.length;c++){var p=u[c],h=o[p];if(p===t.schema.primKey.keyPath){if(0!==dt(h,n))throw new V.Constraint("Cannot update primary key in bulkUpdate()")}else b(a,p,h)}s.push(i),l.push(n),d.push(a)}}));var c=l.length;return i.mutate({trans:a,type:"put",keys:l,values:d,updates:{keys:n,changeSpecs:o}}).then((function(e){var i=e.numFailures,n=e.failures;if(0===i)return c;for(var o=0,a=Object.keys(n);o<a.length;o++){var r,l=a[o],d=s[Number(l)];null!=d&&(r=n[l],delete n[l],n[d]=r)}throw new z("".concat(t.name,".bulkUpdate(): ").concat(i," of ").concat(c," operations failed"),n)}))}))}))},ht.prototype.bulkDelete=function(e){var t=this,i=e.length;return this._trans("readwrite",(function(i){return t.core.mutate({trans:i,type:"delete",keys:e})})).then((function(e){var n=e.numFailures,o=e.lastResult;if(e=e.failures,0===n)return o;throw new z("".concat(t.name,".bulkDelete(): ").concat(n," of ").concat(i," operations failed"),e)}))},ht);function ht(){}function mt(e){function t(t,n){if(n){for(var o=arguments.length,s=new Array(o-1);--o;)s[o-1]=arguments[o];return i[t].subscribe.apply(null,s),e}if("string"==typeof t)return i[t]}var i={};t.addEventType=r;for(var n=1,a=arguments.length;n<a;++n)r(arguments[n]);return t;function r(e,n,a){if("object"!=typeof e){var l;n=n||te;var d={subscribers:[],fire:a=a||J,subscribe:function(e){-1===d.subscribers.indexOf(e)&&(d.subscribers.push(e),d.fire=n(d.fire,e))},unsubscribe:function(e){d.subscribers=d.subscribers.filter((function(t){return t!==e})),d.fire=d.subscribers.reduce(n,a)}};return i[e]=t[e]=d}o(l=e).forEach((function(e){var t=l[e];if(s(t))r(e,l[e][0],l[e][1]);else{if("asap"!==t)throw new V.InvalidArgument("Invalid event config");var i=r(e,G,(function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];i.subscribers.forEach((function(e){w((function(){e.apply(null,t)}))}))}))}}))}}function _t(e,t){return h(t).from({prototype:e}),t}function ft(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function gt(e,t){e.filter=st(e.filter,t)}function yt(e,t,i){var n=e.replayFilter;e.replayFilter=n?function(){return st(n(),t())}:t,e.justLimit=i&&!n}function wt(e,t){if(e.isPrimKey)return t.primaryKey;var i=t.getIndexByKeyPath(e.index);if(!i)throw new V.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return i}function vt(e,t,i){var n=wt(e,t.schema);return t.openCursor({trans:i,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:n,range:e.range}})}function bt(e,t,i,n){var o=e.replayFilter?st(e.filter,e.replayFilter()):e.filter;if(e.or){var s={},a=function(e,i,n){var a,r;o&&!o(i,n,(function(e){return i.stop(e)}),(function(e){return i.fail(e)}))||("[object ArrayBuffer]"==(r=""+(a=i.primaryKey))&&(r=""+new Uint8Array(a)),d(s,r)||(s[r]=!0,t(e,i,n)))};return Promise.all([e.or._iterate(a,i),St(vt(e,n,i),e.algorithm,a,!e.keysOnly&&e.valueMapper)])}return St(vt(e,n,i),st(e.algorithm,o),t,!e.keysOnly&&e.valueMapper)}function St(e,t,i,n){var o=Re(n?function(e,t,o){return i(n(e),t,o)}:i);return e.then((function(e){if(e)return e.start((function(){var i=function(){return e.continue()};t&&!t(e,(function(e){return i=e}),(function(t){e.stop(t),i=J}),(function(t){e.fail(t),i=J}))||o(e.value,e,(function(e){return i=e})),i()}))}))}k=Symbol();var It=(xt.prototype.execute=function(e){var t=null===(t=this.replacePrefix)||void 0===t?void 0:t[0];return t&&"string"==typeof e&&e.startsWith(t)?this.replacePrefix[1]+e.substring(t.length):e},xt);function xt(e){Object.assign(this,e)}var kt=(Tt.prototype._read=function(e,t){var i=this._ctx;return i.error?i.table._trans(null,Ye.bind(null,i.error)):i.table._trans("readonly",e).then(t)},Tt.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,Ye.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},Tt.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=st(t.algorithm,e)},Tt.prototype._iterate=function(e,t){return bt(this._ctx,e,t,this._ctx.table.core)},Tt.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),i=Object.create(this._ctx);return e&&a(i,e),t._ctx=i,t},Tt.prototype.raw=function(){return this._ctx.valueMapper=null,this},Tt.prototype.each=function(e){var t=this._ctx;return this._read((function(i){return bt(t,e,i,t.table.core)}))},Tt.prototype.count=function(e){var t=this;return this._read((function(e){var i=t._ctx,n=i.table.core;if(ft(i,!0))return n.count({trans:e,query:{index:wt(i,n.schema),range:i.range}}).then((function(e){return Math.min(e,i.limit)}));var o=0;return bt(i,(function(){return++o,!1}),e,n).then((function(){return o}))})).then(e)},Tt.prototype.sortBy=function(e,t){var i=e.split(".").reverse(),n=i[0],o=i.length-1;function s(e,t){return t?s(e[i[t]],t-1):e[n]}var a="next"===this._ctx.dir?1:-1;function r(e,t){return(e=s(e,o))<(t=s(t,o))?-a:t<e?a:0}return this.toArray((function(e){return e.sort(r)})).then(t)},Tt.prototype.toArray=function(e){var t=this;return this._read((function(e){var i=t._ctx;if("next"===i.dir&&ft(i,!0)&&0<i.limit){var n=i.valueMapper,o=wt(i,i.table.core.schema);return i.table.core.query({trans:e,limit:i.limit,values:!0,query:{index:o,range:i.range}}).then((function(e){return e=e.result,n?e.map(n):e}))}var s=[];return bt(i,(function(e){return s.push(e)}),e,i.table.core).then((function(){return s}))}),e)},Tt.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,ft(t)?yt(t,(function(){var t=e;return function(e,i){return 0===t||(1===t?--t:i((function(){e.advance(t),t=0})),!1)}})):yt(t,(function(){var t=e;return function(){return--t<0}}))),this},Tt.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),yt(this._ctx,(function(){var t=e;return function(e,i,n){return--t<=0&&i(n),0<=t}}),!0),this},Tt.prototype.until=function(e,t){return gt(this._ctx,(function(i,n,o){return!e(i.value)||(n(o),t)})),this},Tt.prototype.first=function(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)},Tt.prototype.last=function(e){return this.reverse().first(e)},Tt.prototype.filter=function(e){var t;return gt(this._ctx,(function(t){return e(t.value)})),(t=this._ctx).isMatch=st(t.isMatch,e),this},Tt.prototype.and=function(e){return this.filter(e)},Tt.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},Tt.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Tt.prototype.desc=function(){return this.reverse()},Tt.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,i){e(i.key,i)}))},Tt.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},Tt.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,i){e(i.primaryKey,i)}))},Tt.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var i=[];return this.each((function(e,t){i.push(t.key)})).then((function(){return i})).then(e)},Tt.prototype.primaryKeys=function(e){var t=this._ctx;if("next"===t.dir&&ft(t,!0)&&0<t.limit)return this._read((function(e){var i=wt(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:i,range:t.range}})})).then((function(e){return e.result})).then(e);t.keysOnly=!t.isMatch;var i=[];return this.each((function(e,t){i.push(t.primaryKey)})).then((function(){return i})).then(e)},Tt.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},Tt.prototype.firstKey=function(e){return this.limit(1).keys((function(e){return e[0]})).then(e)},Tt.prototype.lastKey=function(e){return this.reverse().firstKey(e)},Tt.prototype.distinct=function(){var e;if(!(e=(e=this._ctx).index&&e.table.schema.idxByName[e.index])||!e.multi)return this;var t={};return gt(this._ctx,(function(e){var i=e.primaryKey.toString();return e=d(t,i),t[i]=!0,!e})),this},Tt.prototype.modify=function(e){var t=this,i=this._ctx;return this._write((function(n){var s,a,r;function l(e,t){var i=t.failures;t=t.numFailures,_+=e-t;for(var n=0,s=o(i);n<s.length;n++){var a=s[n];m.push(i[a])}}r="function"==typeof e?e:(s=o(e),a=s.length,function(t){for(var i=!1,n=0;n<a;++n){var o=s[n],r=e[o],l=v(t,o);r instanceof It?(b(t,o,r.execute(l)),i=!0):l!==r&&(b(t,o,r),i=!0)}return i});var d=i.table.core,c=d.schema.primaryKey,u=c.outbound,p=c.extractKey,h=t.db._options.modifyChunkSize||200,m=[],_=0,f=[];return t.clone().primaryKeys().then((function(t){function o(s){var a=Math.min(h,t.length-s);return d.getMany({trans:n,keys:t.slice(s,s+a),cache:"immutable"}).then((function(c){for(var m=[],_=[],f=u?[]:null,g=[],y=0;y<a;++y){var w=c[y],v={value:A(w),primKey:t[s+y]};!1!==r.call(v,v.value,v)&&(null==v.value?g.push(t[s+y]):u||0===dt(p(w),p(v.value))?(_.push(v.value),u&&f.push(t[s+y])):(g.push(t[s+y]),m.push(v.value)))}var b=ft(i)&&i.limit===1/0&&("function"!=typeof e||e===Ct)&&{index:i.index,range:i.range};return Promise.resolve(0<m.length&&d.mutate({trans:n,type:"add",values:m}).then((function(e){for(var t in e.failures)g.splice(parseInt(t),1);l(m.length,e)}))).then((function(){return(0<_.length||b&&"object"==typeof e)&&d.mutate({trans:n,type:"put",keys:f,values:_,criteria:b,changeSpec:"function"!=typeof e&&e}).then((function(e){return l(_.length,e)}))})).then((function(){return(0<g.length||b&&e===Ct)&&d.mutate({trans:n,type:"delete",keys:g,criteria:b}).then((function(e){return l(g.length,e)}))})).then((function(){return t.length>s+a&&o(s+h)}))}))}return o(0).then((function(){if(0<m.length)throw new F("Error modifying one or more objects",m,_,f);return t.length}))}))}))},Tt.prototype.delete=function(){var e=this._ctx,t=e.range;return ft(e)&&(e.isPrimKey||3===t.type)?this._write((function(i){var n=e.table.core.schema.primaryKey,o=t;return e.table.core.count({trans:i,query:{index:n,range:o}}).then((function(t){return e.table.core.mutate({trans:i,type:"deleteRange",range:o}).then((function(e){var i=e.failures;if(e.lastResult,e.results,e=e.numFailures)throw new F("Could not delete some values",Object.keys(i).map((function(e){return i[e]})),t-e);return t-e}))}))})):this.modify(Ct)},Tt);function Tt(){}var Ct=function(e,t){return t.value=null};function At(e,t){return e<t?-1:e===t?0:1}function Et(e,t){return t<e?-1:e===t?0:1}function Pt(e,t,i){return(e=e instanceof Ot?new e.Collection(e):e)._ctx.error=new(i||TypeError)(t),e}function Lt(e){return new e.Collection(e,(function(){return Bt("")})).limit(0)}function Dt(e,t,i,n){var o,s,a,r,l,d,c,u=i.length;if(!i.every((function(e){return"string"==typeof e})))return Pt(e,et);function p(e){o="next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()},s="next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()},a="next"===e?At:Et;var t=i.map((function(e){return{lower:s(e),upper:o(e)}})).sort((function(e,t){return a(e.lower,t.lower)}));r=t.map((function(e){return e.upper})),l=t.map((function(e){return e.lower})),c="next"===(d=e)?"":n}p("next"),(e=new e.Collection(e,(function(){return Rt(r[0],l[u-1]+n)})))._ondirectionchange=function(e){p(e)};var h=0;return e._addAlgorithm((function(e,i,n){var o=e.key;if("string"!=typeof o)return!1;var p=s(o);if(t(p,l,h))return!0;for(var m=null,_=h;_<u;++_){var f=function(e,t,i,n,o,s){for(var a=Math.min(e.length,n.length),r=-1,l=0;l<a;++l){var d=t[l];if(d!==n[l])return o(e[l],i[l])<0?e.substr(0,l)+i[l]+i.substr(l+1):o(e[l],n[l])<0?e.substr(0,l)+n[l]+i.substr(l+1):0<=r?e.substr(0,r)+t[r]+i.substr(r+1):null;o(e[l],d)<0&&(r=l)}return a<n.length&&"next"===s?e+i.substr(e.length):a<e.length&&"prev"===s?e.substr(0,i.length):r<0?null:e.substr(0,r)+n[r]+i.substr(r+1)}(o,p,r[_],l[_],a,d);null===f&&null===m?h=_+1:(null===m||0<a(m,f))&&(m=f)}return i(null!==m?function(){e.continue(m+c)}:n),!1})),e}function Rt(e,t,i,n){return{type:2,lower:e,upper:t,lowerOpen:i,upperOpen:n}}function Bt(e){return{type:1,lower:e,upper:e}}var Ot=(Object.defineProperty(jt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),jt.prototype.between=function(e,t,i,n){i=!1!==i,n=!0===n;try{return 0<this._cmp(e,t)||0===this._cmp(e,t)&&(i||n)&&(!i||!n)?Lt(this):new this.Collection(this,(function(){return Rt(e,t,!i,!n)}))}catch(o){return Pt(this,Ze)}},jt.prototype.equals=function(e){return null==e?Pt(this,Ze):new this.Collection(this,(function(){return Bt(e)}))},jt.prototype.above=function(e){return null==e?Pt(this,Ze):new this.Collection(this,(function(){return Rt(e,void 0,!0)}))},jt.prototype.aboveOrEqual=function(e){return null==e?Pt(this,Ze):new this.Collection(this,(function(){return Rt(e,void 0,!1)}))},jt.prototype.below=function(e){return null==e?Pt(this,Ze):new this.Collection(this,(function(){return Rt(void 0,e,!1,!0)}))},jt.prototype.belowOrEqual=function(e){return null==e?Pt(this,Ze):new this.Collection(this,(function(){return Rt(void 0,e)}))},jt.prototype.startsWith=function(e){return"string"!=typeof e?Pt(this,et):this.between(e,e+Qe,!0,!0)},jt.prototype.startsWithIgnoreCase=function(e){return""===e?this.startsWith(e):Dt(this,(function(e,t){return 0===e.indexOf(t[0])}),[e],Qe)},jt.prototype.equalsIgnoreCase=function(e){return Dt(this,(function(e,t){return e===t[0]}),[e],"")},jt.prototype.anyOfIgnoreCase=function(){var e=O.apply(B,arguments);return 0===e.length?Lt(this):Dt(this,(function(e,t){return-1!==t.indexOf(e)}),e,"")},jt.prototype.startsWithAnyOfIgnoreCase=function(){var e=O.apply(B,arguments);return 0===e.length?Lt(this):Dt(this,(function(e,t){return t.some((function(t){return 0===e.indexOf(t)}))}),e,Qe)},jt.prototype.anyOf=function(){var e=this,t=O.apply(B,arguments),i=this._cmp;try{t.sort(i)}catch(s){return Pt(this,Ze)}if(0===t.length)return Lt(this);var n=new this.Collection(this,(function(){return Rt(t[0],t[t.length-1])}));n._ondirectionchange=function(n){i="next"===n?e._ascending:e._descending,t.sort(i)};var o=0;return n._addAlgorithm((function(e,n,s){for(var a=e.key;0<i(a,t[o]);)if(++o===t.length)return n(s),!1;return 0===i(a,t[o])||(n((function(){e.continue(t[o])})),!1)})),n},jt.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},jt.prototype.noneOf=function(){var e=O.apply(B,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(i){return Pt(this,Ze)}var t=e.reduce((function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[-1/0,t]]}),null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},jt.prototype.inAnyRange=function(e,t){var i=this,n=this._cmp,o=this._ascending,s=this._descending,a=this._min,r=this._max;if(0===e.length)return Lt(this);if(!e.every((function(e){return void 0!==e[0]&&void 0!==e[1]&&o(e[0],e[1])<=0})))return Pt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",V.InvalidArgument);var l,d=!t||!1!==t.includeLowers,c=t&&!0===t.includeUppers,u=o;function p(e,t){return u(e[0],t[0])}try{(l=e.reduce((function(e,t){for(var i=0,o=e.length;i<o;++i){var s=e[i];if(n(t[0],s[1])<0&&0<n(t[1],s[0])){s[0]=a(s[0],t[0]),s[1]=r(s[1],t[1]);break}}return i===o&&e.push(t),e}),[])).sort(p)}catch(g){return Pt(this,Ze)}var h=0,m=c?function(e){return 0<o(e,l[h][1])}:function(e){return 0<=o(e,l[h][1])},_=d?function(e){return 0<s(e,l[h][0])}:function(e){return 0<=s(e,l[h][0])},f=m;return(e=new this.Collection(this,(function(){return Rt(l[0][0],l[l.length-1][1],!d,!c)})))._ondirectionchange=function(e){u="next"===e?(f=m,o):(f=_,s),l.sort(p)},e._addAlgorithm((function(e,t,n){for(var s,a=e.key;f(a);)if(++h===l.length)return t(n),!1;return!m(s=a)&&!_(s)||(0===i._cmp(a,l[h][1])||0===i._cmp(a,l[h][0])||t((function(){u===o?e.continue(l[h][0]):e.continue(l[h][1])})),!1)})),e},jt.prototype.startsWithAnyOf=function(){var e=O.apply(B,arguments);return e.every((function(e){return"string"==typeof e}))?0===e.length?Lt(this):this.inAnyRange(e.map((function(e){return[e,e+Qe]}))):Pt(this,"startsWithAnyOf() only works with strings")},jt);function jt(){}function Mt(e){return Re((function(t){return Nt(t),e(t.target.error),!1}))}function Nt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var qt="storagemutated",Wt="x-storagemutated-1",Ft=mt(null,qt),zt=(Ut.prototype._lock=function(){return y(!ge.global),++this._reculock,1!==this._reculock||ge.global||(ge.lockOwnerFor=this),this},Ut.prototype._unlock=function(){if(y(!ge.global),0==--this._reculock)for(ge.global||(ge.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{Je(e[1],e[0])}catch(t){}}return this},Ut.prototype._locked=function(){return this._reculock&&ge.lockOwnerFor!==this},Ut.prototype.create=function(e){var t=this;if(!this.mode)return this;var i=this.db.idbdb,n=this.db._state.dbOpenError;if(y(!this.idbtrans),!e&&!i)switch(n&&n.name){case"DatabaseClosedError":throw new V.DatabaseClosed(n);case"MissingAPIError":throw new V.MissingAPI(n.message,n);default:throw new V.OpenFailed(n)}if(!this.active)throw new V.TransactionInactive;return y(null===this._completion._state),(e=this.idbtrans=e||(this.db.core||i).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Re((function(i){Nt(i),t._reject(e.error)})),e.onabort=Re((function(i){Nt(i),t.active&&t._reject(new V.Abort(e.error)),t.active=!1,t.on("abort").fire(i)})),e.oncomplete=Re((function(){t.active=!1,t._resolve(),"mutatedParts"in e&&Ft.storagemutated.fire(e.mutatedParts)})),this},Ut.prototype._promise=function(e,t,i){var n=this;if("readwrite"===e&&"readwrite"!==this.mode)return Ye(new V.ReadOnly("Transaction is readonly"));if(!this.active)return Ye(new V.TransactionInactive);if(this._locked())return new be((function(o,s){n._blockedFuncs.push([function(){n._promise(e,t,i).then(o,s)},ge])}));if(i)return We((function(){var e=new be((function(e,i){n._lock();var o=t(e,i,n);o&&o.then&&o.then(e,i)}));return e.finally((function(){return n._unlock()})),e._lib=!0,e}));var o=new be((function(e,i){var o=t(e,i,n);o&&o.then&&o.then(e,i)}));return o._lib=!0,o},Ut.prototype._root=function(){return this.parent?this.parent._root():this},Ut.prototype.waitFor=function(e){var t,i=this._root(),n=be.resolve(e);i._waitingFor?i._waitingFor=i._waitingFor.then((function(){return n})):(i._waitingFor=n,i._waitingQueue=[],t=i.idbtrans.objectStore(i.storeNames[0]),function e(){for(++i._spinCount;i._waitingQueue.length;)i._waitingQueue.shift()();i._waitingFor&&(t.get(-1/0).onsuccess=e)}());var o=i._waitingFor;return new be((function(e,t){n.then((function(t){return i._waitingQueue.push(Re(e.bind(null,t)))}),(function(e){return i._waitingQueue.push(Re(t.bind(null,e)))})).finally((function(){i._waitingFor===o&&(i._waitingFor=null)}))}))},Ut.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new V.Abort))},Ut.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(d(t,e))return t[e];var i=this.schema[e];if(!i)throw new V.NotFound("Table "+e+" not part of transaction");return(i=new this.db.Table(e,i,this)).core=this.db.core.table(e),t[e]=i},Ut);function Ut(){}function Ht(e,t,i,n,o,s,a){return{name:e,keyPath:t,unique:i,multi:n,auto:o,compound:s,src:(i&&!a?"&":"")+(n?"*":"")+(o?"++":"")+Vt(t)}}function Vt(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function Kt(e,t,i){return{name:e,primKey:t,indexes:i,mappedClass:null,idxByName:(n=function(e){return[e.name,e]},i.reduce((function(e,t,i){return(i=n(t,i))&&(e[i[0]]=i[1]),e}),{}))};var n}var $t=function(e){try{return e.only([[]]),$t=function(){return[[]]},[[]]}catch(t){return $t=function(){return Qe},Qe}};function Jt(e){return null==e?function(){}:"string"==typeof e?1===(t=e).split(".").length?function(e){return e[t]}:function(e){return v(e,t)}:function(t){return v(t,e)};var t}function Gt(e){return[].slice.call(e)}var Xt=0;function Yt(e){return null==e?":id":"string"==typeof e?e:"[".concat(e.join("+"),"]")}function Qt(e,t,i){function n(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");var i=e.lower,n=e.upper,o=e.lowerOpen;return e=e.upperOpen,void 0===i?void 0===n?null:t.upperBound(n,!!e):void 0===n?t.lowerBound(i,!!o):t.bound(i,n,!!o,!!e)}function o(e){var t,i=e.name;return{name:i,schema:e,mutate:function(e){var t=e.trans,o=e.type,s=e.keys,a=e.values,r=e.range;return new Promise((function(e,l){e=Re(e);var d=t.objectStore(i),c=null==d.keyPath,u="put"===o||"add"===o;if(!u&&"delete"!==o&&"deleteRange"!==o)throw new Error("Invalid operation type: "+o);var p,h=(s||a||{length:1}).length;if(s&&a&&s.length!==a.length)throw new Error("Given keys array must have same length as given values array.");if(0===h)return e({numFailures:0,failures:{},results:[],lastResult:void 0});function m(e){++g,Nt(e)}var _=[],f=[],g=0;if("deleteRange"===o){if(4===r.type)return e({numFailures:g,failures:f,results:[],lastResult:void 0});3===r.type?_.push(p=d.clear()):_.push(p=d.delete(n(r)))}else{var y=(c=u?c?[a,s]:[a,null]:[s,null])[0],w=c[1];if(u)for(var v=0;v<h;++v)_.push(p=w&&void 0!==w[v]?d[o](y[v],w[v]):d[o](y[v])),p.onerror=m;else for(v=0;v<h;++v)_.push(p=d[o](y[v])),p.onerror=m}function b(t){t=t.target.result,_.forEach((function(e,t){return null!=e.error&&(f[t]=e.error)})),e({numFailures:g,failures:f,results:"delete"===o?s:_.map((function(e){return e.result})),lastResult:t})}p.onerror=function(e){m(e),b(e)},p.onsuccess=b}))},getMany:function(e){var t=e.trans,n=e.keys;return new Promise((function(e,o){e=Re(e);for(var s,a=t.objectStore(i),r=n.length,l=new Array(r),d=0,c=0,u=function(t){t=t.target,l[t._pos]=t.result,++c===d&&e(l)},p=Mt(o),h=0;h<r;++h)null!=n[h]&&((s=a.get(n[h]))._pos=h,s.onsuccess=u,s.onerror=p,++d);0===d&&e(l)}))},get:function(e){var t=e.trans,n=e.key;return new Promise((function(e,o){e=Re(e);var s=t.objectStore(i).get(n);s.onsuccess=function(t){return e(t.target.result)},s.onerror=Mt(o)}))},query:(t=d,function(e){return new Promise((function(o,s){o=Re(o);var a,r,l,d=e.trans,c=e.values,u=e.limit,p=e.query,h=u===1/0?void 0:u,m=p.index;if(p=p.range,d=d.objectStore(i),m=m.isPrimaryKey?d:d.index(m.name),p=n(p),0===u)return o({result:[]});t?((h=c?m.getAll(p,h):m.getAllKeys(p,h)).onsuccess=function(e){return o({result:e.target.result})},h.onerror=Mt(s)):(a=0,r=!c&&"openKeyCursor"in m?m.openKeyCursor(p):m.openCursor(p),l=[],r.onsuccess=function(e){var t=r.result;return t?(l.push(c?t.value:t.primaryKey),++a===u?o({result:l}):void t.continue()):o({result:l})},r.onerror=Mt(s))}))}),openCursor:function(e){var t=e.trans,o=e.values,s=e.query,a=e.reverse,r=e.unique;return new Promise((function(e,l){e=Re(e);var d=s.index,c=s.range,u=t.objectStore(i),p=(u=d.isPrimaryKey?u:u.index(d.name),d=a?r?"prevunique":"prev":r?"nextunique":"next",!o&&"openKeyCursor"in u?u.openKeyCursor(n(c),d):u.openCursor(n(c),d));p.onerror=Mt(l),p.onsuccess=Re((function(i){var n,o,s,a,r=p.result;r?(r.___id=++Xt,r.done=!1,n=r.continue.bind(r),o=(o=r.continuePrimaryKey)&&o.bind(r),s=r.advance.bind(r),a=function(){throw new Error("Cursor not stopped")},r.trans=t,r.stop=r.continue=r.continuePrimaryKey=r.advance=function(){throw new Error("Cursor not started")},r.fail=Re(l),r.next=function(){var e=this,t=1;return this.start((function(){return t--?e.continue():e.stop()})).then((function(){return e}))},r.start=function(e){function t(){if(p.result)try{e()}catch(t){r.fail(t)}else r.done=!0,r.start=function(){throw new Error("Cursor behind last entry")},r.stop()}var i=new Promise((function(e,t){e=Re(e),p.onerror=Mt(t),r.fail=t,r.stop=function(t){r.stop=r.continue=r.continuePrimaryKey=r.advance=a,e(t)}}));return p.onsuccess=Re((function(e){p.onsuccess=t,t()})),r.continue=n,r.continuePrimaryKey=o,r.advance=s,t(),i},e(r)):e(null)}),l)}))},count:function(e){var t=e.query,o=e.trans,s=t.index,a=t.range;return new Promise((function(e,t){var r=o.objectStore(i),l=s.isPrimaryKey?r:r.index(s.name);(l=(r=n(a))?l.count(r):l.count()).onsuccess=Re((function(t){return e(t.target.result)})),l.onerror=Mt(t)}))}}}i=(r=i,l=Gt((a=e).objectStoreNames),c={schema:{name:a.name,tables:l.map((function(e){return r.objectStore(e)})).map((function(e){var t=e.keyPath,i=e.autoIncrement,n=s(t),o={};return i={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:null==t,compound:n,keyPath:t,autoIncrement:i,unique:!0,extractKey:Jt(t)},indexes:Gt(e.indexNames).map((function(t){return e.index(t)})).map((function(e){var t=e.name,i=e.unique,n=e.multiEntry;return e=e.keyPath,n={name:t,compound:s(e),keyPath:e,unique:i,multiEntry:n,extractKey:Jt(e)},o[Yt(e)]=n})),getIndexByKeyPath:function(e){return o[Yt(e)]}},o[":id"]=i.primaryKey,null!=t&&(o[Yt(t)]=i.primaryKey),i}))},hasGetAll:0<l.length&&"getAll"in r.objectStore(l[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}).schema;var a,r,l,d=c.hasGetAll,c=i.tables.map(o),u={};return c.forEach((function(e){return u[e.name]=e})),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(e){if(!u[e])throw new Error("Table '".concat(e,"' not found"));return u[e]},MIN_KEY:-1/0,MAX_KEY:$t(t),schema:i}}function Zt(e,i,n,o){var s=n.IDBKeyRange;return n.indexedDB,{dbcore:(o=Qt(i,s,o),e.dbcore.reduce((function(e,i){return i=i.create,t(t({},e),i(e))}),o))}}function ei(e,t){var i=t.db;t=Zt(e._middlewares,i,e._deps,t),e.core=t.dbcore,e.tables.forEach((function(t){var i=t.name;e.core.schema.tables.some((function(e){return e.name===i}))&&(t.core=e.core.table(i),e[i]instanceof e.Table&&(e[i].core=t.core))}))}function ti(e,t,i,n){i.forEach((function(i){var o=n[i];t.forEach((function(t){var n=function e(t,i){return m(t,i)||(t=r(t))&&e(t,i)}(t,i);(!n||"value"in n&&void 0===n.value)&&(t===e.Transaction.prototype||t instanceof e.Transaction?p(t,i,{get:function(){return this.table(i)},set:function(e){u(this,i,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):t[i]=new e.Table(i,o))}))}))}function ii(e,t){t.forEach((function(t){for(var i in t)t[i]instanceof e.Table&&delete t[i]}))}function ni(e,t){return e._cfg.version-t._cfg.version}function oi(e,t,i,n){var s=e._dbSchema;i.objectStoreNames.contains("$meta")&&!s.$meta&&(s.$meta=Kt("$meta",pi("")[0],[]),e._storeNames.push("$meta"));var a=e._createTransaction("readwrite",e._storeNames,s);a.create(i),a._completion.catch(n);var r=a._reject.bind(a),l=ge.transless||ge;We((function(){return ge.trans=a,ge.transless=l,0!==t?(ei(e,i),d=t,((n=a).storeNames.includes("$meta")?n.table("$meta").get("version").then((function(e){return null!=e?e:d})):be.resolve(d)).then((function(t){return s=t,r=a,l=i,d=[],t=(n=e)._versions,c=n._dbSchema=ci(0,n.idbdb,l),0!==(t=t.filter((function(e){return e._cfg.version>=s}))).length?(t.forEach((function(e){d.push((function(){var t=c,i=e._cfg.dbschema;ui(n,t,l),ui(n,i,l),c=n._dbSchema=i;var a=ai(t,i);a.add.forEach((function(e){ri(l,e[0],e[1].primKey,e[1].indexes)})),a.change.forEach((function(e){if(e.recreate)throw new V.Upgrade("Not yet support for changing primary key");var t=l.objectStore(e.name);e.add.forEach((function(e){return di(t,e)})),e.change.forEach((function(e){t.deleteIndex(e.name),di(t,e)})),e.del.forEach((function(e){return t.deleteIndex(e)}))}));var d=e._cfg.contentUpgrade;if(d&&e._cfg.version>s){ei(n,l),r._memoizedTables={};var u=S(i);a.del.forEach((function(e){u[e]=t[e]})),ii(n,[n.Transaction.prototype]),ti(n,[n.Transaction.prototype],o(u),u),r.schema=u;var p,h=j(d);return h&&Fe(),a=be.follow((function(){var e;(p=d(r))&&h&&(e=Ue.bind(null,null),p.then(e,e))})),p&&"function"==typeof p.then?be.resolve(p):a.then((function(){return p}))}})),d.push((function(t){var i,o,s=e._cfg.dbschema;i=s,o=t,[].slice.call(o.db.objectStoreNames).forEach((function(e){return null==i[e]&&o.db.deleteObjectStore(e)})),ii(n,[n.Transaction.prototype]),ti(n,[n.Transaction.prototype],n._storeNames,n._dbSchema),r.schema=n._dbSchema})),d.push((function(t){n.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(n.idbdb.version/10)===e._cfg.version?(n.idbdb.deleteObjectStore("$meta"),delete n._dbSchema.$meta,n._storeNames=n._storeNames.filter((function(e){return"$meta"!==e}))):t.objectStore("$meta").put(e._cfg.version,"version"))}))})),function e(){return d.length?be.resolve(d.shift()(r.idbtrans)).then(e):be.resolve()}().then((function(){li(c,l)}))):be.resolve();var n,s,r,l,d,c})).catch(r)):(o(s).forEach((function(e){ri(i,e,s[e].primKey,s[e].indexes)})),ei(e,i),void be.follow((function(){return e.on.populate.fire(a)})).catch(r));var n,d}))}function si(e,t){li(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var i=ci(0,e.idbdb,t);ui(e,e._dbSchema,t);for(var n=0,o=ai(i,e._dbSchema).change;n<o.length;n++){var s=function(e){if(e.change.length||e.recreate)return console.warn("Unable to patch indexes of table ".concat(e.name," because it has changes on the type of index or primary key.")),{value:void 0};var i=t.objectStore(e.name);e.add.forEach((function(t){ne&&console.debug("Dexie upgrade patch: Creating missing index ".concat(e.name,".").concat(t.src)),di(i,t)}))}(o[n]);if("object"==typeof s)return s.value}}function ai(e,t){var i,n={del:[],add:[],change:[]};for(i in e)t[i]||n.del.push(i);for(i in t){var o=e[i],s=t[i];if(o){var a={name:i,def:s,recreate:!1,del:[],add:[],change:[]};if(""+(o.primKey.keyPath||"")!=""+(s.primKey.keyPath||"")||o.primKey.auto!==s.primKey.auto)a.recreate=!0,n.change.push(a);else{var r=o.idxByName,l=s.idxByName,d=void 0;for(d in r)l[d]||a.del.push(d);for(d in l){var c=r[d],u=l[d];c?c.src!==u.src&&a.change.push(u):a.add.push(u)}(0<a.del.length||0<a.add.length||0<a.change.length)&&n.change.push(a)}}else n.add.push([i,s])}return n}function ri(e,t,i,n){var o=e.db.createObjectStore(t,i.keyPath?{keyPath:i.keyPath,autoIncrement:i.auto}:{autoIncrement:i.auto});return n.forEach((function(e){return di(o,e)})),o}function li(e,t){o(e).forEach((function(i){t.db.objectStoreNames.contains(i)||(ne&&console.debug("Dexie: Creating missing table",i),ri(t,i,e[i].primKey,e[i].indexes))}))}function di(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function ci(e,t,i){var n={};return f(t.objectStoreNames,0).forEach((function(e){for(var t=i.objectStore(e),o=Ht(Vt(r=t.keyPath),r||"",!0,!1,!!t.autoIncrement,r&&"string"!=typeof r,!0),s=[],a=0;a<t.indexNames.length;++a){var r=(l=t.index(t.indexNames[a])).keyPath,l=Ht(l.name,r,!!l.unique,!!l.multiEntry,!1,r&&"string"!=typeof r,!1);s.push(l)}n[e]=Kt(e,o,s)})),n}function ui(e,t,i){for(var o=i.db.objectStoreNames,s=0;s<o.length;++s){var a=o[s],r=i.objectStore(a);e._hasGetAll="getAll"in r;for(var l=0;l<r.indexNames.length;++l){var d=r.indexNames[l],c=r.index(d).keyPath,u="string"==typeof c?c:"["+f(c).join("+")+"]";!t[a]||(c=t[a].idxByName[u])&&(c.name=d,delete t[a].idxByName[u],t[a].idxByName[d]=c)}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&n.WorkerGlobalScope&&n instanceof n.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function pi(e){return e.split(",").map((function(e,t){var i=(e=e.trim()).replace(/([&*]|\+\+)/g,""),n=/^\[/.test(i)?i.match(/^\[(.*)\]$/)[1].split("+"):i;return Ht(i,n||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),s(n),0===t)}))}var hi=(mi.prototype._parseStoresSpec=function(e,t){o(e).forEach((function(i){if(null!==e[i]){var n=pi(e[i]),o=n.shift();if(o.unique=!0,o.multi)throw new V.Schema("Primary key cannot be multi-valued");n.forEach((function(e){if(e.auto)throw new V.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new V.Schema("Index must have a name and cannot be an empty string")})),t[i]=Kt(i,o,n)}}))},mi.prototype.stores=function(e){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?a(this._cfg.storesSource,e):e,e=t._versions;var i={},n={};return e.forEach((function(e){a(i,e._cfg.storesSource),n=e._cfg.dbschema={},e._parseStoresSpec(i,n)})),t._dbSchema=n,ii(t,[t._allTables,t,t.Transaction.prototype]),ti(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],o(n),n),t._storeNames=o(n),this},mi.prototype.upgrade=function(e){return this._cfg.contentUpgrade=ie(this._cfg.contentUpgrade||J,e),this},mi);function mi(){}function _i(e,t){var i=e._dbNamesDB;return i||(i=e._dbNamesDB=new en(it,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),i.table("dbnames")}function fi(e){return e&&"function"==typeof e.databases}function gi(e){return We((function(){return ge.letThrough=!0,e()}))}function yi(e){return!("from"in e)}var wi=function(e,t){if(!this){var i=new wi;return e&&"d"in e&&a(i,e),i}a(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function vi(e,t,i){var n=dt(t,i);if(!isNaN(n)){if(0<n)throw RangeError();if(yi(e))return a(e,{from:t,to:i,d:1});var o=e.l;if(n=e.r,dt(i,e.from)<0)return o?vi(o,t,i):e.l={from:t,to:i,d:1,l:null,r:null},xi(e);if(0<dt(t,e.to))return n?vi(n,t,i):e.r={from:t,to:i,d:1,l:null,r:null},xi(e);dt(t,e.from)<0&&(e.from=t,e.l=null,e.d=n?n.d+1:1),0<dt(i,e.to)&&(e.to=i,e.r=null,e.d=e.l?e.l.d+1:1),i=!e.r,o&&!e.l&&bi(e,o),n&&i&&bi(e,n)}}function bi(e,t){yi(t)||function e(t,i){var n=i.from,o=i.to,s=i.l;i=i.r,vi(t,n,o),s&&e(t,s),i&&e(t,i)}(e,t)}function Si(e,t){var i=Ii(t),n=i.next();if(n.done)return!1;for(var o=n.value,s=Ii(e),a=s.next(o.from),r=a.value;!n.done&&!a.done;){if(dt(r.from,o.to)<=0&&0<=dt(r.to,o.from))return!0;dt(o.from,r.from)<0?o=(n=i.next(r.from)).value:r=(a=s.next(o.from)).value}return!1}function Ii(e){var t=yi(e)?null:{s:0,n:e};return{next:function(e){for(var i=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,i)for(;t.n.l&&dt(e,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!i||dt(e,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function xi(e){var i,n,o=((null===(i=e.r)||void 0===i?void 0:i.d)||0)-((null===(n=e.l)||void 0===n?void 0:n.d)||0),s=1<o?"r":o<-1?"l":"";s&&(i="r"==s?"l":"r",n=t({},e),o=e[s],e.from=o.from,e.to=o.to,e[s]=o[s],n[s]=o[i],(e[i]=n).d=ki(n)),e.d=ki(e)}function ki(e){var t=e.r;return e=e.l,(t?e?Math.max(t.d,e.d):t.d:e?e.d:0)+1}function Ti(e,t){return o(t).forEach((function(i){e[i]?bi(e[i],t[i]):e[i]=function e(t){var i,n,o={};for(i in t)d(t,i)&&(n=t[i],o[i]=!n||"object"!=typeof n||T.has(n.constructor)?n:e(n));return o}(t[i])})),e}function Ci(e,t){return e.all||t.all||Object.keys(e).some((function(i){return t[i]&&Si(t[i],e[i])}))}c(wi.prototype,((M={add:function(e){return bi(this,e),this},addKey:function(e){return vi(this,e,e),this},addKeys:function(e){var t=this;return e.forEach((function(e){return vi(t,e,e)})),this}})[L]=function(){return Ii(this)},M));var Ai={},Ei={},Pi=!1;function Li(e){Ti(Ei,e),Pi||(Pi=!0,setTimeout((function(){Pi=!1,Di(Ei,!(Ei={}))}),0))}function Di(e,t){void 0===t&&(t=!1);var i=new Set;if(e.all)for(var n=0,o=Object.values(Ai);n<o.length;n++)Ri(a=o[n],e,i,t);else for(var s in e){var a,r=/^idb\:\/\/(.*)\/(.*)\//.exec(s);r&&(s=r[1],r=r[2],(a=Ai["idb://".concat(s,"/").concat(r)])&&Ri(a,e,i,t))}i.forEach((function(e){return e()}))}function Ri(e,t,i,n){for(var o=[],s=0,a=Object.entries(e.queries.query);s<a.length;s++){for(var r=a[s],l=r[0],d=[],c=0,u=r[1];c<u.length;c++){var p=u[c];Ci(t,p.obsSet)?p.subscribers.forEach((function(e){return i.add(e)})):n&&d.push(p)}n&&o.push([l,d])}if(n)for(var h=0,m=o;h<m.length;h++){var _=m[h];l=_[0],d=_[1],e.queries.query[l]=d}}function Bi(e){var t=e._state,i=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then((function(){return t.dbOpenError?Ye(t.dbOpenError):e}));t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var n=t.openCanceller,s=Math.round(10*e.verno),a=!1;function r(){if(t.openCanceller!==n)throw new V.DatabaseClosed("db.open() was cancelled")}function l(){return new be((function(n,d){if(r(),!i)throw new V.MissingAPI;var c=e.name,h=t.autoSchema||!s?i.open(c):i.open(c,s);if(!h)throw new V.MissingAPI;h.onerror=Mt(d),h.onblocked=Re(e._fireOnBlocked),h.onupgradeneeded=Re((function(n){var o;u=h.transaction,t.autoSchema&&!e._options.allowEmptyDB?(h.onerror=Nt,u.abort(),h.result.close(),(o=i.deleteDatabase(c)).onsuccess=o.onerror=Re((function(){d(new V.NoSuchDatabase("Database ".concat(c," doesnt exist")))}))):(u.onerror=Mt(d),n=n.oldVersion>Math.pow(2,62)?0:n.oldVersion,p=n<1,e.idbdb=h.result,a&&si(e,u),oi(e,n/10,u,d))}),d),h.onsuccess=Re((function(){u=null;var i,r,d,m,_,g=e.idbdb=h.result,y=f(g.objectStoreNames);if(0<y.length)try{var w=g.transaction(1===(m=y).length?m[0]:m,"readonly");if(t.autoSchema)r=g,d=w,(i=e).verno=r.version/10,d=i._dbSchema=ci(0,r,d),i._storeNames=f(r.objectStoreNames,0),ti(i,[i._allTables],o(d),d);else if(ui(e,e._dbSchema,w),((_=ai(ci(0,(_=e).idbdb,w),_._dbSchema)).add.length||_.change.some((function(e){return e.add.length||e.change.length})))&&!a)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),g.close(),s=g.version+1,a=!0,n(l());ei(e,w)}catch(v){}tt.push(e),g.onversionchange=Re((function(i){t.vcFired=!0,e.on("versionchange").fire(i)})),g.onclose=Re((function(t){e.on("close").fire(t)})),p&&(_=e._deps,w=c,g=_.indexedDB,_=_.IDBKeyRange,fi(g)||w===it||_i(g,_).put({name:w}).catch(J)),n()}),d)})).catch((function(e){switch(null==e?void 0:e.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),l();break;case"VersionError":if(0<s)return s=0,l()}return be.reject(e)}))}var d,c=t.dbReadyResolve,u=null,p=!1;return be.race([n,("undefined"==typeof navigator?be.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise((function(e){function t(){return indexedDB.databases().finally(e)}d=setInterval(t,100),t()})).finally((function(){return clearInterval(d)})):Promise.resolve()).then(l)]).then((function(){return r(),t.onReadyBeingFired=[],be.resolve(gi((function(){return e.on.ready.fire(e.vip)}))).then((function i(){if(0<t.onReadyBeingFired.length){var n=t.onReadyBeingFired.reduce(ie,J);return t.onReadyBeingFired=[],be.resolve(gi((function(){return n(e.vip)}))).then(i)}}))})).finally((function(){t.openCanceller===n&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)})).catch((function(i){t.dbOpenError=i;try{u&&u.abort()}catch(o){}return n===t.openCanceller&&e._close(),Ye(i)})).finally((function(){t.openComplete=!0,c()})).then((function(){var t;return p&&(t={},e.tables.forEach((function(i){i.schema.indexes.forEach((function(n){n.name&&(t["idb://".concat(e.name,"/").concat(i.name,"/").concat(n.name)]=new wi(-1/0,[[[]]]))})),t["idb://".concat(e.name,"/").concat(i.name,"/")]=t["idb://".concat(e.name,"/").concat(i.name,"/:dels")]=new wi(-1/0,[[[]]])})),Ft(qt).fire(t),Di(t,!0)),e}))}function Oi(e){function t(t){return e.next(t)}var i=o(t),n=o((function(t){return e.throw(t)}));function o(e){return function(t){var o=e(t);return t=o.value,o.done?t:t&&"function"==typeof t.then?t.then(i,n):s(t)?Promise.all(t).then(i,n):i(t)}}return o(t)()}function ji(e,t,i){for(var n=s(e)?e.slice():[e],o=0;o<i;++o)n.push(t);return n}var Mi={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return t(t({},e),{table:function(i){var n=e.table(i),o=n.schema,s={},a=[];function r(e,i,n){var o=Yt(e),l=s[o]=s[o]||[],d=null==e?0:"string"==typeof e?1:e.length,c=0<i;return c=t(t({},n),{name:c?"".concat(o,"(virtual-from:").concat(n.name,")"):n.name,lowLevelIndex:n,isVirtual:c,keyTail:i,keyLength:d,extractKey:Jt(e),unique:!c&&n.unique}),l.push(c),c.isPrimaryKey||a.push(c),1<d&&r(2===d?e[0]:e.slice(0,d-1),i+1,n),l.sort((function(e,t){return e.keyTail-t.keyTail})),c}i=r(o.primaryKey.keyPath,0,o.primaryKey),s[":id"]=[i];for(var l=0,d=o.indexes;l<d.length;l++){var c=d[l];r(c.keyPath,0,c)}function u(i){var n,o=i.query.index;return o.isVirtual?t(t({},i),{query:{index:o.lowLevelIndex,range:(n=i.query.range,o=o.keyTail,{type:1===n.type?2:n.type,lower:ji(n.lower,n.lowerOpen?e.MAX_KEY:e.MIN_KEY,o),lowerOpen:!0,upper:ji(n.upper,n.upperOpen?e.MIN_KEY:e.MAX_KEY,o),upperOpen:!0})}}):i}return t(t({},n),{schema:t(t({},o),{primaryKey:i,indexes:a,getIndexByKeyPath:function(e){return(e=s[Yt(e)])&&e[0]}}),count:function(e){return n.count(u(e))},query:function(e){return n.query(u(e))},openCursor:function(t){var i=t.query.index,o=i.keyTail,s=i.isVirtual,a=i.keyLength;return s?n.openCursor(u(t)).then((function(e){return e&&r(e)})):n.openCursor(t);function r(i){return Object.create(i,{continue:{value:function(n){null!=n?i.continue(ji(n,t.reverse?e.MAX_KEY:e.MIN_KEY,o)):t.unique?i.continue(i.key.slice(0,a).concat(t.reverse?e.MIN_KEY:e.MAX_KEY,o)):i.continue()}},continuePrimaryKey:{value:function(t,n){i.continuePrimaryKey(ji(t,e.MAX_KEY,o),n)}},primaryKey:{get:function(){return i.primaryKey}},key:{get:function(){var e=i.key;return 1===a?e[0]:e.slice(0,a)}},value:{get:function(){return i.value}}})}}})}})}};function Ni(e,t,i,n){return i=i||{},n=n||"",o(e).forEach((function(o){var s,a,r;d(t,o)?(s=e[o],a=t[o],"object"==typeof s&&"object"==typeof a&&s&&a?(r=P(s))!==P(a)?i[n+o]=t[o]:"Object"===r?Ni(s,a,i,n+o+"."):s!==a&&(i[n+o]=t[o]):s!==a&&(i[n+o]=t[o])):i[n+o]=void 0})),o(t).forEach((function(o){d(e,o)||(i[n+o]=t[o])})),i}function qi(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}var Wi={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return t(t({},e),{table:function(n){var o=e.table(n),s=o.schema.primaryKey;return t(t({},o),{mutate:function(e){var a=ge.trans,r=a.table(n).hook,l=r.deleting,c=r.creating,u=r.updating;switch(e.type){case"add":if(c.fire===J)break;return a._promise("readwrite",(function(){return p(e)}),!0);case"put":if(c.fire===J&&u.fire===J)break;return a._promise("readwrite",(function(){return p(e)}),!0);case"delete":if(l.fire===J)break;return a._promise("readwrite",(function(){return p(e)}),!0);case"deleteRange":if(l.fire===J)break;return a._promise("readwrite",(function(){return function e(i,n,a){return o.query({trans:i,values:!1,query:{index:s,range:n},limit:a}).then((function(o){var s=o.result;return p({type:"delete",keys:s,trans:i}).then((function(o){return 0<o.numFailures?Promise.reject(o.failures[0]):s.length<a?{failures:[],numFailures:0,lastResult:void 0}:e(i,t(t({},n),{lower:s[s.length-1],lowerOpen:!0}),a)}))}))}(e.trans,e.range,1e4)}),!0)}return o.mutate(e);function p(e){var n,a,r,p=ge.trans,h=e.keys||qi(s,e);if(!h)throw new Error("Keys missing");return"delete"!==(e="add"===e.type||"put"===e.type?t(t({},e),{keys:h}):t({},e)).type&&(e.values=i([],e.values,!0)),e.keys&&(e.keys=i([],e.keys,!0)),n=o,r=h,("add"===(a=e).type?Promise.resolve([]):n.getMany({trans:a.trans,keys:r,cache:"immutable"})).then((function(t){var i=h.map((function(i,n){var o,a,r,h=t[n],m={onerror:null,onsuccess:null};return"delete"===e.type?l.fire.call(m,i,h,p):"add"===e.type||void 0===h?(o=c.fire.call(m,i,e.values[n],p),null==i&&null!=o&&(e.keys[n]=i=o,s.outbound||b(e.values[n],s.keyPath,i))):(o=Ni(h,e.values[n]),(a=u.fire.call(m,o,i,h,p))&&(r=e.values[n],Object.keys(a).forEach((function(e){d(r,e)?r[e]=a[e]:b(r,e,a[e])})))),m}));return o.mutate(e).then((function(n){for(var o=n.failures,s=n.results,a=n.numFailures,r=(n=n.lastResult,0);r<h.length;++r){var l=(s||h)[r],d=i[r];null==l?d.onerror&&d.onerror(o[r]):d.onsuccess&&d.onsuccess("put"===e.type&&t[r]?e.values[r]:l)}return{failures:o,results:s,numFailures:a,lastResult:n}})).catch((function(e){return i.forEach((function(t){return t.onerror&&t.onerror(e)})),Promise.reject(e)}))}))}}})}})}};function Fi(e,t,i){try{if(!t)return null;if(t.keys.length<e.length)return null;for(var n=[],o=0,s=0;o<t.keys.length&&s<e.length;++o)0===dt(t.keys[o],e[s])&&(n.push(i?A(t.values[o]):t.values[o]),++s);return n.length===e.length?n:null}catch(a){return null}}var zi={stack:"dbcore",level:-1,create:function(e){return{table:function(i){var n=e.table(i);return t(t({},n),{getMany:function(e){if(!e.cache)return n.getMany(e);var t=Fi(e.keys,e.trans._cache,"clone"===e.cache);return t?be.resolve(t):n.getMany(e).then((function(t){return e.trans._cache={keys:e.keys,values:"clone"===e.cache?A(t):t},t}))},mutate:function(e){return"add"!==e.type&&(e.trans._cache=null),n.mutate(e)}})}}}};function Ui(e,t){return"readonly"===e.trans.mode&&!!e.subscr&&!e.trans.explicit&&"disabled"!==e.trans.db._options.cache&&!t.schema.primaryKey.outbound}function Hi(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Vi={stack:"dbcore",level:0,name:"Observability",create:function(e){var i=e.schema.name,n=new wi(e.MIN_KEY,e.MAX_KEY);return t(t({},e),{transaction:function(t,i,n){if(ge.subscr&&"readonly"!==i)throw new V.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(ge.querier));return e.transaction(t,i,n)},table:function(a){var r=e.table(a),l=r.schema,d=l.primaryKey,c=l.indexes,u=d.extractKey,p=d.outbound,h=d.autoIncrement&&c.filter((function(e){return e.compound&&e.keyPath.includes(d.keyPath)})),m=t(t({},r),{mutate:function(e){function t(e){return e="idb://".concat(i,"/").concat(a,"/").concat(e),m[e]||(m[e]=new wi)}var o,c,u,p=e.trans,m=e.mutatedParts||(e.mutatedParts={}),_=t(""),f=t(":dels"),g=e.type,y=(v="deleteRange"===e.type?[e.range]:"delete"===e.type?[e.keys]:e.values.length<50?[qi(d,e).filter((function(e){return e})),e.values]:[])[0],w=v[1],v=e.trans._cache;return s(y)?(_.addKeys(y),(v="delete"===g||y.length===w.length?Fi(y,v):null)||f.addKeys(y),(v||w)&&(o=t,c=v,u=w,l.indexes.forEach((function(e){var t=o(e.name||"");function i(t){return null!=t?e.extractKey(t):null}function n(i){return e.multiEntry&&s(i)?i.forEach((function(e){return t.addKey(e)})):t.addKey(i)}(c||u).forEach((function(e,t){var o=c&&i(c[t]);0!==dt(o,t=u&&i(u[t]))&&(null!=o&&n(o),null!=t&&n(t))}))})))):y?(w={from:y.lower,to:y.upper},f.add(w),_.add(w)):(_.add(n),f.add(n),l.indexes.forEach((function(e){return t(e.name).add(n)}))),r.mutate(e).then((function(i){return!y||"add"!==e.type&&"put"!==e.type||(_.addKeys(i.results),h&&h.forEach((function(n){var o=e.values.map((function(e){return n.extractKey(e)})),s=n.keyPath.findIndex((function(e){return e===d.keyPath}));i.results.forEach((function(e){return o[s]=e})),t(n.name).addKeys(o)}))),p.mutatedParts=Ti(p.mutatedParts||{},m),i}))}}),_={get:function(e){return[d,new wi(e.key)]},getMany:function(e){return[d,(new wi).addKeys(e.keys)]},count:c=function(t){t=(i=t.query).index;var i=i.range;return[t,new wi(null!==(t=i.lower)&&void 0!==t?t:e.MIN_KEY,null!==(i=i.upper)&&void 0!==i?i:e.MAX_KEY)]},query:c,openCursor:c};return o(_).forEach((function(e){m[e]=function(o){var s=!!(m=ge.subscr),l=Ui(ge,r)&&Hi(e,o)?o.obsSet={}:m;if(s){var d=function(e){return e="idb://".concat(i,"/").concat(a,"/").concat(e),l[e]||(l[e]=new wi)},c=d(""),h=d(":dels"),m=(s=(m=_[e](o))[0],m[1]);if(("query"===e&&s.isPrimaryKey&&!o.values?h:d(s.name||"")).add(m),!s.isPrimaryKey){if("count"!==e){var f="query"===e&&p&&o.values&&r.query(t(t({},o),{values:!1}));return r[e].apply(this,arguments).then((function(t){if("query"===e){if(p&&o.values)return f.then((function(e){return e=e.result,c.addKeys(e),t}));var i=o.values?t.result.map(u):t.result;(o.values?c:h).addKeys(i)}else if("openCursor"===e){var n=t,s=o.values;return n&&Object.create(n,{key:{get:function(){return h.addKey(n.primaryKey),n.key}},primaryKey:{get:function(){var e=n.primaryKey;return h.addKey(e),e}},value:{get:function(){return s&&c.addKey(n.primaryKey),n.value}}})}return t}))}h.add(n)}}return r[e].apply(this,arguments)}})),m}})}};function Ki(e,i,n){if(0===n.numFailures)return i;if("deleteRange"===i.type)return null;var o=i.keys?i.keys.length:"values"in i&&i.values?i.values.length:1;return n.numFailures===o?null:(i=t({},i),s(i.keys)&&(i.keys=i.keys.filter((function(e,t){return!(t in n.failures)}))),"values"in i&&s(i.values)&&(i.values=i.values.filter((function(e,t){return!(t in n.failures)}))),i)}function $i(e,t){return i=e,(void 0===(n=t).lower||(n.lowerOpen?0<dt(i,n.lower):0<=dt(i,n.lower)))&&(void 0===t.upper||(t.upperOpen?dt(e,t.upper)<0:dt(e,t.upper)<=0));var i,n}function Ji(e,t,i,n,o,a){if(!i||0===i.length)return e;var r=t.query.index,l=r.multiEntry,d=t.query.range,c=n.schema.primaryKey.extractKey,u=r.extractKey,p=(r.lowLevelIndex||r).extractKey;return(i=i.reduce((function(e,i){var n=e,o="add"===i.type||"put"===i.type?i.values.filter((function(e){return e=u(e),l&&s(e)?e.some((function(e){return $i(e,d)})):$i(e,d)})).map((function(e){return e=A(e),a&&Object.freeze(e),e})):[];switch(i.type){case"add":n=e.concat(t.values?o:o.map((function(e){return c(e)})));break;case"put":var r=(new wi).addKeys(i.values.map((function(e){return c(e)})));n=e.filter((function(e){return e=t.values?c(e):e,!Si(new wi(e),r)})).concat(t.values?o:o.map((function(e){return c(e)})));break;case"delete":var p=(new wi).addKeys(i.keys);n=e.filter((function(e){return e=t.values?c(e):e,!Si(new wi(e),p)}));break;case"deleteRange":var h=i.range;n=e.filter((function(e){return!$i(c(e),h)}))}return n}),e))===e?e:(i.sort((function(e,t){return dt(p(e),p(t))||dt(c(e),c(t))})),t.limit&&t.limit<1/0&&(i.length>t.limit?i.length=t.limit:e.length===t.limit&&i.length<t.limit&&(o.dirty=!0)),a?Object.freeze(i):i)}function Gi(e,t){return 0===dt(e.lower,t.lower)&&0===dt(e.upper,t.upper)&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function Xi(e,t){return function(e,t,i,n){if(void 0===e)return void 0!==t?-1:0;if(void 0===t)return 1;if(0===(t=dt(e,t))){if(i&&n)return 0;if(i)return 1;if(n)return-1}return t}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=function(e,t,i,n){if(void 0===e)return void 0!==t?1:0;if(void 0===t)return-1;if(0===(t=dt(e,t))){if(i&&n)return 0;if(i)return-1;if(n)return 1}return t}(e.upper,t.upper,e.upperOpen,t.upperOpen)}function Yi(e,t,i,n){e.subscribers.add(i),n.addEventListener("abort",(function(){var n,o;e.subscribers.delete(i),0===e.subscribers.size&&(n=e,o=t,setTimeout((function(){0===n.subscribers.size&&R(o,n)}),3e3))}))}var Qi={stack:"dbcore",level:0,name:"Cache",create:function(e){var i=e.schema.name;return t(t({},e),{transaction:function(t,n,o){var s,a,r=e.transaction(t,n,o);return"readwrite"===n&&(a=(s=new AbortController).signal,o=function(o){return function(){if(s.abort(),"readwrite"===n){for(var a=new Set,l=0,d=t;l<d.length;l++){var c=d[l],u=Ai["idb://".concat(i,"/").concat(c)];if(u){var p=e.table(c),h=u.optimisticOps.filter((function(e){return e.trans===r}));if(r._explicit&&o&&r.mutatedParts)for(var m=0,_=Object.values(u.queries.query);m<_.length;m++)for(var f=0,g=(v=_[m]).slice();f<g.length;f++)Ci((b=g[f]).obsSet,r.mutatedParts)&&(R(v,b),b.subscribers.forEach((function(e){return a.add(e)})));else if(0<h.length){u.optimisticOps=u.optimisticOps.filter((function(e){return e.trans!==r}));for(var y=0,w=Object.values(u.queries.query);y<w.length;y++)for(var v,b,S,I=0,x=(v=w[y]).slice();I<x.length;I++)null!=(b=x[I]).res&&r.mutatedParts&&(o&&!b.dirty?(S=Object.isFrozen(b.res),S=Ji(b.res,b.req,h,p,b,S),b.dirty?(R(v,b),b.subscribers.forEach((function(e){return a.add(e)}))):S!==b.res&&(b.res=S,b.promise=be.resolve({result:S}))):(b.dirty&&R(v,b),b.subscribers.forEach((function(e){return a.add(e)}))))}}}a.forEach((function(e){return e()}))}}},r.addEventListener("abort",o(!1),{signal:a}),r.addEventListener("error",o(!1),{signal:a}),r.addEventListener("complete",o(!0),{signal:a})),r},table:function(n){var o=e.table(n),s=o.schema.primaryKey;return t(t({},o),{mutate:function(e){var a=ge.trans;if(s.outbound||"disabled"===a.db._options.cache||a.explicit)return o.mutate(e);var r=Ai["idb://".concat(i,"/").concat(n)];return r?(a=o.mutate(e),"add"!==e.type&&"put"!==e.type||!(50<=e.values.length||qi(s,e).some((function(e){return null==e})))?(r.optimisticOps.push(e),e.mutatedParts&&Li(e.mutatedParts),a.then((function(t){0<t.numFailures&&(R(r.optimisticOps,e),(t=Ki(0,e,t))&&r.optimisticOps.push(t),e.mutatedParts&&Li(e.mutatedParts))})),a.catch((function(){R(r.optimisticOps,e),e.mutatedParts&&Li(e.mutatedParts)}))):a.then((function(i){var n=Ki(0,t(t({},e),{values:e.values.map((function(e,n){var o;return b(e=null!==(o=s.keyPath)&&void 0!==o&&o.includes(".")?A(e):t({},e),s.keyPath,i.results[n]),e}))}),i);r.optimisticOps.push(n),queueMicrotask((function(){return e.mutatedParts&&Li(e.mutatedParts)}))})),a):o.mutate(e)},query:function(e){if(!Ui(ge,o)||!Hi("query",e))return o.query(e);var t="immutable"===(null===(r=ge.trans)||void 0===r?void 0:r.db._options.cache),s=(d=ge).requery,a=d.signal,r=function(e,t,i,n){var o=Ai["idb://".concat(e,"/").concat(t)];if(!o)return[];if(!(t=o.queries[i]))return[null,!1,o,null];var s=t[(n.query?n.query.index.name:null)||""];if(!s)return[null,!1,o,null];switch(i){case"query":var a=s.find((function(e){return e.req.limit===n.limit&&e.req.values===n.values&&Gi(e.req.query.range,n.query.range)}));return a?[a,!0,o,s]:[s.find((function(e){return("limit"in e.req?e.req.limit:1/0)>=n.limit&&(!n.values||e.req.values)&&Xi(e.req.query.range,n.query.range)})),!1,o,s];case"count":return[a=s.find((function(e){return Gi(e.req.query.range,n.query.range)})),!!a,o,s]}}(i,n,"query",e),l=r[0],d=r[1],c=r[2],u=r[3];return l&&d?l.obsSet=e.obsSet:(d=o.query(e).then((function(e){var i=e.result;if(l&&(l.res=i),t){for(var n=0,o=i.length;n<o;++n)Object.freeze(i[n]);Object.freeze(i)}else e.result=A(i);return e})).catch((function(e){return u&&l&&R(u,l),Promise.reject(e)})),l={obsSet:e.obsSet,promise:d,subscribers:new Set,type:"query",req:e,dirty:!1},u?u.push(l):(u=[l],(c=c||(Ai["idb://".concat(i,"/").concat(n)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[e.query.index.name||""]=u)),Yi(l,u,s,a),l.promise.then((function(i){return{result:Ji(i.result,e,null==c?void 0:c.optimisticOps,o,l,t)}}))}})}})}};function Zi(e,t){return new Proxy(e,{get:function(e,i,n){return"db"===i?t:Reflect.get(e,i,n)}})}var en=(tn.prototype.version=function(e){if(isNaN(e)||e<.1)throw new V.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new V.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,i=t.filter((function(t){return t._cfg.version===e}))[0];return i||(i=new this.Version(e),t.push(i),t.sort(ni),i.stores({}),this._state.autoSchema=!1,i)},tn.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||ge.letThrough||this._vip)?e():new be((function(e,i){if(t._state.openComplete)return i(new V.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void i(new V.DatabaseClosed);t.open().catch(J)}t._state.dbReadyPromise.then(e,i)})).then(e)},tn.prototype.use=function(e){var t=e.stack,i=e.create,n=e.level,o=e.name;return o&&this.unuse({stack:t,name:o}),(e=this._middlewares[t]||(this._middlewares[t]=[])).push({stack:t,create:i,level:null==n?10:n,name:o}),e.sort((function(e,t){return e.level-t.level})),this},tn.prototype.unuse=function(e){var t=e.stack,i=e.name,n=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter((function(e){return n?e.create!==n:!!i&&e.name!==i}))),this},tn.prototype.open=function(){var e=this;return Je(fe,(function(){return Bi(e)}))},tn.prototype._close=function(){var e=this._state,t=tt.indexOf(this);if(0<=t&&tt.splice(t,1),this.idbdb){try{this.idbdb.close()}catch(i){}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new be((function(t){e.dbReadyResolve=t})),e.openCanceller=new be((function(t,i){e.cancelOpen=i})))},tn.prototype.close=function(e){var t=(void 0===e?{disableAutoOpen:!0}:e).disableAutoOpen;e=this._state,t?(e.isBeingOpened&&e.cancelOpen(new V.DatabaseClosed),this._close(),e.autoOpen=!1,e.dbOpenError=new V.DatabaseClosed):(this._close(),e.autoOpen=this._options.autoOpen||e.isBeingOpened,e.openComplete=!1,e.dbOpenError=null)},tn.prototype.delete=function(e){var t=this;void 0===e&&(e={disableAutoOpen:!0});var i=0<arguments.length&&"object"!=typeof arguments[0],n=this._state;return new be((function(o,s){function a(){t.close(e);var i=t._deps.indexedDB.deleteDatabase(t.name);i.onsuccess=Re((function(){var e,i,n;e=t._deps,i=t.name,n=e.indexedDB,e=e.IDBKeyRange,fi(n)||i===it||_i(n,e).delete(i).catch(J),o()})),i.onerror=Mt(s),i.onblocked=t._fireOnBlocked}if(i)throw new V.InvalidArgument("Invalid closeOptions argument to db.delete()");n.isBeingOpened?n.dbReadyPromise.then(a):a()}))},tn.prototype.backendDB=function(){return this.idbdb},tn.prototype.isOpen=function(){return null!==this.idbdb},tn.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name},tn.prototype.hasFailed=function(){return null!==this._state.dbOpenError},tn.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(tn.prototype,"tables",{get:function(){var e=this;return o(this._allTables).map((function(t){return e._allTables[t]}))},enumerable:!1,configurable:!0}),tn.prototype.transaction=function(){var e=function(e,t,i){var n=arguments.length;if(n<2)throw new V.InvalidArgument("Too few arguments");for(var o=new Array(n-1);--n;)o[n-1]=arguments[n];return i=o.pop(),[e,x(o),i]}.apply(this,arguments);return this._transaction.apply(this,e)},tn.prototype._transaction=function(e,t,i){var n=this,o=ge.trans;o&&o.db===this&&-1===e.indexOf("!")||(o=null);var s,a,r=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{if(a=t.map((function(e){if("string"!=typeof(e=e instanceof n.Table?e.name:e))throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return e})),"r"==e||e===nt)s=nt;else{if("rw"!=e&&e!=ot)throw new V.InvalidArgument("Invalid transaction mode: "+e);s=ot}if(o){if(o.mode===nt&&s===ot){if(!r)throw new V.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");o=null}o&&a.forEach((function(e){if(o&&-1===o.storeNames.indexOf(e)){if(!r)throw new V.SubTransaction("Table "+e+" not included in parent transaction.");o=null}})),r&&o&&!o.active&&(o=null)}}catch(d){return o?o._promise(null,(function(e,t){t(d)})):Ye(d)}var l=function e(t,i,n,o,s){return be.resolve().then((function(){var a=ge.transless||ge,r=t._createTransaction(i,n,t._dbSchema,o);if(r.explicit=!0,a={trans:r,transless:a},o)r.idbtrans=o.idbtrans;else try{r.create(),r.idbtrans._explicit=!0,t._state.PR1398_maxLoop=3}catch(c){return c.name===U.InvalidState&&t.isOpen()&&0<--t._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),t.close({disableAutoOpen:!1}),t.open().then((function(){return e(t,i,n,null,s)}))):Ye(c)}var l,d=j(s);return d&&Fe(),a=be.follow((function(){var e;(l=s.call(r,r))&&(d?(e=Ue.bind(null,null),l.then(e,e)):"function"==typeof l.next&&"function"==typeof l.throw&&(l=Oi(l)))}),a),(l&&"function"==typeof l.then?be.resolve(l).then((function(e){return r.active?e:Ye(new V.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):a.then((function(){return l}))).then((function(e){return o&&r._resolve(),r._completion.then((function(){return e}))})).catch((function(e){return r._reject(e),Ye(e)}))}))}.bind(null,this,s,a,o,i);return o?o._promise(s,l,"lock"):ge.trans?Je(ge.transless,(function(){return n._whenReady(l)})):this._whenReady(l)},tn.prototype.table=function(e){if(!d(this._allTables,e))throw new V.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},tn);function tn(e,i){var n=this;this._middlewares={},this.verno=0;var o=tn.dependencies;this._options=i=t({addons:tn.addons,autoOpen:!0,indexedDB:o.indexedDB,IDBKeyRange:o.IDBKeyRange,cache:"cloned"},i),this._deps={indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},o=i.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var s,a,r,l,d,c={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:J,dbReadyPromise:null,cancelOpen:J,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:i.autoOpen};c.dbReadyPromise=new be((function(e){c.dbReadyResolve=e})),c.openCanceller=new be((function(e,t){c.cancelOpen=t})),this._state=c,this.name=e,this.on=mt(this,"populate","blocked","versionchange","close",{ready:[ie,J]}),this.on.ready.subscribe=g(this.on.ready.subscribe,(function(e){return function(t,i){tn.vip((function(){var o,s=n._state;s.openComplete?(s.dbOpenError||be.resolve().then(t),i&&e(t)):s.onReadyBeingFired?(s.onReadyBeingFired.push(t),i&&e(t)):(e(t),o=n,i||e((function e(){o.on.ready.unsubscribe(t),o.on.ready.unsubscribe(e)})))}))}})),this.Collection=(s=this,_t(kt.prototype,(function(e,t){this.db=s;var i=at,n=null;if(t)try{i=t()}catch(a){n=a}var o=e._ctx;e=(t=o.table).hook.reading.fire,this._ctx={table:t,index:o.index,isPrimKey:!o.index||t.schema.primKey.keyPath&&o.index===t.schema.primKey.name,range:i,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:n,or:o.or,valueMapper:e!==G?e:null}}))),this.Table=(a=this,_t(pt.prototype,(function(e,t,i){this.db=a,this._tx=i,this.name=e,this.schema=t,this.hook=a._allTables[e]?a._allTables[e].hook:mt(null,{creating:[Q,J],reading:[X,G],updating:[ee,J],deleting:[Z,J]})}))),this.Transaction=(r=this,_t(zt.prototype,(function(e,t,i,n,o){var s=this;this.db=r,this.mode=e,this.storeNames=t,this.schema=i,this.chromeTransactionDurability=n,this.idbtrans=null,this.on=mt(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new be((function(e,t){s._resolve=e,s._reject=t})),this._completion.then((function(){s.active=!1,s.on.complete.fire()}),(function(e){var t=s.active;return s.active=!1,s.on.error.fire(e),s.parent?s.parent._reject(e):t&&s.idbtrans&&s.idbtrans.abort(),Ye(e)}))}))),this.Version=(l=this,_t(hi.prototype,(function(e){this.db=l,this._cfg={version:e,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))),this.WhereClause=(d=this,_t(Ot.prototype,(function(e,t,i){if(this.db=d,this._ctx={table:e,index:":id"===t?null:t,or:i},this._cmp=this._ascending=dt,this._descending=function(e,t){return dt(t,e)},this._max=function(e,t){return 0<dt(e,t)?e:t},this._min=function(e,t){return dt(e,t)<0?e:t},this._IDBKeyRange=d._deps.IDBKeyRange,!this._IDBKeyRange)throw new V.MissingAPI}))),this.on("versionchange",(function(e){0<e.newVersion?console.warn("Another connection wants to upgrade database '".concat(n.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(n.name,"'. Closing db now to resume the delete request.")),n.close({disableAutoOpen:!1})})),this.on("blocked",(function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('".concat(n.name,"') was blocked")):console.warn("Upgrade '".concat(n.name,"' blocked by other connection holding version ").concat(e.oldVersion/10))})),this._maxKey=$t(i.IDBKeyRange),this._createTransaction=function(e,t,i,o){return new n.Transaction(e,t,i,n._options.chromeTransactionDurability,o)},this._fireOnBlocked=function(e){n.on("blocked").fire(e),tt.filter((function(e){return e.name===n.name&&e!==n&&!e._state.vcFired})).map((function(t){return t.on("versionchange").fire(e)}))},this.use(zi),this.use(Qi),this.use(Vi),this.use(Mi),this.use(Wi);var u=new Proxy(this,{get:function(e,t,i){if("_vip"===t)return!0;if("table"===t)return function(e){return Zi(n.table(e),u)};var o=Reflect.get(e,t,i);return o instanceof pt?Zi(o,u):"tables"===t?o.map((function(e){return Zi(e,u)})):"_createTransaction"===t?function(){return Zi(o.apply(this,arguments),u)}:o}});this.vip=u,o.forEach((function(e){return e(n)}))}M="undefined"!=typeof Symbol&&"observable"in Symbol?Symbol.observable:"@@observable";var nn,on=(sn.prototype.subscribe=function(e,t,i){return this._subscribe(e&&"function"!=typeof e?e:{next:e,error:t,complete:i})},sn.prototype[M]=function(){return this},sn);function sn(e){this._subscribe=e}try{nn={indexedDB:n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB,IDBKeyRange:n.IDBKeyRange||n.webkitIDBKeyRange}}catch(pn){nn={indexedDB:null,IDBKeyRange:null}}function an(e){var t,i=!1,n=new on((function(n){var o,s=j(e),a=!1,r={},l={},c={get closed(){return a},unsubscribe:function(){a||(a=!0,o&&o.abort(),u&&Ft.storagemutated.unsubscribe(h))}};n.start&&n.start(c);var u=!1,p=function(){return Xe(m)},h=function(e){Ti(r,e),Ci(l,r)&&p()},m=function(){var c,m,_;!a&&nn.indexedDB&&(r={},c={},o&&o.abort(),o=new AbortController,_=function(t){var i=Ee();try{s&&Fe();var n=We(e,t);return n=s?n.finally(Ue):n}finally{i&&Pe()}}(m={subscr:c,signal:o.signal,requery:p,querier:e,trans:null}),Promise.resolve(_).then((function(e){i=!0,t=e,a||m.signal.aborted||(r={},function(e){for(var t in e)if(d(e,t))return;return 1}(l=c)||u||(Ft(qt,h),u=!0),Xe((function(){return!a&&n.next&&n.next(e)})))}),(function(e){i=!1,["DatabaseClosedError","AbortError"].includes(null==e?void 0:e.name)||a||Xe((function(){a||n.error&&n.error(e)}))})))};return setTimeout(p,0),c}));return n.hasValue=function(){return i},n.getValue=function(){return t},n}var rn=en;function ln(e){var t=cn;try{cn=!0,Ft.storagemutated.fire(e),Di(e,!0)}finally{cn=t}}c(rn,t(t({},$),{delete:function(e){return new rn(e,{addons:[]}).delete()},exists:function(e){return new rn(e,{addons:[]}).open().then((function(e){return e.close(),!0})).catch("NoSuchDatabaseError",(function(){return!1}))},getDatabaseNames:function(e){try{return i=(t=rn.dependencies).indexedDB,t=t.IDBKeyRange,(fi(i)?Promise.resolve(i.databases()).then((function(e){return e.map((function(e){return e.name})).filter((function(e){return e!==it}))})):_i(i,t).toCollection().primaryKeys()).then(e)}catch(n){return Ye(new V.MissingAPI)}var t,i},defineClass:function(){return function(e){a(this,e)}},ignoreTransaction:function(e){return ge.trans?Je(ge.transless,e):e()},vip:gi,async:function(e){return function(){try{var t=Oi(e.apply(this,arguments));return t&&"function"==typeof t.then?t:be.resolve(t)}catch(i){return Ye(i)}}},spawn:function(e,t,i){try{var n=Oi(e.apply(i,t||[]));return n&&"function"==typeof n.then?n:be.resolve(n)}catch(o){return Ye(o)}},currentTransaction:{get:function(){return ge.trans||null}},waitFor:function(e,t){return t=be.resolve("function"==typeof e?rn.ignoreTransaction(e):e).timeout(t||6e4),ge.trans?ge.trans.waitFor(t):t},Promise:be,debug:{get:function(){return ne},set:function(e){oe(e)}},derive:h,extend:a,props:c,override:g,Events:mt,on:Ft,liveQuery:an,extendObservabilitySet:Ti,getByKeyPath:v,setByKeyPath:b,delByKeyPath:function(e,t){"string"==typeof t?b(e,t,void 0):"length"in t&&[].map.call(t,(function(t){b(e,t,void 0)}))},shallowClone:S,deepClone:A,getObjectDiff:Ni,cmp:dt,asap:w,minKey:-1/0,addons:[],connections:tt,errnames:U,dependencies:nn,cache:Ai,semVer:"4.0.4",version:"4.0.4".split(".").map((function(e){return parseInt(e)})).reduce((function(e,t,i){return e+t/Math.pow(10,2*i)}))})),rn.maxKey=$t(rn.dependencies.IDBKeyRange),"undefined"!=typeof dispatchEvent&&"undefined"!=typeof addEventListener&&(Ft(qt,(function(e){cn||(e=new CustomEvent(Wt,{detail:e}),cn=!0,dispatchEvent(e),cn=!1)})),addEventListener(Wt,(function(e){e=e.detail,cn||ln(e)})));var dn,cn=!1,un=function(){};return"undefined"!=typeof BroadcastChannel&&((un=function(){(dn=new BroadcastChannel(Wt)).onmessage=function(e){return e.data&&ln(e.data)}})(),"function"==typeof dn.unref&&dn.unref(),Ft(qt,(function(e){cn||dn.postMessage(e)}))),"undefined"!=typeof addEventListener&&(addEventListener("pagehide",(function(e){if(!en.disableBfCache&&e.persisted){ne&&console.debug("Dexie: handling persisted pagehide"),null!=dn&&dn.close();for(var t=0,i=tt;t<i.length;t++)i[t].close({disableAutoOpen:!1})}})),addEventListener("pageshow",(function(e){!en.disableBfCache&&e.persisted&&(ne&&console.debug("Dexie: handling persisted pageshow"),un(),ln({all:new wi(-1/0,[[]])}))}))),be.rejectionMapper=function(e,t){return!e||e instanceof q||e instanceof TypeError||e instanceof SyntaxError||!e.name||!K[e.name]?e:(t=new K[e.name](t||e.message,e),"stack"in e&&p(t,"stack",{get:function(){return this.inner.stack}}),t)},oe(ne),t(en,Object.freeze({__proto__:null,Dexie:en,liveQuery:an,Entity:lt,cmp:dt,PropModSymbol:k,PropModification:It,replacePrefix:function(e,t){return new It({replacePrefix:[e,t]})},default:en,RangeSet:wi,mergeRanges:bi,rangesOverlap:Si}),{default:en}),en}();const ts=Ue(es.exports),is=Symbol.for("Dexie"),ns=globalThis[is]||(globalThis[is]=ts);if(ts.semVer!==ns.semVer)throw new Error("Two different versions of Dexie loaded in the same app: ".concat(ts.semVer," and ").concat(ns.semVer));let os,ss=!1;try{os=new ns("relatedArticle"),os.version(1).stores({articles:"triplekey, relatedlist, timestamp, showRecReason"})}catch(Nu){ls("initRelatedArticleDB",Nu)}async function as(){await async function(e=rs){try{return window.navigator&&window.navigator.storage&&window.navigator.storage.estimate?window.navigator.storage.estimate().then((({quota:t,usage:i})=>i>=t||i>=e)):!!(window.navigator&&window.navigator.webkitTemporaryStorage&&window.navigator.webkitTemporaryStorage.queryUsageAndQuota)&&new Promise((t=>{window.navigator.webkitTemporaryStorage.queryUsageAndQuota(((i,n)=>{t(i>n||i>=e)}))}))}catch(Nu){return ls("getIfCurrentUsageExceed",Nu),!1}}()&&await async function(){if(!ss)try{os.transaction("rw",os.articles,(async()=>{ss=!0;const e=await os.articles.count(),t=Math.floor(e/2),i=await os.articles.orderBy("timestamp").limit(t),n=await i.delete();console.log("clean oldArticles count",n)}))}catch(Nu){ls("cleanRelatedArticleList",Nu)}finally{ss=!1}}()}const rs=1e8;function ls(e,t){try{let i="indexDBError-".concat(e,"-");t&&t.message?i+=t.message:t&&(i+=JSON.stringify(t)),ge.setLogs({id:110809,key:84,value:1,log:encodeURIComponent(i)}),window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.report("related article err","biz=".concat(window.biz," mid=").concat(window.mid," idx=").concat(window.idx),{mid:"mmbizwap:related_article_db_err",view:"wap_business",_info:{error:t,errorMsg:i}}),console.log(t)}catch(i){console.log(i)}}const ds=We.getInnerHeight(),cs=100*Math.random()<1,us=[window.biz,window.mid,window.idx].join("_"),ps=ve.os.ipad||!Ae.isIOS&&!Ae.isAndroid;let hs=0;Ae.isIOS?hs=1:Ae.isAndroid&&(hs=2);const ms=[{name:"内容低质",value:1},{name:"不看此公众号内容",value:2}],_s=(()=>{let e=!1;const t=[],i=n=>{e=!0,ye({url:"/mp/relatedarticle?action=expose",type:"POST",dataType:"json",data:n,complete(){t.length?i(t.shift()):e=!1}})};return n=>{e?t.push(n):i(n)}})(),fs=window.matchMedia("(prefers-color-scheme: dark)"),gs=(e="")=>{if(!e)return"";const t=parseInt("0x".concat(e.slice(1,3)),16),i=parseInt("0x".concat(e.slice(3,5)),16),n=parseInt("0x".concat(e.slice(5,7)),16),o=parseInt("0x".concat(e.slice(7,9)),16);return"rgba(".concat(i,", ").concat(n,", ").concat(o,", ").concat(t/255,")")},ys={name:"mp-related-article",filters:{getRecTagStyle:(e,t)=>e?{color:gs(t?e.dark_mode_text_color:e.text_color)}:{},dateToString(e){const t=(new Date).getTime()/1e3-e,i=(new Date).getFullYear(),n=new Date(1e3*e);return t<60?"".concat(Math.floor(t),"秒前"):t<3600?"".concat(Math.floor(t/60),"分钟前"):t<86400?"".concat(Math.floor(t/60/60),"小时前"):t<172800?"昨天":t<604800?"".concat(Math.floor(t/24/60/60),"天前"):n.getFullYear()===i?"".concat(n.getMonth()+1,"月").concat(n.getDate(),"日"):"".concat(n.getFullYear(),"年").concat(n.getMonth()+1,"月").concat(n.getDate(),"日")}},components:{Intersect:C},data(){const{cgiData:e}=this.$store.state;return{list:[],reason:[],reportInfo:"",showRecReason:!1,showList:!Ae.isMpapp&&1*e.item_show_type==0&&""!==e.item_show_type,unbindTransition:!1,listStyle:{overflow:"hidden",opacity:1,height:0,margin:0},feedbackIdx:-1,feedbackPos:"bottom",feedbackReasonTacitly:{},feedbackReasonKeyword:{},darkModeMatches:fs.matches,relatedArticleListInfo:null,isCreatePlaceholder:!1,hasDataInDB:0}},computed:{...h(["extRes"]),...h("mp-related-article",["notLoad","sources"]),...g("mp-like-and-share",["hasExtAppmsgStat"]),commonReportData(){const{cgiData:e}=this.$store.state;let t=parseInt(window.enterid,10)||0;return!Ae.isWp&&-1===navigator.userAgent.indexOf("MicroMessenger")&&document.body.offsetWidth>=1024&&(t=1024,ge.setSum(223326,18,1)),{Bizuin_from:e.biz,Msgid_from:parseInt(e.mid,10)||0,Itemidx_from:parseInt(e.idx,10)||0,Scene:parseInt(e.source,10)||0,Subscene:parseInt(e.subscene,10)||parseInt(e.source,10)||0,Sessionid:e.sessionid||"",Enterid:t,ItemShowType:parseInt(e.item_show_type,10)||0}},type(){return this.sources[0]},isPageInit(){return this.sources[1]},isFromPay(){return"pay"===this.type?1:0},loadType(){switch(this.type){case"default":default:return 0;case"favorite":return 1;case"share":return 2;case"praise":return 3;case"like":return 4;case"pay":return 5;case"reward":return 6;case"favorited":return 7;case"shared":return 8;case"praised":return 9;case"liked":return 10;case"paid":return 11;case"rewarded":return 12;case"recommend":return 13;case"force":return 14;case"subscribe":return 15}},hasFeedbackReason(){return!!(Object.keys(this.feedbackReasonTacitly).length+Object.keys(this.feedbackReasonKeyword).length)},isKuaiXun(){return this.relatedArticleListInfo&&(1===this.relatedArticleListInfo.style||2===this.relatedArticleListInfo.style)},hasExtLoadDone(){var e,t;return 0===(null==(t=null==(e=this.extRes)?void 0:e.base_resp)?void 0:t.ret)},canShowList(){return!!this.showList&&(this.hasExtLoadDone?!this.notLoad&&this.type:!(!this.list||!this.list.length))}},watch:{sources(){this.$nextTick(this.loadData)}},created(){this.hasReported29433=!1,this.exposeHeight=0,this.loadDataFromDB()},mounted(){if(this.itemHeight=parseFloat(window.getComputedStyle(this.$el).getPropertyValue("--RELATE-ITEM-HEIGHT")),this.itemHeightPx=0,cs&&window.WX_BJ_REPORT){const{cgiData:e}=this.$store.state;window.WX_BJ_REPORT.BadJs.report("relatedArticleFlag","value:".concat(e.relatedArticleFlag),{mid:"mmbizwap:related_monitor",uin:e.user_uin})}fs.addListener((({matches:e})=>{this.darkModeMatches=!!e})),Ne.on(window,"scroll",this.loadData),Ne.on(window,"scroll",this.exposeHandler)},beforeDestroy(){this.destroy()},methods:{preloadMoreKuaixun(){console.log("??????preload"),Ee.invoke("onWebPageUrlExposed",{bizType:0,urlList:[{url:this.relatedArticleListInfo.more_url,extInfo:{itemshowType:0,preloadType:0}}]})},async loadData(){if(!this.hasExtLoadDone||!this.canShowList||[0,1].includes(this.hasDataInDB)||this.__lock)return;const e=this.extRes.distance_to_get_related_article_data||-1;e>=0&&We.getElementActualTop(this.$refs.jsRelatedArea)-We.getScrollTop()-ds>ds*e||(this.__lock=!0,this.$nextTick((()=>{if(144===this.commonReportData.Scene)return;const{cgiData:e}=this.$store.state;this.isPageInit&&(this.listStyle.transition="none");this.list&&this.list.length||(ge.setSum(110809,81,1),ge.setSum(110809,83,1),ye({url:"/mp/relatedarticle?action=precheck&article_url=".concat(window.encodeURIComponent(location.href),"&__biz=").concat(e.biz,"&mid=").concat(e.mid,"&idx=").concat(e.idx,"&has_related_article_info=").concat(e.hasRelatedArticleInfo,"&is_pay=").concat(this.isFromPay,"&is_from_recommand=").concat(Qo?1:0,"&scene=").concat(this.commonReportData.Scene,"&subscene=").concat(parseInt(e.subscene,10)||0,"&is_open_comment=").concat(this.extRes.comment_enabled).concat("subscribe"===this.type?"&is_from_subscribe=1":""),type:"GET",dataType:"json",success:t=>{t&&t.base_resp&&1*t.base_resp.ret==0&&1*t.empty_scene==0&&(this.__placeholderTimer=setTimeout((()=>{this.isCreatePlaceholder=!0,ge.setSum(314064,25,1),this.showCard(3)}),500),ye({url:"/mp/relatedarticle?action=directgetlist&article_url=".concat(window.encodeURIComponent(location.href),"&__biz=").concat(e.biz,"&mid=").concat(e.mid,"&idx=").concat(e.idx,"&has_related_article_info=").concat(e.hasRelatedArticleInfo,"&is_pay=").concat(this.isFromPay,"&is_from_recommand=").concat(Qo?1:0,"&scene=").concat(this.commonReportData.Scene,"&subscene=").concat(parseInt(e.subscene,10)||0,"&is_open_comment=").concat(this.extRes.comment_enabled).concat("subscribe"===this.type?"&is_from_subscribe=1":""),type:"GET",dataType:"json",success:t=>{if(cs&&t&&1*t.empty_scene!=0&&this.isCreatePlaceholder&&window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs.report("empty_scene","empty_scene:".concat(t.empty_scene),{mid:"mmbizwap:related_monitor",uin:e.user_uin}),t&&t.base_resp&&1*t.base_resp.ret==0&&t.list&&t.list.length){const i=t.list.map((e=>(e.url=e.url.replace(/#wechat_redirect$/,"&show_related_article=1&subscene=".concat(this.commonReportData[132===this.commonReportData.Scene?"Subscene":"Scene"],"$&")),e.like_num_wording=e.old_like_num?Pe.formatReadNum(e.old_like_num):"",e.read_num_wording=e.read_num?Pe.formatReadNum(e.read_num):"",e.pay_cnt_wording=e.pay_cnt?Pe.formatReadNum(e.pay_cnt):"",e)));cs&&window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs.report("list.length","list.length:".concat(i.length),{mid:"mmbizwap:related_monitor",_info:{relatedArticleFlag:e.relatedArticleFlag,isPc:ps},uin:e.user_uin}),this.list=i,this.$emit("list-data-change",this.list),this.list.forEach((({url:e,ext_info:i})=>{we.report(29139,Object.assign({Bizuin:be.getQuery("__biz",e),Msgid:parseInt(be.getQuery("mid",e),10)||0,Itemidx:parseInt(be.getQuery("idx",e),10)||0,ExtInfo:i,RecInfo:t.report_info},this.commonReportData))})),this.reason=ms,this.reportInfo=t.report_info||"",this.showRecReason=1===t.show_rec_reason;const n={list:i,showRecReason:1===t.show_rec_reason,style:t.style,more_url:t.more_url};!async function(e,t){await as();try{const i=await os.articles.add({triplekey:e,relatedlist:t.list,timestamp:Date.now(),showRecReason:t.showRecReason,style:t.style,more_url:t.more_url});i&&(console.log("add success",i),await as())}catch(Nu){ls("addRelatedArticleListToDB",Nu)}}(us,n),this.relatedArticleListInfo=n,this.showRelatedArticles(t.list.length)}else this.clearPlaceholderTimeout((e=>{!e&&this.setLines(0),this.destroy()}))}}))},error:e=>{console.error(e),this.clearPlaceholderTimeout((e=>{!e&&this.setLines(0),this.destroy()}))}}))})))},async loadDataFromDB(){const e=await async function(e){try{const t=await os.articles.get({triplekey:e});return os.articles.update(e,{timestamp:Date.now()}),console.log("getRelatedArticleList",t),t?{list:t.relatedlist,showRecReason:t.showRecReason,style:t.style,more_url:t.more_url}:void 0}catch(Nu){ls("getRelatedArticleListFromDB",Nu)}}(us);e&&e.list&&e.list.length?(ge.setSum(110809,81,1),ge.setSum(110809,82,1),this.list=e.list,this.showRecReason=e.showRecReason,this.relatedArticleListInfo=e,this.reason=ms,this.hasDataInDB=1,this.getRecReason(),this.showRelatedArticles(this.list.length),this.$emit("list-data-change",this.list)):this.hasDataInDB=2},showRelatedArticles(e){this.clearPlaceholderTimeout((t=>{t?this.showCard(e):this.setLines(e),this.listStyle.opacity=1,this.listStyle.overflow="visible",this.$nextTick((()=>{this.exposeHandler(),window.ipados13_font_scale&&B(this.$refs.jsRelatedArea,window.ipados13_font_scale/100),!this.isPageInit&&Me.setCompRenderInfo({compEle:this.$refs.jsRelatedArea,compType:"mp-related-article",compIdx:1,wrapper:document.querySelector("#page_bottom_area")},this.$refs.jsRelatedArea.offsetHeight+parseInt(getComputedStyle(this.$refs.jsRelatedArea).marginTop,10))}))}))},showCard(e){this.setLines(e),delete this.__placeholderTimer},setLines(e){const t=this.$refs.jsRelatedTitle,i=-1===document.body.className.indexOf("pages_skin_pc")?40:60,n=t?t.getBoundingClientRect().height:i,o=this.$refs.moreNews,s=o?o.offsetHeight:0;let a=0;if(0===e){if(this.isCreatePlaceholder){const e=this.$refs.jsRelatedArea,t=e&&this.isPercentInViewport(e);if(t){let e=0;switch(!0){case t>=1:e=31;break;case t>=.8:e=30;break;case t>=.6:e=29;break;case t>=.4:e=28;break;case t>=.2:e=27;break;default:e=26}ge.setSum(314064,e,1),ge.setSum(314064,32,1)}}this.listStyle.overflow="hidden",this.listStyle.margin="0",this.unbindTransition=!0}else window.is_like_profile_gray,this.listStyle.margin="8px 0 0",a="calc(".concat(e*this.itemHeight,"em + ").concat(n,"px + ").concat(s,"px)");const r={compEle:this.$refs.jsRelatedArea,compType:"mp-related-article",compIdx:1,wrapper:document.querySelector("#page_bottom_area")};this.setLinesTimes=this.setLinesTimes?this.setLinesTimes+1:1,1!==this.setLinesTimes&&(r.subCompType="setLine-".concat(this.setLinesTimes)),this.isPageInit&&Me.renderCompSilentlyPreHandler(r),this.listStyle.height=a,this.isPageInit&&this.$nextTick((()=>{Me.renderCompSilently(r)})),this.isPageInit&&e&&this.transitionEndHandler({propertyName:"height"})},getHeight(e){return this.itemHeightPx||(this.$refs.relatedPlaceholder?this.itemHeightPx=this.$refs.relatedPlaceholder.getBoundingClientRect().height:this.itemHeightPx=Pe.qs(".js_related_item",this.$refs.jsRelatedList).getBoundingClientRect().height),e*this.itemHeightPx+Pe.qs(".js_related_title",this.$refs.jsRelatedMain).getBoundingClientRect().height},clearPlaceholderTimeout(e){this.__placeholderTimer?(clearTimeout(this.__placeholderTimer),delete this.__placeholderTimer,"function"==typeof e&&e(!0)):"function"==typeof e&&e(!1)},jumpArticle(e){const t=e.currentTarget,{dataset:i}=t,{url:n}=i;ge.setSum(110809,23,1),we.report(18832,Object.assign({LoadType:this.loadType,Actiontype:2,Type:1,Bizuin:be.getQuery("__biz",n),Msgid:parseInt(be.getQuery("mid",n),10)||0,Itemidx:parseInt(be.getQuery("idx",n),10)||0,Sendtimestamp:parseInt(i.time,10)||0,Pos:(1*i.index||0)+1,Recalltype:1*i.recalltype,Isreaded:1*i.isreaded,Mmversion:hs,ExpType:i.exptype,ExtInfo:i.ext_info,RecInfo:i.report_info},this.commonReportData)),Ae.isOnlyWechat&&!Ae.isMpapp?Ee.invoke("openWebViewUseFastLoad",{url:n,item_show_type:i.item_show_type,scene:132,subscene:this.commonReportData[132===this.commonReportData.Scene?"Subscene":"Scene"],openType:0},(e=>{console.log("openWebViewUseFastLoad res: ",e),e&&e.err_msg&&-1===e.err_msg.indexOf("ok")&&Ge(n.replace(/#wechat_redirect$/,"&scene=132$&"))})):location.href=n.replace(/#wechat_redirect$/,"&scene=132$&")},goKuaixunFeed(){Ee.invoke("openUrlWithExtraWebview",{url:this.relatedArticleListInfo.more_url,openType:1})},exposeHandler(){const{jsRelatedArticleItem:e}=this.$refs;if(!e)return;const{top:t,bottom:i}=this.$refs.jsRelatedArea.getBoundingClientRect();if(!(t>ds||i<0)){let n=0;n=t<0?i:i>ds?ds-t:i-t,this.exposeHeight=Math.max(this.exposeHeight,n);const o=[];for(let t=0;t<e.length;t++){const i=e[t];if(1*i.dataset.hasreport!=1){const e=i.clientHeight/2,n=i.getBoundingClientRect().bottom;n>=e&&n<=e+ds&&((e,t)=>{const{dataset:i}=e,{url:n}=i;i.hasreport=1,ge.setSum(110809,21,1);const s={LoadType:this.loadType,Actiontype:1,Type:1,Bizuin:be.getQuery("__biz",n),Msgid:parseInt(be.getQuery("mid",n),10)||0,Itemidx:parseInt(be.getQuery("idx",n),10)||0,Sendtimestamp:parseInt(i.time,10)||0,Pos:t+1,Recalltype:1*i.recalltype,Mmversion:hs,Isreaded:1*i.isreaded,ExpType:i.exptype,ExtInfo:i.ext_info,RecInfo:i.report_info};we.report(18832,Object.assign(s,this.commonReportData)),_s({bizuin:i.bizuin,mid:i.mid,idx:i.idx}),o.push({item_show_type:i.item_show_type,url:n})})(i,t)}}o.length&&Ee.invoke("downloadPageDataForFastLoad",{itemList:o},(e=>{console.log("downloadPageDataForFastLoad",e)})),this.report29433()}},transitionEndHandler(e){this.unbindTransition||"height"!==e.propertyName||(this.unbindTransition=!0)},destroy(){this.showList=!1,Ne.off(window,"scroll",this.loadData),Ne.off(window,"scroll",this.exposeHandler)},showFeedback(e){const{jsRelatedArticleItem:t}=this.$refs,i=t[e];this.feedbackIdx=e,this.feedbackPos=ds-i.getBoundingClientRect().bottom<268?"top":"bottom",this.$nextTick((()=>{this.$refs.feedbackBd[e].focus()})),n.show({alpha:.3,onClick:()=>{this.hideFeedback()}})},hideFeedback(){this.feedbackIdx=-1,this.feedbackPos="bottom",this.feedbackReasonTacitly={},this.feedbackReasonKeyword={},n.hide()},submitFeedback(e){if(this.hasFeedbackReason){const t={tacitly:Object.keys(this.feedbackReasonTacitly).map((e=>1*e)),keyword:Object.keys(this.feedbackReasonKeyword)},{cgiData:i}=this.$store.state,n={biz_from:i.biz,mid_from:i.mid,idx_from:i.idx,recommended_biz:be.getQuery("__biz",e.url),mid:be.getQuery("mid",e.url),idx:be.getQuery("idx",e.url),reason:JSON.stringify(t)};ye({type:"POST",url:"/mp/relatedarticle?action=dislike",dataType:"json",data:n,success:t=>{if(console.log(t),t&&t.base_resp&&0===t.base_resp.ret){this.hideFeedback();const t=this.list.indexOf(e);t>-1&&(this.list.splice(t,1),this.setLines(this.list.length),async function(e,t){try{os.transaction("rw",os.articles,(async()=>{await os.articles.get(e);const i=await os.articles.update(e,{relatedlist:t.list});console.log("updatedResult",i)}))}catch(Nu){ls("updateRelatedArticleList",Nu)}}(us,{list:this.list}))}else window.weui.alert("系统错误，请稍后再试")}})}},chooseFeedbackReason(e){const t=e.currentTarget,i=Ce.hasClass(t,"js_reason")?this.feedbackReasonTacitly:this.feedbackReasonKeyword,{value:n}=t.dataset;i[n]?this.$delete(i,n):this.$set(i,n,1)},report29433(){if(this.hasReported29433)return;this.hasReported29433=!0;const{cgiData:e}=this.$store.state,t={bizuin_from1:e.biz,msgid_from1:parseInt(e.mid,10)||0,Itemidx_from:parseInt(e.idx,10)||0,ItemShowType:parseInt(e.item_show_type,10)||0};we.report(29433,Object.assign({Type:0},t)),we.leaveReport(29433,(()=>Object.assign({Type:1,Pos_Height:Math.round(this.exposeHeight),Is_article_exposed:Array.prototype.some.call(this.$refs.jsRelatedArticleItem,(e=>1*e.dataset.hasreport==1))?1:0},t)))},getRecReason(){if(!this.list||!this.list.length)return;const e=[],t=[];this.list.forEach((i=>{const n={};n.bizuin=i.bizuin,n.mid=i.mid,n.idx=i.idx,e.push(n),t.push([i.bizuin,i.mid,i.idx].join("_"))}));const i=encodeURIComponent(JSON.stringify({appmsg_list:e}));ye({type:"GET",url:"/mp/getrecreason?appmsg_list=".concat(i),dataType:"json",success:e=>{if(e&&e.base_resp&&0===e.base_resp.ret){const i=e.appmsg_list;i&&i.length&&i.forEach((e=>{const i=[e.bizuin,e.mid,e.idx].join("_"),n=t.indexOf(i);if(n>=0&&this.list[n]){const{rec_reason:t}=e;t&&t.wording&&(this.list[n].rec_reason=t)}}))}}})},isPercentInViewport(e){const t=$e.getId("js_article_bottom_bar"),i=t?t.offsetHeight:0,n=e.getBoundingClientRect(),o=Math.min(n.bottom,O.height-i)-Math.max(n.top,0);return o<=0?0:o/n.height}}};const ws=xt(ys,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"related_container"},[e.canShowList?t("div",{ref:"jsRelatedArea",staticClass:"relate_mod_transition function_mod js_related_area",style:e.listStyle,on:{transitionend:e.transitionEndHandler}},[t("div",{ref:"jsRelatedMain",staticClass:"function_mod_index js_related_main"},[e.isKuaiXun?t("div",{ref:"jsRelatedTitle",staticClass:"function_hd js_related_title",staticStyle:{display:"flex","justify-content":"space-between"}},[e._v(" 相关快讯 "),1===e.relatedArticleListInfo.style?t("Intersect",{attrs:{threshold:[1]},on:{"~enter":function(t){return e.preloadMoreKuaixun.apply(null,arguments)}}},[t("span",{staticStyle:{color:"#576b95","font-weight":"500"},on:{click:e.goKuaixunFeed}},[e._v("更多")])]):e._e()],1):"share"===e.type||"shared"===e.type?t("div",{ref:"jsRelatedTitle",staticClass:"function_hd js_related_title"},[e._v(" 分享此内容的人还喜欢 ")]):"favorite"===e.type||"favorited"===e.type?t("div",{ref:"jsRelatedTitle",staticClass:"function_hd js_related_title"},[e._v(" 收藏此内容的人还喜欢 ")]):"subscribe"===e.type?t("div",{ref:"jsRelatedTitle",staticClass:"function_hd js_related_title"},[e._v(" 关注此账号的人还喜欢 ")]):e.list.length?t("div",{ref:"jsRelatedTitle",staticClass:"function_hd js_related_title"},[e._v(" 喜欢此内容的人还喜欢 ")]):e._e(),t("div",{staticClass:"function_bd"},[e.list.length?t("div",{ref:"jsRelatedList",staticClass:"relate_article_index_list relate_article_list js_related_list",staticStyle:{height:"auto"}},[e._l(e.list,(function(i,n){return t("div",{key:n,ref:"jsRelatedArticleItem",refInFor:!0,staticClass:"weui-media-box weui-media-box_appmsg js_related_item js_wx_tap_highlight wx_tap_cell",attrs:{"data-index":n,"data-url":i.url,"data-time":i.send_time,"data-recalltype":i.recall_type,"data-isreaded":i.is_readed,"data-bizuin":i.bizuin,"data-mid":i.mid,"data-idx":i.idx,"data-item_show_type":i.item_show_type,"data-exptype":i.exptype,"data-ext_info":i.ext_info,"data-report_info":e.reportInfo},on:{click:e.jumpArticle}},[t("div",{staticClass:"weui-media-box__bd"},[t("div",{class:["ellipsis_relate_title mask_ellipsis_wrp mask_ellipsis_auto_height",i.is_pay_subscribe?i.is_paid?"relate_article_paid":"relate_article_pay":"relate_article_default",e.showRecReason?"relate_article_tag_before":""],attrs:{role:"link",tabindex:"0","aria-labelledby":"relate_article_title_"+i.mid+"_"+i.idx+" js_a11y_comma relate_article_tag_"+i.mid+" js_a11y_comma0 relate_article_nickname_"+i.mid+"_"+i.idx+" js_a11y_comma1 relate_article_num_"+i.mid+"_"+i.idx}},[t("div",{staticClass:"mask_ellipsis_text",attrs:{"aria-hidden":"true"}},[e._v(" "+e._s(i.title)+" "),i.is_pay_subscribe&&i.is_paid?t("span",{staticClass:"pay__tag"},[e._v(" 已付费 ")]):i.is_pay_subscribe?t("span",{staticClass:"unpay__tag"},[e._v(" 付费 ")]):e._e()]),t("div",{staticClass:"mask_ellipsis",attrs:{"aria-hidden":"true"}},[t("div",{staticClass:"mask_ellipsis_text",attrs:{id:"relate_article_title_"+i.mid+"_"+i.idx}},[e._v(" "+e._s(i.title)+" "),i.is_pay_subscribe&&i.is_paid?t("span",{staticClass:"pay__tag"},[e._v(" 已付费 ")]):i.is_pay_subscribe?t("span",{staticClass:"unpay__tag"},[e._v(" 付费 ")]):e._e()]),t("div",{staticClass:"mask_ellipsis_placeholder"}),t("div",{staticClass:"mask_ellipsis_extra"},[i.is_pay_subscribe&&i.is_paid?t("span",{staticClass:"pay__tag"},[e._v(" 已付费 ")]):i.is_pay_subscribe?t("span",{staticClass:"unpay__tag"},[e._v(" 付费 ")]):e._e()])])]),t("div",{staticClass:"weui-media-box__info weui-flex"},[t("div",{staticClass:"weui-media-box__info__inner weui-flex weui-flex_align-center weui-flex__item"},[e.showRecReason&&i.rec_reason&&i.rec_reason.wording?t("div",{staticClass:"weui-media-box__info__meta relate_profile_tag",attrs:{"aria-hidden":"true",id:"relate_article_tag_"+i.mid+"_"+i.idx}},[t("span",{staticClass:"icon_appmsg_tag",style:e._f("getRecTagStyle")(i.rec_reason,e.darkModeMatches)},[e._v(" "+e._s(i.rec_reason.wording)+" ")])]):e._e(),t("div",{staticClass:"js_profile relate_profile_nickname weui-media-box__info__meta",attrs:{"aria-hidden":"true",id:"relate_article_nickname_"+i.mid+"_"+i.idx,"data-username":i.username}},[e._v(" "+e._s(i.nickname)+" ")]),e.isKuaiXun?t("div",{staticClass:"js_profile relate_profile_nickname weui-media-box__info__meta",attrs:{"aria-hidden":"true",id:"relate_article_nickname_"+i.mid+"_"+i.idx}},[e._v(" "+e._s(e._f("dateToString")(i.send_time))+" ")]):e._e(),e.showRecReason?e._e():t("div",{staticClass:"weui-media-box__info__meta",attrs:{"aria-hidden":"true",id:"relate_article_num_"+i.mid+"_"+i.idx}},[i.old_like_num>=10?[e._v("赞 "+e._s(i.like_num_wording))]:i.is_pay_subscribe&&i.pay_cnt?[e._v(" 付费 "+e._s(i.pay_cnt_wording)+" ")]:i.read_num?[e._v("阅读 "+e._s(i.read_num_wording))]:e._e()],2)]),t("div",{staticClass:"relate_article_opr"},[t("button",{ref:"feedbackBtn",refInFor:!0,staticClass:"reset_btn dislike_btn js_feedback_btn weui-wa-hotarea",attrs:{type:"button"},on:{touchstart:function(e){e.stopPropagation()},touchend:function(e){e.stopPropagation()},mousedown:function(e){e.stopPropagation()},click:function(t){return t.stopPropagation(),e.showFeedback(n)}}},[e._v(" 不喜欢 ")])]),t("div",{ref:"feedbackBd",refInFor:!0,class:["feedback_dialog_wrp js_feedback_dialog",e.feedbackIdx===n?"feedback_dialog_show":""],attrs:{role:"dialog","aria-modal":"true",tabindex:"0","aria-hidden":e.feedbackIdx!==n?"true":"false"},on:{click:function(e){e.stopPropagation()},touchstart:function(e){e.stopPropagation()},touchmove:function(e){e.preventDefault()},touchend:function(e){e.stopPropagation()},mousedown:function(e){e.stopPropagation()}}},[t("div",{staticClass:"weui-mask js_mask",attrs:{role:"button","aria-label":"关闭"},on:{click:e.hideFeedback}}),t("div",{class:["feedback_dialog js_dialog_wrp","top"===e.feedbackPos?"feedback_dialog_pos_top":""]},[t("div",{staticClass:"feedback_dialog_hd weui-flex"},[t("div",{staticClass:"weui-flex__item feedback_dialog_title"},[e._v("不看的原因")]),t("button",{class:["weui-btn weui-btn_primary weui-btn_mini js_submit",e.hasFeedbackReason?"":"weui-btn_disabled"],attrs:{type:"button"},on:{click:function(t){return e.submitFeedback(i)}}},[e._v(" 确定 ")])]),t("div",{staticClass:"feedback_dialog_bd"},[t("ul",{staticClass:"feedback_tag_list"},[e._l(e.reason,(function(i){return t("li",{key:i.value,class:["feedback_tag_item js_reason js_tag_item",e.feedbackReasonTacitly[i.value]?"feedback_tag_selected":""],attrs:{role:"checkbox","aria-checked":!!e.feedbackReasonTacitly[i.value],"data-value":i.value},on:{click:e.chooseFeedbackReason}},[e._v(" "+e._s(i.name)+" ")])})),e._l(i.keyword,(function(i,n){return[n<2?t("li",{key:i,class:["feedback_tag_item js_keyword js_tag_item",e.feedbackReasonKeyword[i]?"feedback_tag_selected":""],attrs:{role:"checkbox","aria-checked":!!e.feedbackReasonKeyword[i],"data-value":i},on:{click:e.chooseFeedbackReason}},[e._v(" 对"+e._s(i)+"不感兴趣 ")]):e._e()]}))],2)])])])])]),t("div",{staticClass:"weui-media-box__ft"},[t("img",{directives:[{name:"wxpic-src",rawName:"v-wxpic-src",value:i.cover,expression:"item.cover"}],staticClass:"relate_article_cover",attrs:{alt:"相关阅读封面"}})])])})),e.relatedArticleListInfo&&2===e.relatedArticleListInfo.style?t("Intersect",{attrs:{threshold:[1]},on:{"~enter":function(t){return e.preloadMoreKuaixun.apply(null,arguments)}}},[t("div",{ref:"moreNews",staticClass:"more_news weui-media-box",on:{click:e.goKuaixunFeed}},[e._v(" 更多快讯 "),t("svg",{attrs:{width:"10",height:"20",viewBox:"0 0 10 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[t("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M2.04504 5.48386L2.92893 4.59998L7.74467 9.41572C8.06978 9.74083 8.07266 10.265 7.74467 10.593L2.92893 15.4088L2.04504 14.5249L6.56556 10.0044L2.04504 5.48386Z"}})])])]):e._e()],2):[e._m(0),t("div",{staticClass:"relate_article_list relate_article_placeholder"},[t("div",{ref:"relatedPlaceholder",staticClass:"weui-media-box weui-media-box_appmsg"},[t("div",{staticClass:"weui-media-box_placeholder"})])])]],2)])]):e._e()])}),[function(){var e=this._self._c;return e("div",{staticClass:"relate_list_loading"},[e("span",{staticClass:"weui-primary-loading",attrs:{role:"img"}},[e("span",{staticClass:"weui-primary-loading__dot"})])])}],!1,null,"bf8c5bf5",null,null).exports;var vs={exports:{}};self;var bs=vs.exports=(()=>{return{156:function(e,t){var i=this&&this.__assign||function(){return i=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)},n=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var n,o=0,s=t.length;o<s;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.mpThirdExtParamToSearchExtParam=function(e){var t,a,r=e.thirdExtParam,l=void 0===r?"":r,d=e.kvItems,c=void 0===d?[]:d,u=e.sessionKvItems,p=void 0===u?[]:u,h=e.scene,m=void 0===h?-1:h,_=e.query,f=e.parentType,g={crossExtReqParams:[],sessionExtReqParams:[]};try{if(!l)throw new Error("mpThirdExtParamToSearchExtParam thirdExtParam 不存在");var y=JSON.parse(decodeURIComponent(l));if(null==y?void 0:y.s1sKeywordsData){var w=(y||{}).s1sKeywordsData,v=void 0===w?{}:w,b=v.enterId,S=void 0===b?0:b,I=v.s1sContextInfo,x=void 0===I?"{}":I,k=v.s1sStatInfo,T=void 0===k?"{}":k,C=(v.preRenderData,v.sessionId),A=void 0===C?"":C,E=o(decodeURIComponent(x)),P=o(decodeURIComponent(T)),L=P.bizuin,D=void 0===L?0:L,R=P.msgid,B=void 0===R?0:R,O=P.msgidx,j=void 0===O?0:O,M=E.mixerCommonContext,N=void 0===M?"":M,q=(E.isNeedUpdateGPTInfo,i({},E));delete q.mixerCommonContext,g.crossExtReqParams.push({key:"parentSearchID",textValue:[f||s(m),S||P.enterId,_,"".concat(D,"_").concat(B,"_").concat(j),encodeURIComponent(JSON.stringify({enterId:S||P.enterId,sessionId:A,s1sContextInfo:q,s1sStatInfo:P}))].join(":").replace(/,/g,";")}),N&&g.crossExtReqParams.push({key:"mixerCommonContext",textValue:N}),(null==y?void 0:y.mpSelectedContent)&&g.crossExtReqParams.push({key:"mpSelectedContent",textValue:y.mpSelectedContent}),(null==y?void 0:y.mpSelectActionType)&&g.crossExtReqParams.push({key:"mpSelectActionType",textValue:y.mpSelectActionType}),(null==y?void 0:y.mp_bizuin_msgid_msgidx)&&g.crossExtReqParams.push({key:"mpBizuinMsgidMsgidx",textValue:y.mp_bizuin_msgid_msgidx})}return(null==c?void 0:c.length)&&(t=g.crossExtReqParams).push.apply(t,c),(null==p?void 0:p.length)&&(a=g.sessionExtReqParams).push.apply(a,p),{thirdExtParam:encodeURIComponent(JSON.stringify(g)),extReqParams:JSON.stringify(n(n([],g.crossExtReqParams,!0),g.sessionExtReqParams,!0))}}catch(W){return console.error("mpThirdExtParamToSearchExtParam err:",W),{thirdExtParam:l}}};var o=function(e){if("object"==typeof e&&e)return e;if("string"==typeof e)try{return JSON.parse(e)}catch(t){return}},s=function(e){return 173===e?95:78}}}[156](0,e={}),e;var e})();const Ss=(Ae.isAndroid||Ae.isIOS)&&Ae.isOnlyWechat;const Is=xt({name:"mp-related-search",props:{needShow:{type:Boolean,required:!0}},data:()=>({wordList:[],isClicked:!1,itemsLoaded:!1,itemClickedStates:[],observedSearchItems:[],titleObserver:null,keywordObserver:null,exposeItems:new Set,isLargeFont:!1,executed:!1,processedWordList:[],truncateTextNumList:[]}),watch:{needShow(e){e&&(this.getData(),this.executed=!0)},itemsLoaded(e){e&&this.$nextTick((()=>{this.setObserver(),this.setFontChange()}))},wordList:{handler(){this.$nextTick((()=>{this.truncateText()}))},immediate:!0}},beforeDestroy(){this.titleObserver&&this.titleObserver.disconnect(),this.keywordObserver&&this.keywordObserver.disconnect()},methods:{getData(){this.executed||ye({url:"/mp/relatedsearchword?action=getsearchword&__biz=".concat(window.biz,"&mid=").concat(window.mid,"&idx=").concat(window.idx,"&enterid=").concat(window.enterid,"&request_id=").concat(Date.now(),"&scene=").concat(window.source,"&sessionid=").concat(window.sessionid),type:"GET",dataType:"json",success:e=>{0===e.base_resp.ret&&(this.wordList=e.list,this.itemClickedStates=this.wordList.map((()=>!1)),this.itemsLoaded=!0,ge.setSum(368675,5,1))}})},clickSearchWords(e){const{word:t,s1s_stat_info:i,s1s_context_info:n,source:o,s1s_jsapi_name:s,s1s_jsapi_paras:a}=this.wordList[e],r={s1sKeywordsData:{s1sContextInfo:n,s1sStatInfo:i}};if("openWXSearchHalfPage"===s&&Ss){const e=JSON.parse(a)||{},i=bs.mpThirdExtParamToSearchExtParam({query:t,parentType:95,thirdExtParam:encodeURIComponent(JSON.stringify(r)),...e});De({query:t,parentType:95,...e,...i},2)}else{const e=bs.mpThirdExtParamToSearchExtParam({query:t,scene:173,parentType:95,thirdExtParam:encodeURIComponent(JSON.stringify(r))});De({query:t,scene:173,parentType:95,...e})}this.reportRelatedKeywords(3e3,{s1s_status_info:i,query_pull_type:o,query:t,extinfo:this.getExtInfo(e)},!0),ge.setSum(368675,7,1)},toggleClickedState(e,t){this.$set(this.itemClickedStates,e,t)},setItemRef(e){e&&this.observedSearchItems.push(e)},getExtInfo(e){const t={},i=this.truncateTextNumList[e]||0;return t.exposedTextNum=i,JSON.stringify(t)},setObserver(){const e=document.getElementById("content_bottom_interaction"),t=Math.floor(null==e?void 0:e.getBoundingClientRect().height)||0;this.titleObserver=new IntersectionObserver(((e,t)=>{e.forEach((e=>{const{target:i}=e;e.isIntersecting&&(this.reportRelatedKeywords(2e3,{s1s_status_info:this.wordList[0].s1s_stat_info,query_pull_type:0,query:""}),t.unobserve(i),ge.setSum(368675,6,1))}))}),{rootMargin:"0px 0px ".concat(-t,"px 0px")}),this.$refs.relatedTitle&&this.titleObserver.observe(this.$refs.relatedTitle),this.keywordObserver=new IntersectionObserver(((e,t)=>{e.forEach((e=>{const{target:i}=e;e.isIntersecting&&!this.exposeItems.has(i)&&setTimeout((()=>{if(e.isIntersecting){this.exposeItems.add(i);const e=i.getAttribute("data-idx"),{s1s_stat_info:n,source:o,word:s}=this.wordList[e];this.reportRelatedKeywords(2004,{s1s_status_info:n,query_pull_type:o,query:s,extinfo:this.getExtInfo(e)}),t.unobserve(i)}}),500)}))}),{rootMargin:"0px 0px ".concat(-t,"px 0px")}),this.observedSearchItems.forEach((e=>{this.keywordObserver.observe(e)}))},truncateText(){this.$nextTick((()=>{const e=this.$refs.textSpanNode;Array.isArray(e)&&e.forEach(((e,t)=>{const i=this.wordList[t].word,n=parseInt(window.getComputedStyle(e).lineHeight);if(e.textContent=i,this.isLargeFont)if(e.offsetHeight>2*n){let o=i;for(;e.offsetHeight>2*n&&o.length>1;)o=o.slice(0,-1),e.textContent=o+"...";this.$set(this.processedWordList,t,o+"..."),this.$set(this.truncateTextNumList,t,o.length)}else this.$set(this.processedWordList,t,i),this.$set(this.truncateTextNumList,t,i.length);else if(e.offsetHeight>n){let o=i;for(;e.offsetHeight>n&&o.length>1;)o=o.slice(0,-1),e.textContent=o+"...";this.$set(this.processedWordList,t,o+"..."),this.$set(this.truncateTextNumList,t,o.length)}else this.$set(this.processedWordList,t,i),this.$set(this.truncateTextNumList,t,i.length)}))}))},setFontChange(){const e=Gt();this.isLargeFont=e>=1.2,this.truncateText(),j((()=>{const e=Gt();this.isLargeFont=e>=1.2,this.truncateText()}))},reportRelatedKeywords(e,{s1s_status_info:t,query_pull_type:i,query:n,extinfo:o},s=!1){const a={ActionType:e,Query:n,S1sStatusInfo:t,QueryPullType:i+"",extinfo:o||"",Scene:1*window.scene||0,EnterId:1*window.enterid||0,SessionId:window.sessionid,ActionTimestamp:Math.round(new Date/1e3)};we.report(31671,a,{realTime:s})}}},(function(){var e=this,t=e._self._c;return e.wordList.length>0?t("div",{staticClass:"related_search_container"},[t("h1",{ref:"relatedTitle",staticClass:"related_search_title"},[e._v("搜索")]),t("ul",{staticClass:"related_search_words_list"},e._l(e.wordList,(function(i,n){return t("li",{key:n,ref:e.setItemRef,refInFor:!0,staticClass:"related_search_words_li",class:{active:e.itemClickedStates[n],large_font:e.isLargeFont,normal_font:!e.isLargeFont},attrs:{"data-idx":n},on:{click:function(t){return e.clickSearchWords(n)},touchstart:function(t){return e.toggleClickedState(n,!0)},touchend:function(t){return e.toggleClickedState(n,!1)},touchcancel:function(t){return e.toggleClickedState(n,!1)}}},[t("span",{ref:"textSpanNode",refInFor:!0},[e._v(e._s(e.processedWordList[n]))]),n%2==0?t("div",{staticClass:"dividing_line"}):e._e()])})),0)]):e._e()}),[],!1,null,"d828d882",null,null).exports,xs="--appmsgExtra-BG";const ks=xt({components:{[ws.name]:ws,[Is.name]:Is,[Xt.name]:Xt,[M.name]:M,[N.name]:N},data:()=>({isNewMpApp:Ae.isNewMpApp,bottomBounceColor:xs,hasExtLoadDone:!1,hasBottomAd:!1,hasRelatedArticle:!1,fetchBeforeExtResp:!window.__immersiveListMode,commentStatus:{showPreComment:!1,isShowComment:!1,isLoading:!1,isInitial:!1,isEmpty:!0},adObserver:null,onlyComment:"1"===be.getQuery("only_comment")}),computed:{cmtStoreBase:()=>Ae.isNewMpApp?"mp-app-comment":"mp-comment",...h(["extRes"]),...h({fansMsgEnabled(e,t){return t["".concat(this.cmtStoreBase,"/fansMsgEnabled")]},commentEnabled(e,t){return t["".concat(this.cmtStoreBase,"/commentEnabled")]},commentId(e,t){return t["".concat(this.cmtStoreBase,"/commentId")]},writeCommentEntry(e,t){return t["".concat(this.cmtStoreBase,"/writeCommentEntry")]}}),isShowRelatedSearchWord(){return!(!this.extRes||void 0===this.extRes.show_related_search_word)&&0!==this.extRes.show_related_search_word},hasExtraCnt(){return this.fansMsgEnabled||1===this.commentEnabled&&1*this.commentId!=0||this.hasBottomAd||this.hasRelatedArticle}},watch:{bottomBounceColor(e){this.setBottomBounceColor(e)}},created(){this.setBottomBounceColor(this.bottomBounceColor),je.on("ext-complete-success",(()=>{this.hasExtLoadDone=!0,this.updateBgColor()}))},mounted(){},beforeDestroy(){this.adObserver&&this.adObserver.disconnect()},methods:{loadBottomAd(){const e=new IntersectionObserver((t=>{t.forEach((t=>{if(t.isIntersecting){const{target:i}=t;"js_bottom_opr_right"===i.id?(ge.setSum(364569,0,1),e.unobserve(i)):i.classList.contains("mpda_bottom_container")&&(ge.setSum(364569,1,1),e.unobserve(i))}}))}),{root:null,rootMargin:"0px",threshold:.05}),t=document.getElementById("js_bottom_opr_right"),i=document.querySelector(".mpda_bottom_container");t&&e.observe(t),i&&e.observe(i),this.adObserver=e,this.hasBottomAd=!0,this.updateBgColor()},onRelatedArticleListDataChange(e){this.hasRelatedArticle=e.length>0,this.updateBgColor()},commentStatusChange(e,t){this.commentStatus[e]=t,this.updateBgColor()},updateBgColor(){this.hasExtLoadDone?this.commentStatus.isShowComment&&!this.commentStatus.isEmpty||this.commentStatus.isShowComment&&this.commentStatus.isInitial&&!this.fansMsgEnabled&&this.writeCommentEntry?this.bottomBounceColor="":this.hasBottomAd||this.hasRelatedArticle||this.commentStatus.isShowComment&&(!this.commentStatus.isShowComment||!this.commentStatus.isEmpty||this.commentStatus.isLoading||this.commentStatus.isInitial)?this.bottomBounceColor=xs:this.bottomBounceColor="":this.commentStatus.showPreComment?this.bottomBounceColor="":this.bottomBounceColor=xs},setBottomBounceColor(e){Yt.set(e?{bottom:Qt.get(e)}:void 0),document.body.classList[e?"remove":"add"]("wx_wap_page_primary")},scrollToComment(){const e=this.$refs.comment.$refs.comment.$el.getBoundingClientRect();q.start({y:e.y+window.scrollY})},submitComment(e){this.__submitingComment||(this.__submitingComment=!0,this.$refs.comment.$refs.comment.sendComment({content:e,successEnd:this.scrollToComment,complete:()=>{this.__submitingComment=!1}}))},showAccessComment(e){this.$refs.comment.$refs.comment.showCmtInput(e)},onRenderComment(e){},onShowMoreRepliesSuccess(){},beforeHidePercomment(){document.scrollingElement.style.minHeight||(document.scrollingElement.style.minHeight=document.scrollingElement.scrollHeight+"px",this.__hasSetTmpMinHeight=!0)},afterHidePercomment(){this.__hasSetTmpMinHeight&&(document.scrollingElement.style.minHeight="",this.__hasSetTmpMinHeight=!1)}}},(function(){var e=this,t=e._self._c;return t("div",{class:{has_extra_cnt:e.hasExtraCnt},staticStyle:{position:"relative"},attrs:{id:"page_bottom_area"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.onlyComment,expression:"!onlyComment"}],ref:"cmtTop"},[t("div",{staticStyle:{"font-size":"0",height:"0"},attrs:{"aria-hidden":"true"}},[e._v("​")]),t("mp-bottom-ad",{on:{"ad-load":e.loadBottomAd}}),e.$store.state.cgiData.isRefutedAppmsg?e._e():t("mp-related-article",{on:{"list-data-change":e.onRelatedArticleListDataChange}}),t("mp-related-search",{attrs:{"need-show":e.isShowRelatedSearchWord}})],1),t("mp-appmsg-comment",{ref:"comment",attrs:{"lazy-show":!0,"fetch-before-ext-resp":e.fetchBeforeExtResp},on:{"per-comment-status":t=>e.commentStatusChange("showPreComment",t),"show-comment-change":t=>e.commentStatusChange("isShowComment",t),"loading-change":t=>e.commentStatusChange("isLoading",t),"initial-change":t=>e.commentStatusChange("isInitial",t),"empty-change":t=>e.commentStatusChange("isEmpty",t),"render-comment":e.onRenderComment,"show-more-replies-success":e.onShowMoreRepliesSuccess,"before-hide-percomment":e.beforeHidePercomment,"after-hide-percomment":e.afterHidePercomment}}),e.isNewMpApp?t("mp-interaction-bar",{on:{"submit-comment":e.submitComment,"scroll-to-comment":e.scrollToComment,"show-access-comment":e.showAccessComment}}):e._e()],1)}),[],!1,null,null,null,null).exports,Ts=window.Vue;const Cs=document.getElementById("profileBt");const As=xt({name:"mp-profile-card",data:()=>({nickname:window.title,headImg:window.round_head_img,signature:window.profile_signature_new?window.profile_signature_new:window.profile_signature,originalArticleCount:0,verifyPrincipal:"",isVerify:!1,showProfileCard:!1,unloginMobile:Nt(),showPcProfileCard:!1}),computed:{arrowPositionStyle:()=>({left:Cs.offsetWidth/2-8+"px"}),qrcodeImgSrc(){let e=10000005;const t=document.referrer;if(0==t.indexOf("http://weixin.sogou.com")?e=10000006:0==t.indexOf("https://wx.qq.com")&&(e=10000007),window.isSg)return window.sg_qr_code.htmlDecode();return(new Image).src="/mp/report?action=pcclick&__biz="+window.biz+"&uin="+window.uin+"&scene="+e+"&r="+Math.random(),"/mp/qrcode?scene="+e+"&size=102&__biz="+window.biz+"&mid="+window.mid+"&idx="+window.idx+"&sn="+window.sn+"&send_time="+window.send_time}},mounted(){Cs.addEventListener("click",(e=>{this.showPcProfileCard=!0,e.stopPropagation()}));const e=document.getElementById("js_profile_qrcode");document.addEventListener("click",(t=>{const i=t.target;e&&i!=Cs&&i!=e&&(this.showPcProfileCard=!1)})),ye({type:"GET",url:"/mp/authorinfo?biz=".concat(window.biz),success:e=>{try{const t=JSON.parse(e),{identity_name:i,is_verify:n,original_article_count:o}=t;i&&(this.verifyPrincipal=i),n&&(this.isVerify=n),o&&(this.originalArticleCount=o)}catch(t){console.log(t)}},error:e=>{console.log(e)}})}},(function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.showPcProfileCard,expression:"showPcProfileCard"}],ref:"js_profile_qrcode",staticClass:"profile_card_container",attrs:{id:"js_profile_qrcode"}},[t("div",{staticClass:"profile_card_wrap"},[t("div",{staticClass:"profile_card_qrcode"},[t("img",{staticClass:"profile_qrcode_img",attrs:{id:"js_profile_qrcode_img",src:e.qrcodeImgSrc,alt:"profile_qrcode"}})]),t("div",{staticClass:"profile_card_info"},[t("div",[t("span",{staticClass:"profile_info_nickname"},[e._v(" "+e._s(e.nickname)+" ")])]),e.isVerify?t("div",{staticClass:"profile_verify_principal profile_card_info_meta"},[t("span",{staticClass:"profile_main_text"},[e._v(e._s(e.verifyPrincipal))]),e.isVerify?t("div",{staticClass:"profile_verify-icon"},[1===e.isVerify?t("i",{staticClass:"profile_item-title-type__person inline-icon"}):t("i",{staticClass:"profile_item-title-type inline-icon"})]):e._e()]):e._e(),e.signature?t("div",{staticClass:"profile_card_info_meta"},[t("p",{staticClass:"profile_card_info_meta_text profile_card_signature"},[e._v(" "+e._s(e.signature)+" ")])]):e._e(),e.originalArticleCount?t("p",{staticClass:"profile_original_count profile_card_info_meta"},[t("span",{staticClass:"profile_card_info_meta_text"},[e._v(e._s(e.originalArticleCount)+"篇原创内容")])]):e._e()])]),t("div",{staticClass:"profile_arrow_wrp",style:e.arrowPositionStyle,attrs:{id:"js_profile_arrow_wrp"}},[t("i",{staticClass:"profile_arrow arrow_out"}),t("i",{staticClass:"profile_arrow arrow_in"})])])}),[],!1,null,"da33bb4f",null,null).exports,Es=window.Vue;var Ps={name:"mp-feedback",props:{show:{type:Boolean,default:!1},pos:{type:String,default:"bottom"},title:{type:String,default:"不看的原因"},reason:{type:Array,default:function(){return[]}},keyword:{type:Array,default:function(){return[]}},dialogStyle:{type:Object,default:function(){return{}}},reasonLiStyle:{type:Object,default:function(){return{}}},arrowStyle:{type:Object,default:function(){return{}}},showMask:{type:Boolean,default:!0},maskStyle:{type:Object,default:function(){return{}}},showMaskTransition:{type:Boolean,default:!0},showSubmitFeedback:{type:Boolean,default:!0},isSelected:{type:Boolean,default:!0},showShadow:{type:Boolean,default:!1}},data:function(){return{innerShow:!1,reasonTacitly:{},reasonKeyword:{}}},watch:{show:{handler:function(e){var t=this;e?n.show({alpha:this.showMask?.2:0,onClick:function(){t.hideFeedback()}}):(this.reasonTacitly={},this.reasonKeyword={}),this.innerShow=e},immediate:!0}},computed:{hasFeedbackReason:function(){return!!(Object.keys(this.reasonTacitly).length+Object.keys(this.reasonKeyword).length)}},methods:{hideFeedback:function(){this.innerShow=!1,this.reasonTacitly={},this.reasonKeyword={},this.$emit("hide"),n.hide()},submitFeedback:function(){var e=this;this.hasFeedbackReason&&(this.$emit("submit",{tacitly:Object.keys(this.reasonTacitly).map((function(t){return e.reasonTacitly[t]})),keyword:Object.keys(this.reasonKeyword)}),this.hideFeedback())},chooseFeedbackReason:function(e,t){if(this.isSelected){var i=e.currentTarget,n=Ce.hasClass(i,"js_reason")?this.reasonTacitly:this.reasonKeyword,o=i.dataset.value;n[o]?this.$delete(n,o):this.$set(n,o,t)}else this.$emit("selectFeedback")}}};const Ls=ei(Ps,(function(){var e=this,t=e._self._c;return t("div",{ref:"feedbackBd",class:["feedback_dialog_wrp feedback_dialog_radius_tail js_feedback_dialog",e.innerShow?"feedback_dialog_show":"",e.showMaskTransition?"feedback_mask":""],attrs:{role:"dialog","aria-modal":"true",tabindex:"0","aria-hidden":!e.innerShow},on:{click:function(e){e.stopPropagation()},touchstart:function(e){e.stopPropagation()},touchend:function(e){e.stopPropagation()},touchmove:function(e){e.stopPropagation(),e.preventDefault()}}},[t("div",{staticClass:"weui-mask js_mask",style:{background:e.maskStyle.background,backdropFilter:e.maskStyle.filter},attrs:{role:"button","aria-label":"关闭"},on:{click:e.hideFeedback}}),e._t("default"),t("div",{class:["feedback_dialog js_dialog_wrp","top"===e.pos?"feedback_dialog_pos_top":"",e.showShadow?"feedback_dialog_shadow":""],style:e.dialogStyle},[t("div",{staticClass:"feedback_dialog_hd weui-flex"},[t("div",{staticClass:"weui-flex__item feedback_dialog_title"},[e._v(e._s(e.title))]),e.showSubmitFeedback?t("button",{class:["weui-btn weui-btn_primary weui-btn_mini js_submit",e.hasFeedbackReason?"":"weui-btn_disabled"],attrs:{type:"button",disabled:!e.hasFeedbackReason},on:{click:e.submitFeedback}},[e._v(" 确定 ")]):e._e()]),t("div",{staticClass:"feedback_dialog_bd"},[t("ul",{staticClass:"feedback_tag_list"},[e._l(e.reason,(function(i){return t("li",{key:i.value,class:["feedback_tag_item js_reason js_tag_item",e.reasonTacitly[i.value]?"feedback_tag_selected":""],style:e.reasonLiStyle,attrs:{role:"checkbox","aria-checked":!!e.reasonTacitly[i.value],"data-value":i.value},on:{click:function(t){return e.chooseFeedbackReason(t,i)}}},[e._v(" "+e._s(i.name)+" ")])})),e._l(e.keyword,(function(i,n){return[n<2?t("li",{key:i,class:["feedback_tag_item js_keyword js_tag_item",e.reasonKeyword[i]?"feedback_tag_selected":""],attrs:{role:"checkbox","aria-checked":!!e.reasonKeyword[i],"data-value":i},on:{click:function(t){return e.chooseFeedbackReason(t,i)}}},[e._v(" 对"+e._s(i)+"不感兴趣 ")]):e._e()]}))],2)]),t("div",{class:["feedback_dialog_tail","top"===e.pos?"":"feedback_dialog_tail_pos_up"],style:e.arrowStyle})])],2)}),[],!1,null,"60c0d2a0",null,null).exports;!function(e,t){try{if("undefined"!=typeof document&&!document.getElementById(t.styleId)){var i=document.createElement("style");i.setAttribute("id",t.styleId);for(const e in t.attributes)i.setAttribute(e,t.attributes[e]);i.appendChild(document.createTextNode('.feedback_dialog_wrp[data-v-60c0d2a0]{opacity:0;-webkit-user-select:none;-ms-user-select:none;user-select:none;pointer-events:none}.feedback_dialog_wrp.feedback_mask[data-v-60c0d2a0]{transition:opacity .07s ease-out}.feedback_dialog_wrp .weui-mask[data-v-60c0d2a0]{background:rgba(0,0,0,.2)}.feedback_dialog[data-v-60c0d2a0]{position:absolute;z-index:5000;font-size:10px;right:calc(-16px - 6.4em);top:calc(100% + 10px);width:288px;padding:16px;box-sizing:border-box;background-color:var(--weui-BG-5);color:var(--weui-FG-0);line-height:1.4;border-radius:8px;transition:transform .15s cubic-bezier(.175,.885,.32,1.1);-ms-transform:scale(0);transform:scale(0);-ms-transform-origin:80% 0;transform-origin:80% 0}.feedback_dialog[data-v-60c0d2a0]:before{content:"";display:inline-block;width:0;height:0;border-width:6px;border-style:dashed;border-color:transparent;border-top-width:0;border-bottom-color:var(--weui-BG-5);border-bottom-style:solid;position:absolute;right:calc(7.4em + 10px);top:-6px}.feedback_dialog_radius_tail .feedback_dialog[data-v-60c0d2a0]:before{display:none}.feedback_dialog_tail[data-v-60c0d2a0]{pointer-events:none;position:absolute;left:50%;margin-left:-4px;width:8px;height:8px;border-radius:1.5px;background:var(--weui-BG-5);-ms-transform:rotate(45deg);transform:rotate(45deg);top:auto;bottom:-3px;left:auto;right:calc(7.4em + 12px)}.feedback_dialog_tail[data-v-60c0d2a0]:before,.feedback_dialog_tail[data-v-60c0d2a0]:after{content:"";position:absolute;width:8px;height:8px;border-radius:50%;box-shadow:-6.5px 0 0 0 var(--weui-BG-5)}.feedback_dialog_tail[data-v-60c0d2a0]:before{bottom:-7px;left:6px;-ms-transform:rotate(74deg);transform:rotate(74deg);-ms-transform-origin:0 0;transform-origin:0 0}.feedback_dialog_tail[data-v-60c0d2a0]:after{top:-2px;right:-7px;-ms-transform:rotate(16deg);transform:rotate(16deg);-ms-transform-origin:0 100%;transform-origin:0 100%}.feedback_dialog_tail_pos_up[data-v-60c0d2a0]{bottom:auto;top:-3px}.feedback_dialog_tail_pos_up[data-v-60c0d2a0]:before,.feedback_dialog_tail_pos_up[data-v-60c0d2a0]:after{box-shadow:6.5px 0 0 0 var(--weui-BG-5)}.feedback_dialog_tail_pos_up[data-v-60c0d2a0]:before{bottom:1px;left:-6px;-ms-transform:rotate(16deg);transform:rotate(16deg)}.feedback_dialog_tail_pos_up[data-v-60c0d2a0]:after{top:-15px;right:0;-ms-transform:rotate(80deg);transform:rotate(80deg)}.feedback_dialog_hd[data-v-60c0d2a0]{-ms-flex-align:center;align-items:center}.feedback_dialog_title[data-v-60c0d2a0]{padding-right:16px;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;font-size:15px;font-weight:500;color:var(--weui-FG-0)}.feedback_dialog_bd[data-v-60c0d2a0]{padding-top:4px}.feedback_tag_list[data-v-60c0d2a0]{font-size:0}.feedback_tag_item[data-v-60c0d2a0]{--weui-TAG-TEXT-GREEN: #07C160;--weui-TAG-BACKGROUND-GREEN: rgba(7, 193, 96, .1);margin-right:8px;margin-top:8px;display:inline-block;vertical-align:middle;font-size:14px;width:auto;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;word-wrap:normal;max-width:100%;padding:8px 12px;border-radius:4px;box-sizing:border-box;color:var(--weui-FG-0);background:rgba(0,0,0,.03);-webkit-tap-highlight-color:rgba(0,0,0,0)}.feedback_tag_item.feedback_tag_selected[data-v-60c0d2a0]{color:var(--weui-TAG-TEXT-GREEN);background-color:var(--weui-TAG-BACKGROUND-GREEN)}.feedback_tag_item[data-v-60c0d2a0]:active{position:relative}.feedback_tag_item[data-v-60c0d2a0]:active:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.1)}.feedback_dialog_pos_top[data-v-60c0d2a0]{top:auto;bottom:calc(100% + 10px)}.feedback_dialog_pos_top[data-v-60c0d2a0]:before{border-bottom:0;border-top:6px solid var(--weui-BG-5);top:auto;bottom:-6px}.feedback_dialog_show[data-v-60c0d2a0]{opacity:1;pointer-events:all}.feedback_dialog_show.feedback_mask[data-v-60c0d2a0]{transition:all .05s ease-in}.feedback_dialog_show .feedback_dialog[data-v-60c0d2a0]{-ms-transform:scale(1);transform:scale(1)}@media screen and (min-width: 400px){.feedback_dialog[data-v-60c0d2a0]{left:auto;width:320px}}@media (prefers-color-scheme: dark){.feedback_tag_item[data-v-60c0d2a0]{background-color:#ffffff08}}.feedback_dialog[data-v-60c0d2a0]{-ms-transform-origin:50% 0;transform-origin:50% 0}.feedback_dialog.feedback_dialog_pos_top[data-v-60c0d2a0]{-ms-transform-origin:50% 100%;transform-origin:50% 100%}.feedback_dialog_shadow[data-v-60c0d2a0]{box-shadow:0 4px 25px #0003}')),document.head.appendChild(i)}}catch(n){console.error("vite-plugin-css-injected-by-js",n)}}(0,{styleId:"mp-common-components-0.9220637911981961"});const Ds=xt({components:{[Ls.name]:Ls},data(){var e,t;return{isShowFeedBack:!1,feedbackArrowStyle:{right:"10px"},feedbackDialogStyle:{position:"absolute",width:"auto",top:"27px",right:"0px"},feedbackReasonLiStyle:{marginRight:0},media:null==(e=window.matchMedia)?void 0:e.call(window,"(prefers-color-scheme: dark)"),isDarkMode:null==(t=window.matchMedia)?void 0:t.call(window,"(prefers-color-scheme: dark)").matches,bottomBarDom:null,bottomBarZIndex:0,bottomBarMaskDom:null,bottomBarMaskZIndex:0,payPanelDom:null,payPanelZIndex:0}},methods:{showFeedBack(){ye({url:"/publicpoc/mparticlefeedback?action=Report&bizuin=".concat(window.biz,"&mid=").concat(window.mid,"&idx=").concat(window.idx,"&feedback_reason_enum=0"),type:"POST"}),this.isShowFeedBack=!0,n.show({color:"#ffffff",alpha:0}),this.bottomBarDom=document.querySelector("#js_article_bottom_bar"),this.bottomBarDom&&(this.bottomBarZIndex=this.bottomBarDom.style.zIndex,this.bottomBarDom.style.zIndex=0),this.bottomBarMaskDom=document.querySelector(".bottom_bar_padding_mask"),this.bottomBarMaskDom&&(this.bottomBarMaskZIndex=this.bottomBarMaskDom.style.zIndex,this.bottomBarMaskDom.style.zIndex=0),this.payPanelDom=document.querySelector("#js_pay_panel"),this.payPanelDom&&(this.payPanelZIndex=this.payPanelDom.style.zIndex,this.payPanelDom.style.zIndex=0)},selectFeedbackFn(){this.hideFeedBack(),ye({url:"/publicpoc/mparticlefeedback?action=Report&bizuin=".concat(window.biz,"&mid=").concat(window.mid,"&idx=").concat(window.idx,"&feedback_reason_enum=1"),type:"POST"}),window.weui.toast("已反馈",{duration:800})},darkModeListener(){var e;this.isDarkMode=null==(e=this.media)?void 0:e.matches},hideFeedBack(){this.isShowFeedBack=!1,n.hide(),this.bottomBarDom&&(this.bottomBarDom.style.zIndex=this.bottomBarZIndex),this.bottomBarMaskDom&&(this.bottomBarMaskDom.style.zIndex=this.bottomBarMaskZIndex),this.payPanelDom&&(this.payPanelDom.style.zIndex=this.payPanelZIndex),n.hide()}},computed:{maskBackground(){return this.isDarkMode?"linear-gradient(to bottom, rgba(25,25,25,1), rgba(25,25,25,0.5) 120px, rgba(25,25,25,0.5) 120px)":"linear-gradient(to bottom, rgba(255, 255, 255, 1), rgba(255, 255, 255, 0.5) 120px, rgba(255, 255, 255, 0.5) 120px)"},maskFilter(){return this.isShowFeedBack?"blur(5px)":"blur(0px)"}},created(){this.media.addEventListener?this.media.addEventListener("change",this.darkModeListener):this.media.addListener(this.darkModeListener)},destroyed(){this.media.removeEventListener?this.media.removeEventListener("change",this.darkModeListener):this.media.removeListener(this.darkModeListener)}},(function(){var e=this,t=e._self._c;return t("div",{ref:"feedbackIcon",staticClass:"rich_media_meta_feedback dislike_btn",on:{click:function(t){return t.stopPropagation(),e.showFeedBack.apply(null,arguments)}}},[t("mp-feedback",{attrs:{show:e.isShowFeedBack,"arrow-style":e.feedbackArrowStyle,"dialog-style":e.feedbackDialogStyle,title:"反馈",showSubmitFeedback:!1,reason:[{name:"标题有误导性"}],isSelected:!1,showShadow:!0,showMask:!1,maskStyle:{background:e.maskBackground,filter:e.maskFilter},reasonLiStyle:e.feedbackReasonLiStyle,showMaskTransition:!0},on:{hide:e.hideFeedBack,selectFeedback:e.selectFeedbackFn}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowFeedBack,expression:"isShowFeedBack"}],staticClass:"dislike_btn inner"})])],1)}),[],!1,null,"6abc76d6",null,null).exports,Rs=window.Vue;function Bs(e){Ce.removeClass(e,"rich_media_meta_link"),Ce.removeClass(e,"js_wx_tap_highlight")}const Os={initAuthorName:(e,t)=>{const i=document.getElementById("js_author_name");t.reward_entrance_enable_for_preview?Ae.isInMiniProgram&&i&&Bs(i):!Ae.isInMiniProgram&&(Ae.isWindowsWechat||Ae.isMacWechat||Ae.isIOS||Ae.isAndroid)?(i&&e.rewardsn&&e.timestamp&&(i.setAttribute("data-rewardsn",e.rewardsn),i.setAttribute("data-timestamp",e.timestamp),i.setAttribute("data-canreward",e.can_reward)),i&&!e.can_reward&&Bs(i)):i&&Bs(i)}},js={tagName:"mp-common-cpslink",componentIdPropName:"data-link-component-id",clickReportPropName:"data-click-report-url",exposureReportPropName:"data-exposure-report-url",banPropName:"data-ban-status"},Ms={};function Ns(e){const t=Number(decodeURIComponent(e.getAttribute(js.banPropName)));return 1===t||0===t||-1===t}function qs(e){ye({url:"/mp/cps_product_info?action=UrlGet&product_type=1&url=".concat(encodeURIComponent(e)),type:"GET"})}function Ws(e){Ne.on(e,"click",(()=>{const t=decodeURIComponent(e.getAttribute("data-jump-url")),i=decodeURIComponent(e.getAttribute(js.clickReportPropName)||"");Ns(e)&&t&&(i&&qs(i),Ge(t))}))}function Fs(){const e=document.getElementsByTagName(js.tagName);for(const t of e){const e=t.getAttribute(js.componentIdPropName);if(Ms[e])continue;const i=t.getBoundingClientRect();if(i.bottom>0&&i.top<window.innerHeight){const i=decodeURIComponent(t.getAttribute(js.exposureReportPropName)||"");if(!Ns(t)||!i)continue;qs(i),Ms[e]=!0}}}const zs={initCpslink:function(){const e=document.getElementsByTagName(js.tagName);for(const t of e)t.classList.add("js_wx_tap_highlight"),Ws(t);Ne.on(window,"scroll",Fs)},updateCpslinkStatus:function(e){for(const t of e){if(!t||!t.component_id)continue;const e=t.component_id,i=document.querySelector("".concat(js.tagName,"[").concat(js.componentIdPropName,'="').concat(e,'"]'));i&&(i.setAttribute(js.clickReportPropName,t.click_url),i.setAttribute(js.exposureReportPropName,t.exp_url),i.setAttribute(js.banPropName,t.merge_status))}Fs()}},Us='<div id="page-content">\n  \x3c!--S 全屏播放 full_screen_mv--\x3e\n  <div id="js_mpvedio_wrapper_<#=vid#>" style="position:relative;height:100%">\n    <div class="add_bg_color appmsg_video">\n      <div id="js_video_tail_panel_<#=vid#>" class="video_tail_module video_screen_half" style="display: none;">\n        <div class="video_tail_module__hd" id="js_video_tail_hd">\n          <div class="account_info_wrp">\n            <div class="profile_info_wrp js_go_profile">\n              <img class="account_avatar" src="" alt="" id="js_tail_panel_account_avatar">\n                <div class="account_name" id="js_tail_panel_account_name"></div>\n                <div class="subscription_info subscription_success">\n                  <div class="account_subscription_tips js_subscription_success" id="js_subscription_success"\n                    style="display: none;">已关注</div>\n                  <i class="account_link_icon js_profile_icon" id="js_profile_icon"></i>\n                </div>\n            </div>\n            <div class="btn_account_subscription js_btn_account_subscription" id="js_btn_account_subscription" style="display: none;">\n              关注</div>\n          </div>\n          <div class="opr_wrp">\n            <span class="opr_item_wrp js_replay" id="js_replay">\n              <i class="opr_item refresh_icon"></i>\n              <span class="opr_item_text">重播</span>\n            </span>\n            <span class="opr_item_wrp share_item_wrp js_share_button" id="js_tail_share_button"\n              style="display: none;">\n              <i class="opr_item share_icon"></i>\n              <span class="opr_item_text">分享</span>\n            </span>\n            \x3c!--点赞后 加className selected--\x3e\n            <span class="opr_item_wrp like_item_wrp" id="js_tail_like_button" style="display: none;">\n              <i class="opr_item like_icon"></i>\n              <span class="opr_item_text">赞</span>\n            </span>\n            \x3c!-- <span class="opr_item_wrp recommend_item_wrp" id="js_tail_channel_button"\n              style="display: none;">\n              <i class="opr_item video-logo_icon"></i>\n              <span class="opr_item_text">随便看看</span>\n            </span> --\x3e\n          </div>\n        </div>\n\n        \x3c!-- 有拓展内容 --\x3e\n        <div class="have_expand" id="js_expand_area">\n        </div>\n\n        \x3c!-- 广告内容 --\x3e\n        <div class="ad_area" id="js_tail_video_ad_area">\n        </div>\n      </div>\n    </div>\n    <div id="js_vue_player_<#=index#>"></div>\n  </div>\n  \x3c!--E 视频播放器--\x3e\n  \x3c!-- S 视频社交--\x3e\n  <div id="bottom_bar" class="interact_video" style="display:none;height: 35px;">\n    <div class="inter_opr">\n      <a id="video_detail_btn" href="javascript:;" target="_blank" class="access_original">\n        视频详情\n      </a>\n    </div>\n  </div>\n</div>';function Hs(){const e={hasShowBotbar:!1,mpVideoBotH:37,showComment:!0,loverCount:{}};let t={};function i(e,t){const i=t||window.location.search,n=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),o=i.substr(i.indexOf("?")+1).match(n);return null!=o?o[2]:""}function n(t){return document.querySelector("#js_mp_video_container_".concat(e.iframeIdx," #").concat(t))}function o(){!function(){let i=e.ratio;t.vw&&t.vh&&(i=t.vw/t.vh);const o=t.vw||e.dom.js_mpvedio.offsetWidth,s=Math.ceil(o/i),a=[zt];Ae.isWechat&&!Ae.isNewMpApp&&(ve.os.iphone||ve.os.android)&&new Date(1e3*window.ct)>new Date("2022/01/12 19:00:00 GMT+0800")&&a.push(Ut);const r={cgiData:t,preview:!(1*t.preview!=1),isInIframe:!0,hitBizuin:t.hit_bizuin,hitVid:t.hit_vid,fromid:e.scene,oriStatus:e.ori_status,isMpVideo:t.txvideo_vid?0:t.is_mp_video,plugins:a,oriVid:e.vid,vid:t.txvideo_vid?t.txvideo_vid:e.vid,ckey:t.txvideo_vid?"":e.ckey,ckey_ad:e.ckey_ad,width:o,height:s,__biz:e.__biz,uin:e.uin,mid:e.mid,idx:e.idx,coverFit:"contain",vtitle:window.msg_title,videoTitle:window.msg_title,useFeFullscreen:!0,comment_id:e.comment_id,scene_type:0,autoplay:e.autoplay,videoMd5:t.video_md5,headImgUrl:window.round_head_img,canShareVideo:!t.isPaySubscribe,bizUserName:window.user_name,bizNickName:window.nickname,profileTabType:1,leaveReport12710Type:1,storeFactory:e=>{const t=new W.Store({modules:{[F.name]:F},state:{...z(),cgiData:e},mutations:U()});return t.registerModule([F.name,H.name],H),t.registerModule([F.name,V.name],V),t}},l=Wt();e.myPlayer=new Ft({el:"#js_vue_player_"+e.iframeIdx,opt:r,store:l}),e.myPlayer.$on("player-ready",(()=>{if(e.dom.js_mpvedio.style.height="100%",K.showReprint()&&!e.hasShowBotbar){const i=n("bottom_bar");i&&(i.style.display="",e.hasShowBotbar=!0,Re.postMessage({type:"addVideoIframeHeight",data:{vid:t.txvideo_vid||e.id,height:e.mpVideoBotH}}))}Re.postMessage({type:"videoInited",data:{vid:e.id,ori_status:e.ori_status,hit_bizuin:t.hit_bizuin,hit_vid:t.hit_vid}})})),e.myPlayer.$on("video-ready",(()=>{Re.postMessage({type:"removeVideoLoading",data:{vid:e.vid}})})),e.myPlayer.$on("fullscreenchange",(t=>{"frontend"===t.type&&(t.state&&e.dom.js_mpvedio.parentNode!==document.body?(e.dom.js_mpvedio.style="position: fixed; top: 0; width: 100%; height: 100%",e.dom.js_mpvedio.style.zIndex=510,e.dom.js_article.style.opacity=0,window.requestAnimationFrame((()=>{document.body.appendChild(e.dom.js_mpvedio),t.supportSwipeBack||(e.dom.js_article.style.transition="opacity .1s")}))):t.state||e.dom.js_mpvedio.parentNode===e.dom.page_content||(e.dom.page_content.appendChild(e.dom.js_mpvedio),t.supportSwipeBack?(e.dom.js_mpvedio.style="position: relative; height: 100%",e.dom.js_article.style.opacity=1):(e.dom.js_mpvedio.style="",setTimeout((()=>{e.dom.js_article.style.opacity=1}),150))))}))}()}function s(s){const{vid:a,vh:r,vw:l,ratio:d,index:c,is_mp_video:u}=s,p=(window.__videoPageInfos||[]).find((({video_id:e})=>e===a))||{};new Promise((e=>{u?e():ye({url:"/mp/videoplayer?action=tx_video&biz=".concat(window.biz,"&mid=").concat(window.mid,"&idx=").concat(window.idx,"&vid=").concat(a,"&source=").concat(window.source),type:"GET",dataType:"json",f:"json",success:t=>{t&&t.base_resp&&0===t.base_resp.ret?e(t.ckey):e()},error:()=>e()})})).then((s=>{t={hit_bizuin:p.hit_bizuin,hit_vid:p.hit_vid,ori_status:p.ori_status,hit_username:p.hit_username,is_mp_video:/^wxv/.test(p.hit_vid)||p.is_mp_video,vh:r,vw:l,vid:a,ckey:s,ratio:d,iframeIdx:c,biz:window.biz,mid:window.mid,idx:window.idx,uin:window.uin,__biz:window.biz,video_title:window.cgiData.title||"",is_login:window.is_login,user_uin:window.user_uin,username:window.user_name,nick_name:window.nickname,preview:!!window.is_temp_url,create_time:window.create_time,source_encode_biz:window.source_encode_biz,comment_id:window.comment_id,show_comment:window.show_comment,isPaySubscribe:1*window.isPaySubscribe||0,bizNickname:window.nickname,roundHeadImg:window.round_head_img,subscene:window.subscene,enterid:1*window.enterid,sessionid:window.sessionid,channel_session_id:window.channel_session_id,real_item_show_type:window.real_item_show_type,item_show_type:window.item_show_type,clientversion:window.clientversion,devicetype:window.devicetype,isprofileblock:window.isprofileblock,sn:window.sn||i("sign",window.location.href)||"",scene:window.source||window.scene||i("scene",window.location.href)||0},1*t.ori_status==1?e.ori_status=1:1*t.ori_status==2?e.ori_status=2:e.ori_status=3,e.showComment=1*t.show_comment==1,e.comment_id=t.comment_id,e.vid=t.vid,e.ckey=t.ckey,e.ckey_ad=t.ckey_ad,e.__biz=t.__biz,e.uin=t.uin,e.mid=t.mid,e.idx=t.idx,e.scene=t.scene||i("scene",window.location.href)||0,e.autoplay=!!e.container.getAttribute("__sec_open_auto_play__"),e.iframeIdx=t.iframeIdx,e.dom={js_article:document.getElementById("js_article"),js_mpvedio:n("js_mpvedio_wrapper_"+e.vid),page_content:n("page-content")},o(),function(){const o=n("h5_profile_btn");o&&2===t.ori_status&&Ne.tap(o,(()=>{const e="https://mp.weixin.qq.com/mp/profile_ext?action=home&__biz="+t.source_encode_biz+"&scene=111#wechat_redirect";Ae.isWindowsWechat||Ae.isMacWechat?location.href=e:Ee.invoke("openUrlWithExtraWebview",{url:e,openType:1},(t=>{-1===t.err_msg.indexOf("ok")&&(location.href=e)}))}));const s=n("video_detail_btn");s&&/^wxv_/.test(t.vid||"")&&Ne.tap(s,(()=>{const n=["https://mp.weixin.qq.com/mp/video?t=pages/video_detail_new","&vid=",e.vid,"&mid=",e.mid,"&__biz=",e.__biz,"&idx=",e.idx,"&sn=",window.sn||i("sign",window.location.href)||"","&vidsn=",t&&t.vidsn?t.vidsn:"","&scene=100#wechat_redirect"];e.myPlayer&&e.myPlayer.extendMpReportData({detail_click:1}),window.location.href=n.join("")}))}()}))}return{createMpVideoDom:function(t,i,n){const o=be.getQuery("vid",n),a=t.getAttribute("data-vw"),r=t.getAttribute("data-vh"),l=t.getAttribute("data-ratio"),d=document.createElement("span"),c=t.attributes;for(let e=c.length-1;e>=0;e--)d.setAttribute(c[e].name,c[e].value);d.id="js_mp_video_container_"+i,d.setAttribute("vid",o),d.classList.add("video_iframe"),d.style.cssText=t.style.cssText,d.style.display="none";const u=qe.tmpl(Us,{vid:o,index:i,video_h:r},!1);d.innerHTML=u;const p=t.parentNode;return p?(p.lastChild===t?p.appendChild(d):p.insertBefore(d,t.nextSibling),p.removeChild(t),e.container=d,s({iframe:d,vid:o,vh:r,vw:a,ratio:l,index:i,is_mp_video:/^wxv_.+$/.test(o||"")}),d):null}}}function Vs(){const e={txVideoReg:/^http(s)*\:\/\/v\.qq\.com\/iframe\/(preview|player)\.html\?/,mpVideoReg:/^http(s)*\:\/\/mp\.weixin\.qq\.com\/mp\/readtemplate\?t=pages\/video_player_tmpl/,video_iframe:[],video_top:[]};function t(e){console.info("iframe_onload");let t=0;try{const i=document.getElementsByTagName("html").item(0).style["-webkit-text-size-adjust"],n=e.contentDocument;if(n){const e=n.getElementsByTagName("html").item(0);e&&(e.style["-webkit-text-size-adjust"]=i)}Ee.on("menu:setfont",(()=>{const t=function(e){let t=0;return e.contentDocument&&e.contentDocument.body.offsetHeight?t=e.contentDocument.body.offsetHeight:e.Document&&e.Document.body&&e.Document.body.scrollHeight?t=e.Document.body.scrollHeight:e.document&&e.document.body&&e.document.body.scrollHeight&&(t=e.document.body.scrollHeight),t}(e);e.parentElement&&0!==t&&(e.style.height="".concat(t,"px"))})),e.contentDocument&&e.contentDocument.body.offsetHeight?t=e.contentDocument.body.offsetHeight:e.Document&&e.Document.body&&e.Document.body.scrollHeight?t=e.Document.body.scrollHeight:e.document&&e.document.body&&e.document.body.scrollHeight&&(t=e.document.body.scrollHeight);if(e.parentElement&&(e.style.height=t+"px"),/MSIE\s(7|8)/.test(navigator.userAgent)&&e.contentWindow&&e.contentWindow.document){const t=e.contentWindow.document.getElementsByTagName("html");t&&t.length&&(t[0].style.overflow="hidden")}const o=e.contentWindow.document,s=o.querySelectorAll(".vote_option_title .img_panel img"),a="data-prevent-longtap";for(const e of s){if("1"===e.getAttribute(a))continue;e.setAttribute(a,"1"),e.style["pointer-events"]="none",e.addEventListener("touchstart",(e=>e.preventDefault()));const t=e.parentNode,i=t.parentNode,n=o.createElement("div");n.setAttribute("style","\n          position: absolute;\n          left: 0;\n          top: 0;\n          width: 100%;\n          height: 100%;\n        "),i.style.position="relative",i.removeChild(t),n.appendChild(t),i.appendChild(n),n.addEventListener("touchstart",(()=>e.dispatchEvent(new MouseEvent("click"))),!0)}On&&On.postPageHeightMessage&&On.postPageHeightMessage("updatePageHeight"),console.log("financeUtils done"),Me.emitRenderNewHeightEvt()}catch(Mu){}}const i=[].slice.call(document.getElementsByTagName("iframe")),n=[],o=Math.ceil(1e4*Math.random());window.reportVid=[];for(let a=0,r=i.length;a<r;++a){const s=i[a],r=a;let l=s.getAttribute("data-src")||"";const d=s.className||"";let c=s.getAttribute("src")||l;if(!l||"#"===l){let e=s.getAttribute("data-display-src");if(e&&(0==e.indexOf("/cgi-bin/readtemplate?t=vote/vote-new_tmpl")||0==e.indexOf("https://mp.weixin.qq.com/cgi-bin/readtemplate?t=vote/vote-new_tmpl"))){e=e.replace(/&amp;/g,"&");const t=e.split("&"),i=["/mp/newappmsgvote?action=show"];t.forEach((e=>{0!=e.indexOf("__biz=")&&0!=e.indexOf("supervoteid=")||i.push(e)})),i.length>1&&(l=i.join("&")+"#wechat_redirect")}}if(c&&(e.txVideoReg.test(c)||e.mpVideoReg.test(c))||s.getAttribute("data-mpvid")&&s.getAttribute("data-mpvid").startsWith("wxv_")){const t=be.getQuery("vid",l)||s.getAttribute("data-mpvid"),i=(window.__videoPageInfos||[]).find((e=>e.video_id===t)),n=i&&i.hit_vid;if($.isShowMpVideo()||e.mpVideoReg.test(c)||"".concat(n).startsWith("wxv_")){if(!t)return;const i=s.getAttribute("data-vw"),n=s.getAttribute("data-vh");"qq.com"==document.domain&&((new Image).src="https://badjs.weixinbridge.com/badjs?id=139&level=4&from="+window.encodeURIComponent(window.location.host)+"&msg="+window.encodeURIComponent(window.location.href),ge.setLogs({id:27302,key:100,value:1,log:"[beforeD]"+window.encodeURIComponent(window.location.href)})),window.reportVid.push(t),c=["/mp/videoplayer?video_h=",n,"&video_w=",i,"&scene=",window.source,"&random_num=",o,"&article_title=",encodeURIComponent(window.msg_title.htmlDecode()),"&source=4&vid=",t,"&mid=",appmsgid,"&idx=",itemidx||idx,"&__biz=",biz,"&nodetailbar=",window.is_temp_url?1:0,"&uin=",uin,"&key=",key,"&pass_ticket=",pass_ticket,"&version=",version,"&devicetype=",window.devicetype||"","&wxtoken=",window.wxtoken||"","&sessionid=",window.sessionid||"","&preview=",window.is_temp_url?1:0,"&is_in_pay_subscribe=",window.isPaySubscribe,"&nickname=".concat(window.nickname),"&roundHeadImg=".concat(window.round_head_img),"&enterid=".concat(window.enterid),"&subscene=".concat(window.subscene)].join("");const a=Hs().createMpVideoDom(s,r,c);e.video_iframe.push({dom:a,vid:t})}}else if(l&&(l.indexOf("newappmsgvote")>-1&&(d.indexOf("js_editor_vote_card")>=0||d.indexOf("vote_iframe")>=0)||0==l.indexOf("http://mp.weixin.qq.com/bizmall/appmsgcard")&&(d.indexOf("card_iframe")>=0||d.indexOf("js_editor_card")>=0)||l.indexOf("appmsgvote")>-1||l.indexOf("mp.weixin.qq.com/mp/getcdnvideourl")>-1)){if(window.is_transfer_msg&&!window.reprint_ticket&&l.indexOf(window.biz)<0)return void n.push(s);if(window.__second_open__||(l=l.replace(/^http:/,location.protocol)),d.indexOf("card_iframe")>=0||d.indexOf("js_editor_card")>=0){-1===d.indexOf("card_iframe")&&(s.className+=" card_iframe"),-1===d.indexOf("res_iframe")&&(s.className+=" res_iframe");let e=l.replace("#wechat_redirect",["&pass_ticket=",pass_ticket,"&scene=",source,"&msgid=",appmsgid,"&msgidx=",itemidx||idx,"&version=",version,"&devicetype=",window.devicetype||"","&child_biz=",biz,"&wxtoken=",window.wxtoken||""].join(""));reprint_ticket&&(e+=["&mid=",mid,"&idx=",idx,"&reprint_ticket=",reprint_ticket,"&source_mid=",source_mid,"&source_idx=",source_idx].join("")),window.__second_open__?ye({url:e,type:"GET",f:"html",success:function(i){s.setAttribute("src",e),s.contentWindow.document.open("text/html","replace"),s.contentWindow.document.write(i),s.contentWindow.document.close(),s.contentWindow.history.replaceState(null,null,e),-1==l.indexOf("mp.weixin.qq.com/mp/getcdnvideourl")&&(s.onload=function(){t(s)})}}):(s.setAttribute("src",e),-1==l.indexOf("mp.weixin.qq.com/mp/getcdnvideourl")&&(s.onload=function(){t(s)}))}else{let e=l.indexOf("#wechat_redirect")>-1,i=["&uin=",uin,"&key=",key,"&pass_ticket=",pass_ticket,"&wxtoken=",window.wxtoken||""].join("");reprint_ticket?i+=["&mid=",mid,"&idx=",idx,"&reprint_ticket=",reprint_ticket,"&source_mid=",source_mid,"&source_idx=",source_idx,"&appmsg_token=",appmsg_token].join(""):(d.indexOf("vote_iframe")>=0||d.indexOf("js_editor_vote_card")>=0)&&(i+=["&mid=",mid,"&idx=",idx,"&appmsg_token=",appmsg_token].join(""),-1===d.indexOf("vote_iframe")&&(s.className+=" vote_iframe"));let n=e?l.replace("#wechat_redirect",i):l+i;window.__second_open__?ye({url:n,type:"GET",f:"html",success:function(e){s.contentWindow.Ajax=ye,s.setAttribute("src",n),s.contentWindow.document.open("text/html","replace"),s.contentWindow.document.write(e),s.contentWindow.document.close(),s.contentWindow.history.replaceState(null,null,n),-1==l.indexOf("mp.weixin.qq.com/mp/getcdnvideourl")&&(s.onload=function(){t(s)})}}):(s.setAttribute("src",n),-1==l.indexOf("mp.weixin.qq.com/mp/getcdnvideourl")&&(s.onload=function(){t(s)}))}s.appmsg_idx=a}}function s(){const t=window.pageYOffset||document.documentElement.scrollTop,i=e.video_top.length,n=t+We.getInnerHeight();let o=0;for(let s=0;s<i;s++){const t=e.video_top[s];t.reported?o++:n>=t.start&&n<=t.end&&(t.reported=!0,setTimeout(function(e,t,i){return function(){const n=Be.getVideoInfo();let o="",s="",a=3;n[e]&&(n[e].hit_bizuin&&(o=n[e].hit_bizuin),n[e].hit_vid&&(s=n[e].hit_vid),n[e].ori_status&&(a=n[e].ori_status)),K.report({step:1,hit_vid:s,hit_bizuin:o,ori_status:a,vid:e,screen_num:Math.ceil(t/i),screen_height:i})}}(t.vid,n,We.getInnerHeight()),1e4))}o==i&&(Ne.off(window,"scroll",s),e.video_top=null,e.video_iframe=null,s=null)}if(n.forEach((e=>e.parentNode.removeChild(e))),window.iframe_reload=function(){i.forEach((e=>{const i=e.getAttribute("src");i&&(i.indexOf("newappmsgvote")>-1||i.indexOf("appmsgvote")>-1)&&t(e)}))},"getElementsByClassName"in document){const e=document.getElementsByClassName("video_iframe");for(let t,i=0;t=e.item(i++);)t.setAttribute("scrolling","no"),t.style.overflow="hidden"}e.video_iframe.length>0&&setTimeout((()=>{const t=e.video_iframe,i=document.getElementById("js_article");for(let n=0,o=t.length;n<o;n++){const o=t[n];if(!o||!o.dom)return;let s=o.dom;const a=parseFloat(getComputedStyle(s).getPropertyValue("height"));let r=0;for(;s&&i!==s;)r+=s.offsetTop,s=s.offsetParent;e.video_top.push({start:r+a/2,end:r+a/2+We.getInnerHeight(),reported:!1,vid:o.vid})}s(),Ne.on(window,"scroll",s)}))}const Ks=[],$s='<span class="original_img_wrp">\n<span class="tips_global">来自: <#=source_nickname#></span>\n</span>';function Js(e){let t=e.getAttribute("data-src")||e.getAttribute("src"),i=be.getQuery("vid",t),n=e.getAttribute("data-vw"),o=e.getAttribute("data-vh"),s=e.getAttribute("data-ratio"),a=document.createElement("span");a.setAttribute("data-ratio",s),a.id="js_tx_video_container_"+Math.random(),a.className="js_tx_video_container",a.style.cssText=e.style.cssText,a.style.display="none";let r=e.parentNode;if(r)return r.lastChild===e?r.appendChild(a):r.insertBefore(a,e.nextSibling),Ht.createTxVideo({containerId:a.id,vid:i,width:n,height:o,autoplay:!1,allowFullScreen:!0,onSuccess:function(e){a.playerObj=e.player,function(e,t){if(!t||!e)return;let i=e.parentNode;if(!i)return;let n=[];for(let o=0,s=i.children.length;o<s;o++){let e=i.children[o];e.className.indexOf("js_img_placeholder")>=0&&e.getAttribute("data-vid")==t&&n.push(e)}for(let o=0,s=n.length;o<s;o++)i.removeChild(n[o]);e.style.display="block"}(a,i),a.style.display="block"},onError:function(){}}),r.removeChild(e),a}function Gs(){let e="27613";const t=Pe.getHeadimgTotalCount();Ye.getData({biz:biz,appmsg_type:appmsg_type,mid:mid,sn:sn,idx:idx,scene:source,subscene:window.subscene||0,ascene:1*window.ascene||0,title:msg_title,ct:ct,abtest_cookie:abtest_cookie,devicetype:devicetype,version:window.clientversion,is_need_ticket:Ks&&Ks.length>0?1:0,is_need_ad:0,comment_id:comment_id,is_need_reward:is_need_reward,both_ad:0,reward_uin_count:is_need_reward?t:0,send_time:window.send_time||"",msg_daily_idx:msg_daily_idx,item_show_type:window.item_show_type,is_original:0,is_only_read:is_only_read,req_id:window.req_id||"",pass_ticket:pass_ticket,is_temp_url:window.is_temp_url||0,rtId:e,rtKey:"50",appmsg_like_type:window.appmsg_like_type,is_pay_subscribe:window.isPaySubscribe,pay_subscribe_uin_count:window.isPaySubscribe?t:0,has_red_packet_cover:window.__appmsgCgiData.has_red_packet_cover,export_key:be.getQuery("exportkey"),export_key_extinfo:"",onSuccess:function(t){if(t)try{if(window.__second_open__&&t&&1*!!t.bizfile_ret==1&&(window.localStorage&&window.localStorage.setItem&&window.localStorage.setItem("isBanned-".concat(window.biz,"-").concat(window.mid,"-").concat(window.idx),"1"),window.location.href.indexOf("?")>-1?window.location.href=window.location.href+"&r="+Math.random()+"#wechat_redirect":window.location.href=window.location.href+"?r="+Math.random()+"#wechat_redirect"),c.commit("SET_EXT_RES",t),window.__second_open__&&t.pay_subscribe_info&&1*t.pay_subscribe_info.is_paid!=isPaid)return et.report110809(11),(new Image).src="https://badjs.weixinbridge.com/badjs?id=244&level=4&from="+window.encodeURIComponent(window.location.host)+"&msg="+window.encodeURIComponent(window.location.href),void Ee.invoke("handleMPPageAction",{action:"paySuccess",fullUrl:window.location.href,itemShowType:window.item_show_type,url:location.href},(e=>{e.err_msg.indexOf("ok")>-1?et.report110809(19):et.report110809(20),window.localStorage&&window.localStorage.setItem&&window.localStorage.setItem("isPaid-".concat(window.biz,"-").concat(window.mid,"-").concat(window.idx),"1"),window.location.href=window.location.href+"&r="+Math.random()+"#wechat_redirect"}));if(t&&t.base_resp&&t.base_resp.wxtoken&&(window.wxtoken=t.base_resp.wxtoken),window.fromWeixinCached&&Vs(),function(e){if(!e||!e.img_copy_info||!e.img_copy_info.list)return;let t={},i=e.img_copy_info.list,n=window.__appmsgCgiData.copyright_stat,o=window.__appmsgCgiData.source_biz;for(let a=0,r=i.length;a<r;a++){let e=i[a];if(2==e.type){if(2==n&&o==e.source_uin)continue;t[e.img_url]={source_nickname:e.source_nickname,source_uin:e.source_uin,source_encode_biz:e.source_encode_biz||""}}}let s=document.getElementsByTagName("img");for(let a=0,r=s.length;a<r;a++){let e=s[a],i=e.getAttribute("data-src")||e.getAttribute("data-backsrc")||"";if(t[i]){let n=document.createElement("div");n.innerHTML=qe.tmpl($s,t[i],!1);let o=n.children[0],s=e.parentNode.insertBefore(o,e),a=s.children[0];!function(e,t){Ne.on(t,"click",(function(t){let i="https://mp.weixin.qq.com/mp/profile_ext?action=home&__biz="+e.source_encode_biz+"&scene=112#wechat_redirect";return Ae.isWindowsWechat||Ae.isMacWechat?(location.href=i,!1):(Ee.invoke("openUrlWithExtraWebview",{url:i,openType:1},(function(e){-1==e.err_msg.indexOf("ok")&&(location.href=i)})),!1)}))}(t[i],a),s.insertBefore(e,a)}}}(t),t.ret)return;t.red_packet_cover_data&&t.red_packet_cover_data.cover_uri_data&&t.red_packet_cover_data.cover_uri_data.length>0&&(J.init(),J.render({list:t.red_packet_cover_data.cover_uri_data})),t.link_component_list&&t.link_component_list.length&&zs.updateCpslinkStatus(t.link_component_list),window.lastText=t.effective_content_last_html_node,G.setLastTextNode(),G.setLastTextMsg(),window.isFans=t.is_fans,function(e){let t=e.appmsgstat||{};const i=e.appmsgact||{},n=e.paySubscribeInfo||{};window.paySubscribeInfo=n,window.isFans=e.is_fans,window.appmsgstat||(window.appmsgstat=t),st(),Os.initAuthorName(e.reward,{reward_entrance_enable_for_preview:e.reward_entrance_enable_for_preview}),window.isPaySubscribe&&_.init(n,c);const o=document.querySelector("#js_star");if(o){const e=localStorage.getItem("star_info");let i=1*t.star_num||0;if(e){const t=JSON.parse(e);Number(t.mid)===Number(window.mid)&&t.has_star&&0===i&&(i=1)}ti(o,i,t.star_status)}let s=[];const{old_liked_before:a,seen_before:r,favorite_before:l,share_before:d,reward_before:u,pay_before:p}=i,{old_liked:h,liked:m}=t;(h||a)&&s.push("like"),(m||r)&&s.push("zaikan"),l&&s.push("collect"),d&&s.push("share"),u&&s.push("reward"),p&&s.push("pay"),window.is_like_profile_gray=e.show_biz_banner,window.is_like_profile_gray&&s.push("gray"),(s.length>0||Qo)&&c.commit("mp-like-profile/setSources",s),e.close_related_article&&c.commit("mp-related-article/setNotLoad",!0),t.old_liked||i.old_liked_before?c.commit("mp-related-article/setSources",["praised",!0]):t.liked||i.seen_before?c.commit("mp-related-article/setSources",["liked",!0]):i.favorite_before?c.commit("mp-related-article/setSources",["favorited",!0]):i.share_before?c.commit("mp-related-article/setSources",["shared",!0]):Qo?c.commit("mp-related-article/setSources",["recommend",!0]):e.show_related_article?c.commit("mp-related-article/setSources",["force",!0]):i.reward_before?c.commit("mp-related-article/setSources",["rewarded",!0]):i.pay_before&&c.commit("mp-related-article/setSources",["paid",!0])}({show_biz_banner:t.show_biz_banner,appmsgstat:t.appmsgstat,appmsgact:t.appmsgact,comment_enabled:t.comment_enabled,comment_count:t.comment_count,only_fans_can_comment:t.only_fans_can_comment,only_fans_days_can_comment:t.only_fans_days_can_comment,is_fans_days:t.is_fans_days,reward:{reward_total:t.reward_total_count,is_reward_total_count_cut:t.is_reward_total_count_cut,reward_head_img_infos:t.reward_head_img_infos||[],can_reward:t.can_reward,user_can_reward:t.user_can_reward,timestamp:t.timestamp,reward_author_head:t.reward_author_head,rewardsn:t.rewardsn,scene:source,is_need_reward:is_need_reward,title:msg_title,author_id:author_id,appmsgextRtId:e,appmsgextRtKey:"50",can_whisper:t.can_whisper},reward_entrance_enable_for_preview:t.reward_entrance_enable_for_preview,reward_wording:t.reward_wording,reward_author_head:t.reward_author_head,comment_entrance_enable_for_preview:t.comment_entrance_enable_for_preview,share_redirect_url:t.share_redirect_url||"",logo_url:t.logo_url,nick_name:t.nick_name,is_fans:t.is_fans,paySubscribeInfo:t.pay_subscribe_info,share_flag:t.share_flag,test_flag:t.test_flag,show_related_article:t.show_related_article,close_related_article:t.close_related_article,related_article_fast_close:t.related_article_fast_close,hit_bizrecommend:t.hit_bizrecommend}),window.ext_complete_success=!0,je.emit("ext-complete-success")}catch(Mu){return Se.log("[Appmsg] error parse async data, biz="+biz+", mid="+mid),ge.setLogs({id:24729,key:1,value:1,log:"biz:".concat(biz,",mid:").concat(mid,",uin:").concat(uin,",[key1]").concat(encodeURIComponent(Mu.toString())).substring(0,1024)}),console&&console.error(Mu),void(void 0!==window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&WX_BJ_REPORT.BadJs.onError(Mu))}},onError:function(){ge.setLogs({id:24729,key:2,value:1,log:"biz:".concat(biz,",mid:").concat(mid,",uin:").concat(uin,",[key2]ajax_err")})},onComplete:function(){window.ext_complete=!0,Ae.isOnlyWechat||(console.warn("window.ext_complete_success:",window.ext_complete_success),window.ext_complete_success=!0),je.emit("ext-complete")}})}function Xs(){!function(){let e=document.getElementsByTagName("iframe"),t=[];for(let o=0,s=e.length;o<s;++o)t.push(e[o]);e=null;let i=document.getElementById("js_content").offsetWidth,n=i/K.getRatio();window.logs.video_cnt=0;for(let o=0,s=t.length;o<s;++o){let e=t[o],s=e.getAttribute("data-src")||"",a=e.getAttribute("src")||s;if(a)if(0==a.indexOf("http://z.weishi.com/weixin/player.html"))a=a.replace(/width=\d+/g,"width="+i),a=a.replace(/height=\d+/g,"height="+n),e.width=i,e.height=n,e.style.setProperty&&(e.style.setProperty("width",i+"px","important"),e.style.setProperty("height",n+"px","important")),e.setAttribute("src",a),window.__addIdKeyReport&&window.__addIdKeyReport("28307",10),window.logs.video_cnt++;else{if(/http(s)*\:\/\/v\.qq\.com\/iframe\/(preview|player)\.html\?/.test(a)){const t=be.getQuery("vid",s)||e.getAttribute("data-mpvid"),i=(window.__videoPageInfos||[]).find((e=>e.video_id===t)),n=i&&i.hit_vid;if(!$.isShowMpVideo()&&!"".concat(n).startsWith("wxv_")){const t=Js(e);t&&Ks.push(t),"function"==typeof window.__addIdKeyReport&&(window.__addIdKeyReport("28307",10),Ae.isWechat&&Ae.isWindowsWechat?window.__addIdKeyReport("110644",0):Ae.isWechat&&Ae.isMacWechat&&window.__addIdKeyReport("110644",1))}window.logs.video_cnt++;continue}/^http(s)*\:\/\/mp\.weixin\.qq\.com\/mp\/readtemplate\?t=pages\/video_player_tmpl/.test(a)&&window.logs.video_cnt++}}Ks.length>0&&"function"==typeof window.__getVideoWh&&Ne.on(window,"resize",(function(){try{for(let e=0,t=Ks.length;e<t;e++){let t=Ks[e],i=t.playerObj;if(i){let e=window.__getVideoWh(t);t.style.width=e.w+"px",t.style.height=e.h+"px",i.resize({width:e.vw,height:e.vh})}}}catch(Mu){}}),!1)}(),Gs()}document.querySelectorAll("mp-common-product");const Ys=window.user_uin||0,Qs=Math.floor(Ys/100)%1e3,Zs=0!==Ys&&Qs<1001;function ea(e,t){window.logs.img={download:{},read:{},load:{}};const i=document.getElementById("js_cover");if(i){let e=i.getAttribute("data-src");e&&(e.isCDN()&&(e=e.imgChange640(),t&&(e=At(e)),e=Ie(e,5),is_https_res||Zs?e=e.http2https():"http:"!=location.protocol&&-1==navigator.userAgent.indexOf("MicroMessenger")||(e=e.https2http())),setTimeout((function(){i.onload=function(){ii.setProperty(i,"height","auto","important"),ii.setProperty(i,"visibility","visible","important")},i.setAttribute("src",e)}),0),window.logs.img.read[e]=!0,window.logs.img.load[e]=!0,i.removeAttribute("data-src"))}function n(e){return parseInt(e,10)||0}window.logs.outer_pic=0;const o=document.getElementsByTagName("img");for(let a=0,d=o.length;a<d;a++){const e=o[a].getAttribute("data-src");e&&e.isGif()&&o[a].classList.add("__bg_gif")}const s=document.getElementsByClassName("__bg_gif");for(let a=0,d=s.length;a<d;++a)s[a].setAttribute("data-order",a);const r=function(e){try{let t=e.childNodes,i=getComputedStyle(e);(i.backgroundImage.match(/https\:\/\/mmbiz\.qpic\.cn/)||i.backgroundImage.match(/http\:\/\/mmbiz\.qpic\.cn/))&&window.__addIdKeyReport("111535",2);for(let e=0;e<t.length;e++)"a"!=t[e].tagName.toLowerCase()&&r(t[e])}catch(Mu){}};try{const e=document.getElementsByTagName("a");for(let t=0;t<e.length;t++){const i=e.item(t);null!=(i.getAttribute("href")||"").match(/^http/)&&r(i)}}catch(Mu){}let l=!1;window.isCartoonCopyright||window.is_care_mode||new Vo({attrKey:"data-src",imgOccupied:!0,crossOrigin:!0,inImgRead(e){e&&(window.logs.img.read[e]=!0)},changeSrc(i,n,o,s){if(!i)return"";if(window.__offlineCacheScheme)return i.offline();let a=i;if(i.isCDN())a=a.imgChange640(),e&&a.canHevc()?(a=Et(a,!1),window.__addIdKeyReport("28307",91)):t?(a=At(a),window.__addIdKeyReport("28307",84)):a=xe(a,"tp","nowebp",!0),a=Ie(a,"img"===s?5:15),is_https_res||Zs?(a=a.http2https(),window.__addIdKeyReport("28307",77)):"http:"!=location.protocol&&-1==navigator.userAgent.indexOf("MicroMessenger")||(a=a.https2http(),window.__addIdKeyReport("28307",70));else try{new RegExp("^http(s)?://((mmbiz.qpic.cn/.*)|(m.qpic.cn/.*)|(mmsns.qpic.cn/.*)|(shp.qpic.cn/.*)|(puui.qpic.cn/.*)|(wx.qlogo.cn/.*)|(mmbiz.qlogo.cn/.*)|((a|b)[0-9]*.photo.store.qq.com/.*)|(mp.weixin.qq.com/.*)|(res.wx.qq.com/.*))").test(i)||(window.__addIdKeyReport("28307",9),window.logs.outer_pic++)}catch(Mu){}return a=a.replace(/^http\:\/\/(a|b)(\d)+\.photo\.store\.qq\.com/g,"http://m.qpic.cn"),/^http(s)?:\/\/m\.qpic\.cn([\/?].*)*$/i.test(a)&&!t&&(a=xe(a,"t","",!0)),a=xe(a,"wx_lazy","1",!0),"anonymous"==n.crossOrigin&&(a=xe(a,"wx_co","1",!0)),console.log(a,s,a.isJpg(),i),!Pt()||"img"!==s&&!a.isJpg()||a.isGif()||(a=Lt(a)),Dt(a)&&window.__addIdKeyReport("28307",106),window.logs.img.load[a]=!0,Se.log("[Appmsg] image_load_event_change_src. originsrc:"+i+"  ^^^ newsrc : "+a),n.start_load_time=+new Date,a},onerror(e,t,i,o){let s,a=t&&t.__retryload||0;if("img"===o&&a>=2&&function(e,t,i){const o=i;!o||(o.width<40||o.height<40)&&(n(o.style.width)<40||n(o.style.height)<40)||o.classList.contains("wx_img_placeholder_err")||(o.classList.add("wx_img_placeholder_err"),o.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==",window.__addIdKeyReport("28307",51),o.bindRetry||(o.bindRetry=!0,Ne.on(o,"click",(()=>(window.__addIdKeyReport("28307",66),o.classList.remove("wx_img_placeholder_err"),e=e.https2http(),t.__retryload++,t.src=xe(e,"retryload",t.__retryload,!0),!1)))))}(e,t,i),!e||a>2)return;if(!e.isCDN()){if(!Pt())return;if(!Dt(e))return}const r=0==e.indexOf("https://")?7:0;window.__addIdKeyReport("28307",72+r),a<=1&&window.__addIdKeyReport("28307",75+1*a+r),e.isWxpic()?(window.__addIdKeyReport("28307",93),window.WX_BJ_REPORT&&WX_BJ_REPORT.BadJs.report("imgError:hevc",e,{mid:"mmbizwap:imgMonitor",view:"wap_appmsg"}),a<=1&&window.__addIdKeyReport("28307",96+1*a)):e.isWebp()?(window.__addIdKeyReport("28307",86),window.WX_BJ_REPORT&&WX_BJ_REPORT.BadJs.report("imgError:webp",e,{mid:"mmbizwap:imgMonitor",view:"wap_appmsg"}),a<=1&&window.__addIdKeyReport("28307",89+1*a)):window.WX_BJ_REPORT&&WX_BJ_REPORT.BadJs.report("imgError",e,{mid:"mmbizwap:imgMonitor",view:"wap_appmsg"}),Dt(e)&&window.__addIdKeyReport("28307",108),"img"===o&&a<2&&(a++,t.__retryload=a,1==a&&e.indexOf("http://")>-1?(e=e.http2https(),window.__addIdKeyReport("28307",60),window.__addIdKeyReport("28307",77)):1==a&&e.indexOf("https://")>-1?(window.__addIdKeyReport("28307",61),window.__addIdKeyReport("28307",77)):2==a&&e.indexOf("mmbiz.qpic.cn")>-1&&(e=e.replace("mmbiz.qpic.cn","mmbiz.qlogo.cn")).indexOf(!1)&&(e=e.http2https()),Dt(e)&&(e=Rt(e)),t.start_load_time=+new Date,s=e=xe(e,"retryload",a,!0)),window.__has_imgfailed||(window.__has_imgfailed=!0,window.__addIdKeyReport("28307",65)),Se.log("[Appmsg] image_load_event_on_error. src:"+e),t.setAttribute("data-fail",1);try{if("[object Array]"==Object.prototype.toString.call(t.lazyLoadOnerror))for(let e=0,i=t.lazyLoadOnerror.length;e<i;e++)"function"==typeof t.lazyLoadOnerror[e]&&t.lazyLoadOnerror[e].call(t)}catch(Mu){}let l=10;return/tp\=webp/.test(e)&&(l=11),ge.setLogs({id:24729,key:l,value:1,log:encodeURIComponent(e)+"["+uin+"]"}),s},onload(e,t,i){var n;if(!window.__second_open__&&!l){const e=window.performance||window.msPerformance||window.webkitPerformance;if(!e||!e.timing)return;const t=window.location.protocol;a.saveSpeeds({uin:uin,pid:"https:"==t?462:417,speeds:{sid:35,time:Date.now()-e.timing.navigationStart}}),a.send(),l=!0}"img"===i&&(null==(n=null==t?void 0:t.classList)||n.remove("wx_img_placeholder_err"),t.gray&&!t.loadGif&&((t.width||t.naturalWidth)<120||(t.height||t.naturalHeight)<120?t.autoTap&&t.autoTap():t.span&&t.span.children&&t.span.children.item(0)&&(t.span.children.item(0).style.display="")));let o=t&&t.__retryload||0;if(o>2)return;Se.log("[Appmsg] image_load_event_onload_image. src:"+e+"  ^^^  retryloadtimes: "+o),t.setAttribute("data-fail",0),"img"===i&&function(e){try{const t=e.getAttribute("data-src");if(!/^https?\:\/\/mmbiz\.qpic\.cn/.test(t))return;let i=e.parentNode,n=!1;Ce.hasClass(i,"js_jump_icon")&&(n=!0);let o=!1;for(;i.tagName&&"body"!=i.tagName.toLowerCase();){if("a"==i.tagName.toLowerCase()){null!=(i.getAttribute("href")||"").match(/^http/)&&(o=!0);break}i=i.parentNode}if(n&&!o){let t=e.parentNode,i=t.parentNode;if(i){let e=document.createDocumentFragment();for(;t.firstChild;)e.appendChild(t.firstChild);i.insertBefore(e,t),i.removeChild(t)}}else if(!n&&o){let t=document.createElement("span"),i=getComputedStyle(e);"static"!=i.positon&&(t.style.position=i.positon),t.style.left=i.left,t.style.top=i.top,t.style.right=i.right,t.style.bottom=i.bottom,t.style.margin=i.margin,Ce.addClass(t,"js_jump_icon"),Ce.addClass(t,"h5_image_link"),e.style.position="static",e.style.margin="0px",e.parentNode.insertBefore(t,e),t.appendChild(e),window.__addIdKeyReport("111535",0)}}catch(Mu){}}(t);try{if("[object Array]"==Object.prototype.toString.call(t.lazyLoadOnload))for(let e=0,i=t.lazyLoadOnload.length;e<i;e++)"function"==typeof t.lazyLoadOnload[e]&&t.lazyLoadOnload[e].call(t)}catch(Mu){}const s=0==e.indexOf("https://")?7:0;window.__addIdKeyReport("28307",71+s),o<=1&&window.__addIdKeyReport("28307",73+1*o+s),e.isWxpic()?(window.__addIdKeyReport("28307",92),o<=1&&window.__addIdKeyReport("28307",94+1*o)):e.isWebp()&&(window.__addIdKeyReport("28307",85),o<=1&&window.__addIdKeyReport("28307",87+1*o)),Dt(e)&&window.__addIdKeyReport("28307",107),window.__has_imgsucceed||(window.__has_imgsucceed=!0,window.__addIdKeyReport("28307",64)),1==o&&e.indexOf("http://")>-1&&window.__addIdKeyReport("28307",50),1==o&&e.indexOf("https://")>-1&&window.__addIdKeyReport("28307",52);const r=Math.random(),d=+new Date-t.start_load_time;d&&0==e.indexOf("https://")&&r<.5?(window.__addIdKeyReport("27822",121,d),window.__addIdKeyReport("27822",122)):d&&r<5e-4&&(window.__addIdKeyReport("27822",124,d),window.__addIdKeyReport("27822",125)),"img"!==i||""===t.style.filter||"none"===t.style.filter||/translate(Z|3d)\(/.test(t.style.transform)||(t.style.transform+=" translateZ(0)",t.style.webkitTransform+=" translateZ(0)")},detect(e){if(!e||!e.time||!e.loadList)return;const t=e.time,i=e.loadList;window.logs&&window.logs.img&&window.logs.img.download&&(window.logs.img.download[t]=i)},container:document.getElementById("page-content")})}function ta(){const e=document.getElementById("js_read_container"),t={player:null,srcId:"__wxtag__".concat(window.biz,"-").concat(window.mid,"-").concat(window.idx),mediaId:"",tag:"===mediaId-sep===",playDuration:0,playTime:0,maxNum:5,curNum:0,format:"",type:6,speed:100,voiceInfo:{title:"",nickname:"",appmsgUrl:"",duration:0},voiceOpt:null,lock:!1,status:"stop",currentTime:0,beginTime:0,leaveNeedReport:!1,pause2PlayNeedReport:!1,isSeek:!1,loadingTimer:null},i=e=>"".concat(e,"&uin=").concat(window.uin,"&key=").concat(window.key,"&pass_ticket=").concat(encodeURIComponent(window.pass_ticket)),n=()=>{if(t.curNum>10)return(e=>{if(!e&&null!==t.loadingTimer)return clearTimeout(t.loadingTimer),void(t.loadingTimer=null);Ee.invoke("handleMPPageAction",{action:"showToast",status:e?"loading":"dismissloading"})})(!1),t.lock=!1,void window.weui.alert("系统繁忙，请稍后再试");t.curNum++;const e=t.curNum>t.maxNum?5e3:1e3;ye({url:"/mp/msgvoice?action=getvoiceinfo&__biz=".concat(window.biz,"&mid=").concat(window.mid,"&idx=").concat(window.idx,"&sn=").concat(window.sn,"&type=").concat(t.type,"&speed=").concat(t.speed),type:"GET",dataType:"json",async:!0,success:s=>{if(s&&s.base_resp&&0===s.base_resp.ret)if(s.mediaid){t.mediaId=s.mediaid;const e=encodeURIComponent("__biz=".concat(window.biz,"&mid=").concat(window.mid,"&idx=").concat(window.idx)),n=t.voiceInfo;t.voiceOpt={protocol:2===s.format?"hls":"",src:i("https://mp.weixin.qq.com/mp/msgvoice?action=get_voice&mediaid=".concat(s.mediaid,"&devicetype=").concat(window.devicetype,"&_type=").concat(t.type,"&speed=").concat(t.speed,"&encodeurl=").concat(e)),lowbandUrl:i("https://mp.weixin.qq.com/mp/msgvoice?action=get_voice&mediaid=".concat(s.mediaid,"&devicetype=").concat(window.devicetype,"&_type=").concat(t.type,"&speed=").concat(t.speed,"&encodeurl=").concat(e)),title:n.title,epname:"来自文章",singer:n.nickname?"".concat(n.nickname,"的语音"):"公众号语音",srcId:t.srcId+t.tag+t.mediaId,coverImgUrl:"",webUrl:n.appmsgUrl,musicbar_url:"https://mp.weixin.qq.com/mp/msgvoice?action=ttspage&__biz=".concat(window.biz,"&mid=").concat(window.mid,"&idx=").concat(window.idx,"&sn=").concat(window.sn,"&type=").concat(t.type,"#wechat_redirect"),needStartMusicUI:0},o()}else setTimeout(n,1e3);else console.log("getvoiceinfo err",s),setTimeout(n,e)},error:t=>{console.log("getvoiceinfo err",t),setTimeout(n,e)}})},o=()=>{t.player=ut.init({protocal:"hls",wxIndex:t.voiceOpt.srcId,type:7,comment_id:"",src:t.voiceOpt.src,jsapi2Src:t.voiceOpt.src+"&voice_type=1",allowPause:!0,duration:t.voiceInfo.duration,title:t.voiceOpt.title,singer:t.voiceOpt.singer,epname:t.voiceOpt.epname,coverImgUrl:t.voiceOpt.coverImgUrl,playingCss:"share_audio_playing",playCssDom:e.getElementsByClassName("js_read_main")[0],playArea:e.getElementsByClassName("js_read_play")[0],progress:e.getElementsByClassName("js_read_progress")[0],fileSize:0,playtimeDom:e.getElementsByClassName("js_read_playtime")[0],bufferDom:e.getElementsByClassName("js_read_buffer")[0],playdotDom:e.getElementsByClassName("js_read_playdot")[0],seekRange:e.getElementsByClassName("js_read_seekRange")[0],seekContainer:e.getElementsByClassName("js_read_main")[0],loadingDom:e.getElementsByClassName("js_read_loading")[0],detailArea:"",detailUrl:t.voiceOpt.musicbar_url,webUrl:t.voiceOpt.musicbar_url})};ye({url:"/mp/msgvoice?action=ttspage&__biz=".concat(window.biz,"&mid=").concat(window.mid,"&idx=").concat(window.idx,"&sn=").concat(window.sn,"&type=").concat(t.type,"&f=json"),type:"GET",dataType:"json",async:!0,success:i=>{i&&i.base_resp&&0===i.base_resp.ret?(t.voiceInfo={title:i.title,nickname:i.nickname,appmsgUrl:i.appmsg_url,duration:1*i.voice_info.duration},n(),e.getElementsByClassName("js_read_duration")[0].innerHTML=(e=>{const t=e=>e>=10?e:"0".concat(e);return"".concat(t(Math.floor(e/60)),":").concat(t(e%60))})(1*i.voice_info.duration)):window.weui.alert("系统繁忙，请稍后再试")},error:e=>{console.log("ttspage err: ",e),window.weui.alert("网络不可用，请检查网络设置")}})}const ia=!Ae.isWechat||Ae.isWindowsWechat||Ae.isMacWechat||Ae.isNewMpApp,na=Ae.isAndroid&&window.clientversion<"28002A00"||Ae.isIOS&&window.clientversion<"18002824",oa=Ae.isAndroid&&window.clientversion<"28002800"||Ae.isIOS&&window.clientversion<"18002831",sa=e=>e?ut.encodeStr(e).replace(/^\s/,"").replace(/\s$/,""):"";class aa{constructor(){this.validTagLen=0,this.adapter={1:pt,2:ht},this.tagMap={qqmusic:{eles:[],isClMusic:!1,watchAttrs:[],renderTag:"mp-common-qqmusic"},"mp-common-qqmusic":{eles:[],isClMusic:!1,watchAttrs:["musicid"],renderTag:"mp-common-qqmusic"},"mp-common-clmusic":{eles:[],isClMusic:!0,type2Wording:{1:"音乐",2:"专辑",3:"歌单"},renderTag:"mp-common-clmusic",watchAttrs:["listenid","categoryid"]}},this.tagNameList=Object.keys(this.tagMap),this.validateEnv()&&(this.renderTag(),console.log("➜ music tag",this.tagMap),this.renderCard())}validateEnv(){try{const e=document.querySelector("#js_content");return this.tagNameList.forEach((t=>{this.tagMap[t].eles=Array.from(e.querySelectorAll(t))})),this.validTagLen=this.tagNameList.reduce(((e,t)=>e+this.tagMap[t].eles.length),0),!!this.validTagLen}catch(e){return console.error("validateEnv err",e),!1}}renderTag(){this.tagNameList.forEach((e=>{const t=this.tagMap[e],{renderTag:i,eles:n}=t;n.forEach(((t,o)=>{if(i!==e){const e=((e,t)=>{const i=document.createElement(t);for(const n of e.attributes)i.setAttribute(n.name,n.value);return i.innerHTML=e.innerHTML,e.parentNode.replaceChild(i,e),i})(t,i);this.tagMap[i].eles.push(e),n.splice(o,1,null)}})),t.eles=n.filter((e=>e))}))}renderCard(){this.batchGetClMusicInfo().then((()=>{this.tagNameList.forEach((e=>{const t=this.tagMap[e],{eles:i,watchAttrs:n,isClMusic:o}=t;i.forEach(((e,t)=>{Ce.addClass(e,"js_wx_tap_highlight");let i={isClMusic:o,posIndex:t,media_id:sa(e.getAttribute("mid"))||"",singer:sa(e.getAttribute("singer"))||"",albumid:sa(e.getAttribute("albumid"))||"",otherid:sa(e.getAttribute("otherid"))||"",musicid:sa(e.getAttribute("musicid"))||"",albumurl:sa(e.getAttribute("albumurl"))||"",audiourl:sa(e.getAttribute("audiourl"))||"",listenId:sa(e.getAttribute("listenid"))||"",clMusicType:parseInt(e.getAttribute("type"))||"",musictype:parseInt(e.getAttribute("musictype"))||1,music_name:sa(e.getAttribute("music_name"))||"",jumpurlkey:sa(e.getAttribute("jumpurlkey"))||"",categoryId:sa(e.getAttribute("categoryid"))||"",duration:parseInt(e.getAttribute(o?"duration":"play_length")||0,10)};if(i.musictype>2&&(i.musictype=2),!i.singer){const t=e.getAttribute("src")||"",n=decodeURIComponent(be.getQuery("singer",t)||"");i.singer=sa(n)||""}o?(i.type=11,i.pauseCss="",i.allowPause=!1):this.adapter[i.musictype]&&"function"==typeof this.adapter[i.musictype].initData&&(i=this.adapter[i.musictype].initData(i,{scene:0}),e.setAttribute("albumurl",i.albumurl)),e.setAttribute("posindex",t),this.reRenderCard(e,n),o&&!e.isErrStatus?1!==i.clMusicType||na||ia?this.bindEvent(e,i):this.renderPlayer(e,i):o||this.renderPlayer(e,i)}))}))}))}reRenderCard(e,t=[]){e&&t.forEach((t=>{const i=e.getAttribute(t);i&&(e.removeAttribute(t),e.setAttribute(t,i))}))}renderPlayer(e,t){setTimeout((()=>{Se.log("[Music] init "+t.detailUrl);const i="".concat(t.musicid||t.listenId,"_").concat(t.posIndex);var n;t.player=ut.init({epname:"音乐",mid:t.media_id,singer:t.singer,songId:t.musicid,type:t.type||0,otherid:t.otherid,albumid:t.albumid,wxIndex:t.posIndex,duration:t.duration,listenId:t.listenId,webUrl:t.webUrl||"",isClMusic:t.isClMusic,coverImgUrl:t.albumurl,jumpurlkey:t.jumpurlkey,playingCss:"share_audio_playing",pauseCss:t.pauseCss||"",allowPause:!!t.allowPause,title:(n=t.music_name,n?ut.decodeStr(n):""),detailUrl:t.detailUrl||"",playArea:e.shadowRoot.querySelector("#music_play_".concat(i)),playCssDom:e.shadowRoot.querySelector("#music_main_".concat(i)),detailArea:e.shadowRoot.querySelector("#music_home_".concat(i))})}),0)}bindEvent(e,t){setTimeout((()=>{const i=t.clMusicType,n="".concat(t.listenId||t.categoryId,"_").concat(t.posIndex),o=e.shadowRoot.querySelector("#music_main_".concat(n)),s=e.shadowRoot.querySelector("#music_play_".concat(n));o&&Ne.on(o,"click",(()=>{if(ia)(window.weui||window).alert("请在手机微信内操作");else if(1===i&&na||(2===i||3===i)&&oa)Ee.invoke("confirmDialog",{title:"当前版本暂不支持，请更新至微信最新版本",confirmText:"去更新",cancelText:"取消"},(e=>{-1!==e.err_msg.indexOf(":ok")?location.href=Ae.isIOS?"https://itunes.apple.com/cn/app/id414478124?mt=8&ls=1":"https://support.weixin.qq.com/update/":-1!==e.err_msg.indexOf("system:")&&(window.weui||window).alert("当前版本暂不支持，请更新至微信最新版本")}));else{const t=sa(e.getAttribute("categoryid"))||"";Ee.invoke("openTingView",{action:"openCategory",category_id:t,sync_get:!0},(e=>{console.log("["+t+"], res: "+JSON.stringify(e))}))}})),s&&(Ne.on(s,"mousedown",(e=>e.stopPropagation())),Ne.on(s,"touchstart",(e=>e.stopPropagation())))}),0)}batchGetClMusicInfo(){return new Promise(((e,t)=>{const i=this.tagMap["mp-common-clmusic"],n=i.eles;if(!n.length)return void e();const o=this,s={count:n.length};n.forEach(((e,t)=>{const i=1*e.getAttribute("type");s["type".concat(t)]=i,s["source".concat(t)]=1*e.getAttribute("music_source"),s["username".concat(t)]=e.getAttribute("username")||"",s["id".concat(t)]=e.getAttribute(1===i?"listenid":"categoryid")||""})),ye({url:"/mp/finder_music_appmsg?action=get",type:"POST",async:!0,dataType:"json",data:s,success(t){var s;if(0===(null==(s=null==t?void 0:t.base_resp)?void 0:s.ret)){const e=t.music_info_list||[];n.forEach((t=>{const n=1*t.getAttribute("type"),s=t.getAttribute(1===n?"listenid":"categoryid")||"",a=e.find((e=>e.id===s));if(a){const{flag:e}=a;switch(1*e!=0&&(t.isErrStatus=!0),1*e){case 0:o.updateClMusicCardInfo(t,a),t.setAttribute("verify_err","");break;case 1:t.setAttribute("verify_err","".concat(i.type2Wording[n],"暂时无法播放"));break;case 2:t.setAttribute("verify_err","".concat(i.type2Wording[n],"已被作者删除"));break;case 3:t.setAttribute("verify_err","".concat(i.type2Wording[n],"已被设置为私密"));break;case 4:t.setAttribute("verify_err","因作者隐私设置，暂时无法查看该内容")}}}))}e()},error:e})}))}updateClMusicCardInfo(e,t){const{type:i}=t,n=t.user_info||{};let o={};switch(1*i){case 1:o=t.music;break;case 2:o=t.album;break;case 3:o=t.playlist}e.setAttribute("count",o.item_num||0);try{const t=new URL(e.getAttribute("albumurl")||""),i=new URLSearchParams(t.search);i.delete("picformat");const n=new URL(o.cover||"");"".concat(t.origin).concat(t.pathname,"?").concat(i.toString())!=="".concat(n.origin).concat(n.pathname).concat(n.search)&&e.setAttribute("albumurl",o.cover||"")}catch(s){console.error(s)}e.setAttribute("singer",n.nickname||o.author||""),e.setAttribute("duration",o.duration||""),e.setAttribute("avatar",n.headimg_url||""),e.setAttribute("music_name",o.name||o.title||"")}}const ra=32561,la=293511,da=Ae.isIOS&&Ae.getInner()>="18003238"||Ae.isAndroid&&Ae.getInner()>="28003259",ca=Ae.isIOS&&Ae.getInner()>="18003238"||Ae.isAndroid&&Ae.getInner()>="28003258";let ua="";const pa=({listenId:e,onSuccess:t,onError:i,onComplete:n,scene:o=0})=>{ge.setSum(la,11,1),ye({url:"/mp/listenplayer?action=add_to_playlist&__biz=".concat(window.biz,"&appmsgid=").concat(window.mid,"&idx=").concat(window.idx),type:"POST",dataType:"json",async:!0,data:{data:JSON.stringify({listen_id:e,scene:o})},success:e=>{e&&e.base_resp&&0===e.base_resp.ret?"function"==typeof t&&t(e):("function"==typeof i&&i(),ge.setSum(la,14,1))},error:()=>{"function"==typeof i&&i(),ge.setSum(la,14,1)},complete:()=>{"function"==typeof n&&n()}})},ha=({listenId:e,onSuccess:t,onError:i,onComplete:n})=>{ge.setSum(la,39,1),ye({url:"/mp/listenplayer?action=rm_from_playlist&__biz=".concat(window.biz,"&appmsgid=").concat(window.mid,"&idx=").concat(window.idx),type:"POST",dataType:"json",async:!0,data:{data:JSON.stringify({listen_id:e})},success:e=>{e&&e.base_resp&&0===e.base_resp.ret?"function"==typeof t&&t():("function"==typeof i&&i(e),ge.setSum(la,40,1))},error:()=>{"function"==typeof i&&i(),ge.setSum(la,39,1)},complete:()=>{"function"==typeof n&&n()}})},ma=Ae.isWechat&&!Ae.isWindowsWechat&&!Ae.isMacWechat&&!Ae.isNewMpApp,_a={getTingIsOpenPromise:null,getListenLaterIsOpenPromise:null,musicLen:0,musicList:{},isTingOpen:-1,isSupportListenLater:ma?1:0,srcRoot:"".concat(location.protocol,"//res.wx.qq.com/voice/getvoice?mediaid=#meidaid#"),inWechat:ma,channelsInfo:[]};function fa(e){return document.getElementById(e)}async function ga(e,t){let i=0;for(let n=0;n<_a.musicLen;n++){const o=_a._oElements[n],s={};let a=o.getAttribute("voice_encode_fileid")||"";try{a=decodeURIComponent(a)}catch(Mu){}if(t&&(s.audioPanelVue=t),s.voiceid=ut.encodeStr(a)||o.getAttribute("listen_id"),s.voiceid=s.voiceid.replace(/&#61;/g,"=").replace(/^\s/,"").replace(/\s$/,""),s.isaac=1*o.getAttribute("isaac2")||0,s.src=_a.srcRoot.replace("#meidaid#",s.voiceid),s.hasAddedListenLater=0,o.setAttribute("has-added-listen-later",0),1===s.isaac&&(s.jsapi2Src=s.src+"&voice_type=1"),s.voiceid&&"undefined"!=s.voiceid){if(s.albumLink="",e&&e.length>0&&e.forEach((e=>{if(e.voice_id===a)return e.appmsgalbuminfo&&(s.albumTitle=e.appmsgalbuminfo.title||"",s.albumLink=e.appmsgalbuminfo.link.html(!1).replace("#wechat_redirect","")+"#wechat_redirect",s.albumNum=e.appmsgalbuminfo.tag_content_num||0,s.albumid=e.appmsgalbuminfo.album_id||0),!1})),o.setAttribute("data-verify_state",3),o.setAttribute("data-trans_state",1),musicMap.set(o,{_oMusic:s,num:i}),wa(o,s,i),"undefined"!=typeof voiceid&&a&&window.voiceid&&a===window.voiceid){const e=o.offsetTop+122-40;setTimeout((()=>{window.scrollTo(0,e)}),0)}i++}}(function(){const e=[...fa("js_content").getElementsByTagName("mp-common-claudio")];return new Promise((t=>{if(!e.length)return void t(e);const i={video_snap_num:e.length};e.forEach(((e,t)=>{i["exportid_".concat(t)]=e.dataset.id,i["username_".concat(t)]=e.dataset.username,i["listen_id".concat(t)]=e.getAttribute("listen_id")})),ye({url:"/mp/appmsg_video_snap?action=batch_get_video_snap",type:"POST",dataType:"json",async:!0,data:i,success(i){i&&i.base_resp&&0===i.base_resp.ret&&(_a.channelsInfo=i.video_snap_info),t(e)},error(){t(e)}})}))})().then((e=>{if(!_a.channelsInfo.length)return;let t=null;e.forEach((e=>{const{flag:i,added_in_playlist:n,nonce_id:o,tid:s}=_a.channelsInfo.find((t=>t.export_id===e.dataset.id));e.setAttribute("has-added-listen-later",n);const a=e.getAttribute("data-nonceid")!==o&&o,r=e.getAttribute("data-tid")!==s&&s;switch(a&&e.setAttribute("data-nonceid",o),r&&e.setAttribute("data-tid",s),i){case 1:e.setAttribute("err_tips","当前音频已被作者删除");break;case 2:case 4:e.setAttribute("err_tips","当前音频暂时无法播放");break;case 3:e.setAttribute("err_tips","当前音频已被设置私密")}if(a||r){const i=musicMap.get(e);if(i&&i._oMusic){const e=_a.musicList[i._oMusic.voiceid+"_"+i.num];e&&e.player&&(e.player._o&&(e.player._o.finderInfo={nonceId:o,tid:s}),e.player.player&&e.player.player._o&&(e.player.player._o.finderInfo={nonceId:o,tid:s})),t=i._oMusic.audioPanelVue}}})),t&&"function"==typeof t.updateCardList&&t.updateCardList()}))}function ya(e,t){e.setAttribute("play_length",t.play_length||1),e.setAttribute("data-verify_state",void 0===t.voice_verify_state?3:t.voice_verify_state),e.setAttribute("data-trans_state",void 0===t.voice_trans_state?1:t.voice_trans_state)}function wa(e,t,i){t.duration=parseInt((1*e.getAttribute("play_length")||0)/1e3,10),t.posIndex=i;let n=e.getAttribute("name")||"";try{n=decodeURIComponent(n)}catch(Mu){}if(t.title=ut.encodeStr(n).replace(/^\s/,"").replace(/\s$/,""),t.fileSize=1*e.getAttribute("high_size")||0,t.cover=(e.getAttribute("cover")||"").html(!1),t.nickname=window.nickname,t.voiceTag="v",Ce.addClass(e,"js_wx_tap_highlight"),_a.getTingIsOpenPromise.then((()=>async function(e,t){t.isShowListenLater=1===_a.isSupportListenLater&&!window.is_pay_subscribe&&!window.tts_is_ban,await mt()?e.setAttribute("show-listen-later","0"):e.setAttribute("show-listen-later",t.isShowListenLater?1:0);if(t.playArea=e.shadowRoot.querySelector(".js_voice_play"),t.progress=e.shadowRoot.querySelector(".js_audio_card_progress_inner"),t.bufferDom=e.shadowRoot.querySelector(".js_audio_card_progress_buffer"),t.loadingDom=e.shadowRoot.querySelector(".js_audio_card_progress_loading"),t.playdotDom=e.shadowRoot.querySelector(".js_audio_card_progress_handle"),t.seekRange=e.shadowRoot.querySelector(".js_audio_card_progress_wrp"),t.audioProgressBarDom=e.shadowRoot.querySelector(".js_audio_progress_bar"),t.playpercent=e.shadowRoot.querySelector(".js_voice_percent"),t.playpercentDesc=e.shadowRoot.querySelector(".js_voice_percent_desc"),t.listenLaterDom=e.shadowRoot.querySelector(".js_audio_listen_later"),t.albumDom=e.shadowRoot.querySelector(".js_voice_album"),t.playtimeDom=e.shadowRoot.querySelector(".js_duration"),"MP-COMMON-CLAUDIO"===e.tagName&&!function(e){const t=e=>e.stopPropagation();if(!Ae.isWechat||Ae.isWindowsWechat||Ae.isMacWechat||Ae.isNewMpApp)return Ne.on(e.detailArea,"click",(()=>{(window.weui||window).alert("请在手机微信内操作")})),e.listenLaterDom&&Ne.on(e.listenLaterDom,"touchstart",t),e.listenLaterDom&&Ne.on(e.listenLaterDom,"mousedown",t),Ne.on(e.playArea,"touchstart",t),Ne.on(e.playArea,"mousedown",t),!1;if(Ae.isAndroid&&window.clientversion<"28002655"||Ae.isIOS&&window.clientversion<"18002725"){const i=()=>{Ee.invoke("confirmDialog",{title:"当前版本暂不支持，请更新至微信最新版本",confirmText:"去更新",cancelText:"取消"},(e=>{-1!==e.err_msg.indexOf(":ok")?location.href=Ae.isIOS?"https://itunes.apple.com/cn/app/id414478124?mt=8&ls=1":"https://support.weixin.qq.com/update/":-1!==e.err_msg.indexOf("system:")&&(window.weui||window).alert("当前版本暂不支持，请更新至微信最新版本")}))};return Ne.on(e.detailArea,"click",i),e.listenLaterDom&&Ne.on(e.listenLaterDom,"touchstart",t),e.listenLaterDom&&Ne.on(e.listenLaterDom,"mousedown",t),Ne.on(e.playArea,"touchstart",t),Ne.on(e.playArea,"mousedown",t),!1}return!0}(t))return void(e.style.opacity=1);(function(e,t){const i=e.voiceid+"_"+e.posIndex;let n="";if(window.voice_in_appmsg&&window.voice_in_appmsg[e.voiceid]){const t=window.voice_in_appmsg[e.voiceid];let i=window.biz||"",o=window.mid||"",s=window.idx||"";t.bizuin&&t.appmsgid&&t.idx&&(i=t.bizuin,o=t.appmsgid,s=t.idx);n=(window.location.protocol||"https:")+"//mp.weixin.qq.com/mp/audio?_wxindex_=#_wxindex_#&scene=104&__biz=#biz#&mid=#mid#&idx=#idx#&voice_id=#voice_id#&sn=#sn##wechat_redirect".replace("#_wxindex_#",e.posIndex).replace("#biz#",i).replace("#mid#",o).replace("#idx#",s).replace("#voice_id#",e.voiceid).replace("#sn#",t.sn||"")}console.log("[Voice] init"+n),Se.log("[Voice] init"+n);const o=ut.decodeStr(e.title);e.player=ut.init({wxIndex:e.posIndex,type:2,songId:e.voiceid,comment_id:"",src:e.src,jsapi2Src:e.jsapi2Src,allowPause:!0,duration:e.duration,title:o,singer:window.nickname?window.nickname+"的语音":"公众号语音",epname:"来自文章",coverImgUrl:window.__appmsgCgiData.hd_head_img,playingCss:"share_audio_playing",pauseCss:"share_audio_pause",playCssDom:e.detailArea||fa("voice_main_"+i),playArea:e.playArea||fa("voice_play_"+i),progress:e.progress||fa("voice_progress_"+i),fileSize:e.fileSize,playtimeDom:e.playtimeDom||fa("voice_playtime_"+i),bufferDom:e.bufferDom||fa("voice_buffer_"+i),playdotDom:e.playdotDom||fa("voice_playdot_"+i),playpercent:e.playpercent||fa("voice_percent_"+i),playpercentDesc:e.playpercentDesc||fa("voice_percent_desc_"+i),seekRange:e.seekRange||fa("voice_seekRange_"+i),seekContainer:e.detailArea||fa("voice_main_"+i),loadingDom:e.loadingDom||fa("voice_loading_"+i),detailArea:e.detailArea||fa("voice_main_"+i)||"",albumDom:e.albumDom||fa("voice_album_"+i),detailUrl:n,webUrl:window.msg_link,speedList:[.75,1,1.25,1.5,2],audioCardBody:fa("audio_card_bd_".concat(i)),ctrlArea:fa("audio_card_control_".concat(i)),fastBackBtn:fa("audio_fast_back_".concat(i)),fastForwardBtn:fa("audio_fast_forward_".concat(i)),doubleSpeedBtn:fa("audio_double_speed_".concat(i)),isAudio:!0,isClAudio:"MP-COMMON-CLAUDIO"===t.tagName,userName:window.user_name||"",articleCoverCdnUrl1_1:window.cdn_url_1_1,tingExtInfo:{bizuin:window.biz&&1*window.atob(window.biz)||0,appmsgid:1*window.mid||0,idx:1*window.idx||0,audio_id:e.voiceid||"",is_album_page:!1},albumInfo:{albumId:e.albumid||"",albumName:e.albumTitle||"",albumUrl:e.albumLink||""},finderInfo:e.finderInfo||{},cover:e.cover||"",author:e.author||"",listenId:e.listenId||"",isTingOpen:_a.isTingOpen,isSupportListenLater:_a.isSupportListenLater,hasAddedListenLater:e.hasAddedListenLater||0,audioDurationDom:fa("audio_duration_".concat(i)),listenLaterDom:e.listenLaterDom||fa("audio_listen_later_".concat(i)),useNewListenLaterCgi:!!e.audioPanelVue&&!e.audioPanelVue.starVersion,audioRealTimeDom:fa("audio_real_playtime_".concat(i)),audioProgressBarDom:e.audioProgressBarDom||fa("audio_progress_bar_".concat(i)),listBase64:e.listBase64||"",detailAreaClickHook:()=>{const i=e.audioPanelVue;if(i&&e.listenId){if(i.starVersion){const n=va(e,t);i.show(n)}else i.playingListenId===e.listenId&&i.isPlaying?i.show(!1):function(e,t,i=!1){var n;const o=e.audioPanelVue;if(null==(n=null==o?void 0:o.show)||n.call(o,!0),ba(e,t,1),pa({listenId:e.listenId||"",onSuccess:()=>{var t;return null==(t=null==o?void 0:o.getListData)?void 0:t.call(o,!0,(t=>{if(o.notifyAppListChange(),i&&!o.supportDynamicPlayList){const i=t.find((t=>t.listen_id===e.listenId));i&&(o.selectInfo=i.listen_item,o.play(i.listen_item,!1,0,!1,1105))}}))}}),i&&(null==o?void 0:o.supportDynamicPlayList)){const i=va(e,t);o.selectInfo=i,o.play(i,!1,0,!1,1105)}}(e,t,!0);return!0}return!1},onListenLaterStart:()=>{const i=e.audioPanelVue;if(ba(e,t,1),i){const e=Date.now();Ee.invoke("showBottomToast",{id:"".concat(e),title:"已加入「播放列表」",iconData:"iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAMAAABiM0N1AAAAVFBMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////////8wXzyWAAAAHHRSTlMAAwQKDQ8SFx0fIC4zaGttfoeTl5inrrGzzNfmamG/UwAAAAFiS0dEAf8CLd4AAADCSURBVFjD7dfbDoJADATQonhFFPEK8///6YOgoIvabaMxmXnenDRL2ywiDMMwP0xeODlA4eS4SDngIq2vDqqpSz2olnTo0Pl/Z7VNPtkbi3dOVmM/cqgnq4FhSekMSop7PjRHy8R0PyLpuTkcqEn33Yclbf+Mj2FJ34dhKaafQ1LcXDxLsfP1KMXPaV+yzHtXsu2NWz+VG0U/v6zJvMf6kmUfdiXbXr1L1v3cSlanleyOSLoDTnOXZ/Rkxl8ShmG+lwsknDDzI+DkEwAAAABJRU5ErkJggg==",subtitle:i?"详情":"",needArrow:!!i,clickable:!!i}),i&&Ee.on("onClickBottomToast",(()=>{var e;return null==(e=null==i?void 0:i.show)?void 0:e.call(i,!0)}))}},onListenLaterError:()=>{ba(e,t,0)},onCancelListenLaterStart:()=>{ba(e,t,0)},onCancelListenLaterError:()=>{ba(e,t,1)},onPlaySuccess:()=>{const i=e.audioPanelVue;e.listenId&&i&&!i.starVersion&&pa({listenId:e.listenId||"",onSuccess:()=>ba(e,t,1)})}})})(t,e),e.style.opacity=1}(e,t))),_a.getListenLaterIsOpenPromise.then((async()=>{const t=1===_a.isSupportListenLater&&!window.is_pay_subscribe&&!window.tts_is_ban;await mt()?e.setAttribute("show-listen-later","0"):e.setAttribute("show-listen-later",t?1:0)})),"MP-COMMON-CLAUDIO"===e.tagName)return(t={posIndex:i,voiceTag:"v"}).type=4,t.listenId=e.getAttribute("listen_id"),t.duration=1*e.getAttribute("duration"),t.cover=e.getAttribute("cover").html(!1),t.title=e.getAttribute("name"),t.author=e.getAttribute("author"),t.finderInfo={nonceId:e.getAttribute("data-nonceid"),tid:e.getAttribute("data-tid")},t.hasAddedListenLater=e.getAttribute("has-added-listen-later"),e.setAttribute("cover",t.cover),t.detailArea=e.shadowRoot.querySelector(".js_wx_claudio_card"),_a.musicList[t.listenId+"_"+t.posIndex]=t,window.musicList[t.listenId+"_"+t.posIndex]=t,void Ce.addClass(e,"mp_common_channel");if(1===window.is_temp_url&&window.voice_in_appmsg[t.voiceid]){const{transState:i,voiceVerifyState:n}=window.voice_in_appmsg[t.voiceid];e.removeAttribute("err_tips"),e.setAttribute("data-verify_state",void 0===n?3:n),e.setAttribute("data-trans_state",void 0===i?1:i),ut.rollStatus(t.voiceid,(t=>{ya(e,t)}))}else ut.getVoiceStatus(t.voiceid).then((i=>{var n,o,s,a;i&&(e.removeAttribute("err_tips"),i.play_length&&parseInt((1*i.play_length||0)/1e3,10)!==1*e.getAttribute("play_length")&&(t.duration=parseInt((1*i.play_length||0)/1e3,10),t.listenId=i.listen_id||0,e.setAttribute("listen_id",i.listen_id||0),t.hasAddedListenLater=i.added_in_playlist||0,e.setAttribute("has-added-listen-later",i.added_in_playlist||0),t.player&&t.player._o&&(t.player._o.duration=t.duration,null==(o=null==(n=t.player.player)?void 0:n.setDuration)||o.call(n,t.duration),t.player._o.hasAddedListenLater=t.hasAddedListenLater,t.player._o.listenId=t.listenId,null==(a=null==(s=t.player.player)?void 0:s.setListenId)||a.call(s,t.listenId),setTimeout((()=>{var e;t.player.playtimeDomInnerHtml=(null==(e=t.player._o.playtimeDom)?void 0:e.innerHTML)||""})),t.audioPanelVue&&"function"==typeof t.audioPanelVue.updateCardList&&t.audioPanelVue.updateCardList())),ya(e,i))}));t.detailArea=e.shadowRoot.querySelector(".js_wx_mpaudio_card"),_a.musicList[t.voiceid+"_"+t.posIndex]=t,window.musicList[t.voiceid+"_"+t.posIndex]=t,Ce.addClass(e,"mp_common_audio")}function va(e,t){return{listen_id:e.listenId,title:ut.decodeStr(e.title||"")||"",author:e.author||"",duration:e.duration,cover:e.cover||"",type:"MP-COMMON-CLAUDIO"===t.tagName?4:3,...e.finderInfo?{finder_info:e.finderInfo}:{},author_info:{nickname:e.author||"",type:"MP-COMMON-CLAUDIO"===t.tagName?4:3,username:window.user_name||""},article_info:{audio_id:e.voiceid||"",audio_title:ut.decodeStr(e.title||"")||"",audio_url:e.src,author:e.author||"",biz_username:window.user_name||"",cover:e.cover||"",duration:e.duration,url:window.msg_link}}}function ba(e,t,i){e.hasAddedListenLater=i,t.setAttribute("has-added-listen-later",i),e.player&&(e.player._o.hasAddedListenLater=i),e.audioPanelVue&&(e.audioPanelVue.needUpdate=!0)}function Sa(e,t){if(function(){const e=fa("js_content");return!(!e||(_a._oElements=[...e.getElementsByTagName("mp-common-mpaudio"),...e.getElementsByTagName("mp-common-claudio")],_a._oElements.length<=0))}())try{_a.getTingIsOpenPromise=new Promise((e=>{_a.inWechat?Ee.invoke("getTingAudioState",{},(t=>{/:ok$/.test(t.err_msg)?_a.isTingOpen=1:-9999!==t.err_code&&-1===t.err_msg.indexOf("function_not_exist")||(_a.isTingOpen=0),e()})):e()})),_a.getListenLaterIsOpenPromise=new Promise((e=>{let t=null;t=setTimeout((()=>{_a.isSupportListenLater=0,e()}),3e3),_a.inWechat?Ee.invoke("handleMPPageAction",{action:"isSupportAddToTingPlayList"},(i=>{t&&clearTimeout(t),/:ok$/.test(i.err_msg)?_a.isSupportListenLater=1:_a.isSupportListenLater=0,e()})):e()})),_a.musicLen=_a._oElements.length,ga(e,t)}catch(i){console.error(i)}}window.musicList={},window.musicMap=new WeakMap;const Ia='\x3c!-- 发表留言 --\x3e\n<#if(window.new_appmsg){#>\n  <div id="js_cmt_mine" class="discuss_container_wrp" style="display:none;">\n    <div class="discuss_container editing access">\n        <div class="discuss_container_inner">\n          <div class="discuss_container_hd">\n            <h2 class="rich_media_title">\n                <#if(window.item_show_type == 10){#>\n                    <#=textPageTitle#>\n                <#}else{#>\n                    <#=window.msg_title.html(1)#>\n                <#}#>\n            </h2>\x3c!-- 标题要转义 --\x3e\n            <span id="log"></span>\n            <div class="frm_textarea_box_wrp">\n                <span class="frm_textarea_box">\n                    <#if(window.friend_comment_enabled == 1){#>\n                    \x3c!-- <textarea id="js_cmt_input" class="frm_textarea" placeholder="留言对朋友可见，被公众号筛选后，将对所有人可见。"></textarea> --\x3e\n                    <textarea id="js_cmt_input" class="frm_textarea" placeholder="留言将由公众号筛选后显示，对所有人可见。"></textarea>\n                    <#}else{#>\n                    <textarea id="js_cmt_input" class="frm_textarea" placeholder="留言将由公众号筛选后显示，对所有人可见。"></textarea>\n                    <#}#>\n                    <div class="emotion_tool">\n                        <span class="emotion_switch" style="display:none;"></span>\n                        <span id="js_emotion_switch" class="pic_emotion_switch_wrp">\n                            <img class="pic_default" src="<#=window.icon_emotion_switch#>" alt="">\n                            <img class="pic_active" src="<#=window.icon_emotion_switch_active#>" alt="">\n                            <img class="pic_default_primary" src="<#=window.icon_emotion_switch_primary#>" alt="">\n                            <img class="pic_active_primary" src="<#=window.icon_emotion_switch_active_primary#>" alt="">\n                        </span>\n                    </div>\n                </span>\n            </div>\n            <div class="emotion_panel" id="js_emotion_panel">\n                <span class="emotion_panel_arrow_wrp" id="js_emotion_panel_arrow_wrp">\n                    <i class="emotion_panel_arrow arrow_out"></i>\n                    <i class="emotion_panel_arrow arrow_in"></i>\n                </span>\n                <div class="emotion_list_wrp" id="js_slide_wrapper">\n                    \x3c!--<ul class="emotion_list"></ul>--\x3e\n                    \x3c!--<li class="emotion_item"><i class="icon_emotion"></i></li>--\x3e\n                </div>\n                <ul class="emotion_navs" id="js_navbar">\n                    \x3c!--<li class="emotion_nav"></li>--\x3e\n                </ul>\n            </div>\n            <div class="discuss_btn_wrp"><a id="js_cmt_submit" class="btn btn_primary btn_discuss btn_disabled" href="##">留言</a></div>\n          </div>\n          <div class="discuss_container_bd">\n            <div class="" style="display:none">\n                <div class="mod_title_context">\n                    <strong class="mod_title">我的留言</strong>\n                </div>\n                <ul class="discuss_list" id="js_cmt_mylist"></ul>\n            </div>\n            <div class="weui-loadmore" id="js_mycmt_loading">\n                <i class="weui-loading"></i>\n                <span class="weui-loadmore__tips">正在加载</span>\n            </div>\n            <div id="js_cmt_toast" style="display: none;">\n                <div class="weui-mask_transparent"></div>\n                <div class="weui-toast">\n                    <i class="weui-icon-success-no-circle weui-icon_toast"></i>\n                    <p class="weui-toast__content">已留言</p>\n                </div>\n            </div>\n            <div class="weui-dialog__wrp weui-transition_opacity-hide" id="js_delete_panel_mobile">\n                <div class="weui-mask"></div>\n                <div class="weui-dialog">\n                    <div class="weui-dialog__bd">确定删除留言吗？</div>\n                    <div class="weui-dialog__ft">\n                    <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_default" id="js_delete_cancel_mobile">取消</a>\n                    <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_primary" id="js_delete_confirm_mobile">删除</a>\n                    </div>\n                </div>\n            </div>\n          </div>\n        </div>\n    </div>\n  </div>\n<#}else{#>\n    <div id="js_cmt_mine" class="discuss_container editing access" style="display:none;">\n        <div class="discuss_container_inner">\n            <h2 class="rich_media_title"><#=window.msg_title.html(1)#></h2>\x3c!-- 标题要转义 --\x3e\n            <span id="log"></span>\n            <div class="frm_textarea_box_wrp">\n                <span class="frm_textarea_box">\n                    <#if(window.friend_comment_enabled == 1){#>\n                    \x3c!-- <textarea id="js_cmt_input" class="frm_textarea" placeholder="留言对朋友可见，被公众号筛选后，将对所有人可见。"></textarea> --\x3e\n                    <textarea id="js_cmt_input" class="frm_textarea" placeholder="留言将由公众号筛选后显示，对所有人可见。"></textarea>\n                    <#}else{#>\n                    <textarea id="js_cmt_input" class="frm_textarea" placeholder="留言将由公众号筛选后显示，对所有人可见。"></textarea>\n                    <#}#>\n                    <div class="emotion_tool">\n                        <span class="emotion_switch" style="display:none;"></span>\n                        <span id="js_emotion_switch" class="pic_emotion_switch_wrp">\n                            <img class="pic_default" src="<#=window.icon_emotion_switch#>" alt="">\n                            <img class="pic_active" src="<#=window.icon_emotion_switch_active#>" alt="">\n                        </span>\n                        <div class="emotion_panel" id="js_emotion_panel">\n                            <span class="emotion_panel_arrow_wrp" id="js_emotion_panel_arrow_wrp">\n                                <i class="emotion_panel_arrow arrow_out"></i>\n                                <i class="emotion_panel_arrow arrow_in"></i>\n                            </span>\n                            <div class="emotion_list_wrp" id="js_slide_wrapper">\n                                \x3c!--<ul class="emotion_list"></ul>--\x3e\n                                \x3c!--<li class="emotion_item"><i class="icon_emotion"></i></li>--\x3e\n                            </div>\n                            <ul class="emotion_navs" id="js_navbar">\n                                \x3c!--<li class="emotion_nav"></li>--\x3e\n                            </ul>\n                        </div>\n                    </div>\n                </span>\n            </div>\n            <div class="discuss_btn_wrp"><a id="js_cmt_submit" class="btn btn_primary btn_discuss btn_disabled" href="##">留言</a></div>\n            <div class="discuss_list_wrp" style="display:none">\n                <div class="rich_tips with_line title_tips discuss_title_line">\n                    <span class="tips">我的留言</span>\n                </div>\n                <ul class="discuss_list" id="js_cmt_mylist"></ul>\n            </div>\n            <div class="rich_tips tips_global loading_tips" id="js_mycmt_loading">\n                <img src="<#=window.icon_loading_white#>" class="rich_icon icon_loading_white" alt="">\n                <span class="tips">加载中</span>\n            </div>\n            <div class="wx_poptips" id="js_cmt_toast" style="display:none;">\n                <img alt="" class="icon_toast" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGoAAABqCAYAAABUIcSXAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3NpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoyMTUxMzkxZS1jYWVhLTRmZTMtYTY2NS0xNTRkNDJiOGQyMWIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTA3QzM2RTg3N0UwMTFFNEIzQURGMTQzNzQzMDAxQTUiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTA3QzM2RTc3N0UwMTFFNEIzQURGMTQzNzQzMDAxQTUiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NWMyOGVjZTMtNzllZS00ODlhLWIxZTYtYzNmM2RjNzg2YjI2IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjIxNTEzOTFlLWNhZWEtNGZlMy1hNjY1LTE1NGQ0MmI4ZDIxYiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pmvxj1gAAAVrSURBVHja7J15rF1TFMbXk74q1ZKHGlMkJVIhIgg1FH+YEpEQJCKmGBpThRoSs5jVVNrSQUvEEENIhGiiNf9BiERICCFIRbUiDa2qvudbOetF3Tzv7XWGffa55/uS7593977n3vO7e5+199p7v56BgQGh0tcmvAUERREUQVEERREUQVEERREUQVEERREUQVEERREUQVEERREUQVEERVAUQVEERVAUQbVYk+HdvZVG8b5F0xj4RvhouB+eCy8KrdzDJc1RtAX8ILxvx98V1GyCSkN98Cx4z/95/Wn4fj6j6tUEeN4wkFSnw1MJqj5NhBfAuwaUHREUg4lqNMmePVsHll/HFhVfe1t3FwpJI8DXCCquDrCWNN4B6Tb4M3Z98aTPmTvh0YHl18PXw29yZiKejoPvcUD6E74yFBJbVDk6Bb7K8aP/Hb4c/tRzEYIqprPhSxzlf4Uvhb/0Xoig8qnHAJ3lqPMzfDH8XZ4LEpRf2sVdA5/sqPO9Qfop70UJyn+/boaPddT5yrq7VUUvTIVJI7q74MMddXR8NB1eXcYvhBpZm0s2w72/o86HFoKvLau/pYaXzjLMdUJ6y0LwtWV9CIIaXtvA8+G9HHV03u5q+K+yH47U0NoRngPv7KjzHDwTLj0bS1BDazfJJlcnOOostC6ysnCT+q80G/sIvFVgeW09D8FPVT0uoP7VfvAD8NjA8pqmuAN+OcYAjso0RbIZ8DGB5TVNcRO8JMaHY9SXSdfa3eeANJimWBLrA7JFiZwIXye+NMUV8CcxP2SRFjXefok7NRjSGZJlWUPvw2/wtNiQirSoXWyMsR28wR7AzzYM0oXw+Y7yK+CLJGeaoqjyrJSdZJD6Ov4+z5y6NJc0Az7NUecHydIUy+v60KNyQHoM3nKI1y7YCFiq0i7uBvgER52vDdKqWn9djhY1Dn4G3n6Ecqm2rF74dvgoR53S0hQxW9RJAZAGW5bSn58QJA27dQ7uIEedjywEX5NKVxCqsY6y+qA+LxFI4+yZ6oH0trWkNan80jygtIUsc5SflgAsDXgehfdx1KkkTRE76tN+Xue2jnTU0Ru1oIbvpt30bBtKhOp5yaaRkts0lic8V1i6dPcIRx2d/l8Y8XtNNEg7OOo8bl1kmmOKnDsO88CaYzejau0hWZqiL7C83oCH4SeTHvwV2BqqsHRVztSEYOmWF80NeXZT6Hd4KflResE9vCnBOlCyGfDNAstHTVPUDWoQ1t3iW+9WNizvlhfd4aerXd+ThqiMfNR6+9LvOOro5OY5JX2H4+F7HZD+kGzlamMgldWiirQsjcwWFbjmqZJteekJLK9pisvgL6RhKvuciZiwzrWWGapfrPy30kBVcSBIrw0aD3PU0XB6cehntq7rTMf7/2iQlktDVdXJLXlg6VjmiYBn6rWSTRCH6hvJ0hQrpcGq8oidsmHpTP8t8DGO9/vcWt9qabiqPgup1yKyQwvC2tSefZ73SSpNkUJ4PlLorlHZ+446nc8f3fIyywlJhwrTuwVSjBa1ccvSxN0hjjoK5xVrYZMd9V6XbFfgBukixTwGLg8sDam3dZR/wZ6L/dJlin1en8LS+bgpFbz3Ygvzu1J1HKxYNqxGpCmaCEo12rrBorD6LRp8UbpcdR5VWhTW35KlKd6QFqjuM2XzwlpnMxTvSkuUwuG/Xlg6NtPjbT6WFimF/VG6LEvXgn8QGDjMbBukVECFwhpoS+CQatfX2Q1q6H7wENHdrfCr0lKleEB9JyxNneus+VJpsVL9TwI6W65LovWIGl3KtVJaLv7LBwYTFEERFEVQFEERFEVQFEERFEVQFEERFEVQFEERFEVQFEERFFWq/hFgADUMN4RzT6/OAAAAAElFTkSuQmCC">\n                <p class="toast_content">已留言</p>\n            </div>\n        </div>\n    </div>\n<#}#>\n<div class="weui-webview-nav" style="display:none;" id="js_fake_bar">\n    <button class="weui-webview-nav__btn_goback" id="js_cmt_goback">goback</button>\n    <button class="weui-webview-nav__btn_forward weui-webview-nav__btn_disabled" disabled="disabled">forward</button>\n</div>';const xa={tagName:"mp-common-poi",oldTagName:"mppoi",isWechat:(Ae.isAndroid||Ae.isIOS)&&(Ae.isWechat||Ae.isWxWork)&&!Ae.isNewMpApp,screen_height:We.getInnerHeight(),commonReportData:{bizuin:1*Fe(window.biz),msgid:1*window.mid,itemidx:1*window.idx,sessionidnew:window.sessionid,enterid:1*window.enterid},poiDom:[]},ka=e=>{xa.isWechat?Ae.isWxWork?Oe():Ee.invoke("openLocation",{latitude:1*e.latitude,longitude:1*e.longitude,name:e.name,address:e.address,poiCardExpand:!0,infoUrl:""},(function(e){-1!==e.err_msg.indexOf("ok")?ge.setSum(110809,53,1):ge.setSum(110809,54,1)})):Ae.isNewMpApp?window.open("https://apis.map.qq.com/uri/v1/marker?marker=coord:".concat(e.latitude,",").concat(e.longitude,";title:").concat(encodeURIComponent(e.name),";addr:").concat(encodeURIComponent(e.address))):new t({msg:"请使用移动端微信打开。"})},Ta=(e={})=>{const t=e.dom,i=e.poiInfo;Ne.on(t,"click",(function(e){e.stopPropagation(),e.preventDefault(),we.report(19937,Object.assign({},xa.commonReportData,{type:2,actiontype:2})),ge.setSum(110809,55,1),ka(i)}),!0)},Ca=()=>{for(let e=0;e<xa.poiDom.length;e++){const t=xa.poiDom[e];if(1*t.getAttribute("data-hasreport")!=1){t.setAttribute("data-hasreport",1);const e=document.documentElement.scrollTop||document.body.scrollTop;t.clientHeight+t.offsetTop>=e+t.clientHeight/2&&t.clientHeight+t.offsetTop<=e+t.clientHeight/2+xa.screen_height&&("A"===t.tagName?(we.report(19937,Object.assign({},xa.commonReportData,{type:1,actiontype:1})),ge.setSum(110809,58,1)):(we.report(19937,Object.assign({},xa.commonReportData,{type:2,actiontype:1})),ge.setSum(110809,56,1)))}}},Aa={oldTagName:"mpsearch",tagName:"mp-common-search",isWechat:(Ae.isAndroid||Ae.isIOS)&&(Ae.isWechat||Ae.isWxWork)&&!Ae.isNewMpApp,keywords:[],screen_height:We.getInnerHeight(),exposeHasReport:0,commonReportData:{BizUin:window.biz,MsgId:1*window.mid,ItemIdx:1*window.idx,SearchKeyWord:"",SessionId:window.sessionid,EnterId:1*window.enterid,Scene:1*window.source,SubScene:1*window.subscene}},Ea=(e={})=>{Ne.on(e.dom,"click",(function(){const e=Aa.keywords.map((e=>e.label)).join(";");if(we.report(19453,Object.assign({},Aa.commonReportData,{SearchKeyWord:e,EventType:2})),ge.setSum(110809,47,1),Aa.isWechat){if(Ae.isWxWork)Oe();else if((Ae.isIOS&&Ae.ltVersion("7.0.12")||Ae.isAndroid&&Ae.ltVersion("7.0.12"))&&!Ae.isWxWork)return void new t({msg:"当前微信版本不支持展示该内容，请升级至最新版本。"});const e=[];for(let t=0;t<Aa.keywords.length;t++)e.push({hotword:Aa.keywords[t].label,id:t,optype:1});Ee.invoke("openWXSearchPage",{query:"",thirdExtParam:JSON.stringify({data:[{items:e,title:window.nickname+"推荐搜索",type:4}],from:"mpWidget",bizUserName:window.user_name,bizNickName:window.nickname,id:"mpWidget_".concat(Aa.commonReportData.BizUin,":").concat(Aa.commonReportData.MsgId,":").concat(Aa.commonReportData.ItemIdx)})},(function(e){-1!==e.err_msg.indexOf("ok")?ge.setSum(110809,48,1):ge.setSum(110809,49,1)}))}else new t({msg:"请使用移动端微信打开。"})}));const i=()=>{if(!Aa.exposeHasReport){Aa.exposeHasReport=1;const t=document.documentElement.scrollTop||document.body.scrollTop;if(e.dom.clientHeight+e.dom.offsetTop>=t+e.dom.clientHeight/2&&e.dom.clientHeight+e.dom.offsetTop<=t+e.dom.clientHeight/2+Aa.screen_height){const e=Aa.keywords.map((e=>e.label)).join(";");we.report(19453,Object.assign({},Aa.commonReportData,{SearchKeyWord:e,EventType:1})),ge.setSum(110809,46,1)}}};Ne.on(window,"scroll",i),i()};let Pa={pvele:[],checkInScreenId:null,reportRandom:Math.random()};function La(){if(console.log("weproduct init"),"function"!=typeof document.getElementsByClassName)return;let e=document.getElementsByClassName("js_product_container");e&&e.length>0&&(!function(e){try{for(let t=0,i=e.length;t<i;t++){let i=e[t];if(i.className.indexOf("js_list_container")>=0){let e=i.querySelector("img.js_cover");if(e){let t=e.parentNode.getBoundingClientRect();e.style.setProperty("width",t.width+"px","important"),e.style.setProperty("height",t.height+"px","important"),e.style.setProperty("background-size","unset","important"),"0"==e.getAttribute("data-fail")?Da.call(e):e.getAttribute("data-fail")||(e.lazyLoadOnload=e.lazyLoadOnload||[],e.lazyLoadOnload.push(Da))}}}}catch(Mu){}}(e),i.getAppidInfo({onSuccess:function(t){Pa.data=t.data,function(e){for(let n=0,o=e.length;n<o;n++)!function(e,t){Ne.on(e,"click",".js_product_loop_content",(function(e){let n=e.delegatedTarget,o=n.getAttribute("data-wxaappid"),s=n.getAttribute("data-wxapath"),a=n.getAttribute("data-pid"),r=n.getAttribute("data-appid"),l=n.querySelector(".cps_inner_info_title").innerHTML;return i.jumpUrl({privateExtraData:{cookies:"cps_package=123456; expires=1538286412; busid=mmbiz_ad_cps; domain=*"},sourceAppId:r,appid:o,path:s,scene:1091,sceneNote:[encodeURIComponent(location.href),user_name,msg_title,encodeURIComponent(a),l,s].join(":"),beforeNonWechatWarn:function(){},beforeJumpBackupPage:function(){},onJsapiCallback:function(e){if("openWeApp:ok"===e.err_msg&&a){let e=2;2==n.getAttribute("data-pidtype")&&(e=4),Ba([{wxa_appid:o,pid:a,type:e,absolute_order:t+1,appid:n.getAttribute("data-appid")||"",templateid:n.getAttribute("data-templateid")||"",relative_order:1*n.getAttribute("data-order"),packid:n.getAttribute("data-packid")||""}])}}}),!1}))}(e[n],n);let t=document.getElementsByClassName("js_product_loop_content");if(t&&t.length>0&&We.getInnerHeight()){for(let e=0;e<t.length;e++)Pa.pvele.push(t[e]);Ra(),Ne.on(window,"scroll",Ra)}}(e)}})),setTimeout((function(){let e=document.getElementsByClassName("js_product_loop_content").length,t=document.getElementsByClassName("js_product_err_container").length;ge.setSum("64469","15",e+t),ge.setSum("64469","16",e),ge.setSum("64469","18",t)}),0)}function Da(){let e=this.parentNode;if(!e)return;let t=document.createElement("span");t.className=this.className,t.style.background='url("'+this.src+'") no-repeat center',e.insertBefore(t,this),e.removeChild(this)}function Ra(e){Pa.checkInScreenId&&clearTimeout(Pa.checkInScreenId),Pa.checkInScreenId=setTimeout((function(){Pa.checkInScreenId=null;let e=[];for(let t=0;t<Pa.pvele.length;t++){let i=Pa.pvele[t],n=i.getBoundingClientRect();if((n.height||n.bottom-n.top)>0&&n.top<We.getInnerHeight()&&n.bottom>0){let n=i.getAttribute("data-pid");if(n){let o=1;2==i.getAttribute("data-pidtype")&&(o=3),e.push({wxa_appid:i.getAttribute("data-wxaappid"),pid:n,type:o,absolute_order:t+1,appid:i.getAttribute("data-appid")||"",templateid:i.getAttribute("data-templateid")||"",relative_order:1*i.getAttribute("data-order"),packid:i.getAttribute("data-packid")||""})}Pa.pvele.splice(t--,1)}}Ba(e),0==Pa.pvele.length&&(Ne.off(window,"scroll",Ra),Ra=null)}),100)}function Ba(e){if(!e||0==e.length)return;let t={batch_no:be.getQuery("batch_no")||"",bizuin:window.biz||"",biz:window.biz||"",mid:window.mid||"",idx:window.idx||"",total:e.length};for(let i=0;i<e.length;i++){let n=e[i],o=i+1;for(let e in n)n.hasOwnProperty(e)&&(t[e+""+o]=n[e])}ye({url:"/mp/productreport?",type:"POST",data:t,dataType:"json",async:!0})}const Oa=window.location.protocol+"//support.weixin.qq.com/update/";let ja=[],Ma=1,Na=be.getQuery("fontScale");function qa(e){Na=e.fontScale,setTimeout((()=>{const e=document.getElementsByTagName("wx-open-subscribe")||[];for(let t=0;t<e.length;t++)e[t].setAttribute("size",Ma),e[t].setAttribute("scale",Na),Ma++}),50)}function Wa(){if(!document.getElementById("js_content"))return;const e=document.querySelectorAll("mpsubscribe");for(let t=0;t<e.length;t++){const i=e[t],n=document.createElement("mp-common-subscribe"),o=i.getAttribute("data-templateidlist"),s=i.getAttribute("data-index")||0;i.parentNode.appendChild(n),i.parentNode.removeChild(i),n.setAttribute("data-templateidlist",o),n.setAttribute("data-index",s)}ja=document.getElementsByTagName("mp-common-subscribe")||[];for(let t=0;t<ja.length;t++){const e=ja[t],i=e.getAttribute("data-templateidlist")||[],n=e.getAttribute("data-index")||0,o=window.__is_support_wxOpen?1:0;e.setAttribute("data-scene",window.is_temp_url?3:2),e.setAttribute("data-username",window.user_name),e.setAttribute("data-supportwxopen",o),e.setAttribute("data-scale",Na),e.setAttribute("data-index",n),e.setAttribute("data-tagContent","订阅通知"),e.setAttribute("data-templateidlist",i),o||e.classList.add("js_subsc_btn")}j(qa),function(){const e=document.getElementsByClassName("js_subsc_btn")||[];for(let t=0;t<e.length;t++){const i=e[t];Ne.on(i,"click",(()=>{qt("js_subsc_btn")||(window.uin&&window.key&&Ae.isWechat&&!Ae.isWindowsWechat&&!Ae.isMacWechat?document.getElementById("js_update_dialog").style.display="block":window.weui.alert("请在手机微信内操作"))}))}Ne.on(document.getElementById("js_update_cancel"),"click",(()=>{document.getElementById("js_update_dialog").style.display="none"})),Ne.on(document.getElementById("js_update_confirm"),"click",(()=>{Pe.jumpUrl(Oa,!0)}))}()}function Fa(){if(!networkType)return;let e=window.performance||window.msPerformance||window.webkitPerformance;if(!e||void 0===e.getEntries)return;let t,i,n=document.getElementsByTagName("img"),o=n.length,s=navigator.userAgent,a=!1;i=RegExp.$1;for(let r=0,l=n.length;r<l;r++){if(t=parseInt(100*Math.random()),t>100)continue;let l=n[r].getAttribute("src");if(!l||l.indexOf("mp.weixin.qq.com")>=0)continue;let d,c=e.getEntries();for(let e=0;e<c.length;e++)if(d=c[e],d.name==l){let e=n[r].getAttribute("data-fail"),t=0;try{s.match(/iphone/i)?t=1:s.match(/android/i)&&(t=2),we.report(11065,{Uin:parseInt(atob(window.biz))||0,IfSuccess:e?1:0,Device:t,user_agent:navigator.userAgent,net_type:networkType,url:l,delay_time:parseInt(d.duration)>0?parseInt(d.duration):0,img_size:n[r].fileSize||0,sample:o>100?100:o,user_device:navigator.userAgent,client_version:i,appmsg_id:parseInt(window.appmsgid,10)})}catch(Nu){console.log(Nu)}a=!0;break}if(a)break}}let za={"network_type:fail":"fail","network_type:edge":"2g/3g","network_type:wwan":"2g/3g","network_type:wifi":"wifi"};const Ua='<div id="js_profile_ban" style="display: none;">\n  <div class="weui-mask_transparent"></div>\n  <div class="weui-toast">\n    <i class="weui-icon-warn weui-icon_toast"></i>\n    <p class="weui-toast__content">该账号因违规无法跳转</p>\n  </div>\n</div>';let Ha=[];const Va=[];function Ka(e){try{return 1*window.atob(e)}catch(Mu){}return 0}function $a(e,t,i,n){we.report(22316,{BizUin:Ka(window.biz),AppMsgID:window.parseInt(window.mid,10)||0,ItemIndex:window.parseInt(window.idx,10)||0,Itemshowtype:0,SessionId:window.sessionid+"",EnterId:window.parseInt(window.enterid,10)||0,Scene:1*window.source,Subscene:1*window.subscene,ActionType:e,toBizuin:Ka(t),isBizBan:1*i,isMassSend:1*window.appmsg_type,CardType:n})}function Ja(){if(Ha&&Ha.length&&Va.length===Ha.length)Ne.off(window,"scroll",Ja);else for(let e=0;e<Ha.length;e++){const t=Ha[e],i=t.querySelector(".js_wx_profile_card");if(i&&i.getBoundingClientRect().top>0&&i.getBoundingClientRect().top+i.getBoundingClientRect().height/2<=We.getInnerHeight()){const e=i.getAttribute("data-id"),n=i.getAttribute("data-index");if(-1===Va.indexOf(n)){Va.push(n);$a(0,e,i.getAttribute("data-isban"),1*t.getAttribute("data-from"))}}}}function Ga(e,t,i,n,o,s,a){e.addEventListener("click",(()=>{if($a(1,i,n,s),n){const e=document.getElementById("js_profile_ban");"none"===e.style.display&&(e.style.display="block",setTimeout((()=>{e.style.display="none"}),2e3))}else oi({dom:e,callback:function(){$e.goProfile({biz:i,scene:124},{username:t,scene:"200"},null,o)},idkey:299174,idkeyItem:18,detectName:"profileCoverDetect",title:"即将打开公众号",contentDesc:"".concat(a)})}))}function Xa(e){return window.mp_profile.find((t=>t.fakeid===e))}function Ya(){!function(){if(!document.getElementById("js_content"))return;Ha=Array.from(document.getElementsByTagName("mpprofile"))||[];const e=Array.from(document.getElementsByTagName("mp-common-profile"))||[],t=Ha.concat(e);window.mp_profile.forEach((e=>{e.round_head_img&&(e.round_head_img=e.round_head_img.compressCDNImgSize(),e.round_head_img=be.addWxfrom(e.round_head_img,19))}));for(let n=0;n<t.length;n++){let e=t[n];const i=e.getAttribute("data-id"),o=1*e.getAttribute("data-from"),s=Xa(i)||{},{alias:a="",fakeid:r,is_biz_ban:l,nickname:d="",original_num:c,round_head_img:u,signature:p="",username:h,biz_account_status:m}=s,_=e.parentNode&&e.parentNode.querySelector('[data-preloadingid="'.concat(i,'"]'));if(_&&e.parentNode.removeChild(_),s){if("MPPROFILE"===e.tagName){const t=document.createElement("mp-common-profile");e.parentNode.appendChild(t),e.parentNode.removeChild(e),e=t}e.setAttribute("data-index",n),e.setAttribute("data-id",r),e.setAttribute("data-headimg",u),e.setAttribute("data-nickname",d.htmlDecode()),e.setAttribute("data-alias",a.htmlDecode()),e.setAttribute("data-signature",p.htmlDecode()),e.setAttribute("data-origin_num",1*c),e.setAttribute("data-is_biz_ban",1*l),e.setAttribute("data-isban",1*l),e.setAttribute("data-biz_account_status",1*m),e.classList.add("js_wx_tap_highlight"),Ga(e,s.username,s.fakeid,s.is_biz_ban,s.biz_account_status,o,d.htmlDecode())}else e.innerHTML=""}Ja();const i=document.createElement("div");i.innerHTML=qe.tmpl(Ua,{}),document.body.appendChild(i)}(),Ne.on(window,"scroll",Ja)}const Qa=[],Za=document.getElementsByTagName("mp-common-sticker"),er=new Map,tr=[],ir=[];for(const x of Za){tr.push(x.dataset.md5);const e=er.get(x.dataset.md5);e?(e.push(x),er.set(x.dataset.md5,e)):(er.set(x.dataset.md5,[x]),x.dataset.buf||ir.push(x.dataset.md5))}const nr={EXPOSE:0,CLICK:1,LONGTAP:2};function or(e,t){const i=t.dataset.md5,n=Number(t.dataset.type),o=t.dataset.emoji_url,s=Number(t.dataset.is_ban),a=t.dataset.buf;we.report(29377,{bizuin:window.biz&&Number(window.atob(window.biz))||0,msgid:window.parseInt(window.mid,10)||0,itemidx:window.parseInt(window.idx,10)||0,SessionId:window.sessionid+"",EnterId:window.parseInt(window.enterid,10)||0,scene:1*window.source,Subscene:1*window.subscene,action:e,md5:i,type:n,url:o,isBan:s,buf:a})}function sr(){var e;!function(){for(const e of Za)Ne.longtap(e,(function(t){if(t.stopPropagation(),1===parseInt(e.dataset.is_ban,10))return;or(nr.LONGTAP,e);ar(e.dataset.emoji_url,e.dataset.md5,1,e.dataset.buf||"",!0)}),!0),Ne.tap(e,(function(t){if(t.stopPropagation(),1===parseInt(e.dataset.is_ban,10))return;or(nr.CLICK,e);ar(e.dataset.emoji_url,e.dataset.md5,0,e.dataset.buf||"",!0)}))}(),e=tr,ye({type:"POST",url:"/mp/checkemoticon?action=checkmd5batch",data:{action:"checkmd5batch",md5ListJson:JSON.stringify({list:e})},dataType:"json",timeout:3e3,success:e=>{e&&e.base_resp&&-1!==e.base_resp.ret&&e.is_ban_list&&Array.isArray(e.is_ban_list)&&e.is_ban_list.forEach(((e,t)=>{Za[t].dataset.is_ban=e}))}}),function(e){if(0===e.length)return;ye({type:"POST",url:"/mp/getemojibuf?action=getbuf",data:{action:"getbuf",md5ListJson:JSON.stringify({list:e})},dataType:"json",timeout:3e3,success:e=>{if(e&&e.base_resp&&-1!==e.base_resp.ret&&e.emoji_info&&Array.isArray(e.emoji_info)){e.emoji_info.forEach((e=>{if(e.md5){er.get(e.md5).forEach((t=>{t.dataset.buf=e.buf}))}}))}},complete:()=>{}})}(ir),function(){let e=null;e=new IntersectionObserver((function(t,i){t.forEach((t=>{if(t.isIntersecting){const i=t.target;or(nr.EXPOSE,i),e.unobserve(i)}}))}),{threshold:.5}),Za.forEach((t=>{e.observe(t)}))}()}function ar(e,t,i,n,o){const s=new XMLHttpRequest;s.open("GET",e,!0),s.responseType="arraybuffer",s.onload=function(e){const a=new Uint8Array(s.response);let r=a.length;const l=new Array(r);for(;r--;)l[r]=String.fromCharCode(a[r]);const d=l.join(""),c=window.btoa(d);if(o)Ee.invoke("emoticonAPICollection",{md5:t,opType:i,imageDataString:c,emojiInfoBuf:n},(function(e){}));else{if(!Qa)return;Qa.push({md5:t,emojiInfoBuf:n,opType:i,imgDataString:c})}return c},s.onerror=function(e){console.log("xmlHttp.onerror",e)},s.onabort=function(e){console.log("xmlHttp.onabort",e)},s.send()}const rr={tagName:"mp-common-answer",isWechat:(Ae.isAndroid||Ae.isIOS)&&Ae.isWechat&&!Ae.isWxWork&&!Ae.isNewMpApp,isPCWechat:Ae.isWindowsWechat||Ae.isMacWechat},lr=Array.from(document.getElementsByTagName(rr.tagName)),dr=[],cr=[];lr&&lr.length&&lr.forEach((e=>{Number(e.dataset.card_type)?dr.push(e):cr.push(e)}));const ur={EXPOSE:1,CLICK:2,ANSWER:3};function pr(e){let t=[];try{if(e){const i=JSON.parse(e);i&&i.list&&Array.isArray(i.list)&&(t=i.list)}}catch(i){console.log(i)}return t}function hr(e,t){const i=window.parseInt(t.dataset.usertype,10),n=pr(t.dataset.picture_clist),o=pr(t.dataset.video_list);we.report(30376,{bizuin:window.biz&&Number(window.atob(window.biz))||0,msgid:window.parseInt(window.mid,10)||0,itemidx:window.parseInt(window.idx,10)||0,title:window.msg_title||"",accountType:1===i?2:1,accountUin:t.dataset.username,answerCardId:t.dataset.aid,questionId:t.dataset.qid,hasComment:t.dataset.comment?1:0,hasPicture:n.length>0?1:0,hasVideo:o.length>0?1:0,actionType:e,type:Number(t.dataset.card_type)?1:0})}function mr(e,t,i={}){let n="";i.minVersion&&(n+="&min_version=".concat(encodeURIComponent(i.minVersion)));const o="#/".concat(e);let s="";return Object.keys(t).forEach((e=>{e&&void 0!==t[e]&&(s+="".concat(s?"&":"?").concat(encodeURIComponent(e),"=").concat(encodeURIComponent(String(t[e]))))})),"https://search.weixin.qq.com/cgi-bin/newsearchweb/userclientjump?path=page%2Fask%2Findex".concat(n).concat(o).concat(s)}function _r(e,t=100){if(e)return e.replace(/\n|\r|\t/g," ").replace(/"|'/g,"").slice(0,t)}function fr(e){const t=e.map((e=>{var t,i,n,o,s,a,r,l,d,c,u,p;const h=null==(i=null==(t=e.answer_content)?void 0:t.video_list)?void 0:i.map((e=>e.media_info?{like_count:e.media_info.like_count||0,thumb_url:e.media_info.thumb_url||""}:{}));let m="";(null==(n=e.answer_content)?void 0:n.text)&&(m=_r(e.answer_content.text,350));let _="";if(null==(s=null==(o=e.answer_top_comment)?void 0:o.content)?void 0:s.text){const t=_r(e.answer_top_comment.content.text,100),i=e.answer_top_comment.nickname;t&&(_="".concat(i,"：").concat(t))}return{question_text:e.question_text,state:e.answer_content.state,usertype:e.type,like_count:e.like_count||0,forward_count:e.forward_count||0,comment_count:e.comment_count||0,username:null==(a=e.user_info)?void 0:a.username,nickname:null==(r=e.user_info)?void 0:r.nickname,headimg_url:null==(l=e.user_info)?void 0:l.headimg_url,aid:null==(d=e.answer_content)?void 0:d.aid,qid:null==(c=e.answer_content)?void 0:c.qid,content_text:m,content_type:null==(u=e.answer_content)?void 0:u.type,picture_list:null==(p=e.answer_content)?void 0:p.picture_list,video_list:h,comment:_}}));cr.forEach(((e,i)=>{if(t[i]){const n=t[i].state;if(4!==n)2===n?e.dataset.message="回答仍在审核中":8===n?e.dataset.message="回答审核不通过":64===n&&(e.dataset.message="该回答已被删除"),e.dataset.status=2;else{e.dataset.like_count=t[i].like_count,e.dataset.forward_count=t[i].forward_count,e.dataset.comment_count=t[i].comment_count,t[i].comment&&t[i].comment.length&&(e.dataset.comment=t[i].comment.slice(0,100));const n=t[i].picture_list;n&&n.length&&Array.isArray(n)&&(e.dataset.picture_clist=JSON.stringify({list:n.slice(0,4)}));const o=t[i].video_list;o&&(e.dataset.video_list=JSON.stringify({list:o})),e.dataset.content_text=t[i].content_text,e.classList.add("js_wx_tap_highlight")}}}))}function gr(){if(!lr||!lr.length)return;const e={count:cr.length,type:[],username:[],aid:[],qid:[],question_id:[]};dr&&dr.length&&dr.forEach((t=>{e.question_id.push(t.dataset.qid)})),cr&&cr.length&&cr.forEach((t=>{const{usertype:i,username:n,aid:o,qid:s}=t.dataset;e.type.push(i),e.username.push(n),e.aid.push(o),e.qid.push(s)})),ye({type:"POST",url:"/mp/zhuge_appmsg?action=get_qa_info",data:e,dataType:"json",timeout:3e3,success:e=>{if(e&&e.base_resp&&-1!==e.base_resp.ret){const t=e.answer_list;t&&Array.isArray(t)&&fr(t);const i=e.question_list;i&&Array.isArray(i)&&function(e){const t=e.map((e=>({qid:e.question_content.qid,question_text:e.question_content.text,answer_count:e.answer_count,follow_count:e.follow_count,state:e.question_content.state})));dr.forEach(((e,i)=>{if(t[i]){const n=t[i].state;4!==n?(2===n?e.dataset.message="问题仍在审核中":8===n?e.dataset.message="问题审核不通过":64===n&&(e.dataset.message="该问题已被删除"),e.dataset.status=2):(e.dataset.follow_count=t[i].follow_count,e.dataset.answer_count=t[i].answer_count,e.classList.add("js_wx_tap_highlight"))}}))}(i)}},complete:()=>{cr.forEach((e=>{1===Number(e.dataset.status)&&(e.dataset.status=0)})),dr.forEach((e=>{1===Number(e.dataset.status)&&(e.dataset.status=0)}))}})}function yr(){gr(),function(){for(const e of lr){const t=e.shadowRoot.querySelector("button");t&&Ne.on(t,"touchstart",(e=>{e.stopPropagation()})),Ne.on(e,"click",(t=>{var i;if(2!==Number(e.dataset.status))if(rr.isWechat){const i=t.composedPath();if(i&&Array.isArray(i)){const t=i[0];!t||"BUTTON"!==t.tagName||window.zhuge_user_limit||window.is_teenager?(hr(ur.CLICK,e),Ee.invoke("openLiteApp",{appId:"wxalite2fd372f050eecd471a4392786dfae78c",page:"pages/question/entry",query:{qid:e.dataset.qid,aid:e.dataset.aid,scene:7,sceneNote:"".concat(window.biz?window.atob(window.biz):"0","_").concat(window.mid,"_").concat(window.idx)}},(e=>{console.log("open w1w",e)}))):(hr(ur.ANSWER,e),Ee.invoke("openLiteApp",{appId:"wxalite2fd372f050eecd471a4392786dfae78c",page:"pages/answer-editor/entry",query:{qid:e.dataset.qid,scene:7,sceneNote:"".concat(window.biz?window.atob(window.biz):0,"_").concat(window.mid,"_").concat(window.idx)}},(e=>{console.log("open w1w",e)})))}}else if(rr.isPCWechat){const t=mr("pages/question/entry",{qid:e.dataset.qid,aid:e.dataset.aid,scene:7,sceneNote:"".concat(window.atob(window.biz),"_").concat(window.mid,"_").concat(window.idx)});window.open(t)}else i="请在手机微信端打开",setTimeout((function(){window.weui?window.weui.alert(i):window.alert(i)}),0)}))}}(),function(){let e=null;e=new IntersectionObserver((function(t,i){t.forEach((t=>{if(t.isIntersecting){const i=t.target;hr(ur.EXPOSE,i),e.unobserve(i)}}))}),{threshold:0}),lr.forEach((t=>{e.observe(t)}))}()}const wr={tagName:"mp-common-product",CHANNEL_PRODUCT_DOMAIN:"https://mp.weixin.qq.com",isWechat:(Ae.isAndroid||Ae.isIOS)&&Ae.isWechat&&!Ae.isWxWork&&!Ae.isNewMpApp,exposureInit:!1};function vr(e,t,i){if(e){if(i&&"2"!==i.getAttribute("data-cardtype")){i.parentNode.style.margin="0 auto 24px";const e={compEle:i,compType:"channelProduct",compIdx:Array.from(document.getElementsByTagName("mp-common-product")).indexOf(i)};Me.renderCompSilentlyPreHandler(e),si(i,i.getAttribute("data-windowproduct")),Me.renderCompSilently(e)}!function(){if(wr.exposureInit)return;wr.exposureInit=!0;let e=null;e=new IntersectionObserver(((e,t)=>{e.forEach((e=>{if(e.isIntersecting){const i=e.target;try{const e=i.shadowRoot.querySelector("iframe");e&&e.contentWindow&&(pi(e.contentWindow,"webEvent",{type:"expose"}),t.unobserve(i))}catch(Nu){console.error(Nu)}}}))}),{threshold:1}),hi.forEach((t=>{e.observe(t)}))}()}}const br={init:function(){li(hi),di(),ci(),window.addEventListener("message",(e=>{const{iframeEle:t,productEle:i}=ui(e.source);if(e.origin===wr.CHANNEL_PRODUCT_DOMAIN&&i&&t)try{const{action:n,value:o}=JSON.parse(e.data);if(!n)return;const s=t.contentWindow;switch(n){case"changeFrameStyle":!function(e,t,i){if("2"!==t.getAttribute("data-cardtype")&&e&&t&&i&&"object"==typeof i)try{const n={compEle:t,compType:"channelProduct",subCompType:"cardHeight",compIdx:Array.from(document.getElementsByTagName("mp-common-product")).indexOf(t)};for(const t of Object.keys(i))"height"===t&&Me.renderCompSilentlyPreHandler(n),e.style[t]=i[t],"height"===t&&Me.renderCompSilently(n)}catch(Nu){console.error(Nu)}}(t,i,o);break;case"onFrameReady":vr(s,0,i)}}catch(Nu){console.error(Nu)}}))}},Sr=window.Vue,Ir={cacheTime:6e5,networkType:"",isPc:/(WindowsNT)|(Windows NT)|(Macintosh)/i.test(navigator.userAgent),defaultErrorWording:"视频加载失败，请刷新页面再试",defaultHeadImgUrl:"http://mmbiz.qpic.cn/mmbiz/a5icZrUmbV8p5jb6RZ8aYfjfS2AVle8URwBt8QIu6XbGewB9wiaWYWkPwq4R7pfdsFibuLkic16UcxDSNYtB8HnC1Q/0",playerStatus:{formatId:null},netTypeMap:{"network_type:fail":"fail","network_type:edge":"2g/3g","network_type:wwan":"2g/3g","network_type:wifi":"wifi"},definitionMap:{20003:4,10002:3,10003:2,10004:1,10102:3,10103:2,10104:1},resolutionNameMap:{10002:"超清",10003:"高清",10004:"流畅",10102:"超清",10103:"高清",10104:"流畅",20003:"自动"},playbackRateInfo:[{rate:.5,name:"0.5倍"},{rate:.75,name:"0.75倍"},{rate:1,name:"1.0倍"},{rate:1.5,name:"1.5倍"},{rate:2,name:"2.0倍"}],allCpsPlayersOfPage:{}},xr={NOT_IN_WECHAT:91,VIDEO_BAN:92},kr=new mi("cps_video_info"),Tr=["继续观看",""],Cr=["再次观看","refresh"],Ar={1:Tr.concat("135px"),2:Cr.concat("135px"),201:Tr.concat("100%"),202:Cr.concat("100%"),203:Tr.concat("135px"),204:Cr.concat("135px")},Er=Sr.extend({components:{Intersect:C,[Vt.name]:Vt},provide:{playerScene:"cps"},data:()=>({id:Date.now()+"_"+Math.floor(Math.random()*Math.floor(Date.now())),opt:null,playerOpt:null,wrapStyle:null,videoStyle:null,posterStyle:null,topStickyExpendWhenPaused:!1,showScreenshotMask:!1,screenshot:"",toastTips:"",canLoad:!0}),computed:{...h(["cgiData"]),...h("mp-video-player",["errType","errCode","errMsg","fullscreenStatus","orientationStatus","refreshBtnStatus","topStickyInfoStatus","commonReportData"]),innerPlugins(){return this.opt&&this.opt.plugins&&this.opt.plugins.filter((e=>e.type===Kt.TYPE_INNER))||[]},coverPlugins(){return this.opt&&this.opt.plugins&&this.opt.plugins.filter((e=>e.type===Kt.TYPE_COVER))||[]},controlPlugins(){return this.opt&&this.opt.plugins&&this.opt.plugins.filter((e=>e.type===Kt.TYPE_CONTROL))||[]},profilePlugins(){return this.opt&&this.opt.plugins&&this.opt.plugins.filter((e=>e.type===Kt.TYPE_PROFILE))||[]},topStickyInfoWording(){const e=Ar[this.topStickyInfoStatus];return e&&e[0]||"继续观看"},topStickyInfoIconClass(){const e=Ar[this.topStickyInfoStatus];return e&&e[1]||""},topStickyInfoMaskWidth(){const e=Ar[this.topStickyInfoStatus];return e&&e[2]||"100%"},extInfo(){return this.opt&&this.opt.extInfo||{}},isDramaVideo(){return this.extInfo&&this.extInfo.dramaInfo}},watch:{orientationStatus(e){this.$emit("orientation-change",e),this.fullscreenStatus?1===e?this.showScreenshotMask=!0:setTimeout((()=>{this.showScreenshotMask=!1}),250):this.showScreenshotMask=!1}},mounted(){Ir.allCpsPlayersOfPage[this.id]=this,this.opt&&this.opt.dontAutoInit||this.init(),this.onPageResize(),this.opt&&this.opt.autoplayWhenExpose&&(this.__debouncedOnScroll=Pe.debounce(this.onPageScroll.bind(this),250),window.addEventListener("scroll",this.__debouncedOnScroll),this.__debouncedOnScroll()),window.addEventListener("unload",this.onPageUnload),window.addEventListener("resize",this.onPageResize),document.addEventListener("visibilitychange",this.onVisibilityChange)},beforeDestroy(){this.opt&&this.opt.autoplayWhenExpose&&this.__debouncedOnScroll&&window.removeEventListener("scroll",this.__debouncedOnScroll),window.removeEventListener("unload",this.onPageUnload),window.removeEventListener("resize",this.onPageResize),document.removeEventListener("visibilitychange",this.onVisibilityChange)},methods:{...y("mp-video-player",["setError"]),init(){this.initController(),ke.addSpecificReport("native_data",(()=>({video_data:{vid:this.opt.vid,lastPlayedTime:this.getCurrentTime(),lastPlayedTimeExpiredTime:(Date.now()+Ir.cacheTime)/1e3}})))},initController(){this.opt={bizUserName:"",bizNickName:"",profileTabType:2,videoTitle:"",headImgUrl:"",preview:!1,fromid:0,oriStatus:3,isMpVideo:0,mpVideoCoverUrl:"",mpVideoTransInfo:[],showFullscreenMenu:!0,videoMd5:"",oriVid:"",vid:"",ckey:"",width:0,height:0,autoplay:!1,muted:!1,loop:!1,__biz:"",uin:"",mid:"",idx:"",comment_id:"",scene_type:0,hitBizuin:"",hitVid:"",totalRange:10,useFeFullscreen:!1,coverFit:"contain",lazyLoad:!1,blurFullscreenBackground:"all",canMute:!0,canFullscreen:!1,canChangePlaybackRate:!1,canPraiseVideo:!1,canShareVideo:!1,canLikeVideo:!1,...this.$options.opt,useWcSlPlayer:!1,useImmersiveMode:!1,isMpVideo:!0},this.opt.oriVid=this.opt.oriVid||this.opt.vid,this.opt.headImgUrl=this.opt.headImgUrl||Ir.defaultHeadImgUrl,1!=this.opt.oriStatus&&2!=this.opt.oriStatus&&(this.opt.oriStatus=3),this.__reportData=X.getVideoReportData(),this.__gWidth=this.__gWidth||this.opt.width,this.__gHeight=this.__gHeight||this.opt.height,this.__playRangeInfo=[],this.__dynamicErrMsg="",this.__isUnloaded=!1,this.__isShowTx=!1,this.__dataCount=0,this.__targetDataCount=2,this.__coverUrl="",this.__cacheStartTs=0,this.__initialData=null,this.__preventResize=Boolean(this.opt.initFullscreenStatus),this.__vInfo={status:null,coverUrl:"",dynamicData:null},this.initLazyLoad(),this.hideError(),this.initLegacyPlugins(),this.initReportData(),this.getCache(),window.__timelineInitialData&&(this.__initialData=window.__timelineInitialData,delete window.__timelineInitialData),this.getCoverUrl(),this.getAdvanceCodecSupportBeforeCallback((()=>{Ir.playerStatus&&!Ir.playerStatus.formatId?Pr((()=>this.getDynamicData())):this.getDynamicData()}))},reinit(e){this.opt&&"object"==typeof this.opt&&(this.$options.opt=e),delete this.__gWidth,delete this.__gHeight,this.$nextTick(this.init)},reload(){this.playerOpt=null,this.initController(),this.triggerEvent("reload")},resetPlayer(){const e=this.$refs.player;e&&(e.__canplay=!1,e.pause(),e.preventOperating(2),e.$refs.video.currentTime=0,e.currentTime=0)},initLazyLoad(){this.canLoad=!this.opt.lazyLoad,this.opt.lazyLoad&&(this.$on("startLoadVideo",(()=>{this.canLoad=!0,this.$nextTick((()=>{this.initPlugins(),this.triggerEvent("playerReady")}))})),this.$on("hideVideo",(()=>{this.canLoad=!1})))},initLegacyPlugins(){const e=this.opt.plugins||[];this.__blockPlugin={},this.__legacyPlugins=[];const t=new $t;t.setPlayer(this),t.init&&t.init(),this.__legacyPlugins.push(t);for(let i=0,n=e.length;i<n;i++){const t=e[i];t.prototype instanceof Kt||(t.setPlayer(this),t.init&&t.init(),this.__legacyPlugins.push(t))}},initPlugins(){this.$refs.innerPlugins&&this.$refs.innerPlugins.forEach((e=>e.initContext(this))),this.$refs.coverPlugins&&this.$refs.coverPlugins.forEach((e=>e.initContext(this))),this.$refs.controlPlugins&&this.$refs.controlPlugins.forEach((e=>e.initContext(this))),this.$refs.profilePlugins&&this.$refs.profilePlugins.forEach((e=>e.initContext(this)))},destroyPlugins(){this.opt.plugins=[],this.__legacyPlugins.forEach((e=>e.destroy&&e.destroy())),this.__legacyPlugins=[],this.__blockPlugin={}},initReportData(){let e=this.__reportData;e.mid=this.opt.mid,e.__biz=this.opt.__biz,e.idx=this.opt.idx,e.vid=this.opt.vid,e.commentid=this.opt.comment_id,e.scene_type=this.opt.scene_type,e.auto_play=this.opt.autoplay?1:0,e.fromid=this.opt.fromid,e.hit_bizuin=this.opt.hitBizuin,e.hit_vid=this.opt.hitVid,this.__monitorUid=this.triggerEvent("initMonitor",64728),this.__monitorUid2=this.triggerEvent("initMonitor",380812)},getReportTypeBySceneType(){return 0==this.opt.scene_type?1:1==this.opt.scene_type||2==this.opt.scene_type?2:4==this.opt.scene_type?3:7==this.opt.scene_type?4:0},onPageScroll(){const e=this.$refs.player;if(!this.__exposing)return void(!this.opt||!this.opt.autoplayWhenExpose||e&&e.isEnd()||this.__coverNextShowing||(this.__shouldPlayAfterCanplay=!1,setTimeout((()=>this.pause()))));Object.keys(Ir.allCpsPlayersOfPage).filter((e=>Ir.allCpsPlayersOfPage[e]&&Ir.allCpsPlayersOfPage[e].__exposing)).reduce(((e,t)=>{const i=Ir.allCpsPlayersOfPage[t].$el.getBoundingClientRect();let n=0;return i.top>=0?n=Math.max(Math.min(window.innerHeight-i.top,i.height),0):i.bottom>=0&&(n=Math.max(Math.min(i.bottom,window.innerHeight),0)),e[t]=n,n>=e.max&&(e.max=n,e.maxId=t),e}),{max:0,maxId:""}).maxId===this.id?!this.opt||!this.opt.autoplayWhenExpose||e&&e.isEnd()||this.__coverNextShowing||e&&e.isPlay()||(this.__canPlay?setTimeout((()=>{const e=this.getPlayer();e&&e.resumeOperating(),this.play(),this.triggerEvent("exposeAutoPlay")})):this.__shouldPlayAfterCanplay=!0):!this.opt||!this.opt.autoplayWhenExpose||e&&e.isEnd()||this.__coverNextShowing||(this.__shouldPlayAfterCanplay=!1,setTimeout((()=>this.pause())))},onPageUnload(e){if(this.__isUnloaded)return;this.__isUnloaded=!0;let t=this.__reportData;if(0===t.videoerror?this.cacheData():this.clearCache(),e&&"leaveReport"===e.type){const e=[];for(let i in t)t.hasOwnProperty(i)&&e.push(i+"="+encodeURIComponent(t[i]));return{reportUrl:"/mp/videoreport?",method:"POST",reportData:e.join("&")}}X.videoreport({data:t,async:!1})},onVisibilityChange(){document.hidden&&this.cacheData()},onPageResize(){this.__preventResize||(this.$refs.player&&this.$refs.player.isWcSlPlayer?this.fullscreenStatus||setTimeout((()=>{const e=this.$el.parentNode,t=e&&e.getBoundingClientRect(),i=t&&t.width||0;0!==i&&this.setVideoSize({width:i})}),0):this.opt.height&&this.opt.width&&(this.__isShowTx&&this.__txPlayer?setTimeout((()=>{try{const e=this.$el.parentNode,t=e&&e.getBoundingClientRect(),i=this.opt.width/this.opt.height,n=t&&t.width||0,o=Math.floor(n/i);0!==n&&(e.style.height=o+"px",this.__gWidth=n,this.__gHeight=o,this.__txPlayer.resize({width:n,height:o}))}catch(Mu){}}),0):setTimeout((()=>{const e=this.$el.parentNode,t=e&&e.getBoundingClientRect(),i=t.width,n=t.height;0!==i&&(this.__gWidth=i,this.__gHeight=n,this.setVideoSize({width:i,height:n}))}),250)))},getCache(){const e=function(e,t,i,n,o){let s=kr.get(n||o);if(!s)return null;try{if(s=JSON.parse(s)||{},!s.time||Date.now()-Ir.cacheTime>1*s.time)return Dr(n||o),s.videoInfo={status:Lr(e,t,i,n||o)},s}catch(Mu){return Dr(n||o),null}return s=s.videoInfo?s:{videoInfo:{}},s.videoInfo.status=Lr(e,t,i,n||o),s.videoInfo?s:null}(this.opt.__biz,this.opt.mid,this.opt.idx,this.opt.vid||this.opt.playUrl);if(e){const t=this.__vInfo;t.dynamicData=e.videoInfo.dynamicData||null,t.coverUrl=e.videoInfo.coverUrl||"",t.status=e.videoInfo.status||null,this.__cacheStartTs=e.time||null}},cacheData(){const e=this.$refs.player,t=this.__vInfo;e&&(t.status||(t.status={}),"function"==typeof e.isEnd&&(t.status.isEnd=e.isEnd()),"function"==typeof e.getCurTime&&(t.status.playTime=e.getCurTime()),"function"==typeof e.getPlaybackRate&&(t.status.playbackRate=e.getPlaybackRate()),!this.__initialData&&this.__coverUrl&&(t.coverUrl=this.__coverUrl),function(e,t,i,n,o,s){let a={dynamicData:o.dynamicData||null,coverUrl:o.coverUrl||""};const r=Date.now()+864e5;kr.set(n,JSON.stringify({time:s||Date.now(),videoInfo:a}),r),o.status&&kr.set(e+t+i+n,JSON.stringify(o.status),r)}(this.opt.__biz,this.opt.mid,this.opt.idx,this.opt.vid||this.opt.playUrl,this.__vInfo,this.__cacheStartTs))},clearCache(){Dr(this.opt.vid||this.opt.playUrl)},getCoverUrl(){this.__coverUrl=this.opt.cover,this.__dataCount++,this.videoDataReady(),this.getFloatCoverBase64(this.__coverUrl)},getDynamicData(){if(window.cgiData.is_teenager||window.is_teenager)return this.__dynamicErrMsg="青少年模式下暂不支持观看视频",this.__reportData.duration_ms=0,this.__vInfo.dynamicData=null,this.__dataCount=this.__targetDataCount,void setTimeout((()=>this.videoDataReady()),0);if(this.isDramaVideo){if(!Ae.isWechat)return this.__dynamicErrMsg="请在微信客户端打开",this.__reportData.videoerror=xr.NOT_IN_WECHAT,this.__reportData.duration_ms=0,this.__vInfo.dynamicData=null,this.__dataCount=this.__targetDataCount,void setTimeout((()=>this.videoDataReady()),0);if(this.extInfo&&this.extInfo.dramaInfo&&this.extInfo.dramaInfo.ban)return this.__dynamicErrMsg="视频暂时无法播放",this.__reportData.videoerror=xr.VIDEO_BAN,this.__reportData.duration_ms=0,this.__vInfo.dynamicData=null,this.__dataCount=this.__targetDataCount,setTimeout((()=>this.videoDataReady()),0),void Se.error("cps player controller: failed to play drama video: dramaBan")}this.__vInfo.dynamicData={data:{formatid:10003,time:this.opt.duration,title:"",width:this.opt.videoWidth,height:this.opt.videoHeight,file_size:0,totalUrl:this.opt.playUrl,rate:0,ori_url_info:[{format_id:10003,url:this.opt.playUrl}]}},this.__dataCount++,this.videoDataReady()},videoDataReady(){this.__dataCount===this.__targetDataCount&&(this.__isShowTx?this.removeLoading():this.__vInfo.dynamicData?this.createPlayer():(this.removeLoading(),Se.error("cps player controller: failed to create player because no dynamic data")))},createPlayer(){let e=this.__vInfo,t=this.__reportData,i=e.dynamicData.data;this.__reportData.duration_ms=parseInt(1e3*i.time),this.initPlayRangeInfo({durationMs:this.__reportData.duration_ms}),t.vtitle=this.opt.vtitle||i.title||"";const n=this.getReportTypeBySceneType();let o,s;if(i.ori_url_info){const e=function(e){const t={};return e.url_info.forEach((i=>{let n;const o=i.format_id;switch(1*o){case 20003:case 10002:case 10003:case 10004:t[Ir.definitionMap[o]]||(n=Ir.definitionMap[o]);break;case 10102:case 10103:case 10104:e.h265&&(n=Ir.definitionMap[o])}n&&(t[n]=i)})),t}({h265:this.__supportH256,url_info:i.ori_url_info});o=i.ori_url_info.find((e=>10004===e.format_id)),s=Object.keys(e).filter((e=>1*e!==Ir.definitionMap[20003]||this.opt.useWcSlPlayer&&Ae.isWechat&&Ae.isAndroid&&Ae.gtVersion("7.0.16",1))).sort(((e,t)=>t-e)).map((t=>{const i=e[t];return{name:i.video_quality_wording||Ir.resolutionNameMap[i.format_id],formatId:i.format_id,height:i.height,width:i.width,src:i.url}}))}const a=be.getQuery("play_time");let r=0;this.__initialData?r=this.__initialData.initialTime||0:""!==a?r=1*a||0:e.status&&!e.status.isEnd&&(r=e.status.playTime||0),console.info("[CPS Video Info]",i),Se.info("cps player controller: begin to create player",JSON.stringify(i)),this.playerOpt={...this.opt,__biz:this.opt.__biz,mid:this.opt.mid,idx:this.opt.idx,bizUserName:this.opt.bizUserName,bizNickName:this.opt.bizNickName,profileTabType:this.opt.profileTabType,videoTitle:t.vtitle,videoReportType:n,coverFit:this.opt.coverFit,cover:this.__coverUrl,width:this.__gWidth,height:this.__gHeight,videoWidth:i.width,videoHeight:i.height,duration:i.time,autoplay:this.opt.autoplay,flowNotice:this.opt.flowNotice,flow:i.flow,loop:this.opt.loop,muted:this.opt.muted,src:i.totalUrl,formatId:i.formatid,headImgUrl:this.opt.headImgUrl,useWcSlPlayer:this.opt.useWcSlPlayer,useImmersiveMode:this.opt.useImmersiveMode,useFeFullscreen:this.opt.useFeFullscreen,oriStatus:this.opt.oriStatus,initialTime:r,resolutionInfo:s,retryResolution:o,playbackRateInfo:Ir.playbackRateInfo,playbackRateBtnInfoDefaultId:2,showFullscreenMenu:this.opt.showFullscreenMenu,videoMd5:this.opt.videoMd5,extinfo:{hit_bizuin:this.opt.hitBizuin,hit_vid:this.opt.hitVid,vid:this.opt.vid,preview:this.opt.preview,pageplayer:this},fileSize:i.file_size,checkPlayAuthority:this.checkPlayAuthority,readNum:this.__immersiveData&&this.__immersiveData.view_num&&this.__immersiveData.view_num.pv||0,praiseNum:this.__immersiveData&&this.__immersiveData.like_num&&this.__immersiveData.like_num.pv||0,likeNum:this.__immersiveData&&this.__immersiveData.seen_num&&this.__immersiveData.seen_num.pv||0,isPraised:this.__immersiveData&&this.__immersiveData.like_num&&this.__immersiveData.like_num.liked||0,isLiked:this.__immersiveData&&this.__immersiveData.seen_num&&this.__immersiveData.seen_num.seen||0,disableBorderRadius:!0,alwaysShowControl:this.opt.alwaysShowControl,hideDuration:this.opt.hideDuration||!1},this.$nextTick((()=>{this.initPlugins(),this.triggerEvent("playerReady")}))},removeLoading(){this.afterRemoveLoading()},afterRemoveLoading(){if(!this.__isShowTx&&!this.__vInfo.dynamicData)if(this.opt.isMpVideo){let e=1;(-1!==[72,73].indexOf(this.__reportData.videoerror)||window.cgiData.is_teenager||window.is_teenager||-1!==Object.values(xr).indexOf(this.__reportData.videoerror))&&(e=2),this.showError(this.__dynamicErrMsg,e)}else this.showError(this.__dynamicErrMsg||"",window.cgiData.is_teenager||window.is_teenager?2:void 0);const e=this.getVideoData();this.triggerEvent("videoReady",{formatId:e&&e.formatid})},showError(e,t){e=e||Ir.defaultErrorWording,this.setError({type:t||1,code:this.__reportData.videoerror,msg:e,refresh:e===Ir.defaultErrorWording?1:0})},hideError(){this.setError({type:0,code:0,msg:"",refresh:0})},checkPlayAuthority(e){this.opt.checkNoPaid?ye({type:"GET",dataType:"json",timeout:3e4,url:"/mp/videoplayer?action=check_video_paid_status&__biz=".concat(this.opt.__biz,"&mid=").concat(this.opt.mid,"&idx=").concat(this.opt.idx),success:t=>{1==!t.can_play?window.weui.confirm("此视频来自于付费内容，在原文付费后才可播放",{buttons:[{type:"default",label:"取消"},{label:"前往原文",onClick:()=>{this.opt.openArticle()}}]}):"function"==typeof e.allowPlay&&e.allowPlay()}}):"function"==typeof e.allowPlay&&e.allowPlay()},onExpose(){this.__exposing=!0,this.triggerEvent("playerExpose")},onExposeLeave(){this.$refs.player,this.__exposing=!1,this.triggerEvent("playerExposeLeave")},onLoaded(){setTimeout((()=>{this.removeLoading()}),0),Se.info("cps player controller: succ created player")},onTimeupdate(e){if(!this.__reportedTimeupdate){this.__reportedTimeupdate=!0;this.$refs.player.getLog().loadwait}if(!this.__reportedPv){this.__reportedPv=!0;const e=this.__monitorUid,t=this.__monitorUid2;this.triggerEvent("clearMonitor",e),this.triggerEvent("clearMonitor",t),this.opt.isMpVideo?(this.triggerEvent("setMonitor",t,{12:1,13:1}),this.triggerEvent("sendMonitor",t)):(this.triggerEvent("setMonitor",e,{0:1,1:1}),this.triggerEvent("sendMonitor",e))}this.__reportData.last_ms=parseInt(1e3*e.currentTime),this.__reportData.video_play_time=parseInt(1e3*e.currentTime),this.triggerEvent("timeupdate",e)},onBeginPlay(){const e=this.__reportData;e.client_time_when_play=Math.round(Date.now()/1e3),e.click_play_button=1,!this.$refs.player.autoplay&&this.recoverPlaybackRate(),this.triggerEvent("beginPlay")},onDurationchange(){this.$refs.player.autoplay&&this.recoverPlaybackRate()},onTouchVideo(){this.triggerEvent("touchVideo")},onOpenSourcePage(){this.triggerEvent("openSourcePage")},onFastForward(){this.triggerEvent("fastForward")},onReplay(){this.triggerEvent("replay")},onStatusChange(e){const t=this.__reportData;"loading"!==e.status||"seeked"!==e.subStatus&&"seeking"!==e.subStatus||this.initPlayRangeInfo({durationMs:t.duration_ms}),"pause"===e.status?this.computePlayTotalTimeForKyk(e):"play"===e.status||e.status,"loading"===e.status&&"waiting"===e.subStatus&&("play"===e.preStatus||"loading"===e.preStatus&&"seeked"===e.preSubStatus||"loading"===e.preStatus&&e.preSubStatus),this.triggerEvent("statusChange",e)},onAfterReplay(){this.triggerEvent("afterReplay")},onHandDragComplete(e){this.triggerEvent("handDragComplete",e)},onBarDragComplete(e){this.triggerEvent("barDragComplete",e)},onEnd(){const e=this.__vInfo,t=this.__reportData;e.dynamicData.data,this.getReportTypeBySceneType(),t.hasended=1,this.triggerEvent("beforeEnd",this.playerOpt.loop),this.playerOpt.loop?(this.__reportedPv=!1,this.__reportData.replay=1):this.triggerEvent("resetVideo"),this.triggerEvent("end",this.playerOpt.loop),this.initPlayRangeInfo({durationMs:t.duration_ms})},onError(e){const t=this.__reportData;this.__monitorUid;const i=this.__monitorUid2;switch(!e||!e.errorcode||e.errorcode>5||e.errorcode<=0?t.videoerror=46:t.videoerror=e.errorcode+40,this.__reportedPv||(this.__reportedPv=!0,this.triggerEvent("setMonitor",i,{12:1})),this.triggerEvent("setMonitor",i,{14:1}),1*e.errorcode){case 1:this.triggerEvent("setMonitor",i,{15:1});break;case 2:this.triggerEvent("setMonitor",i,{16:1});break;case 3:this.triggerEvent("setMonitor",i,{17:1});break;case 4:this.triggerEvent("setMonitor",i,{18:1});break;case 5:this.triggerEvent("setMonitor",i,{19:1});break;case 6:this.triggerEvent("setMonitor",i,{39:1});break;default:this.triggerEvent("setMonitor",i,{20:1})}this.triggerEvent("sendMonitor",i),t.v_err_code=e.errorcode,this.showError(),this.initPlayRangeInfo({durationMs:t.duration_ms})},onErrorRetry(){const e=this.__monitorUid2;this.triggerEvent("setMonitor",e,{64:1}),this.triggerEvent("sendMonitor",e)},onFirstBufferingTime(e){var t;if(this.__hasFirstPlayed||this.$refs.player.autoplay,this.opt.isMpVideo){this.$store.state.cgiData;const e=this.getVideoData();null==(t=e.ori_url_info)||t.some((e=>1*e.format_id%1e3>100)),e.formatid,e.formatid}this.__hasFirstPlayed||(this.__hasFirstPlayed=!0),this.triggerEvent("firstBufferingTime",e)},onPlayingBufferingTime(e){this.triggerEvent("playingBufferingTime",e)},onUserplay(e){this.triggerEvent("userplay",e),1===e.tapType||e.tapType},onUserpause(e){this.triggerEvent("userpause",{curTime:this.getCurrentTime(),...e});const t=this.__reportData;t.pause_num=(t.pause_num||0)+1,1===e.tapType||e.tapType},onWaiting(e){this.triggerEvent("waiting",e)},onPlay(e){this.__pauseTimestamp&&delete this.__pauseTimestamp,this.triggerEvent("play",e)},onPause(e){this.triggerEvent("pause",e),this.__pauseTimestamp=Date.now()},onMidPlayClick(){},onAfterCheckVideoFit(e){let t={97:1};!0===e.needToFit&&(t[98]=1,t[100]=1,e.os.ios&&(t[103]=1),e.os.android&&(t[106]=1),!0===e.supportObjectFit&&(t[101]=1,e.os.ios&&(t[104]=1),e.os.android&&(t[107]=1)));const i=this.__monitorUid;this.triggerEvent("setMonitor",i,t),this.triggerEvent("sendMonitor",i)},onBindError(e){this.triggerEvent("bindError",e)},onRateChange(e){this.triggerEvent("rateChange",e),"changed"===e.action&&this.cacheData()},onResolutionChange(e){"changed"===e.action&&(Ir.playerStatus.formatId=e.infoAfter&&e.infoAfter.formatId||null,kr.set("playerStatus",JSON.stringify({playerStatus:Ir.playerStatus}),Date.now()+6048e5),Ee.invoke("handleMPPageAction",{action:"setLocalData",key:"formatId",data:String(Ir.playerStatus.formatId),url:location.href},(e=>{console.log("setLocalData"+JSON.stringify(e))})),Se.info("player controller: set player status cache "+JSON.stringify(Ir.playerStatus))),this.triggerEvent("resolutionChange",e)},onBrightnessChange(e){this.triggerEvent("brightnessChange",e)},onVolumeChange(e){this.triggerEvent("volumeChange",e)},onLoadedMetaData(){if(this.getAndUpdateVideoInfo(),this.__canPlay=!0,this.__shouldPlayAfterCanplay){const e=this.getPlayer();e&&e.resumeOperating(),this.play(),this.triggerEvent("exposeAutoPlay"),this.__shouldPlayAfterCanplay=!1}this.triggerEvent("loadedmetadata")},onProfileJump(e){this.triggerEvent("profileJump",e)},onProcessStateChange(e){this.triggerEvent("processStateChange",e)},onCanplay(e){this.getAndUpdateVideoInfo(),this.triggerEvent("canplay",e)},onAfterFirstLoaded(e){this.triggerEvent("afterfirstloaded",e)},onShowControlBar(e){this.triggerEvent("showControlBar",e)},onHideControlBar(e){this.triggerEvent("hideControlBar",e)},triggerEvent(e,...t){const i=[].concat(this.$refs.innerPlugins||[],this.$refs.coverPlugins||[],this.$refs.controlPlugins||[],this.$refs.profilePlugins||[],this.__legacyPlugins),n=this.__blockPlugin[e]||this.__blockPlugin.all;let o,s,a=0;if(n&&"function"==typeof n.recv&&(o=n.recv(e,...t),"[object Object]"===Object.prototype.toString.call(o)?(a|=o.code,s=o.data):a|=o,1&a))return s;for(let l=0,d=i.length;l<d;++l){try{o=i[l].recv(e,...t)}catch(r){console.error("player controller plugin error:",r,e,t)}if("[object Object]"===Object.prototype.toString.call(o)?(a|=o.code,s=o.data):a|=o,2&a)break}if(!(this._blockInnerHandler||4&a)){const i=this[e+"InnerHandler"];i&&(o=i.apply(this,[e,...t]),"[object Object]"===Object.prototype.toString.call(o)&&(s=o.data))}return 8&a||this.emitEvent(e.replace(/[A-Z]/g,(e=>"-"+e.toLowerCase())),...t),s},emitEvent(e,...t){e&&this.$emit(e,...t)},getAndUpdateVideoInfo(){const e=this.getPlayer();if(e&&e.$refs.video){const t=Math.round(e.$refs.video.duration),i=e.$refs.video.videoWidth,n=e.$refs.video.videoHeight;t!==this.playerOpt.duration&&0!==t&&this.$set(this.playerOpt,"duration",t),i!==this.playerOpt.videoWidth&&0!==i&&this.$set(this.playerOpt,"videoWidth",i),n!==this.playerOpt.videoHeight&&0!==n&&this.$set(this.playerOpt,"videoHeight",n)}},setBlockPlugin(e,t){this.__blockPlugin[e]=t},getPlayer(){return this.$refs.player},supportWcSlPlayer(){return!!this.$refs.player&&this.$refs.player.supportWcSlPlayer()},getAdvanceCodecSupportBeforeCallback(e){this.checkH265Support(e)},checkH265Support(e){if(this.opt.useWcSlPlayer&&ve.os.iphone)this.__supportH256=!0,"function"==typeof e&&e();else if(this.opt.useWcSlPlayer&&ve.os.android)Ae.gtVersion("8.0.14",1)?Ee.invoke("handleVideoAction",{action:"supportCodec",codecId:172,height:1920,width:1080,frameRate:60},(t=>{const i=-1!==t.err_msg.indexOf(":ok");this.__supportH256=i,"function"==typeof e&&e()})):(this.__supportH256=!1,"function"==typeof e&&e());else{let t=!1;t=Ae.isIOS&&ve.os.getNumVersion()>=11?!ve.isLockdownMode():Ae.isAndroid?this.checkH5VideoCanPlayType('video/mp4; codecs="hvc1"'):this.checkH5VideoCanPlayType('video/mp4; codecs="hevc"'),this.__supportH256=t,"function"==typeof e&&e()}},checkH5VideoCanPlayType(e){const t=document.createElement("video");if("function"==typeof t.canPlayType){const i=t.canPlayType(e);if("maybe"==i.toLowerCase()||"probably"==i.toLowerCase())return!0}return!1},initPlayRangeInfo(e){if(e.durationMs<=0)return;const t=this.opt.totalRange;function i(e,t){const i=[{start:0,end:e,hasReport:!1}];for(;;){let n=i[i.length-1];if(n.end>=t)break;i.push({start:n.end,end:n.end+e,hasReport:!1})}return i}1e3*t>=e.durationMs?this.__playRangeInfo=i(1e3,e.durationMs):this.__playRangeInfo=i(Math.ceil(e.durationMs/t),e.durationMs)},getTraceId:()=>0,getOrderid:()=>0,getOriStatus(){return this.opt.oriStatus},getFromid(){return this.opt.fromid},resetVideoInnerHandler(){this.$refs.player.isWcSlPlayer?this.$refs.player.showCover():this.$refs.player.resetVideo()},coverNextShowStatusChangeInnerHandler(e){this.__coverNextShowing=e},pause(){this.$refs.player&&this.$refs.player.pause4outer()},play(){this.$refs.player&&this.$refs.player.play4outer()},getRealPlayTime(){let e=0,t=this.$refs.player;return t&&(e=Math.round(1e3*t.getPlayTotalTime())),e},getCurrentTime(){let e=0,t=this.$refs.player;return t&&(e=t.getCurTime()),e},getCurrentTimeMs(){return Math.round(1e3*this.getCurrentTime())},getVideoData(){return this.__vInfo&&this.__vInfo.dynamicData&&this.__vInfo.dynamicData.data?this.__vInfo.dynamicData.data:null},getReportData(){return this.__reportData},extendMpReportData(e){Object.assign(this.__reportData,e)},getMpReportData(){return this.__reportData},recoverPlaybackRate(){const e=this.__vInfo.status,t=e&&e.playbackRate||1;this.$refs.player.setPlaybackRate(t),this.$refs.player.isWcSlPlayer&&setTimeout((()=>{this.$refs.player&&this.$refs.player.setPlaybackRate(t)}),250)},setLoop(e){this.playerOpt&&(this.playerOpt.loop=e)},setMuted(e){this.playerOpt&&(this.playerOpt.muted=e)},setAutoplay(e){this.$refs.player&&(this.$refs.player.autoplay=e)},setVideoSize(e){this.playerOpt&&("number"==typeof e.width&&(this.playerOpt.width=e.width),"number"==typeof e.height&&(this.playerOpt.height=e.height))},getVideoDuration(){return this.playerOpt&&this.playerOpt.duration||0},getFloatCoverBase64(e){const t=new Image;t.crossOrigin="anonymous",t.onload=()=>{t.onload=null,t.onerror=null;try{const e=t.naturalWidth||t.width,i=t.naturalHeight||t.height,n=document.createElement("canvas"),o=n.getContext("2d"),s=640,a=1280;n.width=s,n.height=a,n.style.width=s+"px",n.style.height=a+"px";const r=function(e="cover",t,i,n,o){let s=1,a=0,r=0,l=n,d=o,c=0,u=0,p=t,h=i,m=t/i,_=n/o;"cover"===e?_>=m?(s=i/o,a=(n-t/s)/2,l=t/s,d=o):(s=t/n,r=(o-i/s)/2,l=n,d=i/s):"contain"===e&&(_>=m?(s=t/n,u=(i-o*s)/2,h=o*s):(s=i/o,c=(t-n*s)/2,p=n*s));return[a,r,l,d,c,u,p,h]}("contain",s,a,e,i);o.drawImage(t,...r),o.beginPath(),o.moveTo(s/2-50,a/2-60),o.lineTo(s/2-50,a/2+60),o.lineTo(s/2+50,a/2),o.fillStyle="rgba(255,255,255,0.8)",o.strokeStyle="rgba(255,255,255,0.8)",o.shadowBlur=100,o.shadowColor="rgba(0,0,0,0.5)",o.fill(),o.closePath(),o.stroke(),this.__floatCoverBase64=n.toDataURL("image/jpeg",0),this.__floatCoverBase64=this.__floatCoverBase64.replace("data:image/jpeg;base64,","")}catch(Mu){this.__floatCoverBase64="",console.error(Mu)}},t.onerror=()=>{this.__floatCoverBase64="",t.onload=null,t.onerror=null},t.src=e},showToast(e){this.__toastTimeoutId&&clearTimeout(this.__toastTimeoutId),this.toastTips=e,this.__toastTimeoutId=setTimeout((()=>{this.__toastTimeoutId=null,this.toastTips=""}),1e3)},computePlayTotalTimeForKyk(e){},getCurrentDefinition(){return Ir.playerStatus.formatId?Ir.definitionMap[Ir.playerStatus.formatId]:this.__vInfo.dynamicData?Ir.definitionMap[this.__vInfo.dynamicData.data.formatid]:0},onTouchMoveHorizontally(e){this.triggerEvent("touchMoveHorizontally",e)},onPlayerTouchEnd(e){this.triggerEvent("playerTouchEnd",e)},onSeekingStatusChange(e){this.triggerEvent("seekingStatusChange",e)},onSwipeBack(e){this.triggerEvent("swipeBack",e)},onMuteChange(e){Object.keys(Ir.allCpsPlayersOfPage).forEach((t=>{const i=Ir.allCpsPlayersOfPage[t],n=i&&i.$refs.player,o=n&&n.$refs.video;o&&(o.muted=e,n.$set(n.opt,"muted",e))})),this.triggerEvent("muteChange",e)},onClickPlaySwitch(e){this.triggerEvent("clickPlaySwitch",e)}}});function Pr(e){!Ir.networkType&&Ae.isWechat&&(Ae.isIOS||Ae.isAndroid)?Ee.invoke("getNetworkType",{},(t=>{Ir.networkType=Ir.netTypeMap[t.err_msg]||"fail","network_type:edge"!=t.err_msg&&"network_type:wwan"!=t.err_msg||(t.detailtype||t.subtype)&&(Ir.networkType=t.detailtype||t.subtype),"function"==typeof e&&e()})):"function"==typeof e&&e()}function Lr(e,t,i,n){let o=kr.get(e+t+i+n);if(!o)return null;try{o=JSON.parse(o)||{}}catch(Mu){return function(e,t,i,n){kr.remove(e+t+i+n)}(e,t,i,n),null}return o}function Dr(e){kr.remove(e)}Pr(),function(){let e=kr.get("playerStatus");if(e){try{e=JSON.parse(e)||{}}catch(Mu){return void Dr("playerStatus")}e.playerStatus&&(Ir.playerStatus=e.playerStatus,Se.info("cps player controller: get player status cache "+JSON.stringify(Ir.playerStatus)))}}();const Rr=Er;Vt._getFormatTime,Vt._getAllPlayersOfPage;const Br=xt(Rr,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("intersect",{attrs:{threshold:[.5]},on:{enter:e.onExpose,leave:e.onExposeLeave}},[t("div",{staticClass:"mp-video-player",style:{height:e.fullscreenStatus?"100vh":"100%"}},[0===e.errType&&e.playerOpt?t("mp-video-player",{ref:"player",class:101===e.fullscreenStatus?"opr_fade_out":"",attrs:{opt:e.playerOpt,"can-load":e.canLoad,"wrap-style":e.wrapStyle,"video-style":e.videoStyle,"poster-style":e.posterStyle},on:{loaded:e.onLoaded,timeupdate:e.onTimeupdate,"begin-play":e.onBeginPlay,durationchange:e.onDurationchange,"status-change":e.onStatusChange,"after-replay":e.onAfterReplay,"hand-drag-complete":e.onHandDragComplete,"bar-drag-complete":e.onBarDragComplete,end:e.onEnd,error:e.onError,"error-retry":e.onErrorRetry,"first-buffering-time":e.onFirstBufferingTime,"playing-buffering-time":e.onPlayingBufferingTime,userplay:e.onUserplay,userpause:e.onUserpause,waiting:e.onWaiting,play:e.onPlay,pause:e.onPause,"mid-play-click":e.onMidPlayClick,"after-check-video-fit":e.onAfterCheckVideoFit,"bind-error":e.onBindError,"rate-change":e.onRateChange,"resolution-change":e.onResolutionChange,"brightness-change":e.onBrightnessChange,"volume-change":e.onVolumeChange,"profile-jump":e.onProfileJump,"process-state-change":e.onProcessStateChange,canplay:e.onCanplay,"show-control-bar":e.onShowControlBar,"hide-control-bar":e.onHideControlBar,replay:e.onReplay,"touch-video":e.onTouchVideo,"open-source-page":e.onOpenSourcePage,"fast-forward":e.onFastForward,loadedmetadata:e.onLoadedMetaData,"touch-move-horizontally":e.onTouchMoveHorizontally,"player-touch-end":e.onPlayerTouchEnd,"seeking-status-change":e.onSeekingStatusChange,"swipe-back":e.onSwipeBack,afterfirstloaded:e.onAfterFirstLoaded,"mute-change":e.onMuteChange,"click-play-switch":e.onClickPlaySwitch},scopedSlots:e._u([{key:"poster",fn:function({cover:i,coverStatus:n,videoSnapshot:o,withoutCover:s}){return[t("div",{directives:[{name:"show",rawName:"v-show",value:(i&&0!==n||o)&&!s,expression:"(cover && coverStatus !== 0 || videoSnapshot) && !withoutCover"}],staticClass:"poster_cover_wrp",style:e.posterStyle},[t("div",{staticClass:"poster_cover",style:"background-image: url(".concat(o||i.imgChange640(),"); background-size: contain; background-color: transparent;")}),t("div",{staticClass:"poster_cover_blur_wrp"},[t("div",{staticClass:"poster_cover_blur"}),t("div",{staticClass:"poster_cover",style:"background-image: url(".concat(o||i.imgChange640(),"); background-size: cover;")})])])]}},{key:"video_background",fn:function({cover:e}){return[t("div",{staticClass:"poster_cover_blur_wrp"},[t("div",{staticClass:"poster_cover_blur"}),t("div",{staticClass:"poster_cover",style:"background-image: url(".concat(e.imgChange640(),"); background-size: cover;")})])]}},{key:"inner",fn:function(){return e._l(e.innerPlugins,(function(e,i){return t(e,{key:i,ref:"innerPlugins",refInFor:!0,tag:"component"})}))},proxy:!0},{key:"cover",fn:function(){return e._l(e.coverPlugins,(function(e,i){return t(e,{key:i,ref:"coverPlugins",refInFor:!0,tag:"component"})}))},proxy:!0},{key:"control",fn:function(){return e._l(e.controlPlugins,(function(e,i){return t(e,{key:i,ref:"controlPlugins",refInFor:!0,tag:"component"})}))},proxy:!0},{key:"profile",fn:function(){return e._l(e.profilePlugins,(function(e,i){return t(e,{key:i,ref:"profilePlugins",refInFor:!0,tag:"component"})}))},proxy:!0}],null,!1,4255383019)}):1===e.errType?t("div",{staticClass:"wrp_pop_tips wx_video_error_box js_error_box"},[t("div",{staticClass:"wx_video_error_msg js_error_area"},[t("p",{attrs:{role:"heading"}},[e._v(e._s(e.errMsg))]),t("i",{staticClass:"wx_video_error_code"},[e._v("错误码："+e._s(e.errCode))]),0!==e.refreshBtnStatus?t("a",{staticClass:"wx_video_error_msg_btn js_video_errormsg_btn",attrs:{role:"button",href:"javascript:void(0);"},on:{click:e.reload}},[t("img",{staticClass:"wx_video_error_refresh",attrs:{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAqCAMAAADhynmdAAAAQlBMVEUAAACcnJycnJycnJyoqKicnJycnJycnJycnJycnJyfn5+cnJydnZ2enp6kpKSdnZ2cnJyenp6cnJycnJycnJybm5t8KrXMAAAAFXRSTlMAyeb3CNp3tJRvHIEtJhBgqztWRJ+p5TqGAAABCklEQVQ4y5WTi27DIAxFAUMhgTzX8/+/urB2pdKI0x0pSoRuruyLbf7gF3PBaDE6X44LyY0D1SJQsfd9PpMM/CJx60v8SmV1HMSi1lKyA1n0jnwWSO08l04uJbxpBmTrpDtbGB6fmxC6Tc4BHv9aZDJdJsHW9w43Jez9x8T5M4l31WZsJn2bsYY+nUum2lQkGIVANPZ4FCLWOJImSTgjZE2SkU9crmu57mj9JBc93Qzj9R1d3HSG5bN5MRsnUzcGKK8Ns02z+Da7rYQE4bUE2PG1C6kVnkCyf0pwX8/jwbyxCLhcHpKTFkvkwK3pRmXtRrVFoTGYLvN+t0EUl0qrRaF1pFBz0anp/ptvNB4SY1XDAVMAAAAASUVORK5CYII=",alt:""}}),e._v(" 刷新 ")]):e._e()]),t("img",{staticClass:"wx_video_error_loading js_video_errormsg_loading",staticStyle:{display:"none"},attrs:{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADkAAAA5CAMAAAC7xnO3AAAAY1BMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+aRQ2gAAAAIXRSTlMAOx20pMJbzBQNTDGTh2ohLCZmeUF2hEmXCFdxUquef4yHE17nAAACnklEQVRIx9WW2xqiIBSFRc1AUATJU1a+/1MOm0NYKvnNXM260ZLftRcbqCQinOLI0yiY/iXKuUZPjx5Fk+6RhF1yHiVF0wC6IZfr9fqIkpRqdNyQ9AoiUU8g+YZ8Xn96YmNKvkhkLMskKgEo/yJzaxkXeZsGsjeWKEIFU/FBZgA+D5yEwGtTgR0J18lYUvdcLZ1YkUjLf+a0saYYSG/J3Hury+WSkTCjCETtF6Mvd8QGJMZSWIfsAlKhWGRl5zQ1ZNBDgy/zzvvFavWUK7SyTRs+rsiUZS/4LHIHyo8VgBx7vDkKx2WhPS7dD1Q6cNlu2dTa0gMys4bz/vJR6ph8ADgcVcSVUkfnhzJTc6gRj8fbCOHk30UI2KC+V4gKjskJQqC5frFHli0kafogFIfFkAXVCSqdAFVR8pmtVCWiXCtaarbWpGtQAYx7sjf2GCbfjFRQpH7lTLucveSMBE7+Z6VqViT2/PVs0d7hPk9TUcTaUuVaT8k/f/v6SXOgyG7InZaSvM8vj/309LrbvpSAORDH2/kWGyHhm/u5AYUc8qdFBRRrsV749bRv6I5x1OY50GZUUxQz9aGplAXZcOQ1DL3vwsTyvHQ2YWgjZV2rDTmxYRjUuoBvcQDr7QRLBiiNzJ4BawG3FLtTmEMGBigTRyC2oIKht1vbwLWrKmXKBZal+yApDGhm4q5JCVdNdrZeQBe8B44WnE2NGmxrR1bCvMugHdkhSwMWI9wjIGeosnPlJmNrst6PQrpeFkBSyAmkdD016DYqAVC6HHcNtnCPgazcuytAd5IqB/qYtq4bkP7vnEaL3W4KH9/HhKBAKl8XFUlMIWYIek4hZgh6UtjHBLVA4pPkCKRf9jOQ5Kwp1UvPDyb3qkPJaRG8Ln7f8Q8Bki/Kj5IYnQAAAABJRU5ErkJggg=="}})]):2===e.errType?t("div",{staticClass:"wrp_pop_tips wx_video_msg_primary js_error_box",style:{height:e.fullscreenStatus?"100%":"calc(100% - 12px)"}},[t("div",{staticClass:"wx_video_msg_primary_inner"},[t("p",{staticClass:"wx_video_msg_primary_text"},[e._v(e._s(e.errMsg))])])]):e._e(),t("div",{directives:[{name:"show",rawName:"v-show",value:e.toastTips,expression:"toastTips"}]},[t("div",{staticClass:"weui-mask_transparent"}),t("div",{staticClass:"weui-toast",style:{top:0===e.orientationStatus?"45%":"50%",position:"absolute"}},[t("i",{staticClass:"weui-icon-success-no-circle weui-icon_toast"}),t("p",{staticClass:"weui-toast__content"},[e._v(e._s(e.toastTips))])])]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showScreenshotMask,expression:"showScreenshotMask"}],staticClass:"fullscreen-screenshot__layer",staticStyle:{"background-color":"#000"}}),t("div",{directives:[{name:"show",rawName:"v-show",value:e.screenshot,expression:"screenshot"}],staticClass:"fullscreen-screenshot__layer",style:"z-index: -1; background-image: url("+e.screenshot+")"})],1)])}),[],!1,null,"498c5dbd",null,null).exports;window.Vue.use(W);const Or=()=>{const e=new W.Store({modules:{[F.name]:F},state:z(),mutations:U()});return e.commit(Y.SET_CGI_DATA,Q(window.cgiData)),e.commit(Y.SET_URL_PARAMS,Z()),[ee].forEach((t=>e.registerModule([F.name,t.name],t))),e};const jr=()=>{let e=0;const t=ve.os.version;let i="unknown";return ve.os.ios&&(e=1,i="IOS ".concat(t)),ve.os.android&&(e=2,i="Android ".concat(t)),{os:e,os_ver:i}},Mr=e=>{let t="";try{e||(I.report312728(2),I.report309906(82),window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.report("cpsProductData",JSON.stringify(e),{mid:"mmbizwap:cps_product_data",view:"wap_business"}));const i=JSON.parse(e).kvs;for(const e of i)"js_version"===e.key&&(t=e.value)}catch(Nu){I.report312728(3)}return t||(I.report312728(1),t="v112"),t};async function Nr(){try{const e=await function(){const e=be.getQuery("environment"),t="/mp/cps_product_info?action=GetCpsVersion&kol_uin_c=".concat(window.biz).concat(e?"&environment=1":"");return new Promise(((e,i)=>{ye({url:t,dataType:"json",async:!0,success(t){e(t)},error(e){i(e)}})}))}();if(e.cps_version){let t;const i=Mr(e.cps_version),n=be.getQuery("environment");return t=be.getQuery("forcecpsversion")||i,n&&(t="test/".concat(t)),t}}catch(Nu){console.error("getCpsFinalVersion error",Nu)}}async function qr({traceId:e,appId:t}){var i,n,o,s,a,r;try{const l=await function({appId:e,traceId:t}){const i={uin:0,kol_uin:window.biz,cps_detail:JSON.stringify({user_info:{media_specified_id:0},device_info:jr(),kol_uin:window.biz,req_infos:[{select_trace_id:t||Date.now().toString(),sku_id:"498_".concat(e),game_info:{app_id:e}}],extinfo:JSON.stringify({article:{mid:window.mid,idx:window.idx,mode:303}})})};return new Promise(((e,t)=>{ye({url:"/mp/cps_product_info?action=Detail",type:"POST",dataType:"json",async:!0,data:i,success(t){e(t)},error(e){t(e)}})}))}({traceId:e,appId:t}),d=JSON.parse(null==l?void 0:l.detailrsp);if(0===(null==d?void 0:d.ret)){const e=await(r=null==(s=null==(o=null==(n=null==(i=null==d?void 0:d.detail_info)?void 0:i[0])?void 0:n.game_info)?void 0:o.video_info)?void 0:s.video_uid,new Promise(((e,t)=>{ye({url:"/mp/cps_product_info?action=minigame_vid&vid=".concat(r),type:"GET",dataType:"json",success(t){e(t)},error(e){t(e)}})})));0===(null==(a=null==e?void 0:e.base_resp)?void 0:a.ret)&&(d.video_url=null==e?void 0:e.video_url)}return d}catch(Nu){console.error("getAllMiniGameData error: ",Nu)}}async function Wr({srcAppid:e,dramaId:t,planId:i,playAppid:n,traceId:o,mode:s}){return new Promise(((a,r)=>{ye({type:"POST",url:"/mp/mini_drama_info?action=link",data:{kol_uin:window.biz,uin:window.user_uin,cps_detail:JSON.stringify({device_info:jr(),extinfo:JSON.stringify({article:{uin:"".concat(window.user_uin),mid:window.mid,idx:window.idx,mode:s}}),kol_uin:window.biz,req_infos:[{app_id:n,drama_info:{drama_id:t,src_appid:e},plan_id:i,promoter_id:window.biz,select_trace_id:o||Date.now().toString()}],uin:"".concat(window.user_uin),user_info:{media_specified_id:"".concat(window.user_uin)}})},success(e){var t;0===(null==(t=null==(e=JSON.parse(e))?void 0:e.base_resp)?void 0:t.ret)?a(e.data):(r(),I.report312728(13))},error(e){I.report312728(14),r(e)}})}))}async function Fr({playAppid:e,srcAppid:t,mediaNo:i,dramaId:n}){return new Promise(((o,s)=>{ye({type:"POST",url:"/mp/mini_drama_info?action=play_info",data:{appid:e,src_appid:t,media_no:i,drama_id:n},success(e){o(e)},error(e){s(e)}})}))}function zr({dramaInfo:e,cover:t,playUrl:i,width:n,height:o,duration:s,cpsReportId:a,wrpWidth:r,wrpHeight:l,canFullscreen:d,customFullscreenAction:c,alwaysShowControl:u,cpsCardType:p=1,hideDuration:h=!1}){const m=document.createElement("div");m.setAttribute("class","video_cps_wrp"),m.setAttribute("style","width: ".concat(r,"px;height: ").concat(l,"px;")),m.setAttribute("slot","cps-video-component");const _=document.createElement("div");_.id="js_cps_video",m.appendChild(_);const f=function(e){const t=(e.el instanceof Element?e.el:document.querySelector(e.el)).parentNode;return new Br({el:e.el,opt:{cover:e.cover,playUrl:e.playUrl,plugins:e.plugins||[],width:+e.wrpWidth||t.offsetWidth,height:+e.wrpHeight||t.offsetHeight,videoWidth:e.width||0,videoHeight:e.height||0,duration:e.duration||0,muted:e.muted||!1,extInfo:e.extInfo,autoplayWhenExpose:e.autoplayWhenExpose,canFullscreen:e.canFullscreen||!1,customFullscreenAction:e.customFullscreenAction,alwaysShowControl:e.alwaysShowControl,hideDuration:e.hideDuration||!1,cgiData:window.cgiData,preview:!(1*window.is_temp_url!=1),__biz:window.cgiData.biz,uin:window.cgiData.uin||window.user_uin,mid:window.cgiData.mid,idx:window.cgiData.idx,loop:!0,scene_type:6,autoplay:!1,flowNotice:!1,useFeFullscreen:!0},store:Or()})}({el:_,width:n,height:o,wrpWidth:r,wrpHeight:l,duration:s,cover:t,playUrl:i,plugins:[Jt],muted:!0,autoplayWhenExpose:!0,extInfo:{dramaInfo:e},canFullscreen:d,customFullscreenAction:c,alwaysShowControl:u,hideDuration:h}),g=e=>({BizUin:window.biz,MsgId:+window.mid,Idx:+window.idx,PlayletCpsIdStr:a,SessionId:window.sessionid,EnterId:+window.enterid,EventTime:parseInt(1e3*f.getCurrentTime(),10),PlayTime:f.getRealPlayTime(),Duration:parseInt(1e3*f.getVideoDuration(),10),PageUrl:window.location.href,IsFans:window.isFans+1,CpsCardType:p,...e}),y=e=>{const t=g(e);console.log("cps video report 32253",e.EventType,t),we.report(32253,t)};return f.$on("player-expose",(()=>{f.__hasReportExpose||(y({EventType:1}),f.__hasReportExpose=!0)})),f.$on("click-play-switch",(e=>{y({EventType:e?3:2}),e&&y({EventType:10})})),f.$on("end",(()=>y({EventType:4}))),f.$on("replay",(()=>y({EventType:5}))),f.$on("seeking-status-change",(e=>!e&&y({EventType:6}))),f.$on("mute-change",(e=>y({EventType:e?8:7}))),f.$on("expose-auto-play",(()=>y({EventType:9}))),f.$on("cover-next-show-status-change",(e=>e&&y({EventType:13}))),f.$on("cover-next-click",(e=>e&&y({EventType:14}))),we.leaveReport(32253,(()=>g({EventType:16}))),{videoPlayer:f,dom:m,report32253:y}}const Ur=(e,t)=>{const i=document.createElement(t);Array.from(e.attributes).forEach((e=>i.setAttribute(e.name,e.value)));const{parentNode:n}=e;return n&&n.replaceChild(i,e),i};function Hr(e,t,i=(()=>{})){if(e&&!qt("mp-common-cpsad")){if(!Ae.isOnlyWechat)return I.report312728(19),void alert("请在微信内打开小程序");t.sceneNote?t.sceneNote+=":".concat(window.source_appid):t.sceneNote=window.source_appid,t.sourceAppId=window.source_appid,Ee.invoke("openWeApp",t,i),Xr(jt.CLICK_AD_ACTION,"",e.shadowRoot.querySelector("iframe"))}}function Vr(e,t){var i;const n=null==(i=e.shadowRoot)?void 0:i.querySelector(".cps_video_footer"),o=new IntersectionObserver(((e,i)=>{e.forEach((e=>{e.isIntersecting&&(t&&t(),i.unobserve(e.target))}))}));n&&o.observe(n)}const Kr={LIST:"list",CARD:"card",MP_VIDEO_PLAY:"video-play"};function $r(e,t){return"".concat(e," | ").concat(t)}function Jr(e,t,i){Xr(jt.PROXY_CALLBACK_ACTION,{aid:e.aid,proxyId:e.proxyId,proxyData:t},i)}function Gr(e,t,i){if(-1===[jt.CPS_AD_FRAME_DOMAIN].indexOf(e.origin))return;const{iframeEle:n,aid:o}=function(e,t){let i,n;for(const o in t)if(Object.hasOwnProperty.call(t,o)&&(i=t[o].shadowRoot.querySelector("iframe"),i&&i.contentWindow===e)){n=Number(o);break}return{aid:n,iframeEle:i}}(e.source,i);if(!n)return;const{action:s}=t,a=t.value||{};switch(s){case jt.FRAME_READY:!function(e,t,i){const n=e[i],o=function(e){const{dataset:t}=e,i=t.adtype,n={};if(i===jt.CPS_GOODS_TYPE.SHORT_PLAY){const{dramaid:o,srcappid:s,templateid:a,playappid:r,planid:l,defaultpath:d,traceid:c}=t,u=d?decodeURIComponent(d):"";a===Kr.MP_VIDEO_PLAY&&(n.respInfo=e.shortPlayDataResp),Object.assign(n,{adType:i,dramaId:o,srcAppid:s,templateId:a,playAppid:r,planId:l,defaultPath:u,selectTraceId:c})}else if(i===jt.CPS_GOODS_TYPE.MINI_GAME){const{appid:o,traceid:s,templateid:a,imgurl:r}=t;a===Kr.MP_VIDEO_PLAY&&(n.respInfo=e.miniGameDataResp),Object.assign(n,{adType:i,appId:o,selectTraceId:s,templateId:a,selectedImg:r?decodeURIComponent(r):""})}else{const{pid:e,traceid:i,extinfo:o,templateid:s}=t;Object.assign(n,{traceId:i,goodsId:e,extInfo:o,templateId:s||"list"})}return n}(n);Object.assign(o,{aid:i,cpsVersion:n.getAttribute("data-cpsversion"),type:jt.CPS_GOODS_TYPE.NEW_GOODS}),Xr(jt.SET_PAGE_DATA_ACTION_NAME,{biz:window.biz,uin:window.uin,scene:window.scene,source:window.source,idx:window.idx,mid:window.mid,isSg:window.isSg,userUin:window.user_uin,sn:window.sn,appmsgid:window.appmsgid,sendTime:window.send_time||"",passTicket:decodeURIComponent(window.pass_ticket),itemShowType:window.item_show_type,bodyScrollTop:We.getScrollTop(),screenHeight:We.getInnerHeight(),adOffsetTop:l.getOffset(t).offsetTop,createIframeTime:Date.now(),pageUrl:location.href,heightWidthRate:9/16,boundingClientRect:t.getBoundingClientRect(),type:jt.CPS_GOODS_TYPE.NEW_GOODS,skin:be.getQuery("color_scheme"),wx_traceid:be.getQuery("wx_traceid")},t),Xr(jt.SET_AD_DATA_ACTION_NAME,{goodsInfo:o,type:jt.CPS_GOODS_TYPE.NEW_GOODS,hideAdMark:window.hideAdMarkOnCps},t)}(i,n,o);break;case jt.PROXY_ACTION:!function(e,t,i){var n,o;if("jsapi"===e.proxyType)return void function(e,t){const i=e.proxyData||{},n=function(e){const t=e.proxyData||{},{methodName:i}=t;if(-1===jt.AD_JSAPI_WHITE_LIST.indexOf(i))return $r(jt.INVALID_METHOD_NAME_MSG_PREFIX,i);return!0}(e);if("string"==typeof n)return void Jr(e,{err_msg:n},t);const o=n=>{Jr(e,n,t),"openUrlWithExtraWebview"===i.methodName&&-1===n.err_msg.indexOf("ok")&&(location.href=i.args.url)};try{if("on"===i.methodType)Ee[i.methodType](i.methodName,o);else{if("openWeApp"===i.methodName||"openEmbeddedWeApp"===i.methodName){let{sceneNote:e}=i.args;if(e?e+=":".concat(window.source_appid):e=window.source_appid,i.args.sceneNote=e,i.args.sourceAppId=window.source_appid,qt("mp-common-cpsad"))return}"openEmbeddedWeApp"===i.methodName&&(Ae.isIOS&&Ae.gtVersion("8.0.42",!0)||Ae.isAndroid&&Ae.gtVersion("8.0.42",!0))?Ee[i.methodType]("openEmbeddedWeApp",Object.assign({modalHeightRatio:.8,allowFullScreen:!0,blurMask:!1},i.args),(e=>{e&&e.err_msg&&-1!==e.err_msg.indexOf(":ok")?o(e):Ee[i.methodType]("openWeApp",i.args,o)})):("openEmbeddedWeApp"===i.methodName&&(i.methodName="openWeApp"),Ee[i.methodType](i.methodName,i.args,o))}}catch(s){console.error(s),Jr(e,{err_msg:$r(jt.INVALID_METHOD_TYPE_MSG_PREFIX,i.methodType)},t)}"adDataReport"===i.methodName&&1===i.args.need_record_page_operation&&I.report115849(41)}(e,t);const s=e.proxyData||{};if("bizapi"===e.proxyType){if("request"===s.methodName)return void function(e,t){const i=e.proxyData||{},n=i.args||{};if(-1===jt.AD_REQ_PATH_WHITE_LIST.indexOf(n.path))return void Jr(e,{err_msg:$r(jt.INVALID_REQ_PATH_MSG_PREFIX,n.path)},t);ye({type:n.requestType,url:"".concat(n.path,"?").concat(n.requestQuery||""),data:n.requestBody||{},mayAbort:!0,success:i=>{Jr(e,{err_msg:"request:success",response:i},t)},error:(i,n)=>{Jr(e,{err_msg:"request:error",xhr:i,err_info:n},t)}})}(e,t);if("addIdKeyReport"===s.methodName)return void ge.setSum(s.args.id,s.args.key,s.args.val);if("addBadJsReport"===s.methodName)null==(o=null==(n=window.WX_BJ_REPORT)?void 0:n.BadJs)||o.report("AdFrameError:".concat(s.args.id),s.args.msg)}}(a,n,i[o]);break;case jt.CHANGE_FRAME_STYLE:!function(e,t,i){!1===e.display&&(i.style.display="none");if(e.height){const n=e.height.slice&&"px"===e.height.slice(-2)||"number"==typeof e.height?"".concat(Math.ceil(parseFloat(e.height,10)),"px"):e.height;t.style.height=n,function(e){const t=e.getAttribute("data-planid"),i=e.getAttribute("data-pid"),n=e.getAttribute("data-traceid"),o={compEle:e,compType:"mp-common-cpsad",compIdx:Array.from(document.querySelectorAll("mp-common-cpsad")).indexOf(e)};Me.renderCompSilentlyPreHandler(o),si(e,t||i||n||""),Me.renderCompSilently(o)}(i)}if(e.width){const i=e.width.slice&&"px"===e.width.slice(-2)||"number"==typeof e.width?"".concat(Math.ceil(parseFloat(e.width,10)),"px"):e.width;t.style.width=i}}(a,n,i[o]);break;case jt.PROXY_CONSOLE:!function(e){const{method:t,data:i}=e;if("function"==typeof console[t]){const e=[].concat(i);console[t](...e)}}(a)}}function Xr(e,t,i){const n=i.contentWindow;n&&I.postMessage(n,e,t,jt.CPS_AD_FRAME_DOMAIN)}const Yr={tagName:"mp-common-cpsad",oldTagName:"mpcps",cpsVersion:"",iframeMap:{}},Qr=document.getElementById("js_article"),Zr=document.getElementById("content_bottom_interaction"),el=!!window.is_login;function tl(){const e=document.querySelectorAll("".concat(Yr.oldTagName,",").concat(Yr.tagName));0!==e.length&&Nr().then((t=>{t&&(e.forEach((e=>{e.tagName.toLowerCase()===Yr.oldTagName&&(e=Ur(e,Yr.tagName));const i=Math.ceil(1e4*Math.random());Yr.iframeMap[i]=e;const{templateid:n,adtype:o}=e.dataset;n===Kr.MP_VIDEO_PLAY?o===jt.CPS_GOODS_TYPE.SHORT_PLAY?function(e,t){const{dramaid:i,srcappid:n,planid:o,parentwidth:s,playappid:a,mediano:r,defaultpath:l,traceid:d=""}=e.dataset;(async function({srcAppid:e,dramaId:t,playAppid:i,mediaNo:n,planId:o,traceId:s}){try{let a,r=203;if(n){const[l,d]=await Promise.all([Fr({srcAppid:e,dramaId:t,playAppid:i,mediaNo:n}),Wr({dramaId:t,srcAppid:e,playAppid:i,planId:o,traceId:s,mode:r})]);a={shortPlayDataResp:JSON.parse(d),videoResp:JSON.parse(l)},I.report312728(16)}else{r=205;const n=await Wr({dramaId:t,srcAppid:e,playAppid:i,planId:o,traceId:s,mode:r});a={shortPlayDataResp:JSON.parse(n)},I.report312728(17)}return a}catch(Nu){console.error("getAllShortPlayData error: ",Nu)}})({dramaId:i,srcAppid:n,playAppid:a,mediaNo:r,planId:o,traceId:d}).then((i=>{var n;const{shortPlayDataResp:d,videoResp:c}=i;let u,p;0===(null==d?void 0:d.ret)?(u=function(e){var t,i,n;const o=(null==(t=e.detail_info[0])?void 0:t.drama_info)||{},{cover_url:s,drama_name:a,media_count:r,theme:l,ext:{hot_degree:d},status:c}=o,u=(null==(i=e.detail_info[0])?void 0:i.wx_miniprogram_link)||"",p=(null==(n=e.detail_info[0])?void 0:n.wx_miniprogram_app_username)||"",h={dramaCoverUrl:s,dramaName:a,dramaNum:r,categoryName:l.replace(/、/g,"/"),hotView:d,status:c,path:u,userName:p};return u||I.report312728(14),h}(d),e.shortPlayDataResp=d,p=r&&0===(null==(n=null==c?void 0:c.base_resp)?void 0:n.ret)?function(e){const{coverurl:t,duration:i,jump_appid:n,video_url:o,height:s,width:a}=e;return{videoCoverUrl:t,duration:i,jumpAppid:n,videoPlayUrl:o,videoWidth:a,videoHeight:s}}(c):{videoCoverUrl:e.getAttribute("data-materialcoverurl"),videoPlayUrl:e.getAttribute("data-materialurl")}):I.report312728(18),u.path||I.report312728(20);const h={relativeURL:decodeURIComponent(u.path||l),appId:a,scene:1091,userName:u.userName},m=e=>{var t,i,n;-1===(null==(t=null==e?void 0:e.err_msg)?void 0:t.indexOf("ok"))?(ge.setSum(309906,41,1),null==(n=null==(i=window.WX_BJ_REPORT)?void 0:i.BadJs)||n.report("AdFrameError:PROXY_ID_JUMP_SHORT_PLAY","errMsg:".concat(JSON.stringify(e.err_msg)))):ge.setSum(309906,42,1)},_={drama_name:u.dramaName,total_num:u.dramaNum,cover_url:u.dramaCoverUrl,drama_class:u.categoryName,hot_view:u.hotView,appid:a,jump_path:u.path||decodeURIComponent(l),ban:2===u.status};if(2===u.status)return void e.setAttribute("data-banvideo",1);const{dom:f,report32253:g,videoPlayer:y}=zr({cpsReportId:o,dramaInfo:_,cover:p.videoCoverUrl,playUrl:p.videoPlayUrl,duration:p.duration||0,width:p.videoWidth||0,height:p.videoHeight||0,wrpWidth:s,wrpHeight:s,canFullscreen:!0,alwaysShowControl:!1,hideDuration:!0,customFullscreenAction:()=>{Hr(e,h,m),g({EventType:15})}});y&&y.$on("cover-next-click",(()=>{Xr(jt.CLICK_AD_ACTION,"",e.shadowRoot.querySelector("iframe"))})),e.setAttribute("data-videocarddata",JSON.stringify({videoCoverUrl:u.dramaCoverUrl,name:u.dramaName,categoryInfo:"".concat(u.dramaNum,"集"),categoryName:u.categoryName})),e.addEventListener("click",(t=>{(t.composedPath()||[]).some((e=>{var t;return null==(t=e.classList)?void 0:t.contains("cps_video_footer")}))&&(Hr(e,h,m),g({EventType:12}))})),Vr(e,(()=>{g({EventType:11})})),e.appendChild(f),e.setAttribute("data-cpsversion",t),e.setAttribute("data-ready",1)})).catch((e=>{console.error("getShortPlayData err: ",e)}))}(e,t):o===jt.CPS_GOODS_TYPE.MINI_GAME&&function(e,t){const{appid:i,traceid:n,parentwidth:o,videorate:s}=e.dataset;qr({traceId:n,appId:i}).then((a=>{var r,l,d,c,u,p,h,m,_,f,g,y,w,v;e.miniGameDataResp=a;const b=null==(r=null==a?void 0:a.detail_info)?void 0:r[0],S={relativeURL:(null==b?void 0:b.wx_miniprogram_link)||"",appId:i,scene:1311,userName:(null==b?void 0:b.wx_miniprogram_app_username)||"",sceneNote:"".concat(window.biz,":").concat(window.mid,":").concat(window.idx)},I={drama_name:null==(l=null==b?void 0:b.game_info)?void 0:l.name,cover_url:null==(d=null==b?void 0:b.game_info)?void 0:d.logo,drama_class:(null==(c=null==b?void 0:b.game_info)?void 0:c.brief_intro)||(null==(u=null==b?void 0:b.game_info)?void 0:u.description),appid:null==(p=null==b?void 0:b.game_info)?void 0:p.app_id,jump_path:S.relativeURL,banStatue:0,cover_style:{width:"48px",height:"48px",margin:"16px 0 16px 16px"},cover_next_info_style:{borderRadius:"8px"},ban:2===(null==(h=null==b?void 0:b.game_info)?void 0:h.status)};if(2===(null==(m=null==b?void 0:b.game_info)?void 0:m.status))return void e.setAttribute("data-banvideo",1);const x=function(e){return Math.max(1,Math.min(16/9,e))}(s)||16/9,{dom:k,videoPlayer:T,report32253:C}=zr({cpsReportId:n,dramaInfo:I,cover:null==(f=null==(_=null==b?void 0:b.game_info)?void 0:_.video_info)?void 0:f.cover_img_url,playUrl:null==a?void 0:a.video_url,duration:0,width:0,height:0,wrpWidth:o,wrpHeight:x>1?o/x:o,canFullscreen:!0,cpsCardType:2,hideDuration:!0,customFullscreenAction:()=>{Hr(e,S),C({EventType:15})}});T&&T.$on("cover-next-click",(()=>{Xr(jt.CLICK_AD_ACTION,"",e.shadowRoot.querySelector("iframe"))})),e.setAttribute("data-videocarddata",JSON.stringify({videoCoverUrl:null==(y=null==(g=null==b?void 0:b.game_info)?void 0:g.video_info)?void 0:y.cover_img_url,name:null==(w=null==b?void 0:b.game_info)?void 0:w.name,categoryInfo:null==(v=null==b?void 0:b.game_info)?void 0:v.category_3_name,categoryName:"小游戏"})),e.addEventListener("click",(t=>{(t.composedPath()||[]).some((e=>{var t;return null==(t=e.classList)?void 0:t.contains("cps_video_footer")}))&&(Hr(e,S),C({EventType:12}))})),Vr(e,(()=>{C({EventType:11})})),e.appendChild(k),e.setAttribute("data-cpsversion",t),e.setAttribute("data-ready",1)})).catch((e=>{console.error("getAllMiniGameData err: ",e)}))}(e,t):(e.setAttribute("data-cpsversion",t),e.setAttribute("data-ready",1))})),function(e,t,i,...n){const o=e=>{let o;if(!t||e.origin===t){if("object"!=typeof e.data)try{o=JSON.parse(e.data)}catch(s){return}else o=e.data;"function"==typeof i&&i(e,o,...n)}};e.addEventListener("message",o)}(window,jt.CPS_AD_FRAME_DOMAIN,Gr,Yr.iframeMap))})).catch((e=>{console.error("initArticleCps error:",e)}))}function il(){window.addEventListener&&window.addEventListener("load",(function(){window.__moonsafe_mutation_report_keys||(window.__moonsafe_mutation_report_keys={});const e=window.moon&&window.moon.moonsafe_id||29715,t=window.moon&&window.moon.moonsafe_key||0;let i=[],n={};const o=function(e,t,o){o=o||1,n[e]||(n[e]=0),n[e]+=o,t&&(!function(e){return"[object Array]"==Object.prototype.toString.call(e)}(t)?i.push(t):i=i.concat(t)),setTimeout((function(){s()}),1500)},s=function(){const o=[],a=i.length,r=["r="+Math.random()];for(const i in n)n.hasOwnProperty(i)&&o.push(e+"_"+(1*i+1*t)+"_"+n[i]);for(let e=0;e<a&&!(e>=10);++e)r.push("log"+e+"="+encodeURIComponent(i[e]));if(0==o.length&&r.length<=1)return;const l="idkey="+o.join(";")+"&lc="+(r.length-1)+"&"+r.join("&");let d;if(window.ActiveXObject)try{d=new ActiveXObject("Msxml2.XMLHTTP")}catch(Mu){try{d=new ActiveXObject("Microsoft.XMLHTTP")}catch(c){d=!1}}else window.XMLHttpRequest&&(d=new XMLHttpRequest);d&&(d.open("POST",location.protocol+"//mp.weixin.qq.com/mp/jsmonitor?",!0),d.setRequestHeader("cache-control","no-cache"),d.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),d.setRequestHeader("X-Requested-With","XMLHttpRequest"),d.onreadystatechange=function(){4===d.readyState&&(i.length>10?(i=i.slice(10),s()):(i=[],n={}))},i=[],n={},d.send(l))};try{if(!window.__observer)return;const e=window.__observer_data;if(window.__observer.takeRecords){const t=window.__observer.takeRecords();if(t&&t.length){e.count++;const i=new Date;t.forEach((function(t){const i=t.addedNodes;for(let n=0;n<i.length;n++){const t=i[n];if("SCRIPT"===t.tagName){const i=t.src;!i||/qq\.com/.test(i)||/weishi\.com/.test(i)||e.list.push(i)}}})),e.exec_time+=new Date-i}}window.__observer.disconnect();const t=window.__moonsafe_mutation_report_keys.observer||2,i=window.__moonsafe_mutation_report_keys.script_src||8,n=window.__moonsafe_mutation_report_keys.setattribute||9,s=window.__moonsafe_mutation_report_keys.ajax||10,a=25;for(let l=0;l<e.list.length;l++){const i=e.list[l],n=["[moonsafe][observer][url]:"+location.href,"[moonsafe][observer][src]:"+i,"[moonsafe][observer][ua]:"+navigator.userAgent];e.list.length==l+1&&(n.push("[moonsafe][observer][count]:"+e.count),n.push("[moonsafe][observer][exec_time]:"+e.exec_time+"ms")),o(t,n),"inlinescript_without_nonce"==i&&o(a,n)}const r=window.__danger_src;if(r){const e=[{key:"xmlhttprequest",idkey:s},{key:"script_src",idkey:i},{key:"script_setAttribute",idkey:n}];for(let t=0;t<e.length;t++){const i=e[t].key,n=r[i];if(n&&n.length)for(let s=0;s<n.length;s++){const a=["[moonsafe]["+i+"][url]:"+location.href,"[moonsafe]["+i+"][src]:"+n[s],"[moonsafe]["+i+"][ua]:"+navigator.userAgent];o(e[t].idkey,a)}}}}catch(Mu){o(3,["[moonsafe][observer][exception]:"+Mu])}}),!1)}Qr&&Qr.addEventListener("click",(()=>{for(const e in Yr.iframeMap)Xr(jt.CLICK_OUTSIDE_ACTION,"",Yr.iframeMap[e])})),We.bindDebounceScrollEvent((()=>{const e=We.getScrollTop();let t=We.getInnerHeight();if(el&&Zr){const e=Math.floor(null==Zr?void 0:Zr.getBoundingClientRect().height)||0;t=We.getInnerHeight()-e}for(const i in Yr.iframeMap){const n=Yr.iframeMap[i].shadowRoot.querySelector("iframe");if(!n)continue;const o=l.getOffset(n).offsetTop;Xr(jt.PAGE_SCROLL_ACTION,{bodyScrollTop:e,adOffsetTop:o,screenHeight:t,boundingClientRect:n.getBoundingClientRect()},n)}}));var nl=Object.defineProperty,ol=Object.getOwnPropertySymbols,sl=Object.prototype.hasOwnProperty,al=Object.prototype.propertyIsEnumerable,rl=(e,t,i)=>t in e?nl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,ll=(e,t)=>{for(var i in t||(t={}))sl.call(t,i)&&rl(e,i,t[i]);if(ol)for(var i of ol(t))al.call(t,i)&&rl(e,i,t[i]);return e},dl=(e,t)=>{var i={};for(var n in e)sl.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&ol)for(var n of ol(e))t.indexOf(n)<0&&al.call(e,n)&&(i[n]=e[n]);return i};const cl=window.Vue.getCurrentInstance,ul=window.Vue.unref,pl=window.Vue.watch,hl=window.Vue.onUnmounted,ml=window.Vue.onMounted,_l=window.Vue.nextTick,fl=window.Vue.isRef,gl=window.Vue.defineComponent,yl=window.Vue.computed,wl=window.Vue.toRefs,vl=window.Vue.ref,bl=window.Vue.reactive,Sl=window.Vue.h;window.Vue.isProxy;const Il="[vue-draggable-plus]: ";function xl(e,t,i){return i>=0&&i<e.length&&e.splice(i,0,e.splice(t,1)[0]),e}function kl(e,t){return Array.isArray(e)&&e.splice(t,1),e}function Tl(e,t,i){return Array.isArray(e)&&e.splice(t,0,i),e}function Cl(e,t,i){const n=e.children[i];e.insertBefore(t,n)}function Al(e){e.parentNode&&e.parentNode.removeChild(e)}function El(e,t=document){var i;let n=null;return n="function"==typeof(null==t?void 0:t.querySelector)?null==(i=null==t?void 0:t.querySelector)?void 0:i.call(t,e):document.querySelector(e),n||function(e){console.warn(Il+e)}("Element not found: ".concat(e)),n}function Pl(e,t){Object.keys(e).forEach((i=>{t(i,e[i])}))}const Ll=Object.assign;
/**!
 * Sortable 1.15.2
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function Dl(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Rl(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Dl(Object(i),!0).forEach((function(t){Ol(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Dl(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Bl(e){return(Bl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ol(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function jl(){return jl=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},jl.apply(this,arguments)}function Ml(e,t){if(null==e)return{};var i,n,o=function(e,t){if(null==e)return{};var i,n,o={},s=Object.keys(e);for(n=0;n<s.length;n++)i=s[n],!(t.indexOf(i)>=0)&&(o[i]=e[i]);return o}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)i=s[n],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o}function Nl(e){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var ql=Nl(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Wl=Nl(/Edge/i),Fl=Nl(/firefox/i),zl=Nl(/safari/i)&&!Nl(/chrome/i)&&!Nl(/android/i),Ul=Nl(/iP(ad|od|hone)/i),Hl=Nl(/chrome/i)&&Nl(/android/i),Vl={capture:!1,passive:!1};function Kl(e,t,i){e.addEventListener(t,i,!ql&&Vl)}function $l(e,t,i){e.removeEventListener(t,i,!ql&&Vl)}function Jl(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(i){return!1}return!1}}function Gl(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function Xl(e,t,i,n){if(e){i=i||document;do{if(null!=t&&(">"===t[0]?e.parentNode===i&&Jl(e,t):Jl(e,t))||n&&e===i)return e;if(e===i)break}while(e=Gl(e))}return null}var Yl,Ql=/\s+/g;function Zl(e,t,i){if(e&&t)if(e.classList)e.classList[i?"add":"remove"](t);else{var n=(" "+e.className+" ").replace(Ql," ").replace(" "+t+" "," ");e.className=(n+(i?" "+t:"")).replace(Ql," ")}}function ed(e,t,i){var n=e&&e.style;if(n){if(void 0===i)return document.defaultView&&document.defaultView.getComputedStyle?i=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(i=e.currentStyle),void 0===t?i:i[t];!(t in n)&&-1===t.indexOf("webkit")&&(t="-webkit-"+t),n[t]=i+("string"==typeof i?"":"px")}}function td(e,t){var i="";if("string"==typeof e)i=e;else do{var n=ed(e,"transform");n&&"none"!==n&&(i=n+" "+i)}while(!t&&(e=e.parentNode));var o=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return o&&new o(i)}function id(e,t,i){if(e){var n=e.getElementsByTagName(t),o=0,s=n.length;if(i)for(;o<s;o++)i(n[o],o);return n}return[]}function nd(){return document.scrollingElement||document.documentElement}function od(e,t,i,n,o){if(e.getBoundingClientRect||e===window){var s,a,r,l,d,c,u;if(e!==window&&e.parentNode&&e!==nd()?(a=(s=e.getBoundingClientRect()).top,r=s.left,l=s.bottom,d=s.right,c=s.height,u=s.width):(a=0,r=0,l=window.innerHeight,d=window.innerWidth,c=window.innerHeight,u=window.innerWidth),(t||i)&&e!==window&&(o=o||e.parentNode,!ql))do{if(o&&o.getBoundingClientRect&&("none"!==ed(o,"transform")||i&&"static"!==ed(o,"position"))){var p=o.getBoundingClientRect();a-=p.top+parseInt(ed(o,"border-top-width")),r-=p.left+parseInt(ed(o,"border-left-width")),l=a+s.height,d=r+s.width;break}}while(o=o.parentNode);if(n&&e!==window){var h=td(o||e),m=h&&h.a,_=h&&h.d;h&&(l=(a/=_)+(c/=_),d=(r/=m)+(u/=m))}return{top:a,left:r,bottom:l,right:d,width:u,height:c}}}function sd(e,t,i){for(var n=cd(e,!0),o=od(e)[t];n;){if(!(o>=od(n)[i]))return n;if(n===nd())break;n=cd(n,!1)}return!1}function ad(e,t,i,n){for(var o=0,s=0,a=e.children;s<a.length;){if("none"!==a[s].style.display&&a[s]!==mc.ghost&&(n||a[s]!==mc.dragged)&&Xl(a[s],i.draggable,e,!1)){if(o===t)return a[s];o++}s++}return null}function rd(e,t){for(var i=e.lastElementChild;i&&(i===mc.ghost||"none"===ed(i,"display")||t&&!Jl(i,t));)i=i.previousElementSibling;return i||null}function ld(e,t){var i=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)"TEMPLATE"!==e.nodeName.toUpperCase()&&e!==mc.clone&&(!t||Jl(e,t))&&i++;return i}function dd(e){var t=0,i=0,n=nd();if(e)do{var o=td(e),s=o.a,a=o.d;t+=e.scrollLeft*s,i+=e.scrollTop*a}while(e!==n&&(e=e.parentNode));return[t,i]}function cd(e,t){if(!e||!e.getBoundingClientRect)return nd();var i=e,n=!1;do{if(i.clientWidth<i.scrollWidth||i.clientHeight<i.scrollHeight){var o=ed(i);if(i.clientWidth<i.scrollWidth&&("auto"==o.overflowX||"scroll"==o.overflowX)||i.clientHeight<i.scrollHeight&&("auto"==o.overflowY||"scroll"==o.overflowY)){if(!i.getBoundingClientRect||i===document.body)return nd();if(n||t)return i;n=!0}}}while(i=i.parentNode);return nd()}function ud(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function pd(e,t){return function(){if(!Yl){var i=arguments;1===i.length?e.call(this,i[0]):e.apply(this,i),Yl=setTimeout((function(){Yl=void 0}),t)}}}function hd(e,t,i){e.scrollLeft+=t,e.scrollTop+=i}function md(e){var t=window.Polymer,i=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):i?i(e).clone(!0)[0]:e.cloneNode(!0)}function _d(e,t,i){var n={};return Array.from(e.children).forEach((function(o){var s,a,r,l;if(Xl(o,t.draggable,e,!1)&&!o.animated&&o!==i){var d=od(o);n.left=Math.min(null!==(s=n.left)&&void 0!==s?s:1/0,d.left),n.top=Math.min(null!==(a=n.top)&&void 0!==a?a:1/0,d.top),n.right=Math.max(null!==(r=n.right)&&void 0!==r?r:-1/0,d.right),n.bottom=Math.max(null!==(l=n.bottom)&&void 0!==l?l:-1/0,d.bottom)}})),n.width=n.right-n.left,n.height=n.bottom-n.top,n.x=n.left,n.y=n.top,n}var fd="Sortable"+(new Date).getTime();function gd(){var e,t=[];return{captureAnimationState:function(){(t=[],this.options.animation)&&[].slice.call(this.el.children).forEach((function(e){if("none"!==ed(e,"display")&&e!==mc.ghost){t.push({target:e,rect:od(e)});var i=Rl({},t[t.length-1].rect);if(e.thisAnimationDuration){var n=td(e,!0);n&&(i.top-=n.f,i.left-=n.e)}e.fromRect=i}}))},addAnimationState:function(e){t.push(e)},removeAnimationState:function(e){t.splice(function(e,t){for(var i in e)if(e.hasOwnProperty(i))for(var n in t)if(t.hasOwnProperty(n)&&t[n]===e[i][n])return Number(i);return-1}(t,{target:e}),1)},animateAll:function(i){var n=this;if(!this.options.animation)return clearTimeout(e),void("function"==typeof i&&i());var o=!1,s=0;t.forEach((function(e){var t=0,i=e.target,a=i.fromRect,r=od(i),l=i.prevFromRect,d=i.prevToRect,c=e.rect,u=td(i,!0);u&&(r.top-=u.f,r.left-=u.e),i.toRect=r,i.thisAnimationDuration&&ud(l,r)&&!ud(a,r)&&(c.top-r.top)/(c.left-r.left)==(a.top-r.top)/(a.left-r.left)&&(t=function(e,t,i,n){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-i.top,2)+Math.pow(t.left-i.left,2))*n.animation}(c,l,d,n.options)),ud(r,a)||(i.prevFromRect=a,i.prevToRect=r,t||(t=n.options.animation),n.animate(i,c,r,t)),t&&(o=!0,s=Math.max(s,t),clearTimeout(i.animationResetTimer),i.animationResetTimer=setTimeout((function(){i.animationTime=0,i.prevFromRect=null,i.fromRect=null,i.prevToRect=null,i.thisAnimationDuration=null}),t),i.thisAnimationDuration=t)})),clearTimeout(e),o?e=setTimeout((function(){"function"==typeof i&&i()}),s):"function"==typeof i&&i(),t=[]},animate:function(e,t,i,n){if(n){ed(e,"transition",""),ed(e,"transform","");var o=td(this.el),s=o&&o.a,a=o&&o.d,r=(t.left-i.left)/(s||1),l=(t.top-i.top)/(a||1);e.animatingX=!!r,e.animatingY=!!l,ed(e,"transform","translate3d("+r+"px,"+l+"px,0)"),this.forRepaintDummy=function(e){return e.offsetWidth}(e),ed(e,"transition","transform "+n+"ms"+(this.options.easing?" "+this.options.easing:"")),ed(e,"transform","translate3d(0,0,0)"),"number"==typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout((function(){ed(e,"transition",""),ed(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1}),n)}}}}var yd=[],wd={initializeByDefault:!0},vd={mount:function(e){for(var t in wd)wd.hasOwnProperty(t)&&!(t in e)&&(e[t]=wd[t]);yd.forEach((function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")})),yd.push(e)},pluginEvent:function(e,t,i){var n=this;this.eventCanceled=!1,i.cancel=function(){n.eventCanceled=!0};var o=e+"Global";yd.forEach((function(n){t[n.pluginName]&&(t[n.pluginName][o]&&t[n.pluginName][o](Rl({sortable:t},i)),t.options[n.pluginName]&&t[n.pluginName][e]&&t[n.pluginName][e](Rl({sortable:t},i)))}))},initializePlugins:function(e,t,i,n){for(var o in yd.forEach((function(n){var o=n.pluginName;if(e.options[o]||n.initializeByDefault){var s=new n(e,t,e.options);s.sortable=e,s.options=e.options,e[o]=s,jl(i,s.defaults)}})),e.options)if(e.options.hasOwnProperty(o)){var s=this.modifyOption(e,o,e.options[o]);void 0!==s&&(e.options[o]=s)}},getEventProperties:function(e,t){var i={};return yd.forEach((function(n){"function"==typeof n.eventProperties&&jl(i,n.eventProperties.call(t[n.pluginName],e))})),i},modifyOption:function(e,t,i){var n;return yd.forEach((function(o){e[o.pluginName]&&o.optionListeners&&"function"==typeof o.optionListeners[t]&&(n=o.optionListeners[t].call(e[o.pluginName],i))})),n}};var bd=["evt"],Sd=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=i.evt,o=Ml(i,bd);vd.pluginEvent.bind(mc)(e,t,Rl({dragEl:xd,parentEl:kd,ghostEl:Td,rootEl:Cd,nextEl:Ad,lastDownEl:Ed,cloneEl:Pd,cloneHidden:Ld,dragStarted:Hd,putSortable:Md,activeSortable:mc.active,originalEvent:n,oldIndex:Dd,oldDraggableIndex:Bd,newIndex:Rd,newDraggableIndex:Od,hideGhostForTarget:cc,unhideGhostForTarget:uc,cloneNowHidden:function(){Ld=!0},cloneNowShown:function(){Ld=!1},dispatchSortableEvent:function(e){Id({sortable:t,name:e,originalEvent:n})}},o))};function Id(e){!function(e){var t=e.sortable,i=e.rootEl,n=e.name,o=e.targetEl,s=e.cloneEl,a=e.toEl,r=e.fromEl,l=e.oldIndex,d=e.newIndex,c=e.oldDraggableIndex,u=e.newDraggableIndex,p=e.originalEvent,h=e.putSortable,m=e.extraEventProperties;if(t=t||i&&i[fd]){var _,f=t.options,g="on"+n.charAt(0).toUpperCase()+n.substr(1);!window.CustomEvent||ql||Wl?(_=document.createEvent("Event")).initEvent(n,!0,!0):_=new CustomEvent(n,{bubbles:!0,cancelable:!0}),_.to=a||i,_.from=r||i,_.item=o||i,_.clone=s,_.oldIndex=l,_.newIndex=d,_.oldDraggableIndex=c,_.newDraggableIndex=u,_.originalEvent=p,_.pullMode=h?h.lastPutMode:void 0;var y=Rl(Rl({},m),vd.getEventProperties(n,t));for(var w in y)_[w]=y[w];i&&i.dispatchEvent(_),f[g]&&f[g].call(t,_)}}(Rl({putSortable:Md,cloneEl:Pd,targetEl:xd,rootEl:Cd,oldIndex:Dd,oldDraggableIndex:Bd,newIndex:Rd,newDraggableIndex:Od},e))}var xd,kd,Td,Cd,Ad,Ed,Pd,Ld,Dd,Rd,Bd,Od,jd,Md,Nd,qd,Wd,Fd,zd,Ud,Hd,Vd,Kd,$d,Jd,Gd=!1,Xd=!1,Yd=[],Qd=!1,Zd=!1,ec=[],tc=!1,ic=[],nc="undefined"!=typeof document,oc=Ul,sc=Wl||ql?"cssFloat":"float",ac=nc&&!Hl&&!Ul&&"draggable"in document.createElement("div"),rc=function(){if(nc){if(ql)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),lc=function(e,t){var i=ed(e),n=parseInt(i.width)-parseInt(i.paddingLeft)-parseInt(i.paddingRight)-parseInt(i.borderLeftWidth)-parseInt(i.borderRightWidth),o=ad(e,0,t),s=ad(e,1,t),a=o&&ed(o),r=s&&ed(s),l=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+od(o).width,d=r&&parseInt(r.marginLeft)+parseInt(r.marginRight)+od(s).width;if("flex"===i.display)return"column"===i.flexDirection||"column-reverse"===i.flexDirection?"vertical":"horizontal";if("grid"===i.display)return i.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(o&&a.float&&"none"!==a.float){var c="left"===a.float?"left":"right";return!s||"both"!==r.clear&&r.clear!==c?"horizontal":"vertical"}return o&&("block"===a.display||"flex"===a.display||"table"===a.display||"grid"===a.display||l>=n&&"none"===i[sc]||s&&"none"===i[sc]&&l+d>n)?"vertical":"horizontal"},dc=function(e){function t(e,i){return function(n,o,s,a){var r=n.options.group.name&&o.options.group.name&&n.options.group.name===o.options.group.name;if(null==e&&(i||r))return!0;if(null==e||!1===e)return!1;if(i&&"clone"===e)return e;if("function"==typeof e)return t(e(n,o,s,a),i)(n,o,s,a);var l=(i?n:o).options.group.name;return!0===e||"string"==typeof e&&e===l||e.join&&e.indexOf(l)>-1}}var i={},n=e.group;(!n||"object"!=Bl(n))&&(n={name:n}),i.name=n.name,i.checkPull=t(n.pull,!0),i.checkPut=t(n.put),i.revertClone=n.revertClone,e.group=i},cc=function(){!rc&&Td&&ed(Td,"display","none")},uc=function(){!rc&&Td&&ed(Td,"display","")};nc&&!Hl&&document.addEventListener("click",(function(e){if(Xd)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Xd=!1,!1}),!0);var pc=function(e){if(xd){var t=function(e,t){var i;return Yd.some((function(n){var o=n[fd].options.emptyInsertThreshold;if(o&&!rd(n)){var s=od(n),a=e>=s.left-o&&e<=s.right+o,r=t>=s.top-o&&t<=s.bottom+o;if(a&&r)return i=n}})),i}((e=e.touches?e.touches[0]:e).clientX,e.clientY);if(t){var i={};for(var n in e)e.hasOwnProperty(n)&&(i[n]=e[n]);i.target=i.rootEl=t,i.preventDefault=void 0,i.stopPropagation=void 0,t[fd]._onDragOver(i)}}},hc=function(e){xd&&xd.parentNode[fd]._isOutsideThisEl(e.target)};function mc(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=jl({},t),e[fd]=this;var i={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return lc(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==mc.supportPointer&&"PointerEvent"in window&&!zl,emptyInsertThreshold:5};for(var n in vd.initializePlugins(this,e,i),i)!(n in t)&&(t[n]=i[n]);for(var o in dc(t),this)"_"===o.charAt(0)&&"function"==typeof this[o]&&(this[o]=this[o].bind(this));this.nativeDraggable=!t.forceFallback&&ac,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?Kl(e,"pointerdown",this._onTapStart):(Kl(e,"mousedown",this._onTapStart),Kl(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(Kl(e,"dragover",this),Kl(e,"dragenter",this)),Yd.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),jl(this,gd())}function _c(e,t,i,n,o,s,a,r){var l,d,c=e[fd],u=c.options.onMove;return!window.CustomEvent||ql||Wl?(l=document.createEvent("Event")).initEvent("move",!0,!0):l=new CustomEvent("move",{bubbles:!0,cancelable:!0}),l.to=t,l.from=e,l.dragged=i,l.draggedRect=n,l.related=o||t,l.relatedRect=s||od(t),l.willInsertAfter=r,l.originalEvent=a,e.dispatchEvent(l),u&&(d=u.call(c,l,a)),d}function fc(e){e.draggable=!1}function gc(){tc=!1}function yc(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,i=t.length,n=0;i--;)n+=t.charCodeAt(i);return n.toString(36)}function wc(e){return setTimeout(e,0)}function vc(e){return clearTimeout(e)}mc.prototype={constructor:mc,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(Vd=null)},_getDirection:function(e,t){return"function"==typeof this.options.direction?this.options.direction.call(this,e,t,xd):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,i=this.el,n=this.options,o=n.preventOnFilter,s=e.type,a=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,r=(a||e).target,l=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||r,d=n.filter;if(function(e){ic.length=0;for(var t=e.getElementsByTagName("input"),i=t.length;i--;){var n=t[i];n.checked&&ic.push(n)}}(i),!xd&&!(/mousedown|pointerdown/.test(s)&&0!==e.button||n.disabled)&&!l.isContentEditable&&(this.nativeDraggable||!zl||!r||"SELECT"!==r.tagName.toUpperCase())&&!((r=Xl(r,n.draggable,i,!1))&&r.animated||Ed===r)){if(Dd=ld(r),Bd=ld(r,n.draggable),"function"==typeof d){if(d.call(this,e,r,this))return Id({sortable:t,rootEl:l,name:"filter",targetEl:r,toEl:i,fromEl:i}),Sd("filter",t,{evt:e}),void(o&&e.cancelable&&e.preventDefault())}else if(d&&(d=d.split(",").some((function(n){if(n=Xl(l,n.trim(),i,!1))return Id({sortable:t,rootEl:n,name:"filter",targetEl:r,fromEl:i,toEl:i}),Sd("filter",t,{evt:e}),!0}))))return void(o&&e.cancelable&&e.preventDefault());n.handle&&!Xl(l,n.handle,i,!1)||this._prepareDragStart(e,a,r)}}},_prepareDragStart:function(e,t,i){var n,o=this,s=o.el,a=o.options,r=s.ownerDocument;if(i&&!xd&&i.parentNode===s){var l=od(i);if(Cd=s,kd=(xd=i).parentNode,Ad=xd.nextSibling,Ed=i,jd=a.group,mc.dragged=xd,Nd={target:xd,clientX:(t||e).clientX,clientY:(t||e).clientY},zd=Nd.clientX-l.left,Ud=Nd.clientY-l.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,xd.style["will-change"]="all",n=function(){Sd("delayEnded",o,{evt:e}),mc.eventCanceled?o._onDrop():(o._disableDelayedDragEvents(),!Fl&&o.nativeDraggable&&(xd.draggable=!0),o._triggerDragStart(e,t),Id({sortable:o,name:"choose",originalEvent:e}),Zl(xd,a.chosenClass,!0))},a.ignore.split(",").forEach((function(e){id(xd,e.trim(),fc)})),Kl(r,"dragover",pc),Kl(r,"mousemove",pc),Kl(r,"touchmove",pc),Kl(r,"mouseup",o._onDrop),Kl(r,"touchend",o._onDrop),Kl(r,"touchcancel",o._onDrop),Fl&&this.nativeDraggable&&(this.options.touchStartThreshold=4,xd.draggable=!0),Sd("delayStart",this,{evt:e}),!a.delay||a.delayOnTouchOnly&&!t||this.nativeDraggable&&(Wl||ql))n();else{if(mc.eventCanceled)return void this._onDrop();Kl(r,"mouseup",o._disableDelayedDrag),Kl(r,"touchend",o._disableDelayedDrag),Kl(r,"touchcancel",o._disableDelayedDrag),Kl(r,"mousemove",o._delayedDragTouchMoveHandler),Kl(r,"touchmove",o._delayedDragTouchMoveHandler),a.supportPointer&&Kl(r,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=setTimeout(n,a.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){xd&&fc(xd),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;$l(e,"mouseup",this._disableDelayedDrag),$l(e,"touchend",this._disableDelayedDrag),$l(e,"touchcancel",this._disableDelayedDrag),$l(e,"mousemove",this._delayedDragTouchMoveHandler),$l(e,"touchmove",this._delayedDragTouchMoveHandler),$l(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?Kl(document,"pointermove",this._onTouchMove):Kl(document,t?"touchmove":"mousemove",this._onTouchMove):(Kl(xd,"dragend",this),Kl(Cd,"dragstart",this._onDragStart));try{document.selection?wc((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(i){}},_dragStarted:function(e,t){if(Gd=!1,Cd&&xd){Sd("dragStarted",this,{evt:t}),this.nativeDraggable&&Kl(document,"dragover",hc);var i=this.options;!e&&Zl(xd,i.dragClass,!1),Zl(xd,i.ghostClass,!0),mc.active=this,e&&this._appendGhost(),Id({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(qd){this._lastX=qd.clientX,this._lastY=qd.clientY,cc();for(var e=document.elementFromPoint(qd.clientX,qd.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(qd.clientX,qd.clientY))!==t;)t=e;if(xd.parentNode[fd]._isOutsideThisEl(e),t)do{if(t[fd]){if(t[fd]._onDragOver({clientX:qd.clientX,clientY:qd.clientY,target:e,rootEl:t})&&!this.options.dragoverBubble)break}e=t}while(t=t.parentNode);uc()}},_onTouchMove:function(e){if(Nd){var t=this.options,i=t.fallbackTolerance,n=t.fallbackOffset,o=e.touches?e.touches[0]:e,s=Td&&td(Td,!0),a=Td&&s&&s.a,r=Td&&s&&s.d,l=oc&&Jd&&dd(Jd),d=(o.clientX-Nd.clientX+n.x)/(a||1)+(l?l[0]-ec[0]:0)/(a||1),c=(o.clientY-Nd.clientY+n.y)/(r||1)+(l?l[1]-ec[1]:0)/(r||1);if(!mc.active&&!Gd){if(i&&Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))<i)return;this._onDragStart(e,!0)}if(Td){s?(s.e+=d-(Wd||0),s.f+=c-(Fd||0)):s={a:1,b:0,c:0,d:1,e:d,f:c};var u="matrix(".concat(s.a,",").concat(s.b,",").concat(s.c,",").concat(s.d,",").concat(s.e,",").concat(s.f,")");ed(Td,"webkitTransform",u),ed(Td,"mozTransform",u),ed(Td,"msTransform",u),ed(Td,"transform",u),Wd=d,Fd=c,qd=o}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!Td){var e=this.options.fallbackOnBody?document.body:Cd,t=od(xd,!0,oc,!0,e),i=this.options;if(oc){for(Jd=e;"static"===ed(Jd,"position")&&"none"===ed(Jd,"transform")&&Jd!==document;)Jd=Jd.parentNode;Jd!==document.body&&Jd!==document.documentElement?(Jd===document&&(Jd=nd()),t.top+=Jd.scrollTop,t.left+=Jd.scrollLeft):Jd=nd(),ec=dd(Jd)}Zl(Td=xd.cloneNode(!0),i.ghostClass,!1),Zl(Td,i.fallbackClass,!0),Zl(Td,i.dragClass,!0),ed(Td,"transition",""),ed(Td,"transform",""),ed(Td,"box-sizing","border-box"),ed(Td,"margin",0),ed(Td,"top",t.top),ed(Td,"left",t.left),ed(Td,"width",t.width),ed(Td,"height",t.height),ed(Td,"opacity","0.8"),ed(Td,"position",oc?"absolute":"fixed"),ed(Td,"zIndex","100000"),ed(Td,"pointerEvents","none"),mc.ghost=Td,e.appendChild(Td),ed(Td,"transform-origin",zd/parseInt(Td.style.width)*100+"% "+Ud/parseInt(Td.style.height)*100+"%")}},_onDragStart:function(e,t){var i=this,n=e.dataTransfer,o=i.options;Sd("dragStart",this,{evt:e}),mc.eventCanceled?this._onDrop():(Sd("setupClone",this),mc.eventCanceled||((Pd=md(xd)).removeAttribute("id"),Pd.draggable=!1,Pd.style["will-change"]="",this._hideClone(),Zl(Pd,this.options.chosenClass,!1),mc.clone=Pd),i.cloneId=wc((function(){Sd("clone",i),!mc.eventCanceled&&(i.options.removeCloneOnHide||Cd.insertBefore(Pd,xd),i._hideClone(),Id({sortable:i,name:"clone"}))})),!t&&Zl(xd,o.dragClass,!0),t?(Xd=!0,i._loopId=setInterval(i._emulateDragOver,50)):($l(document,"mouseup",i._onDrop),$l(document,"touchend",i._onDrop),$l(document,"touchcancel",i._onDrop),n&&(n.effectAllowed="move",o.setData&&o.setData.call(i,n,xd)),Kl(document,"drop",i),ed(xd,"transform","translateZ(0)")),Gd=!0,i._dragStartId=wc(i._dragStarted.bind(i,t,e)),Kl(document,"selectstart",i),Hd=!0,zl&&ed(document.body,"user-select","none"))},_onDragOver:function(e){var t,i,n,o,s=this.el,a=e.target,r=this.options,l=r.group,d=mc.active,c=jd===l,u=r.sort,p=Md||d,h=this,m=!1;if(!tc){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),a=Xl(a,r.draggable,s,!0),E("dragOver"),mc.eventCanceled)return m;if(xd.contains(e.target)||a.animated&&a.animatingX&&a.animatingY||h._ignoreWhileAnimating===a)return L(!1);if(Xd=!1,d&&!r.disabled&&(c?u||(n=kd!==Cd):Md===this||(this.lastPutMode=jd.checkPull(this,d,xd,e))&&l.checkPut(this,d,xd,e))){if(o="vertical"===this._getDirection(e,a),t=od(xd),E("dragOverValid"),mc.eventCanceled)return m;if(n)return kd=Cd,P(),this._hideClone(),E("revert"),mc.eventCanceled||(Ad?Cd.insertBefore(xd,Ad):Cd.appendChild(xd)),L(!0);var _=rd(s,r.draggable);if(!_||function(e,t,i){var n=od(rd(i.el,i.options.draggable)),o=_d(i.el,i.options,Td),s=10;return t?e.clientX>o.right+s||e.clientY>n.bottom&&e.clientX>n.left:e.clientY>o.bottom+s||e.clientX>n.right&&e.clientY>n.top}(e,o,this)&&!_.animated){if(_===xd)return L(!1);if(_&&s===e.target&&(a=_),a&&(i=od(a)),!1!==_c(Cd,s,xd,t,a,i,e,!!a))return P(),_&&_.nextSibling?s.insertBefore(xd,_.nextSibling):s.appendChild(xd),kd=s,D(),L(!0)}else if(_&&function(e,t,i){var n=od(ad(i.el,0,i.options,!0)),o=_d(i.el,i.options,Td),s=10;return t?e.clientX<o.left-s||e.clientY<n.top&&e.clientX<n.right:e.clientY<o.top-s||e.clientY<n.bottom&&e.clientX<n.left}(e,o,this)){var f=ad(s,0,r,!0);if(f===xd)return L(!1);if(i=od(a=f),!1!==_c(Cd,s,xd,t,a,i,e,!1))return P(),s.insertBefore(xd,f),kd=s,D(),L(!0)}else if(a.parentNode===s){i=od(a);var g,y,w,v=xd.parentNode!==s,b=!function(e,t,i){var n=i?e.left:e.top,o=i?e.right:e.bottom,s=i?e.width:e.height,a=i?t.left:t.top,r=i?t.right:t.bottom,l=i?t.width:t.height;return n===a||o===r||n+s/2===a+l/2}(xd.animated&&xd.toRect||t,a.animated&&a.toRect||i,o),S=o?"top":"left",I=sd(a,"top","top")||sd(xd,"top","top"),x=I?I.scrollTop:void 0;if(Vd!==a&&(y=i[S],Qd=!1,Zd=!b&&r.invertSwap||v),g=function(e,t,i,n,o,s,a,r){var l=n?e.clientY:e.clientX,d=n?i.height:i.width,c=n?i.top:i.left,u=n?i.bottom:i.right,p=!1;if(!a)if(r&&$d<d*o){if(!Qd&&(1===Kd?l>c+d*s/2:l<u-d*s/2)&&(Qd=!0),Qd)p=!0;else if(1===Kd?l<c+$d:l>u-$d)return-Kd}else if(l>c+d*(1-o)/2&&l<u-d*(1-o)/2)return function(e){return ld(xd)<ld(e)?1:-1}(t);return p=p||a,p&&(l<c+d*s/2||l>u-d*s/2)?l>c+d/2?1:-1:0}(e,a,i,o,b?1:r.swapThreshold,null==r.invertedSwapThreshold?r.swapThreshold:r.invertedSwapThreshold,Zd,Vd===a),0!==g){var k=ld(xd);do{k-=g,w=kd.children[k]}while(w&&("none"===ed(w,"display")||w===Td))}if(0===g||w===a)return L(!1);Vd=a,Kd=g;var T=a.nextElementSibling,C=!1,A=_c(Cd,s,xd,t,a,i,e,C=1===g);if(!1!==A)return(1===A||-1===A)&&(C=1===A),tc=!0,setTimeout(gc,30),P(),C&&!T?s.appendChild(xd):a.parentNode.insertBefore(xd,C?T:a),I&&hd(I,0,x-I.scrollTop),kd=xd.parentNode,void 0!==y&&!Zd&&($d=Math.abs(y-od(a)[S])),D(),L(!0)}if(s.contains(xd))return L(!1)}return!1}function E(r,l){Sd(r,h,Rl({evt:e,isOwner:c,axis:o?"vertical":"horizontal",revert:n,dragRect:t,targetRect:i,canSort:u,fromSortable:p,target:a,completed:L,onMove:function(i,n){return _c(Cd,s,xd,t,i,od(i),e,n)},changed:D},l))}function P(){E("dragOverAnimationCapture"),h.captureAnimationState(),h!==p&&p.captureAnimationState()}function L(t){return E("dragOverCompleted",{insertion:t}),t&&(c?d._hideClone():d._showClone(h),h!==p&&(Zl(xd,Md?Md.options.ghostClass:d.options.ghostClass,!1),Zl(xd,r.ghostClass,!0)),Md!==h&&h!==mc.active?Md=h:h===mc.active&&Md&&(Md=null),p===h&&(h._ignoreWhileAnimating=a),h.animateAll((function(){E("dragOverAnimationComplete"),h._ignoreWhileAnimating=null})),h!==p&&(p.animateAll(),p._ignoreWhileAnimating=null)),(a===xd&&!xd.animated||a===s&&!a.animated)&&(Vd=null),!r.dragoverBubble&&!e.rootEl&&a!==document&&(xd.parentNode[fd]._isOutsideThisEl(e.target),!t&&pc(e)),!r.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),m=!0}function D(){Rd=ld(xd),Od=ld(xd,r.draggable),Id({sortable:h,name:"change",toEl:s,newIndex:Rd,newDraggableIndex:Od,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){$l(document,"mousemove",this._onTouchMove),$l(document,"touchmove",this._onTouchMove),$l(document,"pointermove",this._onTouchMove),$l(document,"dragover",pc),$l(document,"mousemove",pc),$l(document,"touchmove",pc)},_offUpEvents:function(){var e=this.el.ownerDocument;$l(e,"mouseup",this._onDrop),$l(e,"touchend",this._onDrop),$l(e,"pointerup",this._onDrop),$l(e,"touchcancel",this._onDrop),$l(document,"selectstart",this)},_onDrop:function(e){var t=this.el,i=this.options;Rd=ld(xd),Od=ld(xd,i.draggable),Sd("drop",this,{evt:e}),kd=xd&&xd.parentNode,Rd=ld(xd),Od=ld(xd,i.draggable),mc.eventCanceled||(Gd=!1,Zd=!1,Qd=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),vc(this.cloneId),vc(this._dragStartId),this.nativeDraggable&&($l(document,"drop",this),$l(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),zl&&ed(document.body,"user-select",""),ed(xd,"transform",""),e&&(Hd&&(e.cancelable&&e.preventDefault(),!i.dropBubble&&e.stopPropagation()),Td&&Td.parentNode&&Td.parentNode.removeChild(Td),(Cd===kd||Md&&"clone"!==Md.lastPutMode)&&Pd&&Pd.parentNode&&Pd.parentNode.removeChild(Pd),xd&&(this.nativeDraggable&&$l(xd,"dragend",this),fc(xd),xd.style["will-change"]="",Hd&&!Gd&&Zl(xd,Md?Md.options.ghostClass:this.options.ghostClass,!1),Zl(xd,this.options.chosenClass,!1),Id({sortable:this,name:"unchoose",toEl:kd,newIndex:null,newDraggableIndex:null,originalEvent:e}),Cd!==kd?(Rd>=0&&(Id({rootEl:kd,name:"add",toEl:kd,fromEl:Cd,originalEvent:e}),Id({sortable:this,name:"remove",toEl:kd,originalEvent:e}),Id({rootEl:kd,name:"sort",toEl:kd,fromEl:Cd,originalEvent:e}),Id({sortable:this,name:"sort",toEl:kd,originalEvent:e})),Md&&Md.save()):Rd!==Dd&&Rd>=0&&(Id({sortable:this,name:"update",toEl:kd,originalEvent:e}),Id({sortable:this,name:"sort",toEl:kd,originalEvent:e})),mc.active&&((null==Rd||-1===Rd)&&(Rd=Dd,Od=Bd),Id({sortable:this,name:"end",toEl:kd,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){Sd("nulling",this),Cd=xd=kd=Td=Ad=Pd=Ed=Ld=Nd=qd=Hd=Rd=Od=Dd=Bd=Vd=Kd=Md=jd=mc.dragged=mc.ghost=mc.clone=mc.active=null,ic.forEach((function(e){e.checked=!0})),ic.length=Wd=Fd=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":xd&&(this._onDragOver(e),function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}(e));break;case"selectstart":e.preventDefault()}},toArray:function(){for(var e,t=[],i=this.el.children,n=0,o=i.length,s=this.options;n<o;n++)Xl(e=i[n],s.draggable,this.el,!1)&&t.push(e.getAttribute(s.dataIdAttr)||yc(e));return t},sort:function(e,t){var i={},n=this.el;this.toArray().forEach((function(e,t){var o=n.children[t];Xl(o,this.options.draggable,n,!1)&&(i[e]=o)}),this),t&&this.captureAnimationState(),e.forEach((function(e){i[e]&&(n.removeChild(i[e]),n.appendChild(i[e]))})),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return Xl(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var i=this.options;if(void 0===t)return i[e];var n=vd.modifyOption(this,e,t);i[e]=void 0!==n?n:t,"group"===e&&dc(i)},destroy:function(){Sd("destroy",this);var e=this.el;e[fd]=null,$l(e,"mousedown",this._onTapStart),$l(e,"touchstart",this._onTapStart),$l(e,"pointerdown",this._onTapStart),this.nativeDraggable&&($l(e,"dragover",this),$l(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),(function(e){e.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),Yd.splice(Yd.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Ld){if(Sd("hideClone",this),mc.eventCanceled)return;ed(Pd,"display","none"),this.options.removeCloneOnHide&&Pd.parentNode&&Pd.parentNode.removeChild(Pd),Ld=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(Ld){if(Sd("showClone",this),mc.eventCanceled)return;xd.parentNode!=Cd||this.options.group.revertClone?Ad?Cd.insertBefore(Pd,Ad):Cd.appendChild(Pd):Cd.insertBefore(Pd,xd),this.options.group.revertClone&&this.animate(xd,Pd),ed(Pd,"display",""),Ld=!1}}else this._hideClone()}},nc&&Kl(document,"touchmove",(function(e){(mc.active||Gd)&&e.cancelable&&e.preventDefault()})),mc.utils={on:Kl,off:$l,css:ed,find:id,is:function(e,t){return!!Xl(e,t,e,!1)},extend:function(e,t){if(e&&t)for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},throttle:pd,closest:Xl,toggleClass:Zl,clone:md,index:ld,nextTick:wc,cancelNextTick:vc,detectDirection:lc,getChild:ad},mc.get=function(e){return e[fd]},mc.mount=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t[0].constructor===Array&&(t=t[0]),t.forEach((function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(mc.utils=Rl(Rl({},mc.utils),e.utils)),vd.mount(e)}))},mc.create=function(e,t){return new mc(e,t)},mc.version="1.15.2";var bc,Sc,Ic,xc,kc,Tc,Cc=[],Ac=!1;function Ec(){Cc.forEach((function(e){clearInterval(e.pid)})),Cc=[]}function Pc(){clearInterval(Tc)}var Lc=pd((function(e,t,i,n){if(t.scroll){var o,s=(e.touches?e.touches[0]:e).clientX,a=(e.touches?e.touches[0]:e).clientY,r=t.scrollSensitivity,l=t.scrollSpeed,d=nd(),c=!1;Sc!==i&&(Sc=i,Ec(),bc=t.scroll,o=t.scrollFn,!0===bc&&(bc=cd(i,!0)));var u=0,p=bc;do{var h=p,m=od(h),_=m.top,f=m.bottom,g=m.left,y=m.right,w=m.width,v=m.height,b=void 0,S=void 0,I=h.scrollWidth,x=h.scrollHeight,k=ed(h),T=h.scrollLeft,C=h.scrollTop;h===d?(b=w<I&&("auto"===k.overflowX||"scroll"===k.overflowX||"visible"===k.overflowX),S=v<x&&("auto"===k.overflowY||"scroll"===k.overflowY||"visible"===k.overflowY)):(b=w<I&&("auto"===k.overflowX||"scroll"===k.overflowX),S=v<x&&("auto"===k.overflowY||"scroll"===k.overflowY));var A=b&&(Math.abs(y-s)<=r&&T+w<I)-(Math.abs(g-s)<=r&&!!T),E=S&&(Math.abs(f-a)<=r&&C+v<x)-(Math.abs(_-a)<=r&&!!C);if(!Cc[u])for(var P=0;P<=u;P++)Cc[P]||(Cc[P]={});(Cc[u].vx!=A||Cc[u].vy!=E||Cc[u].el!==h)&&(Cc[u].el=h,Cc[u].vx=A,Cc[u].vy=E,clearInterval(Cc[u].pid),(0!=A||0!=E)&&(c=!0,Cc[u].pid=setInterval(function(){n&&0===this.layer&&mc.active._onTouchMove(kc);var t=Cc[this.layer].vy?Cc[this.layer].vy*l:0,i=Cc[this.layer].vx?Cc[this.layer].vx*l:0;"function"==typeof o&&"continue"!==o.call(mc.dragged.parentNode[fd],i,t,e,kc,Cc[this.layer].el)||hd(Cc[this.layer].el,i,t)}.bind({layer:u}),24))),u++}while(t.bubbleScroll&&p!==d&&(p=cd(p,!1)));Ac=c}}),30),Dc=function(e){var t=e.originalEvent,i=e.putSortable,n=e.dragEl,o=e.activeSortable,s=e.dispatchSortableEvent,a=e.hideGhostForTarget,r=e.unhideGhostForTarget;if(t){var l=i||o;a();var d=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,c=document.elementFromPoint(d.clientX,d.clientY);r(),l&&!l.el.contains(c)&&(s("spill"),this.onSpill({dragEl:n,putSortable:i}))}};function Rc(){}function Bc(){}function Oc(e){return null==e?e:JSON.parse(JSON.stringify(e))}Rc.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,i=e.putSortable;this.sortable.captureAnimationState(),i&&i.captureAnimationState();var n=ad(this.sortable.el,this.startIndex,this.options);n?this.sortable.el.insertBefore(t,n):this.sortable.el.appendChild(t),this.sortable.animateAll(),i&&i.animateAll()},drop:Dc},jl(Rc,{pluginName:"revertOnSpill"}),Bc.prototype={onSpill:function(e){var t=e.dragEl,i=e.putSortable||this.sortable;i.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),i.animateAll()},drop:Dc},jl(Bc,{pluginName:"removeOnSpill"}),mc.mount(new function(){function e(){for(var e in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?Kl(document,"dragover",this._handleAutoScroll):this.options.supportPointer?Kl(document,"pointermove",this._handleFallbackAutoScroll):t.touches?Kl(document,"touchmove",this._handleFallbackAutoScroll):Kl(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;!this.options.dragOverBubble&&!t.rootEl&&this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?$l(document,"dragover",this._handleAutoScroll):($l(document,"pointermove",this._handleFallbackAutoScroll),$l(document,"touchmove",this._handleFallbackAutoScroll),$l(document,"mousemove",this._handleFallbackAutoScroll)),Pc(),Ec(),clearTimeout(Yl),Yl=void 0},nulling:function(){kc=Sc=bc=Ac=Tc=Ic=xc=null,Cc.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var i=this,n=(e.touches?e.touches[0]:e).clientX,o=(e.touches?e.touches[0]:e).clientY,s=document.elementFromPoint(n,o);if(kc=e,t||this.options.forceAutoScrollFallback||Wl||ql||zl){Lc(e,this.options,s,t);var a=cd(s,!0);Ac&&(!Tc||n!==Ic||o!==xc)&&(Tc&&Pc(),Tc=setInterval((function(){var s=cd(document.elementFromPoint(n,o),!0);s!==a&&(a=s,Ec()),Lc(e,i.options,s,t)}),10),Ic=n,xc=o)}else{if(!this.options.bubbleScroll||cd(s,!0)===nd())return void Ec();Lc(e,this.options,cd(s,!1),!1)}}},jl(e,{pluginName:"scroll",initializeByDefault:!0})}),mc.mount(Bc,Rc);let jc=null,Mc=null;function Nc(e=null,t=null){jc=e,Mc=t}const qc=Symbol("cloneElement");function Wc(...e){var t,i;const n=null==(t=cl())?void 0:t.proxy,o=e[0];let[,s,a]=e;Array.isArray(ul(s))||(a=s,s=null);let r=null;const{immediate:l=!0,clone:d=Oc,customUpdate:c}=null!=(i=ul(a))?i:{};const u={onUpdate:function(e){if(c)return void c(e);const{from:t,item:i,oldIndex:n,newIndex:o}=e;if(Al(i),Cl(t,i,n),fl(s)){const e=[...ul(s)];s.value=xl(e,n,o)}else xl(ul(s),n,o)},onStart:function(e){var t;const i=ul(null==(t=ul(s))?void 0:t[e.oldIndex]),n=d(i);Nc(i,n),e.item[qc]=n},onAdd:function(e){const t=e.item[qc];if(!function(e){return void 0===e}(t)){if(Al(e.item),fl(s)){const i=[...ul(s)];return void(s.value=Tl(i,e.newDraggableIndex,t))}Tl(ul(s),e.newDraggableIndex,t)}},onRemove:function(e){const{from:t,item:i,oldIndex:n,oldDraggableIndex:o,pullMode:a,clone:r}=e;if(Cl(t,i,n),"clone"!==a)if(fl(s)){const e=[...ul(s)];s.value=kl(e,o)}else kl(ul(s),o);else Al(r)},onEnd:function(){_l((()=>{Nc()}))}};function p(e){const t=ul(o);return e||(e=function(e){return"string"==typeof e}(t)?El(t,null==n?void 0:n.$el):t),e&&!function(e){return e instanceof HTMLElement}(e)&&(e=e.$el),e||function(e){console.error(Il+e)}("Root element not found"),e}function h(){var e;const t=null!=(e=ul(a))?e:{},i=dl(t,["immediate","clone"]);return Pl(i,((e,t)=>{(function(e){return 111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97)})(e)&&(i[e]=(e,...i)=>(Ll(e,{data:jc,clonedData:Mc}),t(e,...i)))})),function(e,t){const i=ll({},e);return Object.keys(t).forEach((n=>{i[n]?i[n]=function(e,t,i=null){return function(...n){return e.apply(i,n),t.apply(i,n)}}(e[n],t[n]):i[n]=t[n]})),i}(null===s?{}:u,i)}const m=e=>{e=p(e),r&&_.destroy(),r=new mc(e,h())};pl((()=>a),(()=>{r&&Pl(h(),((e,t)=>{null==r||r.option(e,t)}))}),{deep:!0});const _={option:(e,t)=>null==r?void 0:r.option(e,t),destroy:()=>{null==r||r.destroy(),r=null},save:()=>null==r?void 0:r.save(),toArray:()=>null==r?void 0:r.toArray(),closest:(...e)=>null==r?void 0:r.closest(...e)};return function(e){cl()?ml(e):_l(e)}((()=>{l&&m()})),function(e){cl()&&hl(e)}(_.destroy),ll({start:m,pause:()=>null==_?void 0:_.option("disabled",!0),resume:()=>null==_?void 0:_.option("disabled",!1)},_)}const Fc=["update","start","add","remove","choose","unchoose","end","sort","filter","clone","move","change"],zc=["clone","animation","ghostClass","group","sort","disabled","store","handle","draggable","swapThreshold","invertSwap","invertedSwapThreshold","removeCloneOnHide","direction","chosenClass","dragClass","ignore","filter","preventOnFilter","easing","setData","dropBubble","dragoverBubble","dataIdAttr","delay","delayOnTouchOnly","touchStartThreshold","forceFallback","fallbackClass","fallbackOnBody","fallbackTolerance","fallbackOffset","supportPointer","emptyInsertThreshold","scroll","forceAutoScrollFallback","scrollSensitivity","scrollSpeed","bubbleScroll","modelValue","tag","target","customUpdate",...Fc.map((e=>"on".concat(e.replace(/^\S/,(e=>e.toUpperCase())))))],Uc=gl({name:"VueDraggable",model:{prop:"modelValue",event:"update:modelValue"},props:zc,emits:["update:modelValue",...Fc],setup(e,{slots:t,emit:i,expose:n,attrs:o}){const s=Fc.reduce(((e,t)=>(e["on".concat(t.replace(/^\S/,(e=>e.toUpperCase())))]=(...e)=>i(t,...e),e)),{}),a=yl((()=>{const t=wl(e),i=dl(t,["modelValue"]),n=Object.entries(i).reduce(((e,[t,i])=>{const n=ul(i);return void 0!==n&&(e[t]=n),e}),{});return ll(ll({},s),function(e){return Object.keys(e).reduce(((t,i)=>(void 0!==e[i]&&(t[function(e){return e.replace(/-(\w)/g,((e,t)=>t?t.toUpperCase():""))}(i)]=e[i]),t)),{})}(ll(ll({},o),n)))})),r=yl({get:()=>e.modelValue,set:e=>i("update:modelValue",e)}),l=vl(),d=bl(Wc(e.target||l,r,a));return n(d),()=>{var i;return Sl(e.tag||"div",{ref:l},null==(i=null==t?void 0:t.default)?void 0:i.call(t,d))}}});const Hc=xt({props:{show:{type:Boolean,default:!1},tipsWording:{type:String,default:""}},model:{prop:"show",event:"change"},methods:{display(){this.$emit("change",!0)},hide(){this.$emit("change",!1)}}},(function(){var e=this;return(0,e._self._c)("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticClass:"tips",attrs:{role:"alert"}},[e._v(e._s(e.tipsWording))])}),[],!1,null,"e2eb5158",null,null).exports;const Vc=xt({props:{showBorder:{type:Boolean,default:!1},showTitle:{type:Boolean,default:!1},title:{type:String,default:""}},data:()=>({needTopBarMask:!1}),watch:{title:{handler(){setTimeout((()=>this.checkMask()))},immediate:!0}},methods:{checkMask(){const e=this.$refs.ghostWrp,t=this.$refs.ghostTitle;this.needTopBarMask=!(!e||!t)&&e.offsetWidth<t.offsetWidth}}},(function(){var e=this,t=e._self._c;return t("div",{staticClass:"audio-panel__header",class:{border:e.showBorder},on:{click:function(t){return e.$emit("click")}}},[t("div",{staticClass:"audio-panel__header-close"},[t("div",{staticClass:"icon-close",attrs:{"aria-role":"button","aria-label":"关闭"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.$emit("close")}}})]),t("transition",{attrs:{name:"fade"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.showTitle&&e.title,expression:"showTitle && title"}],staticClass:"audio-panel__playing-bar-wrp",class:{mask:e.needTopBarMask}},[t("div",{staticClass:"audio-panel__playing-bar"},[t("span",[e._v(e._s(e.title))])])])]),t("div",{staticClass:"audio-panel__playing-bar-wrp ghost",attrs:{"aria-hidden":"true"}},[t("div",{ref:"ghostWrp",staticClass:"audio-panel__playing-bar"},[t("span",{ref:"ghostTitle"},[e._v(e._s(e.title))])])]),t("div",{staticClass:"fullscreen-icon-wrp",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.$emit("fullscreen")}}},[t("div",{staticClass:"fullscreen-icon"})])],1)}),[],!1,null,"249ec9a9",null,null).exports;const Kc=xt({inject:["version","supportSetShutdown"],filters:{durationNumFormatter:e=>_t(e,2)},props:{show:{type:Boolean,default:!0},isPlaying:{type:Boolean,default:!1},hasSetShutDown:{type:Boolean,default:!1},hasInList:{type:Boolean,default:!1},playRate:{type:Number,default:1},duration:{type:Number,default:0},currentTime:{type:Number,default:0},supportListenLater:{type:Boolean,default:!1}},data:()=>({moving:!1}),computed:{playRateWording(){return 1!==this.playRate&&"number"==typeof this.playRate?100*this.playRate%10==0?"".concat(this.playRate.toFixed(1),"倍"):"".concat(this.playRate.toFixed(2),"倍"):"倍速"}},methods:{onTouchStart(e){e.pageX<20||!this.$refs.progress||(this.moving=!0,this.__rect=this.$refs.progress.getBoundingClientRect(),this.__nowPlaying=this.info,this.$emit("seek"),document.addEventListener("touchmove",this.onTouchMove,{capture:!0}),document.addEventListener("touchend",this.onTouchEnd,{capture:!0}))},onTouchMove(e){var t,i;if(!this.moving||!this.__rect)return;const n=e.pageX||(null==(i=null==(t=e.changedTouches)?void 0:t[0])?void 0:i.pageX)||0,o=this.getTouchPercent(n,this.__rect),s=this.duration*o/1e3;return this.$emit("seeking",s),e.preventDefault(),e.stopPropagation(),!1},onTouchEnd(e){var t,i;if(!this.moving||!this.__rect)return;const n=e.pageX||(null==(i=null==(t=e.changedTouches)?void 0:t[0])?void 0:i.pageX)||0,o=this.getTouchPercent(n,this.__rect),s=this.duration*o/1e3;return this.$emit("seeked",s),this.moving=!1,document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd),e.preventDefault(),e.stopPropagation(),!1},getTouchPercent:(e,t)=>Math.max(0,Math.min(1,(e-t.left)/t.width))}},(function(){var e=this,t=e._self._c;return t("div",{staticClass:"card-item__operate-area"},[t("div",{staticClass:"card-item__progress-bar-wrp",style:"--percent: ".concat(100*(e.currentTime?1e3*e.currentTime/e.duration:0),"%")},[t("div",{ref:"progress",staticClass:"card-item__progress-bar",class:e.moving?"active":"",attrs:{role:"progressbar"}}),t("div",{staticClass:"card-item__progress-active-area js_wx_tap_highlight_exclude",attrs:{"aria-hidden":"true"},on:{"!touchstart":function(t){return t.stopPropagation(),t.preventDefault(),e.onTouchStart.apply(null,arguments)}}}),t("div",{staticClass:"card-item__time-info"},[t("span",{attrs:{role:"timer"}},[e._v(e._s(e._f("durationNumFormatter")(1e3*e.currentTime||0)))]),e.duration&&e.currentTime?t("span",{attrs:{role:"timer"}},[e._v("-"+e._s(e._f("durationNumFormatter")(e.duration-1e3*e.currentTime)))]):e.duration?t("span",{attrs:{role:"timer"}},[e._v("-"+e._s(e._f("durationNumFormatter")(e.duration)))]):e._e()])]),t("div",{staticClass:"card-item__btn-wrp"},[e.supportListenLater?t("div",{directives:[{name:"show",rawName:"v-show",value:e.supportSetShutdown,expression:"supportSetShutdown"}],staticClass:"card-item__btn-group shutdown-group left"},[t("div",{staticClass:"card-item__btn-set-shutdown js_wx_tap_highlight",class:e.hasSetShutDown?"icon-set-shutdown-done":"icon-set-shutdown",attrs:{role:"button",tabindex:"0","aria-haspopup":"true","aria-label":"设置定时关闭"},on:{"!click":function(t){return t.stopPropagation(),t.preventDefault(),(t=>e.$emit("set-shutdown",t.target,"right")).apply(null,arguments)}}})]):t("div",{staticClass:"card-item__btn-group rate-group left"},[t("div",{staticClass:"card-item__btn-playback-rate js_wx_tap_highlight",attrs:{role:"button",tabindex:"0"},on:{"!click":function(t){return t.stopPropagation(),t.preventDefault(),(()=>e.$emit("change-rate")).apply(null,arguments)}}},[e._v(e._s(e.playRateWording))])]),t("div",{staticClass:"card-item__btn-group playing-group"},[t("div",{staticClass:"card-item__btn-back-15s js_wx_tap_highlight icon-play-backward",attrs:{role:"button",tabindex:"0","aria-label":"后退15秒"},on:{"!click":function(t){return t.stopPropagation(),t.preventDefault(),(()=>e.$emit("backward")).apply(null,arguments)}}}),t("div",{staticClass:"card-item__btn-play js_wx_tap_highlight_exclude",class:e.isPlaying?"icon-pause":"icon-play",attrs:{role:"button",tabindex:"0","aria-label":e.isPlaying?"暂停":"播放"},on:{"!click":function(t){return t.stopPropagation(),t.preventDefault(),(()=>e.$emit("toggle-play")).apply(null,arguments)}}}),t("div",{staticClass:"card-item__btn-forward-30s js_wx_tap_highlight icon-play-forward",attrs:{role:"button",tabindex:"0","aria-label":"前进30秒"},on:{"!click":function(t){return t.stopPropagation(),t.preventDefault(),(()=>e.$emit("forward")).apply(null,arguments)}}})]),e.supportListenLater?t("div",{staticClass:"card-item__btn-group listen-later-group right"},[t("div",{staticClass:"card-item__btn-listen-later js_wx_tap_highlight",class:e.hasInList?"icon-correct":"icon-listen-later",attrs:{role:"button",tabindex:"0","aria-label":e.hasInList?"取消加入待播列表":"加入待播列表"},on:{"!click":function(t){return t.stopPropagation(),t.preventDefault(),e.$emit("listen-later")}}})]):e.supportSetShutdown?t("div",{staticClass:"card-item__btn-group shutdown-group right"},[t("div",{staticClass:"card-item__btn-set-shutdown js_wx_tap_highlight",class:e.hasSetShutDown?"icon-set-shutdown-done":"icon-set-shutdown",attrs:{role:"button",tabindex:"0","aria-haspopup":"true","aria-label":"设置定时关闭"},on:{"!click":function(t){return t.stopPropagation(),t.preventDefault(),(t=>e.$emit("set-shutdown",t.target)).apply(null,arguments)}}})]):e._e()])])}),[],!1,null,"f3bf6593",null,null).exports;const $c=xt({name:"audio-list-item",filters:{durationFormatter:e=>_t(e),durationNumFormatter:e=>_t(e,2)},components:{Progress:Kc},inject:["version","supportSetShutdown"],props:{playing:{type:Boolean,default:!1},info:{type:Object,required:"required"},isPlaying:{type:Boolean,default:!1},playRate:{type:Number,default:1},hasSetShutDown:{type:Boolean,default:!1},needFinishState:{type:Boolean,default:!0},needPlayingMask:{type:Boolean,default:!0},needProcessingState:{type:Boolean,default:!0}}},(function(){var e,t=this,i=t._self._c;return i("div",{staticClass:"card-item__wrp js_wx_tap_highlight",class:{"now-playing":t.playing,"gray-active":-1!==[2,3].indexOf(t.version),"none-active":1===t.version},on:{click:()=>t.$emit("click")}},[i("div",{staticClass:"card-item__info-area"},[i("div",{staticClass:"card-item__cover",class:1===t.version||2===t.version&&!t.playing?"small-cover":"",style:"background-image: url(".concat(t.info.listen_item&&t.info.listen_item.cover,")"),attrs:{role:"figure"}},[1===t.version?i("div",{directives:[{name:"show",rawName:"v-show",value:t.playing&&t.needPlayingMask,expression:"playing && needPlayingMask"}],staticClass:"playing",class:{pause:!t.isPlaying}},[i("div",{staticClass:"dot1"}),i("div",{staticClass:"dot2"}),i("div",{staticClass:"dot3"}),i("div",{staticClass:"dot4"})]):t._e()]),t.info.listen_item?i("div",{staticClass:"card-item__info"},[i("div",{staticClass:"card-item__title",class:{"bold-title":(2===t.version||3===t.version)&&t.playing,"small-title":1===t.version}},[t._v(t._s((null==(e=t.info.listen_item.article_info)?void 0:e.audio_title)||t.info.listen_item.title))]),i("div",{staticClass:"card-item__desc"},[t._e(),t.info.listen_item.finder_info?i("div",{staticClass:"finder-icon"}):t._e(),i("span",[t._v(t._s(t.info.listen_item.author)+" ")]),2===t.version&&2===t.info.listen_item.tts_model_type?i("span",{directives:[{name:"show",rawName:"v-show",value:t.playing,expression:"playing"}]},[t._v("作者音色朗读 ")]):2===t.version&&2!==t.info.listen_item.type?i("span",{directives:[{name:"show",rawName:"v-show",value:t.playing,expression:"playing"}]},[t._v("音频由作者上传")]):t._e(),t.info.listen_item.duration&&(2!==t.version&&3!==t.version||!t.playing)?[t.needProcessingState&&t.info.currentTime&&t.info.currentTime<parseInt(t.info.listen_item.duration/1e3,10)?i("span",[t._v("剩余"+t._s(t._f("durationFormatter")(t.info.listen_item.duration-1e3*t.info.currentTime)))]):i("span",[t._v(t._s(t._f("durationNumFormatter")(t.info.listen_item.duration)))])]:t._e(),t.info.currentTime&&t.info.currentTime<parseInt(t.info.listen_item.duration/1e3,10)||!t.info.finished||!t.needFinishState?t._e():i("span",[t._v(" 已播完")])],2)]):t._e()]),2!==t.version&&3!==t.version||!t.playing?t._e():i("Progress",t._g({attrs:{"play-rate":t.playRate,"is-playing":t.isPlaying,"current-time":t.info.currentTime,"has-set-shut-down":t.hasSetShutDown,duration:t.info.listen_item.duration}},t.$listeners))],1)}),[],!1,null,"2966d2a1",null,null).exports;const Jc=xt({props:{options:{type:Array,required:"required"},activeKey:{type:[Number,String],default:""},wrpStyle:{type:[Object,String],default:""},show:{type:Boolean,default:!1}},model:{prop:"show",event:"change"},data(){return{activeIndex:this.options.findIndex((e=>e.key===this.activeKey))}},computed:{varsStyle(){return Object.keys(this.wrpStyle).filter((e=>0===e.indexOf("--transform"))).reduce(((e,t)=>({...e,[t]:this.wrpStyle[t]})),{})}},watch:{activeKey(e){this.activeIndex=this.options.findIndex((t=>t.key===e))},show(e){e&&this.$refs.items&&this.$refs.items[0]&&this.$refs.items[0].focus()}},methods:{onClick(e){this.activeIndex=e,this.$emit("select",this.options[e]),this.$emit("change",!1)}}},(function(){var e=this,t=e._self._c;return t("transition",{attrs:{name:"fade"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticClass:"option-menu__wrp",style:e.varsStyle,attrs:{role:"dialog","aria-modal":"true",tabindex:"0","aria-hidden":e.show?"false":"true"},on:{click:function(t){return t.target!==t.currentTarget?null:e.$emit("change",!1)}}},[t("span",{staticStyle:{display:"none"},attrs:{id:"js_a11y_set_shutdown_label_before","aria-hidden":"true"}},[e._v("设置定时关闭: ")]),t("div",{staticClass:"option-menu",style:e.wrpStyle},e._l(e.options,(function(i,n){return t("div",{key:i.key,ref:"items",refInFor:!0,staticClass:"option-item",class:e.activeIndex===n?"active":"",attrs:{id:"js_a11y_set_shutdown_label_".concat(n),role:"button",tabindex:"0","aria-labelledby":"js_a11y_set_shutdown_label_before js_a11y_set_shutdown_label_".concat(n)},on:{click:function(t){return e.onClick(n)}}},[t("span",[e._v(e._s(i.value))]),t("span",{directives:[{name:"show",rawName:"v-show",value:e.activeIndex===n,expression:"activeIndex === index"}],staticClass:"weui-icon-checked"})])})),0)])])}),[],!1,null,"4a0604d9",null,null).exports,Gc=0,Xc=1,Yc=2,Qc={[Gc]:[Xc],[Xc]:[Yc,Gc],[Yc]:[Gc,Xc]};const Zc=xt({props:{title:{type:String,default:""},disable:{type:Boolean,default:!1},v:{type:Number,default:40}},data:()=>({anime:null,needAnime:!1,state:Gc}),watch:{title:{handler(){setTimeout((()=>this.checkAnime()))},immediate:!0}},created(){Ee.on("menu:setfont",(()=>this.checkAnime()))},methods:{checkDisable(){return!!this.disable&&(this.anime=null,this.needAnime=!1,this.state=Gc,!0)},checkState(e){var t;return this.needAnime&&(null==(t=Qc[this.state])?void 0:t.indexOf(e))>-1},checkAnime(){if(this.checkDisable())return;this.needAnime=!1,this.anime&&(this.anime.finish(),this.anime=null);const e=this.$refs.ghost,t=this.$refs.wrp;e&&t&&(console.log("deanti checkAnime",e.clientWidth,t.clientWidth),this.needAnime=e.clientWidth>t.clientWidth)},onAnimeFinished(){this.anime=null,this.state=Gc},play(){var e;const t=Xc;if(this.checkDisable())return;if(!this.checkState(t))return;const i=this.$refs.container;if(!i)return;if(this.state===Yc)return this.state=t,void(null==(e=this.anime)||e.play());const n=this.$refs.text.getBoundingClientRect().width,o=n/this.v*1e3;this.anime=i.animate([{offset:0,transform:"translate3d(0, 0, 1.1px)"},{offset:1,transform:"translate3d(-".concat(n,"px, 0, 1.1px)")}],{easing:"linear",duration:o,delay:1e3}),this.anime.onfinish=()=>this.onAnimeFinished(),this.state=t},pause(){var e;const t=Yc;this.checkDisable()||this.checkState(t)&&(null==(e=this.anime)||e.pause(),this.state=t)},finish(){var e;const t=Gc;this.checkDisable()||this.checkState(t)&&(null==(e=this.anime)||e.finish(),this.anime=null,this.state=t)}}},(function(){var e=this,t=e._self._c;return t("div",{ref:"wrp",staticClass:"wrp",class:{anime:e.needAnime,"anime-done":0===e.state}},[t("div",{ref:"container",staticClass:"container"},[t("span",{ref:"text"},[e._v(e._s(e.title)+e._s(e.needAnime?" ":""))]),t("span",{directives:[{name:"show",rawName:"v-show",value:e.needAnime,expression:"needAnime"}],attrs:{"aria-hidden":"false"}},[e._v(e._s(e.title))]),t("span",{ref:"ghost",staticClass:"ghost",attrs:{"aria-hidden":"false"}},[e._v(e._s(e.title))])])])}),[],!1,null,"fb6c8a9c",null,null).exports;let eu=0;const tu=xt({name:"mp-audio-panel",filters:{durationFormatter:e=>_t(e),durationNumFormatter:e=>_t(e,2)},components:{Tips:Hc,Progress:Kc,Teleport:_i,Intersect:C,OptionMenu:Jc,VueDraggable:Uc,[$c.name]:$c,[te.name]:te,[ie.name]:ie,[w.name]:w,[ne.name]:ne},provide(){return{supportSetShutdown:ca,supportDynamicPlayList:da,version:this.$options.version||1}},data(){const e=ve.os.pc?"20%":"".concat(screen.height/4-(screen.height-window.innerHeight),"px"),t=ft.get("play-rate")||1,i=[{key:"none",value:"不开启"},...[15,30,60,90].map((e=>({key:e,value:"".concat(e,"分钟")}))),{key:"whenEnd",value:"当前单集结束后"}];return{firstScreenDataReady:!1,firstScreenDataError:!1,isShow:!1,cardTitleAnime:!1,panelContentHeight:screen.height/4*3-70,isShowList:!1,isPlaying:!1,playLoading:!1,playingType:0,playingListenId:"",playingSrcId:"",startRoutePoint:{x:0,y:0},animeRoutePoints:[],isShowingListenLaterAnime:!1,loading:!1,hasMore:!0,listSessionBuffer:"",hasInList:!1,list:[],playInfo:{},selectInfo:{},base64:"",version:this.$options.version||1,lastPlayId:"",isOpened:!1,tipsShow:!1,tipsWording:"",shutdownType:"none",shutdownLeftTime:0,shutdownPanelShow:!1,shutdownPanelPosition:{top:"100vh",left:"100vw"},topAnimeAreaInfo:null,topAnimeAreaTop:"",showTopAnimeArea:!1,playingAreaHide:!1,dragMoving:!1,slideMoving:!1,needUpdate:!1,playChanging:!1,showPlayingBar:!1,disableTransition:!1,transitionDis:0,transitionGapByScroll:0,modalTop:e,playRate:t,shutdownOptions:i,supportSetShutdown:ca,supportDynamicPlayList:da}},computed:{animeCoverStyle(){return["left: ".concat(this.startRoutePoint.x,"px; top: ").concat(this.startRoutePoint.y,"px;"),this.isShowingListenLaterAnime?"visibility: visible;":"visibility: hidden;","background-image: url(".concat(this.playInfo.cover,")")].join(";")},playBtnIconClass(){const e=this.playingListenId===this.playInfo.listen_id,t=this.isPlaying&&e;return e&&this.playLoading?"weui-loading":t?"icon-pause":"icon-play"},playingInfo(){var e;return this.list.find((e=>e.listen_id===this.playingListenId))||{listen_id:null==(e=this.selectInfo)?void 0:e.listen_id,listen_item:this.selectInfo}},playingIndex(){return this.list.findIndex((e=>{var t;return e.listen_id===(this.playingListenId||(null==(t=this.selectInfo)?void 0:t.listen_id))}))},showProgress(){return this.selectInfo&&(this.selectInfo.listen_id!==this.playInfo.listen_id||this.playingListenId===this.selectInfo.listen_id||this.playingSrcId===this.selectInfo.src_id)}},watch:{list(e){-1!==(e||[]).findIndex((e=>e.listen_id===this.playInfo.listen_id))?this.hasInList=!0:this.hasInList=!1},playInfo:{handler(e){this.selectInfo={...e}},immediate:!0,deeply:!0},selectInfo(){this.$nextTick((()=>{setTimeout((()=>{this.checkCardTitleAnime(),this.startCardTitleAnime()}),50)}))}},created(){this.getFirstScreenData(),this.__debounceScroll=gt(this.onScroll,300),Ee.invoke("getTingAudioState",{},(e=>{/:ok$/.test(e.err_msg)?eu=1:-9999!==e.err_code&&-1===e.err_msg.indexOf("function_not_exist")||(eu=0)}))},mounted(){var e,t,i;this.registerStatusObserver(),setTimeout((()=>this.checkCardTitleAnime())),Ee.on("menu:setfont",(()=>{const e=this.$refs.playWrp;if(!e)return;const{height:t}=e.getBoundingClientRect();this.panelContentHeight=t,this.checkCardTitleAnime()})),document.addEventListener("visibilitychange",this.onVisibilityChange);const n=null==(e=this.$refs.bottomModal)?void 0:e.getViewRef("contentAreaWrp");n&&(null==(t=n.addEventListener)||t.call(n,"scroll",this.__debounceScroll));const o=document.querySelector(".audio-panel-modal .weui-half-screen-dialog__bd");null==(i=null==o?void 0:o.addEventListener)||i.call(o,"touchmove",(e=>{if(this.dragMoving)return e.preventDefault(),e.stopPropagation(),!1})),this.onDragScroll=(e,t,i,n,s)=>{o.scrollTop+=t,this.transitionGapByScroll+=t,this.transitionDis+=t}},beforeDestroy(){var e,t;this.stopCountdown(),document.removeEventListener("visibilitychange",this.onVisibilityChange);const i=null==(e=this.$refs.bottomModal)?void 0:e.getViewRef("contentAreaWrp");i&&(null==(t=i.removeEventListener)||t.call(i,"scroll",this.__debounceScroll))},methods:{show(e=!1,t=!1){var i,n;try{this.selectInfo=this.playInfo||{},this.$refs.bottomModal.show(),this.checkCardTitleAnime(),this.__titleAnime&&(this.__titleAnime.cancel(),this.__titleAnime=void 0);const o=t||!this.isOpened||this.needUpdate;return this.needUpdate=!1,e||2!==this.version&&3!==this.version?(e||1===this.version)&&o&&this.getListData(!0):(null==(i=this.playInfo)?void 0:i.listen_id)?this.isPlaying&&(null==(n=this.playInfo)?void 0:n.listen_id)===this.playingListenId&&this.playingListenId?o&&this.getListData(!0):this.supportDynamicPlayList?(this.addToListenLater(this.playInfo,(()=>{o&&this.getListData(!0)}),1),this.play(this.playInfo),this.report({EventType:4})):this.addToListenLater(this.playInfo,(()=>{this.play(this.playInfo),o&&this.getListData(!0),this.report({EventType:4})}),1):this.__autoPlayWhenGetFirstScreenData=!0,this.report({EventType:2}),this.isOpened=!0,ge.setSum(la,8,1),this.registerClientListUpdatedListener(),this.getStatus((e=>{e.playRate&&(this.playRate=+e.playRate,ft.set("play-rate",+e.playRate))})),!0}catch(Mu){return!1}},hide(){this.$refs.bottomModal.hide(),this.__titleAnime&&(this.__titleAnime.cancel(),this.__titleAnime=void 0)},showList(){ge.setSum(la,9,1),this.isShowList=!0,this.__titleAnime&&(this.__titleAnime.cancel(),this.__titleAnime=void 0),this.report({EventType:7})},hideList(){this.isShowList=!1,this.startCardTitleAnime()},changePlay(e,t=0,i=!1){var n,o,s,a,r,l;if(this.playingListenId===e.listen_id&&this.isPlaying)return this.pause(!1),void(i&&this.report({EventType:5,Pos:t}));if(this.playChanging=!0,this.__changePlayTimeout&&(clearTimeout(this.__changePlayTimeout),this.__changePlayTimeout=null),this.__changePlayTimeout=setTimeout((()=>{this.playChanging=!1}),500),this.playingAreaHide&&(2===this.version||3===this.version)){this.__afterTopAnimeAreaEnterTimeout&&(clearTimeout(this.__afterTopAnimeAreaEnterTimeout),this.__afterTopAnimeAreaEnterTimeout=null);const i=document.querySelector(".audio-list__item-slide-wrp.pos-".concat(t)),d=null==(o=null==(n=null==i?void 0:i.getBoundingClientRect)?void 0:n.call(i))?void 0:o.top,c=null==(l=null==(r=null==(a=null==(s=this.$refs.bottomModal)?void 0:s.getViewRef("contentAreaWrp"))?void 0:a.getBoundingClientRect)?void 0:r.call(a))?void 0:l.top;this.topAnimeAreaInfo=e,this.topAnimeAreaTop=d&&c&&d-c||"",this.showTopAnimeArea=!0}!i||this.playingListenId===e.listen_id&&this.list[0].listen_id===e.listen_id?this.play(e.listen_item):this.supportDynamicPlayList?(this.addToListenLater(e.listen_item,(()=>{}),1),this.play(e.listen_item)):this.addToListenLater(e.listen_item,(()=>this.play(e.listen_item)),1),this.selectInfo={...e.listen_item},i?this.report({EventType:4,Pos:t}):(ge.setSum(la,10,1),this.report({EventType:11,Pos:t}))},toggleListenLater(){var e,t,i,n;if(this.hasInList)return this.hasInList=!1,this.removeFromListenLater((null==(e=this.playInfo)?void 0:e.listen_id)||""),Ee.invoke("vibrateShort",{style:"medium"}),this.report({EventType:12}),void ge.setSum(la,19,1);this.isShowList||this.showListenLaterAnime();-1!==this.list.findIndex((e=>e.listen_id===this.playingListenId))&&this.playingListenId&&(null==(t=this.playInfo)?void 0:t.listen_id)&&this.playingListenId!==(null==(i=this.playInfo)?void 0:i.listen_id)?this.adjustToNextPlay({listen_item:this.playInfo,listen_id:null==(n=this.playInfo)?void 0:n.listen_id}):this.addToListenLater(this.playInfo),this.hasInList=!0,this.report({EventType:6})},togglePlay(){var e,t;(null==(e=this.playInfo)?void 0:e.listen_id)&&(this.isPlaying&&this.playingListenId===(null==(t=this.playInfo)?void 0:t.listen_id)?this.pause(!0):(this.hasInList||(this.isShowList||this.showListenLaterAnime(),Ee.invoke("vibrateShort",{style:"medium"})),this.supportDynamicPlayList?(this.addToListenLater(this.playInfo,(()=>{}),1),this.play(this.playInfo,!0)):this.addToListenLater(this.playInfo,(()=>this.play(this.playInfo,!0)),1)))},removeFinishedAudio(e){const t=e.results.filter((e=>{const t=this.list.find((t=>t.listen_id===e.listenId));if(!t)return;const i=t&&t.newAdded;return e.finished&&(e.currentTime>=95e-5*t.duration||0===e.currentTime)&&!i&&(!this.isPlaying||this.isPlaying&&e.listenId!==this.playingListenId)})).map((e=>e.listenId));this.batchRemoveFromListenLater(t)},startCountDown(){this.countdownInterval&&this.countdownIntervalId===this.playingListenId||(this.countdownInterval&&this.stopCountdown(),this.countdownIntervalId=this.playingListenId,this.__countdownResTime=0,this.countdownInterval=setInterval((()=>{this.__countdownResTime>=0?(this.__countdownResTime=0,this.getStatus((e=>{e&&e.item&&e.item.listenId&&"playing"===e.status?this.list=[...this.list.map((t=>t.listen_id===e.item.listenId&&e.currentTime?(t.currentTime=+e.currentTime||0,{...t}):t))]:this.stopCountdown()}))):this.list=[...this.list.map((e=>e.listen_id!==this.playingListenId?e:("number"==typeof e.currentTime&&(e.currentTime+=1),{...e})))],this.__countdownResTime+=1}),1e3))},stopCountdown(){this.countdownInterval&&(clearInterval(this.countdownInterval),this.countdownInterval=null,this.countdownIntervalId=void 0,this.__countdownResTime=0)},showTips(e,t=1500){e&&(this.__tipsTimeout&&(clearTimeout(this.__tipsTimeout),this.__tipsTimeout=null),this.tipsWording=e,this.tipsShow=!0,this.__tipsTimeout=setTimeout((()=>{this.tipsShow=!1,this.tipsWording=""}),t))},hideTips(){this.__tipsTimeout&&(clearTimeout(this.__tipsTimeout),this.__tipsTimeout=null),this.tipsShow=!1,this.tipsWording=""},callShutdownPanel(e){this.getStatus((t=>{let i=t.shutdown;if("string"==typeof t.shutdown&&t.shutdown)try{i=JSON.parse(t.shutdown)}catch(Mu){i=null}i?("afterMins"===i.shutdownType?this.shutdownType=i.time||0:this.shutdownType=i.shutdownType||"none",this.shutdownLeftTime=i.leftTime||0):(this.shutdownType="none",this.shutdownLeftTime=0);const n=null==e?void 0:e.getBoundingClientRect();this.shutdownPanelPosition={top:void 0,left:void 0,bottom:"".concat(window.innerHeight-(n.bottom+26),"px"),right:"".concat(window.innerWidth-n.left+4,"px"),"--transform-origin-top":"".concat(n.bottom-n.height/2,"px"),"--transform-origin-left":"".concat(n.left-4,"px")},this.shutdownPanelShow=!0}))},scrollToNowPlaying(){var e;const t=null==(e=this.$refs.bottomModal)?void 0:e.getViewRef("contentAreaWrp"),i=document.querySelector(".audio-list__item-slide-wrp.now-playing");i&&t&&t.scrollTo({top:i.offsetTop,behavior:"smooth"})},registerClientListUpdatedListener(){!this.__hasRegisterClientListUpdatedListener&&this.supportDynamicPlayList&&(this.__hasRegisterClientListUpdatedListener=!0,Ee.on("onTingPlayListRefresh",this.onTingPlayListRefresh))},addToListenLater(e,t,i=0){const n=e.listen_id||"",o=this.list.find((e=>e.listen_id===n)),s={newAdded:!0,currentTime:o&&o.currentTime,listen_id:n,listen_item:e};this.list=[s,...this.list].filter(((e,t,i)=>i.findIndex((t=>t.listen_id===e.listen_id))===t)),pa({scene:i,listenId:n,onSuccess:()=>{this.notifyAppListChange(),this.$emit("add-to-listen-later",n)},onComplete:()=>"function"==typeof t&&t()})},adjustToNextPlay(e,t=0,i=!1){if(!(null==e?void 0:e.listen_id))return;const n=this.list.findIndex((t=>t.listen_id===e.listen_id));this.list=n<=0?[...this.list.slice(0,1),e,...this.list.slice(1)]:[...this.list.slice(0,1),this.list[n],...this.list.slice(1,n),...this.list.slice(n+1)],(({listenId:e,onSuccess:t,onError:i,onComplete:n})=>{ge.setSum(la,37,1),ye({url:"/mp/listenplayer?action=next_play&__biz=".concat(window.biz,"&appmsgid=").concat(window.mid,"&idx=").concat(window.idx),type:"POST",data:{listen_id:e},async:!0,dataType:"json",success:e=>{e&&e.base_resp&&0===e.base_resp.ret?"function"==typeof t&&t():("function"==typeof i&&i(),ge.setSum(la,38,1))},onError:()=>{"function"==typeof i&&i(),ge.setSum(la,38,1)},complete:()=>{"function"==typeof n&&n()}})})({listenId:e.listen_id||"",onSuccess:()=>this.notifyAppListChange()}),i&&this.report({EventType:23,Pos:t})},removeFromListenLater(e,t=0,i=!1){this.list=[...this.list].filter((t=>t.listen_id!==e)),ha({listenId:e,onSuccess:()=>{this.notifyAppListChange(),this.$emit("remove-from-listen-later",e)}}),i&&this.report({EventType:24,Pos:t})},batchRemoveFromListenLater(e){this.list=[...this.list].filter((t=>-1===e.indexOf(t.listen_id))),Ae.isAndroid&&this.supportDynamicPlayList||e.forEach((e=>ha({listenId:e,onSuccess:()=>this.notifyAppListChange()})))},getFirstScreenData(){this.firstScreenDataError=!1,(({onSuccess:e,onError:t,onComplete:i})=>{ge.setSum(la,20,1),ye({url:"/mp/tts?action=getttslistenitem&__biz=".concat(window.biz,"&appmsgid=").concat(window.mid,"&idx=").concat(window.idx),type:"GET",dataType:"json",async:!0,success:i=>{i&&i.base_resp&&0===i.base_resp.ret&&i.tts_listenitem?"function"==typeof e&&e(i):("function"==typeof t&&t(i),ge.setSum(la,21,1))},error:()=>{"function"==typeof t&&t(),ge.setSum(la,21,1)},complete:()=>{"function"==typeof i&&i()}})})({onSuccess:e=>{var t;this.firstScreenDataReady=!0,this.firstScreenDataError=!1,this.playInfo={...e.tts_listenitem,tts_model_type:(null==(t=e.listen_item_ext)?void 0:t.tts_model_type)||1},this.base64=e.category_playlist_info_base64||"",this.$emit("list-base64-change",this.base64),!this.__autoPlayWhenGetFirstScreenData||2!==this.version&&3!==this.version||(this.supportDynamicPlayList?(this.addToListenLater(this.playInfo,(()=>{}),1),this.getListData(!0),this.report({EventType:4})):this.addToListenLater(this.playInfo,(()=>{this.play(this.playInfo),this.getListData(!0),this.report({EventType:4})}),1)),this.__autoPlayWhenGetFirstScreenData=!1,setTimeout((()=>this.checkCardTitleAnime()))},onError:()=>{this.firstScreenDataReady=!1,this.firstScreenDataError=!0}})},getListData(e=!1,t){if(console.log("[audio panel] getList start:",e,this.hasMore,this.loading),!e&&(!this.hasMore||this.loading))return void this.$refs.bottomModal.finishPullUpLoad();this.loading=!0;const i=Math.random().toString("16").slice(2);this.loadingClientId=i,(({buffer:e,onSuccess:t,onError:i,onComplete:n})=>{ge.setSum(la,15,1),ye({url:"/mp/listenplayer?action=get_playlist&__biz=".concat(window.biz,"&appmsgid=").concat(window.mid,"&idx=").concat(window.idx),type:"POST",data:{last_listen_id:e?ua:"",session_buffer:e||"",count:20},async:!0,dataType:"json",success:e=>{if(e&&e.base_resp&&0===e.base_resp.ret){if("function"==typeof t&&t(e),e&&e.results&&e.results.length){const t=e.results[e.results.length-1];ua=t&&t.listen_id||""}}else"function"==typeof i&&i(e),ge.setSum(la,16,1)},error:()=>{"function"==typeof i&&i(),ge.setSum(la,16,1)},complete:()=>{"function"==typeof n&&n()}})})({buffer:e?"":this.listSessionBuffer,onSuccess:n=>{if(i!==this.loadingClientId)return void(this.loading=!1);this.hasMore=n.has_more||!1,this.listSessionBuffer=n.session_buffer||"",this.base64=n.category_playlist_info_base64||"";const o=(n.results||[]).filter((e=>!!e.listen_id&&e.listen_item)).map((e=>{var t,i;return{...e,newAdded:!0,listen_item:{...e.listen_item,tts_model_type:(null==(i=null==(t=n.listen_item_ext)?void 0:t.find((t=>(null==t?void 0:t.listen_id)===e.listen_id)))?void 0:i.tts_model_type)||1}}}));if(e){const e=this.list||[];this.list=[...o.map((t=>({...e.find((e=>e.listen_id===t.listen_id))||{},...t})))].filter(yt("listen_id"))}else this.list=[...this.list,...o].filter(yt("listen_id"));this.getPlayFinishedState(o.map((e=>e.listen_id))),this.loading=!1,"function"==typeof t&&t(this.list),console.log("[audio panel] getList: ".concat(JSON.stringify(n.results||[])," isFirst:").concat(e)),Se.info("[audio panel] getList: ".concat(JSON.stringify(n.results||[])," isFirst:").concat(e))},onError:()=>{i===this.loadingClientId?(this.loading=!1,this.hasMore=!1):this.loading=!1},onComplete:()=>{i===this.loadingClientId?this.$refs.bottomModal.finishPullUpLoad():this.loading=!1}})},report(e){var t;const i=(this.list||[]).find((e=>e.listen_id===this.playingListenId));try{const n={BizUin:window.biz,MsgId:+window.mid,Idx:+window.idx,ListenId:"".concat((null==i?void 0:i.listen_id)||""),ListenType:(null==(t=null==i?void 0:i.listen_item)?void 0:t.type)||0,Scene:1*window.source,SubScene:1*window.subscene,Pos:0,EventType:0,EventTime:parseInt(Date.now()/1e3,10),SessionId:"".concat(window.sessionid),EnterId:+window.enterid,ExpVersion:"".concat(this.version||0),PlayRate:parseInt(100*(this.playRate||1),10),ListenTime:parseInt(1e3*(+(null==i?void 0:i.currentTime)||0),10),ShutDownType:String(this.shutdownType)||"",ShutDownLeftTime:this.shutdownLeftTime||0,ListBase64:this.base64||"",TargetPos:0,...e};console.log("[audio panel] report data",n),we.report(ra,n)}catch(Mu){console.log("[audio panel] report error",Mu)}},play(e,t=!1,i=0,n=void 0){var o,s,a;const r=(e=>{var t,n,o,s,a,r,l,d,c,u,p,h,m,_,f;const g={username:(null==(t=null==e?void 0:e.author_info)?void 0:t.username)||"",name:(null==(n=null==e?void 0:e.author_info)?void 0:n.nickname)||"",bizUin:(null==(o=null==e?void 0:e.article_info)?void 0:o.bizuin)||"",webUrl:(null==(s=null==e?void 0:e.article_info)?void 0:s.url)||"",audioId:(null==(a=null==e?void 0:e.article_info)?void 0:a.audio_id)||""},y={appId:(null==(r=null==e?void 0:e.article_info)?void 0:r.biz_appid)||"",mid:"",webUrl:(null==(l=null==e?void 0:e.article_info)?void 0:l.url)||""},w={nonceId:(null==(d=null==e?void 0:e.finder_info)?void 0:d.nonce_id)||"",tid:(null==(c=null==e?void 0:e.finder_info)?void 0:c.tid)||""};return{listenId:(null==e?void 0:e.listen_id)||"",type:null==e?void 0:e.type,startTime:i,duration:parseInt((null==e?void 0:e.duration)/1e3,10)||123,srcId:(null==e?void 0:e.listen_id)||"",title:(null==(u=null==e?void 0:e.article_info)?void 0:u.audio_title)||(null==e?void 0:e.title)||(null==(p=null==e?void 0:e.article_info)?void 0:p.title)||(null==(h=null==e?void 0:e.finder_info)?void 0:h.title)||"",webUrl:(null==(m=null==e?void 0:e.article_info)?void 0:m.url)||"",dataUrl:null==(_=null==e?void 0:e.article_info)?void 0:_.audio_url,audioUrl:null==(f=null==e?void 0:e.article_info)?void 0:f.audio_url,author:(null==e?void 0:e.author)||"",cover:(null==e?void 0:e.cover)||"",...(null==e?void 0:e.article_info)?{mpInfo:g}:{},...(null==e?void 0:e.article_info)?{musicInfo:y}:{},...(null==e?void 0:e.finder_info)?{finderInfo:w}:{}}})(e);let l={openPlayerUI:!1,playMode:0,listenId:(null==e?void 0:e.listen_id)||"",itemList:[r],scene:n,playbackRate:this.playRate||1,categoryPlaylistInfoBuffer:this.base64||"",categoryDeleteAfterListen:!0};const d={protocol:"",src:function(){var t;const i=(null==(t=null==e?void 0:e.article_info)?void 0:t.audio_url)||"",n=window.clientversion;return n&&(n>"18000e00"&&n<="18000e2d"||n>"18000f00"&&n<="18000f24")?"".concat(i,"&t=").concat(Date.now()):i}(),lowbandUrl:(null==(o=null==e?void 0:e.article_info)?void 0:o.audio_url)||"",title:null==e?void 0:e.title,epname:"",singer:(null==e?void 0:e.author)||"",srcId:null==e?void 0:e.listen_id,coverImgUrl:(null==e?void 0:e.cover)||"",webUrl:(null==(s=null==e?void 0:e.article_info)?void 0:s.url)||"",musicbar_url:(null==(a=null==e?void 0:e.article_info)?void 0:a.url)||"",needStartMusicUI:0,playbackRate:this.playRate||1,startTime:i},c=wt(null==e?void 0:e.type)&&1===eu;let u=c?"setTingAudioState":"setBackgroundAudioState";c&&this.playingListenId&&this.playingListenId===r.listenId&&da&&!this.isPlaying&&!this.playLoading&&(u="operateTingAudio",l={operationType:"resume",srcId:this.playingSrcId}),Ee.invoke(u,c?l:d,(t=>{console.log("[audio panel] play",u,c?l:d,t),Se.info("[audio panel] play ".concat(u," opt:").concat(JSON.stringify(c?l:d)," res:").concat(JSON.stringify(t))),-1===t.err_msg.indexOf("ok")?(this.hide(),window.weui.alert("暂无法播放，请重试"),ge.setSum(la,17,1),window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.report("t1t read fail","res: ".concat(JSON.stringify(t)," | url: ").concat(location.href),{mid:"mmbizwap:t1t_read_fail",view:"wap_business"})):(this.isPlaying=!0,this.playingListenId=e.listen_id||"",this.playingSrcId=e.listen_id||"")})),t&&(ge.setSum(la,12,1),this.report({EventType:4,ListBase64:this.base64||""}))},pause(e=!0){e&&(ge.setSum(la,13,1),this.report({EventType:5}));const t={operationType:"pause",srcId:this.playingSrcId},i=wt(this.playingType)&&1===eu?"operateTingAudio":"operateBackgroundAudio";Ee.invoke(i,t,(e=>{console.log("[audio panel] ".concat(i,": params:"),t,"res:",e),-1!==e.err_msg.indexOf("ok")&&(this.isPlaying=!1)}))},setCurrentTime(e,t){const i=this.list.findIndex((e=>e.listen_id===this.playingListenId)),n=this.list[i].listen_item.duration/1e3,o=parseInt(Math.max(Math.min(e,n),0),10),s={operationType:"seek",srcId:this.playingSrcId||"",seektime:o},a={operationType:"seek",currentTime:o},r=wt(this.list[i].listen_item.type)&&1===eu,l=r?"operateTingAudio":"operateBackgroundAudio";Ee.invoke(l,r?s:a,(e=>{console.log("[audio panel] ".concat(l),r?s:a,e),"function"==typeof t&&t()}))},getStatus(e,t=!0){Ee.invoke(eu?"getTingAudioState":"getBackgroundAudioState",{},(i=>{console.log("[audio panel] getStatus",eu?"getTingAudioState":"getBackgroundAudioState",i),i&&i.item&&i.item.listenId&&t&&this.onGetStatusChange(i),"function"==typeof e&&e(i)}))},registerStatusObserver(){["onTingAudioStateChanged","onBackgroundAudioStateChange"].forEach((e=>{Ee.on(e,(e=>{e&&e.item&&e.item.listenId&&this.onGetStatusChange(e)}))}))},getPlayFinishedState(e,t=!1){const i=(e||(this.list||[]).map((e=>e.listen_id))).filter((e=>e));i.length&&Ee.invoke("operateTingAudio",{operationType:"getFinishedState",listenIds:i},(e=>{if(e&&e.err_msg&&-1!==e.err_msg.indexOf(":ok")){let i=e.results||[];if(Ae.isAndroid&&"string"==typeof e.results)try{i=JSON.parse(i||"[]")||[]}catch(Mu){i=[]}i.forEach((e=>{const t=this.list.findIndex((t=>e.listenId===t.listen_id));-1!==t&&this.$set(this.list[t],"currentTime",+e.currentTime)})),this.getStatus((()=>this.removeFinishedAudio({results:i})),!t)}console.log("[audio panel] getPlayFinishedState",i,e)}))},notifyAppListChange(){this.supportDynamicPlayList&&Ee.invoke("operateTingAudio",{operationType:"refreshPlayList",categoryPlaylistInfoBuffer:this.base64||""},(e=>{console.log("[audio panel] notify app refreshPlayList",e)}))},onShow(){this.isShow=!0,Ee.invoke("operateTingAudio",{operationType:"setForegroundState",isForeground:!0},(e=>console.log("[audio panel] setForegroundState:true res:".concat(JSON.stringify(e)))))},onHide(){var e;this.isShow=!1,this.dragMoving=!1,Ee.invoke("operateTingAudio",{operationType:"setForegroundState",isForeground:!1},(e=>console.log("[audio panel] setForegroundState:false res:".concat(JSON.stringify(e))))),this.$refs.bottomModal.scrollTo(0),this.report({EventType:3}),this.isShowList&&this.report({EventType:10}),null==(e=this.$refs.slideGroup)||e.reset()},onClickHideButton(){this.isShowList?(this.hideList(),this.report({EventType:9})):this.$refs.bottomModal.hide()},onScroll(){var e;const t=null==(e=this.$refs.bottomModal)?void 0:e.getViewRef("contentAreaWrp");t&&(t.scrollTop>130?this.playingAreaHide=!0:this.playingAreaHide=!1)},onVisibilityChange(){const e="visible"===document.visibilityState;e&&this.isOpened&&this.getListData(!0),e&&this.list&&this.list.length&&this.isOpened&&this.getPlayFinishedState(),e&&this.getStatus((e=>{e.playRate&&(this.playRate=+e.playRate,ft.set("play-rate",+e.playRate))}))},onGetStatusChange(e){var t;this.playingListenId=e.item.listenId,this.playingSrcId=e.item.srcId,this.playingType=e.item.type,"playing"===e.status?(this.isPlaying=!0,this.playLoading=!1,this.startCountDown(),this.list.some((t=>t.listen_id===e.item.listenId&&t.newAdded))&&(this.list=this.list.map((t=>t.listen_id===e.item.listenId?(t.newAdded=!1,t):t)))):"loading"===e.status?(this.isPlaying=!1,this.playLoading=!0,this.stopCountdown()):(this.playLoading=!1,this.isPlaying=!1,"idle"===e.status&&(this.playingListenId="",this.playingSrcId=""),this.stopCountdown()),e.duration&&this.playingInfo&&((null==(t=this.playingInfo.listen_item)?void 0:t.duration)&&this.playingInfo.listen_item.duration/1e3===e.duration||(this.list=this.list.map((t=>t.listen_item&&t.listen_id===e.item.listenId?(t.listen_item.duration=1e3*e.duration,t):t)))),(this.lastPlayId!==e.item.listenId||1===this.list.length&&"playing"!==e.status)&&this.getPlayFinishedState([this.lastPlayId],!0),this.lastPlayId&&this.lastPlayId!==e.item.listenId&&this.onSwitchAudio(e.item.listenId,this.lastPlayId),this.lastPlayId=e.item.listenId},onSwitchAudio(e,t){const i=this.list.find((t=>t.listen_id===e));i&&(this.selectInfo=i.listen_item),this.startCardTitleAnime()},onListScreenExpose(){this.report({EventType:8})},onPlayScreenExpose(){this.report({EventType:1}),this.showPlayingBar=!1},onPlayScreenLeave(){this.showPlayingBar=!0},onListItemExpose(e,t){},onListItemLeave(e,t){},onClickPlayingBar(){var e;const t=null==(e=this.$refs.bottomModal)?void 0:e.getViewRef("contentAreaWrp");null==t||t.scrollTo({top:0,behavior:"smooth"})},onSeeking(e,t){this.stopCountdown(),this.$set(this.list[t],"currentTime",parseInt(e,10)),this.__hasReportSeeking||(this.__hasReportSeeking=!0,this.report({EventType:18}),ge.setSum(la,28,1))},onSeeked(e,t){this.$set(this.list[t],"currentTime",parseInt(e,10)),this.setCurrentTime(e),this.startCountDown(),this.__hasReportSeeking=!1,this.report({EventType:19}),ge.setSum(la,29,1)},onSetShutdown(e){const{key:t}=e||{};"number"==typeof t?Ee.invoke("operateTingAudio",{operationType:"setShutdown",shutdownType:"afterMins",time:t},(e=>{console.log("[audio panel] setShutdown afterMins",e),/:ok$/.test(e.err_msg)&&this.showTips("将在".concat(t,"分钟后停止播放"))})):(Ee.invoke("operateTingAudio",{operationType:"setShutdown",shutdownType:t},(e=>{console.log("[audio panel] setShutdown",t,e),/:ok$/.test(e.err_msg)&&("none"===t?this.hideTips():this.showTips("将在此音频播放结束时停止播放"))})),"none"===t&&ge.setSum(la,31,1)),this.shutdownType=t,"number"==typeof t&&(this.shutdownLeftTime=t),this.report({EventType:17}),ge.setSum(la,30,1)},onBackward(e,t){var i;const n=-1===t?this.list.findIndex((e=>{var t;return e.listen_id===(null==(t=this.playInfo)?void 0:t.listen_id)})):t,o=Math.max(((null==(i=this.list[n])?void 0:i.currentTime)||0)-e,0);this.$set(this.list[n],"currentTime",parseInt(o,10)),this.setCurrentTime(o),this.report({EventType:14}),ge.setSum(la,25,1)},onForward(e,t){var i,n,o;const s=-1===t?this.list.findIndex((e=>{var t;return e.listen_id===(null==(t=this.playInfo)?void 0:t.listen_id)})):t,a=Math.min(((null==(i=this.list[s])?void 0:i.currentTime)||0)+e,((null==(o=null==(n=this.list[s])?void 0:n.listen_item)?void 0:o.duration)||1/0)/1e3);this.$set(this.list[s],"currentTime",parseInt(a,10)),this.setCurrentTime(a),this.report({EventType:15}),ge.setSum(la,26,1)},onChangeRate(){const e=[1,1.25,1.5,.75],t=e.indexOf(this.playRate),i=e[(t+1)%e.length];this.playRate=i,Ee.invoke("operateTingAudio",{operationType:"playRate",srcId:this.playingSrcId||"",playRate:this.playRate},(e=>{console.log("[audio panel] setPlayRate",e),1!==this.playRate?this.showTips("已切换至".concat(this.playRate,"倍速播放")):this.hideTips()})),ft.set("play-rate",i),this.report({EventType:16}),ge.setSum(la,27,1)},onClickRemoveFromList(e,t,i){return e.stopPropagation(),e.preventDefault(),this.removeFromListenLater(t,i,!0),!1},onTingPlayListRefresh(e){console.log("deanti onTingPlayListRefresh",e)},onSlideStart(){this.slideMoving=!0},onSlideEnd(){this.slideMoving=!1},onMoveChosen(){this.dragMoving=!0,document.addEventListener("touchmove",this.onDragMove,{capture:!0}),Ee.invoke("vibrateShort",{style:"medium"})},onMoveUnchoose(){this.dragMoving=!1},onMoveStart(e){this.dragMoving=!0,this.__dragStartY=e.originalEvent.pageY,this.transitionDis=0,this.transitionGapByScroll=0},onDragMove(e){const t=((e.touches&&e.touches[0]||{}).pageY||0)-this.__dragStartY;this.transitionDis=t+(Ae.isIOS?this.transitionGapByScroll:0),e.preventDefault()},onMoveDone(){this.dragMoving=!1,document.removeEventListener("touchmove",this.onDragMove)},onMoveUpdate(e){var t,i;this.dragMoving=!1,this.__disableTransitionTimeout&&(clearTimeout(this.__disableTransitionTimeout),this.__disableTransitionTimeout=null),this.disableTransition=!0,this.__disableTransitionTimeout=setTimeout((()=>{this.disableTransition=!1}),500),(null==(t=this.list[0])?void 0:t.listen_id)!==this.playingListenId&&this.playingListenId&&(null==(i=this.list[0])?void 0:i.listen_item)&&this.changePlay(this.list[0],0,!1),(({listenId:e,pos:t,onSuccess:i,onError:n,onComplete:o})=>{ge.setSum(la,35,1),ye({url:"/mp/listenplayer?action=move&listen_id=".concat(e,"&target_pos=").concat(t,"&__biz=").concat(window.biz,"&appmsgid=").concat(window.mid,"&idx=").concat(window.idx),type:"POST",data:{listen_id:e,target_pos:t},async:!0,dataType:"json",success:e=>{e&&e.base_resp&&0===e.base_resp.ret?"function"==typeof i&&i():("function"==typeof n&&n(),ge.setSum(la,36,1))},error:()=>{"function"==typeof n&&n(),ge.setSum(la,36,1)},complete:()=>{"function"==typeof o&&o()}})})({listenId:e.data.listen_id||"",pos:e.newIndex,onSuccess:()=>this.notifyAppListChange()}),this.report({EventType:25,Pos:(null==e?void 0:e.oldIndex)||0,TargetPos:(null==e?void 0:e.newIndex)||0})},showTopAnime(){this.showTopAnimeArea=!0},afterTopAnimeAreaEnter(){this.__afterTopAnimeAreaEnterTimeout=setTimeout((()=>{this.showTopAnimeArea=!1}),0)},showListenLaterAnime(){},checkCardTitleAnime(){this.cardTitleAnime=!1},startCardTitleAnime(){if(!this.cardTitleAnime)return;const e=this.$refs.cardTitle;if(!e)return;if(this.__titleAnime)return;const t=e.children[0].getBoundingClientRect().width,i=t/40*1e3;this.__titleAnime=e.animate([{offset:0,transform:"translate3d(0, 0, 1.1px)"},{offset:1,transform:"translate3d(-".concat(t,"px, 0, 1.1px)")}],{easing:"linear",duration:i,delay:1e3}),this.__titleAnime.onfinish=()=>{this.__titleAnime=void 0}}}},(function(){var e,t,i,n,o,s,a,r,l,d,c,u=this,p=u._self._c;return p("div",{ref:"container"},[p("mp-bottom-modal",{ref:"bottomModal",attrs:{"close-btn-type":"fold","ext-class":"audio-panel-modal ".concat(u.slideMoving?"audio-panel-disable-touch-action":""),top:u.modalTop,"need-head-line":!1,"hide-when-sideslip":!u.dragMoving,"hide-when-scroll-down":!u.dragMoving,"header-type":1===u.version?"slide":"normal"},on:{show:u.onShow,hide:u.onHide,"click-slide-btn":u.hide,"show-after-animation":u.startCardTitleAnime,"hide-after-animation":u.hideList,"pullup-load":u.getListData}},[2===u.version||3===u.version?p("div",{staticClass:"modal-title",attrs:{slot:"title"},on:{click:u.scrollToNowPlaying},slot:"title"},[p("div",{staticClass:"title"},[u._v("播放列表")]),p("div",{directives:[{name:"show",rawName:"v-show",value:u.playingAreaHide&&u.playingListenId,expression:"playingAreaHide && playingListenId"}],staticClass:"desc"},[p("div",{staticClass:"playing",class:{pause:!u.isPlaying&&!u.playLoading},attrs:{role:"figure","aria-describedby":"播放中"}},[p("div",{staticClass:"dot1"}),p("div",{staticClass:"dot2"}),p("div",{staticClass:"dot3"}),p("div",{staticClass:"dot4"})]),p("span",[u._v(u._s(u.playingInfo&&u.playingInfo.listen_item&&u.playingInfo.listen_item.title))])])]):u._e(),p("div",{ref:"wrp",staticClass:"audio-panel__wrp",style:u.isShowList?"":"overflow: hidden;"},[u.firstScreenDataReady||u.firstScreenDataError?!u.firstScreenDataReady&&u.firstScreenDataError?p("div",{ref:"playWrp",staticClass:"audio-panel__screen error",on:{click:u.getFirstScreenData}},[p("div",{staticClass:"weui-loadmore"},[p("div",{staticClass:"weui-loadmore__tips"},[u._v("加载失败，请点击重试")])])]):[1===u.version?p("div",{staticClass:"audio-panel__playing-bar-wrp"},[p("transition",{attrs:{name:"fade"}},[p("div",{directives:[{name:"show",rawName:"v-show",value:u.showPlayingBar&&(null==(e=u.playingInfo)?void 0:e.listen_item)&&(u.isPlaying||u.playLoading||u.playChanging),expression:"showPlayingBar && playingInfo?.listen_item && (isPlaying || playLoading || playChanging)"}],staticClass:"audio-panel__playing-bar",on:{click:u.onClickPlayingBar}},[p("span",[u._v("正在播放 : "+u._s((null==(n=null==(i=null==(t=u.playingInfo)?void 0:t.listen_item)?void 0:i.article_info)?void 0:n.audio_title)||(null==(s=null==(o=u.playingInfo)?void 0:o.listen_item)?void 0:s.title)))])])])],1):u._e(),p("Intersect",{attrs:{threshold:[0]},on:{enter:u.onPlayScreenExpose,leave:u.onPlayScreenLeave}},[1===u.version?p("div",{ref:"playWrp",staticClass:"audio-panel__screen info-screen",class:{"playing-mask":u.showProgress}},[p("div",{staticClass:"audio-panel__play-area",class:{"show-progress":u.showProgress}},[p("div",{ref:"playerCover",staticClass:"audio-panel__play-area__cover",style:"background-image: url(".concat(u.selectInfo&&u.selectInfo.cover,")")}),p("div",{staticClass:"audio-panel__play-area__right"},[p("div",{staticClass:"audio-panel__play-area__info"},[p("div",{staticClass:"info-title"},[u._v(u._s((null==(r=null==(a=u.selectInfo)?void 0:a.article_info)?void 0:r.audio_title)||u.selectInfo.title))]),p("div",{staticClass:"info-desc"},[p("span",{staticClass:"info-desc__author",attrs:{id:"info-desc__author"}},[u._v(u._s(u.selectInfo.author))]),u.showProgress?2===u.selectInfo.tts_model_type?p("span",{staticClass:"info-desc__duration"},[u._v("作者音色朗读")]):2!==u.selectInfo.type?p("span",{staticClass:"info-desc__duration"},[u._v("音频由作者上传")]):u._e():p("span",{directives:[{name:"show",rawName:"v-show",value:u.selectInfo.duration,expression:"selectInfo.duration"}],staticClass:"info-desc__duration",class:u.showProgress?"hidden":"",attrs:{id:"info-desc__duration","aria-hidden":u.showProgress?"true":"false"}},[u._v(u._s(u._f("durationFormatter")(u.selectInfo.duration)))])]),p("div",{directives:[{name:"show",rawName:"v-show",value:!u.showProgress&&(2!==u.selectInfo.type||2===u.selectInfo.tts_model_type),expression:"!showProgress && (selectInfo.type !== 2 || selectInfo.tts_model_type === 2)"}],staticClass:"info-desc"},[2===u.selectInfo.tts_model_type?p("span",[u._v("作者音色朗读")]):2!==u.selectInfo.type?p("span",[u._v("音频由作者上传")]):u._e()])]),u._e()])]),u._e(),p("transition-group",{staticClass:"audio-panel__operate-area-wrp",attrs:{name:"operate-fade"}},[u.showProgress?p("Progress",{key:"progress",attrs:{"play-rate":+u.playRate,"is-playing":u.isPlaying||u.playLoading,"current-time":(null==(l=u.playingInfo)?void 0:l.currentTime)||0,"has-set-shut-down":"none"!==u.shutdownType,duration:(null==(c=null==(d=u.playingInfo)?void 0:d.listen_item)?void 0:c.duration)||0},on:{"change-rate":function(e){return u.onChangeRate()},"set-shutdown":u.callShutdownPanel,forward:function(e){return u.onForward(30,u.playingIndex)},backward:function(e){return u.onBackward(15,u.playingIndex)},"toggle-play":function(e){return u.changePlay(u.playingInfo,u.playingIndex,!0)},seeked:e=>u.onSeeked(e,u.playingIndex),seeking:e=>u.onSeeking(e,u.playingIndex)}}):p("div",{key:"operate-btns",staticClass:"audio-panel__operate-area small"},[p("button",{staticClass:"operate-btn js_wx_tap_highlight",on:{click:u.togglePlay}},[p("i",{class:u.playBtnIconClass}),p("span",[u._v(u._s(u.isPlaying&&u.playingListenId===u.playInfo.listen_id?"暂停":"播放"))])]),p("button",{staticClass:"operate-btn",class:[u.hasInList?"has-in":"js_wx_tap_highlight"],on:{click:function(e){return u.toggleListenLater()}}},[p("i",{staticClass:"icon",class:[u.hasInList?"icon-correct":"icon-listen-later"]}),p("span",[u._v(u._s(u.hasInList?"已加入":"加入列表"))])])])],1)],1):u._e()]),p("Intersect",{attrs:{threshold:[0]},on:{enter:u.onListScreenExpose}},[p("div",{ref:"listScreen",staticClass:"audio-panel__screen list-screen",style:"--top-anime-top: ".concat(u.topAnimeAreaTop,"px; --top-anime-top-end: ").concat(-u.topAnimeAreaTop,"px;")},[p("div",{staticClass:"audio-panel__list-area",class:"version".concat(u.version),style:"--drag-ghost-transition-dis: ".concat(u.transitionDis,"px;")},[1===u.version?p("div",{ref:"listSubTitle",staticClass:"sub-title"},[u._v("播放列表")]):u._e(),p("mp-slide-view-group",{ref:"slideGroup"},[p("VueDraggable",{attrs:{delay:300,scroll:!0,"bubble-scroll":!1,"scroll-fn":u.onDragScroll,"touch-start-threshold":5,disabled:!u.supportDynamicPlayList&&!u.slideMoving,target:".audio-list-sort-wrp"},on:{end:u.onMoveDone,start:u.onMoveStart,update:u.onMoveUpdate,choose:u.onMoveChosen,unchoose:u.onMoveUnchoose},model:{value:u.list,callback:function(e){u.list=e},expression:"list"}},[p("transition-group",{staticClass:"audio-list-sort-wrp",attrs:{name:"audio-list"}},u._l(u.list,(function(e,t){return p("mp-slide-view",{key:"slide-item-".concat(e.listen_id),attrs:{disabled:!u.supportDynamicPlayList&&!u.dragMoving||t<1,"extra-class":["audio-list__item-slide-wrp","pos-".concat(t),u.playingListenId===e.listen_id?"now-playing":"",u.disableTransition?"disable-transition":""]},on:{end:u.onSlideEnd,start:u.onSlideStart},scopedSlots:u._u([{key:"btns",fn:function(){return[u.list.findIndex((t=>t.listen_id===e.listen_id))>=2?p("mp-slide-item",{directives:[{name:"show",rawName:"v-show",value:!u.dragMoving,expression:"!dragMoving"}],attrs:{"extra-class":"slide-item-primary","not-last":""},on:{click:function(i){return u.adjustToNextPlay(e,t,!0)}}},[u._v("下一个播放")]):u._e(),p("mp-slide-item",{directives:[{name:"show",rawName:"v-show",value:!u.dragMoving,expression:"!dragMoving"}],on:{click:i=>u.onClickRemoveFromList(i,e.listen_id,t)}},[u._v("删除")])]},proxy:!0}],null,!0)},[p("Intersect",{attrs:{threshold:[0]},on:{enter:e=>u.onListItemExpose(e,t),leave:e=>u.onListItemLeave(e,t)}},[p("audio-list-item",{key:"audio-".concat(e.listen_id),ref:"audioItem",refInFor:!0,attrs:{info:e,"play-rate":+u.playRate,"is-playing":u.isPlaying||u.playLoading,playing:u.playingListenId===e.listen_id,"has-set-shut-down":"none"!==u.shutdownType},on:{pause:function(e){return u.pause(!1)},"change-rate":function(e){return u.onChangeRate()},"set-shutdown":u.callShutdownPanel,forward:function(e){return u.onForward(30,t)},backward:function(e){return u.onBackward(15,t)},click:function(i){return u.changePlay(e,t,!0)},"toggle-play":function(i){return u.changePlay(e,t,!0)},seeked:e=>u.onSeeked(e,t),seeking:e=>u.onSeeking(e,t)}})],1)],1)})),1)],1)],1),p("div",{directives:[{name:"show",rawName:"v-show",value:!u.loading&&!u.hasMore&&0===u.list.length,expression:"!loading && !hasMore && list.length === 0"}],staticClass:"weui-loadmore weui-loadmore_line empty"},[p("span",{staticClass:"weui-loadmore__tips"},[u._v("暂无收听历史")])]),p("div",{directives:[{name:"show",rawName:"v-show",value:u.loading,expression:"loading"}],staticClass:"weui-loadmore"},[p("div",{staticClass:"weui-loadmore__tips"},[p("i",{staticClass:"weui-loading"})])]),p("div",{directives:[{name:"show",rawName:"v-show",value:!u.loading&&!u.hasMore&&u.list.length,expression:"!loading && !hasMore && list.length"}],staticClass:"weui-loadmore weui-loadmore_line weui-loadmore_dot"},[p("span",{staticClass:"weui-loadmore__tips"})])],1)])])]:p("div",{ref:"playWrp",staticClass:"audio-panel__screen empty"},[p("div",{staticClass:"weui-loadmore"},[p("div",{staticClass:"weui-loadmore__tips"},[p("i",{staticClass:"weui-loading"})])])]),p("div",{staticClass:"audio-panel__modal-bottom-mask",on:{touchstart:function(e){e.stopPropagation(),e.preventDefault()},touchmove:function(e){e.stopPropagation(),e.preventDefault()},touchend:function(e){e.stopPropagation(),e.preventDefault()}}})],2)]),p("div",{ref:"animeCover",staticClass:"anime-cover",style:u.animeCoverStyle,attrs:{"aria-hidden":"true"},on:{animationend:function(e){u.isShowingListenLaterAnime=!1}}}),p("Teleport",{attrs:{to:"body"}},[p("Tips",{attrs:{"tips-wording":u.tipsWording},model:{value:u.tipsShow,callback:function(e){u.tipsShow=e},expression:"tipsShow"}}),p("OptionMenu",{attrs:{"active-key":u.shutdownType,"wrp-style":u.shutdownPanelPosition,options:u.shutdownOptions},on:{select:u.onSetShutdown},model:{value:u.shutdownPanelShow,callback:function(e){u.shutdownPanelShow=e},expression:"shutdownPanelShow"}})],1)],1)}),[],!1,null,"c5b4481e",null,null).exports;let iu="";const nu=({listenId:e,onSuccess:t,onError:i,onComplete:n})=>{ye({url:"/mp/listenplayer?action=add_to_playlist",type:"POST",data:{playlist_type:2,listen_id:e},async:!0,dataType:"json",success:e=>{e&&e.base_resp&&0===e.base_resp.ret?"function"==typeof t&&t(e):"function"==typeof i&&i(e)},error:()=>{"function"==typeof i&&i()},complete:()=>{"function"==typeof n&&n()}})},ou=({listenId:e,from:t,onSuccess:i,onError:n,onComplete:o})=>{ye({url:"/mp/listenplayer?action=rm_from_playlist",type:"POST",data:{playlist_type:"star"===t?2:4,listen_id:e},async:!0,dataType:"json",success:e=>{e&&e.base_resp&&0===e.base_resp.ret?"function"==typeof i&&i(e):"function"==typeof n&&n(e)},error:()=>{"function"==typeof n&&n()},complete:()=>{"function"==typeof o&&o()}})},su=({listenId:e,pos:t,from:i,currentListenId:n,onSuccess:o,onError:s,onComplete:a})=>{ye({url:"/mp/listenplayer?action=move",type:"POST",data:{playlist_type:"star"===i?2:4,listen_id:e,target_pos:t||0,to_playlist_type:2,current_play_listen_id:n||""},async:!0,dataType:"json",success:e=>{e&&e.base_resp&&0===e.base_resp.ret?"function"==typeof o&&o(e):"function"==typeof s&&s(e)},error:()=>{"function"==typeof s&&s()},complete:()=>{"function"==typeof a&&a()}})},au=({listenId:e,pos:t,onSuccess:i,onError:n,onComplete:o})=>{"function"==typeof o&&o()};let ru=0;const lu=xt({name:"mp-audio-panel",filters:{durationFormatter:e=>_t(e),durationNumFormatter:e=>_t(e,2)},components:{Tips:Hc,Header:Vc,Progress:Kc,Teleport:_i,Intersect:C,OptionMenu:Jc,TextMarquee:Zc,VueDraggable:Uc,[$c.name]:$c,[te.name]:te,[ie.name]:ie,[w.name]:w,[ne.name]:ne},provide(){return{supportSetShutdown:ca,supportDynamicPlayList:da,version:this.$options.version||1}},data(){const e=ve.os.pc?"20%":"".concat(screen.height/10*3-(screen.height-window.innerHeight),"px"),t=ft.get("play-rate")||1;return{starVersion:!0,modalTop:e,shutdownOptions:[{key:"none",value:"不开启"},...[15,30,60,90].map((e=>({key:e,value:"".concat(e,"分钟")}))),{key:"whenEnd",value:"当前单集结束后"}],version:this.$options.version||1,firstScreenDataReady:!1,firstScreenDataError:!1,isShow:!1,isPlaying:!1,playLoading:!1,playingType:0,playingListenId:"",playingSrcId:"",hasInList:!1,removedItems:[],cardList:[],playInfo:{},base64:"",lastPlayId:"",isOpened:!1,tipsShow:!1,tipsWording:"",shutdownType:"none",shutdownLeftTime:0,shutdownPanelShow:!1,shutdownPanelPosition:{top:"100vh",left:"100vw"},dragMoving:!1,slideMoving:!1,needUpdate:!1,playChanging:!1,showPlayingBar:!1,disableTransition:!1,transitionDis:0,transitionGapByScroll:0,playRate:t,showList:[],undoneList:[],undoneListBuffer:"",undoneListError:!1,undoneListHasNext:!0,getUndoneListLoading:!1,hasStar:!1,needDoCombine:!1,doingCombine:!1,fromType:"tts",tempStorePlayInfo:null,showBackWrp:!1,tempStorePlayItem:null,showBorder:!1,supportSetShutdown:ca,supportDynamicPlayList:da}},computed:{playBtnIconClass(){const e=this.playingListenId===this.playInfo.listen_id,t=this.isPlaying&&e;return e&&this.playLoading?"weui-loading":t?"icon-pause":"icon-play"},playingInfo(){var e,t;const i={listen_id:null==(e=this.playInfo)?void 0:e.listen_id,listen_item:this.playInfo,currentTime:this.playInfo.currentTime};return this.undoneList.find((e=>e.listen_id===this.playingListenId))||(this.playingListenId===i.listen_id?i:null)||(this.playingListenId===(null==(t=this.tempStorePlayItem)?void 0:t.listen_id)?this.tempStorePlayItem:null)||this.cardList.find((e=>e.listen_id===this.playingListenId))||this.removedItems.find((e=>e.listen_id===this.playingListenId))||i},playingListenItem(){var e;return(null==(e=this.playingInfo)?void 0:e.listen_item)||{}},showProgress:()=>!0,showTitle(){var e,t;return(null==(t=null==(e=this.playingListenItem)?void 0:e.article_info)?void 0:t.audio_title)||this.playingListenItem.title},playingListenItemHasInList(){return this.undoneList.findIndex((e=>e.listen_id===this.playingListenId))>-1}},watch:{undoneList(e){-1!==(e||[]).findIndex((e=>e.listen_id===this.playInfo.listen_id))?this.hasInList=!0:this.hasInList=!1}},created(){this.getFirstScreenData(),this.doCombineList=vt(this.doCombineListRaw,1e3),Ee.invoke("getTingAudioState",{},(e=>{/:ok$/.test(e.err_msg)?ru=1:-9999!==e.err_code&&-1===e.err_msg.indexOf("function_not_exist")||(ru=0),this.getStatus((e=>{e.playRate&&(this.playRate=+e.playRate,ft.set("play-rate",+e.playRate))}))}))},mounted(){var e;this.registerStatusObserver(),document.addEventListener("visibilitychange",this.onVisibilityChange);const t=document.querySelector(".audio-panel-modal .weui-half-screen-dialog__bd"),i=null==(e=this.$refs.bottomModal)?void 0:e.getViewRef("contentAreaWrp");i&&i.addEventListener("scroll",this.onScroll),t.addEventListener("touchmove",(e=>{if(this.dragMoving)return e.preventDefault(),e.stopPropagation(),!1})),this.onDragScroll=(e,i,n,o,s)=>{t.scrollTop+=i,this.transitionGapByScroll+=i,this.transitionDis+=i},this.updateCardList()},beforeDestroy(){this.stopCountdown(),document.removeEventListener("visibilitychange",this.onVisibilityChange)},methods:{show(e){try{const t=e||this.playInfo,i={listen_id:null==t?void 0:t.listen_id,listen_item:t};return this.getUndoneList(!1),this.$refs.bottomModal.show(),this.isPlaying&&(null==t?void 0:t.listen_id)===this.playingListenId&&this.playingListenId||(this.playingListenId&&this.playingListenId!==(null==t?void 0:t.listen_id)?this.getStatus((e=>{this.tempStorePlayInfo=e.item;const t=this.getTempListenItem(this.tempStorePlayInfo);this.tempStorePlayItem={listen_id:t.listen_id,listen_item:t},this.showBackWrp=!0,this.setPlay(i,"tts","show"),this.doCombineList()})):(this.showBackWrp=!1,this.setPlay(i,"tts"),this.doCombineList())),this.isOpened=!0,this.registerClientListUpdatedListener(),this.getStatus((e=>{e.playRate&&(this.playRate=+e.playRate,ft.set("play-rate",+e.playRate))})),this.report({EventType:2}),ge.setSum(la,8,1),!0}catch(Mu){return console.error("[audio panel] showError",Mu),Se.error("[audio panel] showError: ".concat(Mu.message)),!1}},hide(){this.$refs.bottomModal.hide(),this.__titleAnime&&(this.__titleAnime.cancel(),this.__titleAnime=void 0)},updateCardList(){this.cardList=[...document.querySelectorAll("mp-common-mpaudio,mp-common-claudio")].map(bt).filter((e=>e.listen_id)).map((e=>({listen_id:e.listen_id,listen_item:e})))},removeFinishedAudio(e){const t=e.results.filter((e=>{const t=this.undoneList.find((t=>t.listen_id===e.listenId));if(t)return e.finished&&(e.currentTime>=95e-5*t.duration||0===e.currentTime)&&(!this.isPlaying||this.isPlaying&&e.listenId!==this.playingListenId)})).map((e=>e.listenId));this.batchRemoveFromListenLater(t)},startCountDown(){this.countdownInterval&&this.countdownIntervalId===this.playingListenId||(this.countdownInterval&&this.stopCountdown(),this.countdownIntervalId=this.playingListenId,this.__countdownResTime=0,this.countdownInterval=setInterval((()=>{this.__countdownResTime>=0&&(this.__countdownResTime=0,this.getStatus((e=>{e&&e.item&&e.item.listenId&&"playing"===e.status?this.updateCurrentTime(e.item.listenId,+e.currentTime):this.stopCountdown()}))),this.__countdownResTime+=1}),1e3))},stopCountdown(){this.countdownInterval&&(clearInterval(this.countdownInterval),this.countdownInterval=null,this.countdownIntervalId=void 0,this.__countdownResTime=0)},showTips(e,t=1500){e&&(this.__tipsTimeout&&(clearTimeout(this.__tipsTimeout),this.__tipsTimeout=null),this.tipsWording=e,this.tipsShow=!0,this.__tipsTimeout=setTimeout((()=>{this.tipsShow=!1,this.tipsWording=""}),t))},hideTips(){this.__tipsTimeout&&(clearTimeout(this.__tipsTimeout),this.__tipsTimeout=null),this.tipsShow=!1,this.tipsWording=""},callShutdownPanel(e,t="left"){this.getStatus((i=>{let n=i.shutdown;if("string"==typeof i.shutdown&&i.shutdown)try{n=JSON.parse(i.shutdown)}catch(Mu){n=null}n?("afterMins"===n.shutdownType?this.shutdownType=n.time||0:this.shutdownType=n.shutdownType||"none",this.shutdownLeftTime=n.leftTime||0):(this.shutdownType="none",this.shutdownLeftTime=0);const o=null==e?void 0:e.getBoundingClientRect();this.shutdownPanelPosition="right"===t?{top:void 0,right:void 0,bottom:"".concat(window.innerHeight-(o.bottom+26),"px"),left:"".concat(o.right+8,"px"),"--transform-origin-top":"".concat(o.bottom-o.height/2,"px"),"--transform-origin-left":"".concat(o.right+8,"px")}:{top:void 0,left:void 0,bottom:"".concat(window.innerHeight-(o.bottom+26),"px"),right:"".concat(window.innerWidth-o.left+4,"px"),"--transform-origin-top":"".concat(o.bottom-o.height/2,"px"),"--transform-origin-left":"".concat(o.left-4,"px")},this.shutdownPanelShow=!0}))},registerClientListUpdatedListener(){!this.__hasRegisterClientListUpdatedListener&&this.supportDynamicPlayList&&(this.__hasRegisterClientListUpdatedListener=!0,Ee.on("onTingPlayListRefresh",this.onTingPlayListRefresh))},updateCurrentTime(e,t){var i,n,o;(null==(i=this.playInfo)?void 0:i.listen_id)===e&&t&&this.$set(this.playInfo,"currentTime",+t||0),(null==(n=this.tempStorePlayItem)?void 0:n.listen_id)&&(null==(o=this.tempStorePlayItem)?void 0:o.listen_id)===e&&t&&this.$set(this.tempStorePlayItem,"currentTime",+t||0),this.undoneList=[...this.undoneList.map((i=>i&&i.listen_id===e&&t?(i.currentTime=+t||0,{...i}):i))].filter((e=>null==e?void 0:e.listen_item)),this.removedItems=[...this.removedItems.map((i=>i&&i.listen_id===e&&t?(i.currentTime=+t||0,{...i}):i))].filter((e=>null==e?void 0:e.listen_item)),this.showList=[...this.showList.map((i=>i&&i.listen_id===e&&t?(i.currentTime=+t||0,{...i}):i))].filter((e=>null==e?void 0:e.listen_item)),this.cardList=[...this.cardList.map((i=>i&&i.listen_id===e&&t?(i.currentTime=+t||0,{...i}):i))].filter((e=>null==e?void 0:e.listen_item))},batchRemoveFromListenLater(e){Promise.all(e.map((e=>new Promise((t=>au({listenId:e,onComplete:()=>t()})))))).then((()=>{this.undoneList=this.undoneList.filter((t=>-1===e.indexOf(t.listen_id))),this.showList=this.showList.filter((t=>-1===e.indexOf(t.listen_id))),this.isOpened&&this.doCombineList()}))},getFirstScreenData(){this.firstScreenDataError=!1,(({onSuccess:e,onError:t,onComplete:i})=>{ge.setSum(la,20,1),ye({url:"/mp/tts?action=getttslistenitem&__biz=".concat(window.biz,"&appmsgid=").concat(window.mid,"&idx=").concat(window.idx),type:"GET",dataType:"json",async:!0,success:i=>{i&&i.base_resp&&0===i.base_resp.ret&&i.tts_listenitem?"function"==typeof e&&e(i):("function"==typeof t&&t(i),ge.setSum(la,21,1))},error:()=>{"function"==typeof t&&t(),ge.setSum(la,21,1)},complete:()=>{"function"==typeof i&&i()}})})({onSuccess:e=>{var t;this.firstScreenDataReady=!0,this.firstScreenDataError=!1,this.playInfo={...e.tts_listenitem,tts_model_type:(null==(t=e.listen_item_ext)?void 0:t.tts_model_type)||1},this.hasStar=e.star,this.base64=e.merge_playlist_info_base64||"",this.$emit("list-base64-change",this.base64)},onError:()=>{this.firstScreenDataReady=!1,this.firstScreenDataError=!0}})},report(e){var t;const i=this.playingInfo;try{const n={BizUin:window.biz,MsgId:+window.mid,Idx:+window.idx,ListenId:"".concat((null==i?void 0:i.listen_id)||""),ListenType:(null==(t=null==i?void 0:i.listen_item)?void 0:t.type)||0,Scene:1*window.source,SubScene:1*window.subscene,Pos:0,EventType:0,EventTime:parseInt(Date.now()/1e3,10),SessionId:"".concat(window.sessionid),EnterId:+window.enterid,ExpVersion:"".concat(this.version||0),PlayRate:parseInt(100*(this.playRate||1),10),ListenTime:parseInt(1e3*(+(null==i?void 0:i.currentTime)||0),10),ShutDownType:String(this.shutdownType)||"",ShutDownLeftTime:this.shutdownLeftTime||0,ListBase64:this.base64||"",TargetPos:0,...e};console.log("[audio panel] report data",n),we.report(ra,n)}catch(Mu){console.log("[audio panel] report error",Mu)}},play(e,t=!1,i=0,n=!1,o=void 0){var s,a,r;const l=St(e,i);let d={openPlayerUI:n,playMode:0,listenId:(null==e?void 0:e.listen_id)||"",itemList:[l],scene:o,playbackRate:this.playRate||1,categoryPlaylistInfoBuffer:this.base64||"",categoryDeleteAfterListen:!0};const c={protocol:"",src:function(){var t;const i=(null==(t=null==e?void 0:e.article_info)?void 0:t.audio_url)||"",n=window.clientversion;return n&&(n>"18000e00"&&n<="18000e2d"||n>"18000f00"&&n<="18000f24")?"".concat(i,"&t=").concat(Date.now()):i}(),lowbandUrl:(null==(s=null==e?void 0:e.article_info)?void 0:s.audio_url)||"",title:null==e?void 0:e.title,epname:"",singer:(null==e?void 0:e.author)||"",srcId:null==e?void 0:e.listen_id,coverImgUrl:(null==e?void 0:e.cover)||"",webUrl:(null==(a=null==e?void 0:e.article_info)?void 0:a.url)||"",musicbar_url:(null==(r=null==e?void 0:e.article_info)?void 0:r.url)||"",needStartMusicUI:0,playbackRate:this.playRate||1,startTime:i},u=wt(null==e?void 0:e.type)&&1===ru;let p=u?"setTingAudioState":"setBackgroundAudioState";u&&!n&&this.playingListenId&&this.playingListenId===l.listenId&&da&&!this.isPlaying&&!this.playLoading&&(p="operateTingAudio",d={operationType:"resume",srcId:this.playingSrcId}),Ee.invoke(p,u?d:c,(t=>{console.log("[audio panel] play",p,u?d:c,t),Se.info("[audio panel] play ".concat(p," opt:").concat(JSON.stringify(u?d:c)," res:").concat(JSON.stringify(t))),-1===t.err_msg.indexOf("ok")?(this.hide(),window.weui.alert("暂无法播放，请重试"),ge.setSum(la,17,1),window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.report("t1t read fail","res: ".concat(JSON.stringify(t)," | url: ").concat(location.href),{mid:"mmbizwap:t1t_read_fail",view:"wap_business"})):(this.isPlaying=!0,this.playingListenId=e.listen_id||"",this.playingSrcId=e.listen_id||"",this.startCardTitleAnime())})),t&&(ge.setSum(la,12,1),this.report({EventType:4,ListBase64:this.base64||""}))},pause(e=!0){e&&(ge.setSum(la,13,1),this.report({EventType:5}));const t={operationType:"pause",srcId:this.playingSrcId},i=wt(this.playingType)&&1===ru?"operateTingAudio":"operateBackgroundAudio";Ee.invoke(i,t,(e=>{console.log("[audio panel] ".concat(i,": params:"),t,"res:",e),-1!==e.err_msg.indexOf("ok")&&(this.isPlaying=!1)})),this.pauseCardTitleAnime()},setCurrentTime(e,t){var i;const n=this.undoneList.findIndex((e=>e.listen_id===this.playingListenId)),o=((null==(i=this.undoneList)?void 0:i[n])||this.playingInfo).listen_item.duration/1e3,s=parseInt(Math.max(Math.min(e,o),0),10),a={operationType:"seek",srcId:this.playingSrcId||"",seektime:s},r="operateTingAudio";Ee.invoke(r,a,(e=>{console.log("[audio panel] ".concat(r),a,e),"function"==typeof t&&t()}))},getStatus(e,t=!0){Ee.invoke(ru?"getTingAudioState":"getBackgroundAudioState",{},(i=>{console.log("[audio panel] getStatus",ru?"getTingAudioState":"getBackgroundAudioState",i),i&&i.item&&i.item.listenId&&t&&this.onGetStatusChange(i),"function"==typeof e&&e(i)}))},registerStatusObserver(){["onTingAudioStateChanged","onBackgroundAudioStateChange"].forEach((e=>{Ee.on(e,(e=>{e&&e.item&&e.item.listenId&&this.onGetStatusChange(e)}))}))},getPlayFinishedState(e,t=!1){const i=e||(this.undoneList||[]).map((e=>e.listen_id)).filter((e=>e))||[];i.length&&Ee.invoke("operateTingAudio",{operationType:"getFinishedState",listenIds:i},(e=>{if(e&&e.err_msg&&-1!==e.err_msg.indexOf(":ok")){let i=e.results||[];if(Ae.isAndroid&&"string"==typeof e.results)try{i=JSON.parse(i||"[]")||[]}catch(Mu){i=[]}i.forEach((e=>{this.updateCurrentTime(e.listenId,+e.currentTime);const t=this.undoneList.findIndex((t=>e.listenId===t.listen_id));-1!==t&&this.$set(this.undoneList[t],"finished",e.finished)})),this.getStatus((()=>this.removeFinishedAudio({results:i})),!t)}console.log("[audio panel] getPlayFinishedState",i,e)}))},notifyAppListChange(){this.supportDynamicPlayList&&this.isOpened&&Ee.invoke("operateTingAudio",{operationType:"refreshPlayList",categoryPlaylistInfoBuffer:this.base64||""},(e=>{console.log("[audio panel] notify app refreshPlayList",e)}))},onShow(){this.isShow=!0,Ee.invoke("operateTingAudio",{operationType:"setForegroundState",isForeground:!0},(e=>console.log("[audio panel] setForegroundState:true res:".concat(JSON.stringify(e)))))},onHide(){var e;this.isShow=!1,this.dragMoving=!1,Ee.invoke("operateTingAudio",{operationType:"setForegroundState",isForeground:!1},(e=>console.log("[audio panel] setForegroundState:false res:".concat(JSON.stringify(e))))),this.finishCardTitleAnime(),this.$refs.bottomModal.scrollTo(0),this.report({EventType:3}),null==(e=this.$refs.slideGroup)||e.reset()},onVisibilityChange(){const e="visible"===document.visibilityState;e&&this.undoneList&&this.undoneList.length&&this.isOpened&&this.getPlayFinishedState(),e?(this.getStatus((e=>{e.playRate&&(this.playRate=+e.playRate,ft.set("play-rate",+e.playRate))})),Ee.invoke("operateTingAudio",{operationType:"setForegroundState",isForeground:this.isShow},(e=>console.log("[audio panel] setForegroundState:true res:".concat(JSON.stringify(e))))),this.isShow&&this.startCardTitleAnime()):this.finishCardTitleAnime()},onGetStatusChange(e){var t,i;this.playingListenId=e.item.listenId,this.playingSrcId=e.item.srcId,this.playingType=e.item.type,"playing"===e.status?(this.isPlaying=!0,this.playLoading=!1,this.startCountDown()):"loading"===e.status?(this.isPlaying=!1,this.playLoading=!0,this.stopCountdown()):(this.playLoading=!1,this.isPlaying=!1,"idle"===e.status&&(this.playingListenId="",this.playingSrcId=""),this.stopCountdown()),e.duration&&this.playingInfo&&((null==(t=this.playingInfo.listen_item)?void 0:t.duration)&&this.playingInfo.listen_item.duration/1e3===e.duration||(this.undoneList=this.undoneList.map((t=>t.listen_item&&t.listen_id===e.item.listenId?(t.listen_item.duration=1e3*e.duration,t):t)).filter((e=>null==e?void 0:e.listen_item)),this.removedItems=this.removedItems.map((t=>t.listen_item&&t.listen_id===e.item.listenId?(t.listen_item.duration=1e3*e.duration,t):t)).filter((e=>null==e?void 0:e.listen_item)),this.showList=this.showList.map((t=>t.listen_item&&t.listen_id===e.item.listenId?(t.listen_item.duration=1e3*e.duration,t):t)).filter((e=>null==e?void 0:e.listen_item)),this.cardList=this.cardList.map((t=>t.listen_item&&t.listen_id===e.item.listenId?(t.listen_item.duration=1e3*e.duration,t):t)).filter((e=>null==e?void 0:e.listen_item)),this.playInfo.listen_id===e.item.listenId&&this.$set(this.playInfo,"duration",1e3*e.duration),(null==(i=this.tempStorePlayItem)?void 0:i.listen_item)&&this.tempStorePlayItem.listen_id===e.item.listenId&&this.$set(this.tempStorePlayItem.listen_item,"duration",1e3*e.duration))),(this.lastPlayId!==e.item.listenId||1===this.undoneList.length&&"playing"!==e.status)&&this.getPlayFinishedState([this.lastPlayId],!0),this.lastPlayId&&this.lastPlayId!==e.item.listenId&&this.onSwitchAudio(e.item.listenId,this.lastPlayId),this.lastPlayId=e.item.listenId},onSwitchAudio(e,t){e===this.playInfo.listen_id?this.fromType="tts":this.fromType="star",this.__onClickSwitching?(this.finishCardTitleAnime(),setTimeout((()=>this.startCardTitleAnime()))):this.showList=this.undoneList.filter((t=>t.listen_id!==e)),this.__onClickSwitching=!1,this.getPlayFinishedState([t],!0)},onListScreenExpose(){this.report({EventType:8})},onPlayScreenExpose(){this.showBorder=!1,this.report({EventType:1})},onPlayScreenLeave(){this.showBorder=!0},onProgressExpose(){},onProgressLeave(){},onListItemExpose(e,t){},onListItemLeave(e,t){},onScroll(){var e;const t=null==(e=this.$refs.bottomModal)?void 0:e.getViewRef("contentAreaWrp");t&&(t.scrollTop>=285?this.showPlayingBar=!0:this.showPlayingBar=!1)},onClickPlayingBar(){var e,t;const i=null==(t=null==(e=this.$refs.bottomModal)?void 0:e.getScrollEle)?void 0:t.call(e);null==i||i.scrollTo({top:0,behavior:"smooth"})},onClickListenItem(e){this.setPlay(e,"star","list",(()=>{const t=this.undoneList.some((e=>e.listen_id===this.playingListenId));this.__onClickSwitching=!0,this.showList=[...t?[this.playingInfo]:[],...this.undoneList].filter((t=>t.listen_id!==e.listen_id)).filter(yt("listen_id"))}))},onSeeking(e){this.stopCountdown(),this.updateCurrentTime(this.playingListenId,parseInt(e,10)),this.__hasReportSeeking||(this.__hasReportSeeking=!0,this.report({EventType:18}),ge.setSum(la,28,1))},onSeeked(e){this.updateCurrentTime(this.playingListenId,parseInt(e,10)),this.setCurrentTime(e),this.startCountDown(),this.__hasReportSeeking=!1,this.report({EventType:19}),ge.setSum(la,29,1)},onSetShutdown(e){const{key:t}=e||{};"number"==typeof t?Ee.invoke("operateTingAudio",{operationType:"setShutdown",shutdownType:"afterMins",time:t},(e=>{console.log("[audio panel] setShutdown afterMins",e),/:ok$/.test(e.err_msg)&&this.showTips("将在".concat(t,"分钟后停止播放"))})):(Ee.invoke("operateTingAudio",{operationType:"setShutdown",shutdownType:t},(e=>{console.log("[audio panel] setShutdown",t,e),/:ok$/.test(e.err_msg)&&("none"===t?this.hideTips():this.showTips("将在此音频播放结束时停止播放"))})),"none"===t&&ge.setSum(la,31,1)),this.shutdownType=t,"number"==typeof t&&(this.shutdownLeftTime=t),this.report({EventType:17}),ge.setSum(la,30,1)},onBackward(e){var t;const i=Math.max(((null==(t=this.playingInfo)?void 0:t.currentTime)||0)-e,0);this.updateCurrentTime(this.playingListenId,parseInt(i,10)),this.setCurrentTime(i),this.report({EventType:14}),ge.setSum(la,25,1)},onForward(e){var t,i;const n=Math.min(((null==(t=this.playingInfo)?void 0:t.currentTime)||0)+e,((null==(i=this.playingInfo)?void 0:i.duration)||1/0)/1e3);this.updateCurrentTime(this.playingListenId,parseInt(n,10)),this.setCurrentTime(n),this.report({EventType:15}),ge.setSum(la,26,1)},onChangeRate(){const e=[1,1.25,1.5,.75],t=e.indexOf(this.playRate),i=e[(t+1)%e.length];this.playRate=i,Ee.invoke("operateTingAudio",{operationType:"playRate",srcId:this.playingSrcId||"",playRate:this.playRate},(e=>{console.log("[audio panel] setPlayRate",e),1!==this.playRate?this.showTips("已切换至".concat(this.playRate,"倍速播放")):this.hideTips()})),ft.set("play-rate",i),this.report({EventType:16}),ge.setSum(la,27,1)},onTingPlayListRefresh(e){console.log("[audio panel] onTingPlayListRefresh",e)},onSlideStart(){this.slideMoving=!0},onSlideEnd(){this.slideMoving=!1},onStar(){this.hasStar=!0,nu({listenId:this.playInfo.listen_id,onSuccess:()=>this.doCombineList()})},onMoveChosen(){this.dragMoving=!0,document.addEventListener("touchmove",this.onDragMove,{capture:!0}),Ee.invoke("vibrateShort",{style:"medium"})},onMoveUnchoose(){this.dragMoving=!1},onMoveStart(e){this.dragMoving=!0,this.__dragStartY=e.originalEvent.pageY,this.transitionDis=0,this.transitionGapByScroll=0},onDragMove(e){const t=((e.touches&&e.touches[0]||{}).pageY||0)-this.__dragStartY;this.transitionDis=t+(Ae.isIOS?this.transitionGapByScroll:0),e.preventDefault()},onMoveDone(){this.dragMoving=!1,document.removeEventListener("touchmove",this.onDragMove)},onMoveUpdate(e){this.dragMoving=!1,this.__disableTransitionTimeout&&(clearTimeout(this.__disableTransitionTimeout),this.__disableTransitionTimeout=null),this.disableTransition=!0,this.__disableTransitionTimeout=setTimeout((()=>{this.disableTransition=!1}),500),su({from:"star",listenId:e.data.listen_id||"",pos:this.undoneList.some((e=>e.listen_id===this.playingListenId))?e.newIndex+1:e.newIndex,...this.playingListenId?{currentListenId:this.playingListenId}:{},onSuccess:()=>this.notifyAppListChange()});const t=this.undoneList.findIndex((e=>e.listen_id===this.playingListenId)),i=e.oldIndex+(t>=0&&t<=e.oldIndex?1:0),n=e.newIndex+(t>=0&&t<=e.newIndex?1:0),o={...this.undoneList[i]||{}};let s=[...this.undoneList.slice(0,i),...this.undoneList.slice(i+1)];this.undoneList=[...s.slice(0,n),o,...s.slice(n)]},startCardTitleAnime(){var e;null==(e=this.$refs.cardTitle)||e.play()},pauseCardTitleAnime(){var e;null==(e=this.$refs.cardTitle)||e.pause()},finishCardTitleAnime(){var e;null==(e=this.$refs.cardTitle)||e.finish()},async onPullupLoad(){this.undoneListHasNext&&await this.getUndoneList(),this.$refs.bottomModal.finishPullUpLoad()},getUndoneList(e=!0){return new Promise((t=>{this.getUndoneListLoading||!this.undoneListHasNext&&e?t():(this.getUndoneListLoading=!0,(({buffer:e,onSuccess:t,onError:i,onComplete:n})=>{ye({url:"/mp/listenplayer?action=get_playlist",type:"POST",data:{last_listen_id:e?iu:"",count:20,playlist_type:2,session_buffer:e||""},async:!0,dataType:"json",success:e=>{if(e&&e.base_resp&&0===e.base_resp.ret){if("function"==typeof t&&t(e),e&&e.results&&e.results.length){const t=e.results[e.results.length-1];iu=t&&t.listen_id||""}}else"function"==typeof i&&i(e)},error:()=>{"function"==typeof i&&i()},complete:()=>{"function"==typeof n&&n()}})})({buffer:e?this.undoneListBuffer:"",onSuccess:i=>{var n,o;const s=null==(o=null==(n=i.results)?void 0:n.filter((e=>null==e?void 0:e.listen_item)))?void 0:o.map((e=>{var t,n;return{...e,listen_item:{...e.listen_item,tts_model_type:(null==(n=null==(t=i.listen_item_ext)?void 0:t.find((t=>(null==t?void 0:t.listen_id)===e.listen_id)))?void 0:n.tts_model_type)||1}}}));this.undoneList=e?[...this.undoneList,...s].filter((e=>null==e?void 0:e.listen_item)).filter(yt("listen_id")):[...s].filter((e=>null==e?void 0:e.listen_item)).filter(yt("listen_id")),this.showList=this.undoneList.filter((e=>(null==e?void 0:e.listen_id)!==this.playingListenId)),this.undoneListHasNext=i.has_more,this.base64=i.merge_playlist_info_base64||"",this.undoneListBuffer=i.session_buffer||"",this.getPlayFinishedState(s.map((e=>e.listen_id)),!0),this.getUndoneListLoading=!1,t()},onError:()=>{this.undoneListError=!0,this.getUndoneListLoading=!1,this.undoneListHasNext=!1,t()}}))}))},doCombineListRaw(e){this.doingCombine?this.needDoCombine=!0:(this.doingCombine=!0,this.needDoCombine=!1,(({listenId:e,pos:t,onSuccess:i,onError:n,onComplete:o})=>{ye({url:"/mp/listenplayer?action=refresh",type:"POST",data:{data:JSON.stringify({listen_id:e||"",target_pos:t||0})},async:!0,dataType:"json",success:e=>{e&&e.base_resp&&0===e.base_resp.ret?"function"==typeof i&&i(e):"function"==typeof n&&n(e)},error:()=>{"function"==typeof n&&n()},complete:()=>{"function"==typeof o&&o()}})})({listenId:e||this.playInfo.listen_id,pos:0,onSuccess:()=>{this.doingCombine=!1,this.notifyAppListChange(),this.needDoCombine&&this.doCombineList()},onError:()=>{this.doingCombine=!1}}))},setPlay(e,t="star",i,n){if(!(null==e?void 0:e.listen_id))return;if(this.isPlaying&&this.playingListenId===(null==e?void 0:e.listen_id))return void this.pause(!0);const o=this.undoneList.find((t=>t.listen_id===e.listen_id));("tts"!==t||o)&&(su({from:"tts"===t?o?"star":"done":t,listenId:e.listen_id,...this.playingListenId?{currentListenId:this.playingListenId}:{},onSuccess:()=>this.notifyAppListChange()}),"function"==typeof n?n():this.undoneList=[{...e},...this.undoneList].filter((e=>null==e?void 0:e.listen_item)).filter(yt("listen_id"))),this.fromType=t,this.play(e.listen_item,!0),"show"!==i&&(this.showBackWrp=!1)},setPlayNextNew(e,t="star"){var i,n;const o={...e};this.playingListenId&&this.playingListenId===(null==(n=null==(i=this.undoneList)?void 0:i[0])?void 0:n.listen_id)?(this.undoneList=[this.undoneList[0],o,...this.undoneList.slice(1)||[]].filter((e=>null==e?void 0:e.listen_item)).filter(yt("listen_id")),this.showList=this.undoneList.filter((e=>e.listen_id!==this.playingListenId)),su({from:t,listenId:e.listen_id,pos:1,onSuccess:()=>this.doCombineList(this.playingListenId)})):(this.undoneList=[o,...this.undoneList].filter((e=>null==e?void 0:e.listen_item)).filter(yt("listen_id")),this.showList=this.undoneList.filter((e=>e.listen_id!==this.playingListenId)),su({from:t,listenId:e.listen_id,pos:0,onSuccess:()=>this.doCombineList(this.playingListenId)}))},setPlayDone(e){au({listenId:e}),this.undoneList=this.undoneList.filter((t=>t.listen_id!==e)),this.showList=this.undoneList.filter((e=>e.listen_id!==this.playingListenId))},toggleListenLater(e){if(this.playingListenItemHasInList)return ou({listenId:e.listen_id,from:"star",onSuccess:()=>this.doCombineList(this.playingListenId)}),this.undoneList=this.undoneList.filter((t=>t.listen_id!==e.listen_id)),this.showList=this.undoneList.filter((e=>e.listen_id!==this.playingListenId)),this.removedItems=[e,...this.removedItems].filter(yt("listen_id")),Ee.invoke("vibrateShort",{style:"medium"}),this.report({EventType:12}),void ge.setSum(la,19,1);nu({listenId:e.listen_id,onSuccess:()=>this.doCombineList(this.playingListenId)}),this.undoneList=[e,...this.undoneList].filter((e=>null==e?void 0:e.listen_item)).filter(yt("listen_id")),Ee.invoke("showBottomToast",{id:"".concat(Date.now()),title:"已加入「播放列表」",iconData:"iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAMAAABiM0N1AAAAVFBMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////////8wXzyWAAAAHHRSTlMAAwQKDQ8SFx0fIC4zaGttfoeTl5inrrGzzNfmamG/UwAAAAFiS0dEAf8CLd4AAADCSURBVFjD7dfbDoJADATQonhFFPEK8///6YOgoIvabaMxmXnenDRL2ywiDMMwP0xeODlA4eS4SDngIq2vDqqpSz2olnTo0Pl/Z7VNPtkbi3dOVmM/cqgnq4FhSekMSop7PjRHy8R0PyLpuTkcqEn33Yclbf+Mj2FJ34dhKaafQ1LcXDxLsfP1KMXPaV+yzHtXsu2NWz+VG0U/v6zJvMf6kmUfdiXbXr1L1v3cSlanleyOSLoDTnOXZ/Rkxl8ShmG+lwsknDDzI+DkEwAAAABJRU5ErkJggg=="}),this.report({EventType:6})},getStarStatus(){(({listenId:e,onSuccess:t,onError:i,onComplete:n})=>{ye({url:"/mp/listenplayerv2?action=check_star",type:"POST",data:{listen_id:e},async:!0,dataType:"json",success:e=>{e&&e.base_resp&&0===e.base_resp.ret?"function"==typeof t&&t(e):"function"==typeof i&&i(e)},error:()=>{"function"==typeof i&&i()},complete:()=>{"function"==typeof n&&n()}})})({listenId:this.playInfo.listen_id,onSuccess:e=>this.hasStar=e.star})},setStar(e,t){e.listen_id===this.playInfo.listen_id?Ee.invoke("operateStar",{opType:"addStar"},(()=>{this.hasStar=!0,this.getUndoneList(!1).then((()=>this.doCombineList())),"function"==typeof t&&t()})):(nu({listenId:e.listen_id,onSuccess:()=>this.doCombineList()}),this.hasStar=!0,this.undoneList=[e,...this.undoneList].filter((e=>null==e?void 0:e.listen_item)).filter(yt("listen_id")))},cancelStar(e){this.undoneList=this.undoneList.filter((t=>t.listen_id!==e.listen_id)),this.showList=this.undoneList.filter((e=>e.listen_id!==this.playingListenId)),this.playInfo&&e.listen_id===this.playInfo.listen_id&&(this.hasStar=!1),ou({listenId:e.listen_id,from:"star",onSuccess:()=>this.doCombineList()})},handleClickFullscreen(){this.play(this.playingInfo.listen_item,!0,0,!0),this.hide()},onClickStar(e){this.setStar(e)},onClickBack(){const e=this.tempStorePlayInfo,t=this.getTempListenItem(e),i=this.undoneList.findIndex((e=>e.listen_id===this.tempStorePlayInfo.listenId))>-1;this.setPlay({listen_id:this.tempStorePlayInfo.listenId,listen_item:t},i?"star":"tts"),this.showBackWrp=!1},getTempListenItem:e=>e?{...e,listen_id:e.listenId,url:e.webUrl||"",...e.mpInfo?{author_info:{username:e.mpInfo.username,nickname:e.mpInfo.name},article_info:{bizuin:e.mpInfo.bizUin,url:e.webUrl,audio_id:e.mpInfo.audioId}}:{}}:{}}},(function(){var e,t,i,n,o,s,a,r,l,d,c,u,p=this,h=p._self._c;return h("div",{ref:"container"},[h("mp-bottom-modal",{ref:"bottomModal",attrs:{"close-btn-type":"fold","ext-class":"audio-panel-modal audio-panel-modal-for-star ".concat(p.slideMoving?"audio-panel-disable-touch-action":""),top:p.modalTop,"need-head-line":!1,"hide-when-sideslip":!p.dragMoving,"hide-when-scroll-down":!p.dragMoving,"header-type":"slide"},on:{show:p.onShow,hide:p.onHide,"click-slide-btn":p.hide,"show-after-animation":p.startCardTitleAnime,"pullup-load":p.onPullupLoad}},[h("div",{ref:"wrp",staticClass:"audio-panel__wrp"},[p.firstScreenDataReady||p.firstScreenDataError?!p.firstScreenDataReady&&p.firstScreenDataError?h("div",{ref:"playWrp",staticClass:"audio-panel__screen error",on:{click:p.getFirstScreenData}},[h("div",{staticClass:"weui-loadmore"},[h("div",{staticClass:"weui-loadmore__tips"},[p._v("加载失败，请点击重试")])])]):[1===p.version?h("div",{staticClass:"audio-panel__playing-bar-wrp"},[h("transition",{attrs:{name:"fade"}},[h("div",{directives:[{name:"show",rawName:"v-show",value:p.showPlayingBar&&(null==(e=p.playingInfo)?void 0:e.listen_item)&&(p.isPlaying||p.playLoading||p.playChanging),expression:"showPlayingBar && playingInfo?.listen_item && (isPlaying || playLoading || playChanging)"}],staticClass:"audio-panel__playing-bar",on:{click:p.onClickPlayingBar}},[h("span",[p._v("正在播放 : "+p._s((null==(n=null==(i=null==(t=p.playingInfo)?void 0:t.listen_item)?void 0:i.article_info)?void 0:n.audio_title)||(null==(s=null==(o=p.playingInfo)?void 0:o.listen_item)?void 0:s.title)))])])])],1):p._e(),h("Intersect",{attrs:{threshold:[0]},on:{enter:p.onPlayScreenExpose,leave:p.onPlayScreenLeave}},[h("div",{ref:"playWrp",staticClass:"audio-panel__screen info-screen"},[h("div",{staticClass:"audio-panel__play-area",class:{"show-progress":p.showProgress}},[h("div",{ref:"playerCover",staticClass:"audio-panel__play-area__cover",style:"background-image: url(".concat(p.playingListenItem&&p.playingListenItem.cover,")")}),h("div",{staticClass:"audio-panel__play-area__right"},[h("div",{staticClass:"audio-panel__play-area__info"},[h("TextMarquee",{ref:"cardTitle",staticClass:"info-title__wrp",attrs:{title:p.showTitle}}),h("div",{staticClass:"info-desc"},[h("span",{staticClass:"info-desc__author",attrs:{id:"info-desc__author"}},[p._v(p._s(p.playingListenItem.author))]),2===p.playingListenItem.tts_model_type?h("span",[p._v("作者音色朗读")]):2!==p.playingListenItem.type?h("span",{staticClass:"info-desc__duration"},[p._v("音频由作者上传")]):p._e(),p._e(),h("span",{staticClass:"star-wrp js_wx_tap_highlight",attrs:{role:"button","aria-label":p.playingListenItemHasInList?"取消加入播放列表":"加入播放列表"},on:{click:function(e){return p.toggleListenLater(p.playingInfo)}}},[h("i",{class:p.playingListenItemHasInList?"icon-correct":"icon-listen-later"})])])],1)])]),h("Intersect",{attrs:{threshold:[.5]},on:{enter:p.onProgressExpose,leave:p.onProgressLeave}},[h("div",{staticClass:"audio-panel__operate-area-wrp"},[h("Progress",{key:"progress",attrs:{"play-rate":+p.playRate,"has-in-list":p.playingListenItemHasInList,"is-playing":p.isPlaying||p.playLoading,"has-set-shut-down":"none"!==p.shutdownType,duration:(null==(r=null==(a=p.playingInfo)?void 0:a.listen_item)?void 0:r.duration)||0,"current-time":Math.min((null==(l=p.playingInfo)?void 0:l.currentTime)||0,(null==(c=null==(d=p.playingInfo)?void 0:d.listen_item)?void 0:c.duration)||0)},on:{"change-rate":function(e){return p.onChangeRate()},"set-shutdown":p.callShutdownPanel,forward:function(e){return p.onForward(30,0)},backward:function(e){return p.onBackward(15,0)},"toggle-play":function(e){return p.setPlay(p.playingInfo,p.fromType)},seeked:e=>p.onSeeked(e,0),seeking:e=>p.onSeeking(e,0)}})],1)])],1)]),h("Intersect",{attrs:{threshold:[0]},on:{enter:p.onListScreenExpose}},[h("div",{ref:"listScreen",staticClass:"audio-panel__screen list-screen"},[h("transition",{attrs:{name:"collapse"}},[p.showBackWrp?h("div",{staticClass:"back-wrp",on:{click:p.onClickBack}},[h("i",{staticClass:"icon-back"}),h("span",{staticClass:"back-wrp__title"},[p._v("继续播放")]),h("span",[p._v(p._s((null==(u=p.tempStorePlayInfo)?void 0:u.title)||""))])]):p._e()]),h("div",{staticClass:"audio-panel__list-area",style:"--drag-ghost-transition-dis: ".concat(p.transitionDis,"px;")},[h("div",{ref:"listSubTitle",staticClass:"sub-title"},[p._v("待播列表")]),h("mp-slide-view-group",{ref:"slideGroup"},[h("VueDraggable",{attrs:{delay:300,scroll:!0,"bubble-scroll":!1,"scroll-fn":p.onDragScroll,"touch-start-threshold":5,disabled:!p.supportDynamicPlayList&&!p.slideMoving,target:".audio-list-sort-wrp"},on:{end:p.onMoveDone,start:p.onMoveStart,update:p.onMoveUpdate,choose:p.onMoveChosen,unchoose:p.onMoveUnchoose},model:{value:p.showList,callback:function(e){p.showList=e},expression:"showList"}},[h("transition-group",{staticClass:"audio-list-sort-wrp",attrs:{name:"audio-list"}},p._l(p.showList,(function(e,t){return h("mp-slide-view",{key:"slide-item-".concat(e.listen_id),attrs:{disabled:!p.supportDynamicPlayList&&!p.dragMoving,"extra-class":["audio-list__item-slide-wrp","pos-".concat(t),p.playingListenId===e.listen_id?"now-playing":"",p.disableTransition?"disable-transition":""]},on:{end:p.onSlideEnd,start:p.onSlideStart},scopedSlots:p._u([{key:"btns",fn:function(){return[h("mp-slide-item",{attrs:{"not-last":t>=1},on:{click:function(t){return p.cancelStar(e)}}},[p._v("删除")]),t>=1?h("mp-slide-item",{directives:[{name:"show",rawName:"v-show",value:!p.dragMoving,expression:"!dragMoving"}],attrs:{"extra-class":"slide-item-warn"},on:{click:t=>p.setPlayNextNew(e,"star")}},[p._v("下一个播放")]):p._e()]},proxy:!0}],null,!0)},[h("Intersect",{attrs:{threshold:[0]},on:{enter:e=>p.onListItemExpose(e,t),leave:e=>p.onListItemLeave(e,t)}},[h("audio-list-item",{key:"audio-".concat(e.listen_id),ref:"audioItem",refInFor:!0,attrs:{info:e,version:p.version,"play-rate":+p.playRate,"need-finish-state":!1,"is-playing":p.isPlaying||p.playLoading,playing:p.playingListenId===e.listen_id,"has-set-shut-down":"none"!==p.shutdownType},on:{pause:function(e){return p.pause(!1)},"change-rate":function(e){return p.onChangeRate()},"set-shutdown":p.callShutdownPanel,forward:function(e){return p.onForward(30,t)},backward:function(e){return p.onBackward(15,t)},click:function(t){return p.onClickListenItem(e)},seeked:e=>p.onSeeked(e,t),seeking:e=>p.onSeeking(e,t)}})],1)],1)})),1)],1)],1),h("div",{directives:[{name:"show",rawName:"v-show",value:!p.getUndoneListLoading&&!p.undoneListHasNext&&!p.undoneList.length,expression:"!getUndoneListLoading && !undoneListHasNext && !undoneList.length"}],staticClass:"weui-loadmore empty"},[h("span",{staticClass:"weui-loadmore__tips"},[p._v("暂无内容,")])]),h("div",{directives:[{name:"show",rawName:"v-show",value:p.getUndoneListLoading,expression:"getUndoneListLoading"}],staticClass:"weui-loadmore"},[h("div",{staticClass:"weui-loadmore__tips"},[h("i",{staticClass:"weui-loading"})])]),h("div",{directives:[{name:"show",rawName:"v-show",value:!p.getUndoneListLoading&&!p.undoneListHasNext&&p.undoneList.length,expression:"!getUndoneListLoading && !undoneListHasNext && undoneList.length"}],staticClass:"weui-loadmore weui-loadmore_line weui-loadmore_dot"},[h("span",{staticClass:"weui-loadmore__tips"})])],1)],1)])]:h("div",{ref:"playWrp",staticClass:"audio-panel__screen empty"},[h("div",{staticClass:"weui-loadmore"},[h("div",{staticClass:"weui-loadmore__tips"},[h("i",{staticClass:"weui-loading"})])])]),h("div",{staticClass:"audio-panel__modal-bottom-mask",on:{touchstart:function(e){e.stopPropagation(),e.preventDefault()},touchmove:function(e){e.stopPropagation(),e.preventDefault()},touchend:function(e){e.stopPropagation(),e.preventDefault()}}})],2)]),h("Teleport",{attrs:{to:"body"}},[h("Tips",{attrs:{"tips-wording":p.tipsWording},model:{value:p.tipsShow,callback:function(e){p.tipsShow=e},expression:"tipsShow"}}),h("OptionMenu",{attrs:{"active-key":p.shutdownType,"wrp-style":p.shutdownPanelPosition,options:p.shutdownOptions},on:{select:p.onSetShutdown},model:{value:p.shutdownPanelShow,callback:function(e){p.shutdownPanelShow=e},expression:"shutdownPanelShow"}})],1)],1)}),[],!1,null,"3adc14bc",null,null).exports;let du="";const cu=({listenId:e,onSuccess:t,onError:i,onComplete:n})=>{ye({url:"/mp/listenplayerv2?action=add_to_playlist",type:"POST",data:{playlist_type:2,listen_id:e},async:!0,dataType:"json",success:e=>{e&&e.base_resp&&0===e.base_resp.ret?"function"==typeof t&&t(e):"function"==typeof i&&i(e)},error:()=>{"function"==typeof i&&i()},complete:()=>{"function"==typeof n&&n()}})},uu=({listenId:e,pos:t,from:i,currentListenId:n,onSuccess:o,onError:s,onComplete:a})=>{ye({url:"/mp/listenplayerv2?action=move",type:"POST",data:{playlist_type:"star"===i?2:4,listen_id:e,target_pos:t||0,to_playlist_type:2,current_play_listen_id:n||""},async:!0,dataType:"json",success:e=>{e&&e.base_resp&&0===e.base_resp.ret?"function"==typeof o&&o(e):"function"==typeof s&&s(e)},error:()=>{"function"==typeof s&&s()},complete:()=>{"function"==typeof a&&a()}})},pu=({listenId:e,pos:t,onSuccess:i,onError:n,onComplete:o})=>{if(document.cookie.indexOf("mp-exp__dont-jump-play")>-1)return"function"==typeof o&&o(),void("function"==typeof i&&i({}));ye({url:"/mp/listenplayerv2?action=finish",type:"POST",data:{listen_id:e,pos:t||0,playlist_type:4},async:!0,dataType:"json",success:e=>{e&&e.base_resp&&0===e.base_resp.ret?"function"==typeof i&&i(e):"function"==typeof n&&n(e)},error:()=>{"function"==typeof n&&n()},complete:()=>{"function"==typeof o&&o()}})};let hu=0;const mu=xt({name:"mp-audio-panel",filters:{durationFormatter:e=>_t(e),durationNumFormatter:e=>_t(e,2)},components:{Tips:Hc,Header:Vc,Progress:Kc,Teleport:_i,Intersect:C,OptionMenu:Jc,TextMarquee:Zc,VueDraggable:Uc,[$c.name]:$c,[te.name]:te,[ie.name]:ie,[w.name]:w,[ne.name]:ne},provide(){return{supportSetShutdown:ca,supportDynamicPlayList:da,version:this.$options.version||1}},data(){const e=ve.os.pc?"20%":"".concat(screen.height/10*3-(screen.height-window.innerHeight),"px"),t=ft.get("play-rate")||1;return{starVersion:!0,modalTop:e,shutdownOptions:[{key:"none",value:"不开启"},...[15,30,60,90].map((e=>({key:e,value:"".concat(e,"分钟")}))),{key:"whenEnd",value:"当前单集结束后"}],version:this.$options.version||1,firstScreenDataReady:!1,firstScreenDataError:!1,isShow:!1,isPlaying:!1,playLoading:!1,playingType:0,playingListenId:"",playingSrcId:"",hasInList:!1,cardList:[],playInfo:{},base64:"",lastPlayId:"",isOpened:!1,tipsShow:!1,tipsWording:"",shutdownType:"none",shutdownLeftTime:0,shutdownPanelShow:!1,shutdownPanelPosition:{top:"100vh",left:"100vw"},dragMoving:!1,slideMoving:!1,needUpdate:!1,playChanging:!1,showPlayingBar:!1,disableTransition:!1,transitionDis:0,transitionGapByScroll:0,playRate:t,showList:[],undoneList:[],undoneListBuffer:"",undoneListError:!1,undoneListHasNext:!0,getUndoneListLoading:!1,hasStar:!1,needDoCombine:!1,doingCombine:!1,fromType:"tts",tempStorePlayInfo:null,showBackWrp:!1,tempStorePlayItem:null,showBorder:!1,supportSetShutdown:ca,supportDynamicPlayList:da}},computed:{playBtnIconClass(){const e=this.playingListenId===this.playInfo.listen_id,t=this.isPlaying&&e;return e&&this.playLoading?"weui-loading":t?"icon-pause":"icon-play"},playingInfo(){var e,t;const i={listen_id:null==(e=this.playInfo)?void 0:e.listen_id,listen_item:this.playInfo,currentTime:this.playInfo.currentTime};return this.undoneList.find((e=>e.listen_id===this.playingListenId))||(this.playingListenId===i.listen_id?i:null)||(this.playingListenId===(null==(t=this.tempStorePlayItem)?void 0:t.listen_id)?this.tempStorePlayItem:null)||this.cardList.find((e=>e.listen_id===this.playingListenId))||i},playingListenItem(){var e;return(null==(e=this.playingInfo)?void 0:e.listen_item)||{}},showProgress:()=>!0,showTitle(){var e,t;return(null==(t=null==(e=this.playingListenItem)?void 0:e.article_info)?void 0:t.audio_title)||this.playingListenItem.title}},watch:{undoneList(e){-1!==(e||[]).findIndex((e=>e.listen_id===this.playInfo.listen_id))?this.hasInList=!0:this.hasInList=!1}},created(){window.addEventListener("star",this.handleStar),this.getFirstScreenData(),this.getUndoneList(!1),this.doCombineList=vt(this.doCombineListRaw,1e3),Ee.invoke("getTingAudioState",{},(e=>{/:ok$/.test(e.err_msg)?hu=1:-9999!==e.err_code&&-1===e.err_msg.indexOf("function_not_exist")||(hu=0),this.getStatus((e=>{e.playRate&&(this.playRate=+e.playRate,ft.set("play-rate",+e.playRate))}))}))},mounted(){this.registerStatusObserver(),document.addEventListener("visibilitychange",this.onVisibilityChange);const e=document.querySelector(".audio-panel-modal .weui-half-screen-dialog__bd");e.addEventListener("touchmove",(e=>{if(this.dragMoving)return e.preventDefault(),e.stopPropagation(),!1})),this.onDragScroll=(t,i,n,o,s)=>{e.scrollTop+=i,this.transitionGapByScroll+=i,this.transitionDis+=i},this.updateCardList()},beforeDestroy(){this.stopCountdown(),document.removeEventListener("visibilitychange",this.onVisibilityChange)},methods:{show(e){try{const t=e||this.playInfo,i={listen_id:null==t?void 0:t.listen_id,listen_item:t};return this.getUndoneList(!1),this.$refs.bottomModal.show(),this.isPlaying&&(null==t?void 0:t.listen_id)===this.playingListenId&&this.playingListenId||(this.playingListenId&&this.playingListenId!==(null==t?void 0:t.listen_id)?this.getStatus((e=>{this.tempStorePlayInfo=e.item;const t=this.getTempListenItem(this.tempStorePlayInfo);this.tempStorePlayItem={listen_id:t.listen_id,listen_item:t},this.showBackWrp=!0,this.setPlay(i,"tts","show"),this.doCombineList()})):(this.showBackWrp=!1,this.setPlay(i,"tts"),this.doCombineList())),this.isOpened=!0,this.registerClientListUpdatedListener(),this.getStatus((e=>{e.playRate&&(this.playRate=+e.playRate,ft.set("play-rate",+e.playRate))})),this.report({EventType:2}),ge.setSum(la,8,1),!0}catch(Mu){return console.error("[audio panel] showError",Mu),Se.error("[audio panel] showError: ".concat(Mu.message)),!1}},hide(){this.$refs.bottomModal.hide(),this.__titleAnime&&(this.__titleAnime.cancel(),this.__titleAnime=void 0)},updateCardList(){this.cardList=[...document.querySelectorAll("mp-common-mpaudio,mp-common-claudio")].map(bt).filter((e=>e.listen_id)).map((e=>({listen_id:e.listen_id,listen_item:e}))),console.log("deanti this.cardList",this.cardList,[...document.querySelectorAll("mp-common-mpaudio,mp-common-claudio")].map(bt))},removeFinishedAudio(e){const t=e.results.filter((e=>{const t=this.undoneList.find((t=>t.listen_id===e.listenId));if(t)return e.finished&&(e.currentTime>=95e-5*t.duration||0===e.currentTime)&&(!this.isPlaying||this.isPlaying&&e.listenId!==this.playingListenId)})).map((e=>e.listenId));this.batchRemoveFromListenLater(t)},startCountDown(){this.countdownInterval&&this.countdownIntervalId===this.playingListenId||(this.countdownInterval&&this.stopCountdown(),this.countdownIntervalId=this.playingListenId,this.__countdownResTime=0,this.countdownInterval=setInterval((()=>{this.__countdownResTime>=0&&(this.__countdownResTime=0,this.getStatus((e=>{e&&e.item&&e.item.listenId&&"playing"===e.status?this.updateCurrentTime(e.item.listenId,+e.currentTime):this.stopCountdown()}))),this.__countdownResTime+=1}),1e3))},stopCountdown(){this.countdownInterval&&(clearInterval(this.countdownInterval),this.countdownInterval=null,this.countdownIntervalId=void 0,this.__countdownResTime=0)},showTips(e,t=1500){e&&(this.__tipsTimeout&&(clearTimeout(this.__tipsTimeout),this.__tipsTimeout=null),this.tipsWording=e,this.tipsShow=!0,this.__tipsTimeout=setTimeout((()=>{this.tipsShow=!1,this.tipsWording=""}),t))},hideTips(){this.__tipsTimeout&&(clearTimeout(this.__tipsTimeout),this.__tipsTimeout=null),this.tipsShow=!1,this.tipsWording=""},callShutdownPanel(e){this.getStatus((t=>{let i=t.shutdown;if("string"==typeof t.shutdown&&t.shutdown)try{i=JSON.parse(t.shutdown)}catch(Mu){i=null}i?("afterMins"===i.shutdownType?this.shutdownType=i.time||0:this.shutdownType=i.shutdownType||"none",this.shutdownLeftTime=i.leftTime||0):(this.shutdownType="none",this.shutdownLeftTime=0);const n=null==e?void 0:e.getBoundingClientRect();this.shutdownPanelPosition={top:void 0,left:void 0,bottom:"".concat(window.innerHeight-(n.bottom+26),"px"),right:"".concat(window.innerWidth-n.left+4,"px"),"--transform-origin-top":"".concat(n.bottom-n.height/2,"px"),"--transform-origin-left":"".concat(n.left-4,"px")},this.shutdownPanelShow=!0}))},registerClientListUpdatedListener(){!this.__hasRegisterClientListUpdatedListener&&this.supportDynamicPlayList&&(this.__hasRegisterClientListUpdatedListener=!0,Ee.on("onTingPlayListRefresh",this.onTingPlayListRefresh))},updateCurrentTime(e,t){var i,n,o;(null==(i=this.playInfo)?void 0:i.listen_id)===e&&t&&this.$set(this.playInfo,"currentTime",+t||0),(null==(n=this.tempStorePlayItem)?void 0:n.listen_id)&&(null==(o=this.tempStorePlayItem)?void 0:o.listen_id)===e&&t&&this.$set(this.tempStorePlayItem,"currentTime",+t||0),this.undoneList=[...this.undoneList.map((i=>i&&i.listen_id===e&&t?(i.currentTime=+t||0,{...i}):i))].filter((e=>null==e?void 0:e.listen_item)),this.showList=[...this.showList.map((i=>i&&i.listen_id===e&&t?(i.currentTime=+t||0,{...i}):i))].filter((e=>null==e?void 0:e.listen_item)),this.cardList=[...this.cardList.map((i=>i&&i.listen_id===e&&t?(i.currentTime=+t||0,{...i}):i))].filter((e=>null==e?void 0:e.listen_item))},batchRemoveFromListenLater(e){Promise.all(e.map((e=>new Promise((t=>pu({listenId:e,onComplete:()=>t()})))))).then((()=>{this.undoneList=this.undoneList.filter((t=>-1===e.indexOf(t.listen_id))),this.showList=this.showList.filter((t=>-1===e.indexOf(t.listen_id))),this.isOpened&&this.doCombineList()}))},getFirstScreenData(){this.firstScreenDataError=!1,(({onSuccess:e,onError:t,onComplete:i})=>{ge.setSum(la,20,1),ye({url:"/mp/tts?action=getttslistenitem&__biz=".concat(window.biz,"&appmsgid=").concat(window.mid,"&idx=").concat(window.idx),type:"GET",dataType:"json",async:!0,success:i=>{i&&i.base_resp&&0===i.base_resp.ret&&i.tts_listenitem?"function"==typeof e&&e(i):("function"==typeof t&&t(i),ge.setSum(la,21,1))},error:()=>{"function"==typeof t&&t(),ge.setSum(la,21,1)},complete:()=>{"function"==typeof i&&i()}})})({onSuccess:e=>{var t;this.firstScreenDataReady=!0,this.firstScreenDataError=!1,this.playInfo={...e.tts_listenitem,tts_model_type:(null==(t=e.listen_item_ext)?void 0:t.tts_model_type)||1},this.hasStar=e.star,this.$emit("list-base64-change",this.base64)},onError:()=>{this.firstScreenDataReady=!1,this.firstScreenDataError=!0}})},report(e){var t;const i=(this.undoneList||[]).find((e=>e.listen_id===this.playingListenId));try{const n={BizUin:window.biz,MsgId:+window.mid,Idx:+window.idx,ListenId:"".concat((null==i?void 0:i.listen_id)||""),ListenType:(null==(t=null==i?void 0:i.listen_item)?void 0:t.type)||0,Scene:1*window.source,SubScene:1*window.subscene,Pos:0,EventType:0,EventTime:parseInt(Date.now()/1e3,10),SessionId:"".concat(window.sessionid),EnterId:+window.enterid,ExpVersion:"".concat(this.version||0),PlayRate:parseInt(100*(this.playRate||1),10),ListenTime:parseInt(1e3*(+(null==i?void 0:i.currentTime)||0),10),ShutDownType:String(this.shutdownType)||"",ShutDownLeftTime:this.shutdownLeftTime||0,ListBase64:this.base64||"",TargetPos:0,...e};console.log("[audio panel] report data",n),we.report(ra,n)}catch(Mu){console.log("[audio panel] report error",Mu)}},play(e,t=!1,i=0,n=!1,o=void 0){var s,a,r;const l=St(e,i);let d={openPlayerUI:n,playMode:0,listenId:(null==e?void 0:e.listen_id)||"",itemList:[l],scene:o,playbackRate:this.playRate||1,categoryPlaylistInfoBuffer:this.base64||"",categoryDeleteAfterListen:!0};const c={protocol:"",src:function(){var t;const i=(null==(t=null==e?void 0:e.article_info)?void 0:t.audio_url)||"",n=window.clientversion;return n&&(n>"18000e00"&&n<="18000e2d"||n>"18000f00"&&n<="18000f24")?"".concat(i,"&t=").concat(Date.now()):i}(),lowbandUrl:(null==(s=null==e?void 0:e.article_info)?void 0:s.audio_url)||"",title:null==e?void 0:e.title,epname:"",singer:(null==e?void 0:e.author)||"",srcId:null==e?void 0:e.listen_id,coverImgUrl:(null==e?void 0:e.cover)||"",webUrl:(null==(a=null==e?void 0:e.article_info)?void 0:a.url)||"",musicbar_url:(null==(r=null==e?void 0:e.article_info)?void 0:r.url)||"",needStartMusicUI:0,playbackRate:this.playRate||1,startTime:i},u=wt(null==e?void 0:e.type)&&1===hu;let p=u?"setTingAudioState":"setBackgroundAudioState";u&&!n&&this.playingListenId&&this.playingListenId===l.listenId&&da&&!this.isPlaying&&!this.playLoading&&(p="operateTingAudio",d={operationType:"resume",srcId:this.playingSrcId}),Ee.invoke(p,u?d:c,(t=>{console.log("[audio panel] play",p,u?d:c,t),Se.info("[audio panel] play ".concat(p," opt:").concat(JSON.stringify(u?d:c)," res:").concat(JSON.stringify(t))),-1===t.err_msg.indexOf("ok")?(this.hide(),window.weui.alert("暂无法播放，请重试"),ge.setSum(la,17,1),window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.report("t1t read fail","res: ".concat(JSON.stringify(t)," | url: ").concat(location.href),{mid:"mmbizwap:t1t_read_fail",view:"wap_business"})):(this.isPlaying=!0,this.playingListenId=e.listen_id||"",this.playingSrcId=e.listen_id||"",this.startCardTitleAnime())})),t&&(ge.setSum(la,12,1),this.report({EventType:4,ListBase64:this.base64||""}))},pause(e=!0){e&&(ge.setSum(la,13,1),this.report({EventType:5}));const t={operationType:"pause",srcId:this.playingSrcId},i=wt(this.playingType)&&1===hu?"operateTingAudio":"operateBackgroundAudio";Ee.invoke(i,t,(e=>{console.log("[audio panel] ".concat(i,": params:"),t,"res:",e),-1!==e.err_msg.indexOf("ok")&&(this.isPlaying=!1)})),this.pauseCardTitleAnime()},setCurrentTime(e,t){var i;const n=this.undoneList.findIndex((e=>e.listen_id===this.playingListenId)),o=((null==(i=this.undoneList)?void 0:i[n])||this.playingInfo).listen_item.duration/1e3,s=parseInt(Math.max(Math.min(e,o),0),10),a={operationType:"seek",srcId:this.playingSrcId||"",seektime:s},r="operateTingAudio";Ee.invoke(r,a,(e=>{console.log("[audio panel] ".concat(r),a,e),"function"==typeof t&&t()}))},getStatus(e,t=!0){Ee.invoke(hu?"getTingAudioState":"getBackgroundAudioState",{},(i=>{console.log("[audio panel] getStatus",hu?"getTingAudioState":"getBackgroundAudioState",i),i&&i.item&&i.item.listenId&&t&&this.onGetStatusChange(i),"function"==typeof e&&e(i)}))},registerStatusObserver(){["onTingAudioStateChanged","onBackgroundAudioStateChange"].forEach((e=>{Ee.on(e,(e=>{e&&e.item&&e.item.listenId&&this.onGetStatusChange(e)}))}))},getPlayFinishedState(e,t=!1){const i=e||(this.undoneList||[]).map((e=>e.listen_id)).filter((e=>e))||[];i.length&&Ee.invoke("operateTingAudio",{operationType:"getFinishedState",listenIds:i},(e=>{if(e&&e.err_msg&&-1!==e.err_msg.indexOf(":ok")){let i=e.results||[];if(Ae.isAndroid&&"string"==typeof e.results)try{i=JSON.parse(i||"[]")||[]}catch(Mu){i=[]}i.forEach((e=>{this.updateCurrentTime(e.listenId,+e.currentTime);const t=this.undoneList.findIndex((t=>e.listenId===t.listen_id));-1!==t&&this.$set(this.undoneList[t],"finished",e.finished)})),this.getStatus((()=>this.removeFinishedAudio({results:i})),!t)}console.log("[audio panel] getPlayFinishedState",i,e)}))},notifyAppListChange(){this.supportDynamicPlayList&&this.isOpened&&Ee.invoke("operateTingAudio",{operationType:"refreshPlayList",categoryPlaylistInfoBuffer:this.base64||""},(e=>{console.log("[audio panel] notify app refreshPlayList",e)}))},onShow(){this.isShow=!0,Ee.invoke("operateTingAudio",{operationType:"setForegroundState",isForeground:!0},(e=>console.log("[audio panel] setForegroundState:true res:".concat(JSON.stringify(e)))))},onHide(){var e;this.isShow=!1,this.dragMoving=!1,Ee.invoke("operateTingAudio",{operationType:"setForegroundState",isForeground:!1},(e=>console.log("[audio panel] setForegroundState:false res:".concat(JSON.stringify(e))))),this.finishCardTitleAnime(),this.$refs.bottomModal.scrollTo(0),this.report({EventType:3}),null==(e=this.$refs.slideGroup)||e.reset()},onVisibilityChange(){const e="visible"===document.visibilityState;e&&this.undoneList&&this.undoneList.length&&this.isOpened&&this.getPlayFinishedState(),e?(this.getStatus((e=>{e.playRate&&(this.playRate=+e.playRate,ft.set("play-rate",+e.playRate))})),Ee.invoke("operateTingAudio",{operationType:"setForegroundState",isForeground:this.isShow},(e=>console.log("[audio panel] setForegroundState:true res:".concat(JSON.stringify(e))))),this.isShow&&this.startCardTitleAnime()):this.finishCardTitleAnime()},onGetStatusChange(e){var t,i;this.playingListenId=e.item.listenId,this.playingSrcId=e.item.srcId,this.playingType=e.item.type,"playing"===e.status?(this.isPlaying=!0,this.playLoading=!1,this.startCountDown()):"loading"===e.status?(this.isPlaying=!1,this.playLoading=!0,this.stopCountdown()):(this.playLoading=!1,this.isPlaying=!1,"idle"===e.status&&(this.playingListenId="",this.playingSrcId=""),this.stopCountdown()),e.duration&&this.playingInfo&&((null==(t=this.playingInfo.listen_item)?void 0:t.duration)&&this.playingInfo.listen_item.duration/1e3===e.duration||(this.undoneList=this.undoneList.map((t=>t.listen_item&&t.listen_id===e.item.listenId?(t.listen_item.duration=1e3*e.duration,t):t)).filter((e=>null==e?void 0:e.listen_item)),this.showList=this.showList.map((t=>t.listen_item&&t.listen_id===e.item.listenId?(t.listen_item.duration=1e3*e.duration,t):t)).filter((e=>null==e?void 0:e.listen_item)),this.cardList=this.cardList.map((t=>t.listen_item&&t.listen_id===e.item.listenId?(t.listen_item.duration=1e3*e.duration,t):t)).filter((e=>null==e?void 0:e.listen_item)),this.playInfo.listen_id===e.item.listenId&&this.$set(this.playInfo,"duration",1e3*e.duration),(null==(i=this.tempStorePlayItem)?void 0:i.listen_item)&&this.tempStorePlayItem.listen_id===e.item.listenId&&this.$set(this.tempStorePlayItem.listen_item,"duration",1e3*e.duration))),(this.lastPlayId!==e.item.listenId||1===this.undoneList.length&&"playing"!==e.status)&&this.getPlayFinishedState([this.lastPlayId],!0),this.lastPlayId&&this.lastPlayId!==e.item.listenId&&this.onSwitchAudio(e.item.listenId,this.lastPlayId),this.lastPlayId=e.item.listenId},onSwitchAudio(e,t){e===this.playInfo.listen_id?this.fromType="tts":this.fromType="star",this.__onClickSwitching?(this.finishCardTitleAnime(),setTimeout((()=>this.startCardTitleAnime()))):this.showList=this.undoneList.filter((t=>t.listen_id!==e)),this.__onClickSwitching=!1,this.getPlayFinishedState([t],!0)},onListScreenExpose(){this.report({EventType:8})},onPlayScreenExpose(){this.showBorder=!1,this.report({EventType:1})},onPlayScreenLeave(){this.showBorder=!0},onProgressExpose(){this.showPlayingBar=!1},onProgressLeave(){this.showPlayingBar=!0},onListItemExpose(e,t){},onListItemLeave(e,t){},onClickPlayingBar(){var e,t;const i=null==(t=null==(e=this.$refs.bottomModal)?void 0:e.$refs)?void 0:t.contentAreaWrp;null==i||i.scrollTo({top:0,behavior:"smooth"})},onClickListenItem(e){this.setPlay(e,"star","list",(()=>{const t=this.undoneList.some((e=>e.listen_id===this.playingListenId));this.__onClickSwitching=!0,this.showList=[...t?[this.playingInfo]:[],...this.undoneList].filter((t=>t.listen_id!==e.listen_id)).filter(yt("listen_id"))}))},onSeeking(e){this.stopCountdown(),this.updateCurrentTime(this.playingListenId,parseInt(e,10)),this.__hasReportSeeking||(this.__hasReportSeeking=!0,this.report({EventType:18}),ge.setSum(la,28,1))},onSeeked(e){this.updateCurrentTime(this.playingListenId,parseInt(e,10)),this.setCurrentTime(e),this.startCountDown(),this.__hasReportSeeking=!1,this.report({EventType:19}),ge.setSum(la,29,1)},onSetShutdown(e){const{key:t}=e||{};"number"==typeof t?Ee.invoke("operateTingAudio",{operationType:"setShutdown",shutdownType:"afterMins",time:t},(e=>{console.log("[audio panel] setShutdown afterMins",e),/:ok$/.test(e.err_msg)&&this.showTips("将在".concat(t,"分钟后停止播放"))})):(Ee.invoke("operateTingAudio",{operationType:"setShutdown",shutdownType:t},(e=>{console.log("[audio panel] setShutdown",t,e),/:ok$/.test(e.err_msg)&&("none"===t?this.hideTips():this.showTips("将在此音频播放结束时停止播放"))})),"none"===t&&ge.setSum(la,31,1)),this.shutdownType=t,"number"==typeof t&&(this.shutdownLeftTime=t),this.report({EventType:17}),ge.setSum(la,30,1)},onBackward(e){var t;const i=Math.max(((null==(t=this.playingInfo)?void 0:t.currentTime)||0)-e,0);this.updateCurrentTime(this.playingListenId,parseInt(i,10)),this.setCurrentTime(i),this.report({EventType:14}),ge.setSum(la,25,1)},onForward(e){var t,i;const n=Math.min(((null==(t=this.playingInfo)?void 0:t.currentTime)||0)+e,((null==(i=this.playingInfo)?void 0:i.duration)||1/0)/1e3);this.updateCurrentTime(this.playingListenId,parseInt(n,10)),this.setCurrentTime(n),this.report({EventType:15}),ge.setSum(la,26,1)},onChangeRate(){const e=[1,1.25,1.5,.75],t=e.indexOf(this.playRate),i=e[(t+1)%e.length];this.playRate=i,Ee.invoke("operateTingAudio",{operationType:"playRate",srcId:this.playingSrcId||"",playRate:this.playRate},(e=>{console.log("[audio panel] setPlayRate",e),1!==this.playRate?this.showTips("已切换至".concat(this.playRate,"倍速播放")):this.hideTips()})),ft.set("play-rate",i),this.report({EventType:16}),ge.setSum(la,27,1)},onTingPlayListRefresh(e){console.log("[audio panel] onTingPlayListRefresh",e)},onSlideStart(){this.slideMoving=!0},onSlideEnd(){this.slideMoving=!1},onStar(){this.hasStar=!0,cu({listenId:this.playInfo.listen_id,onSuccess:()=>this.doCombineList()})},onMoveChosen(){this.dragMoving=!0,document.addEventListener("touchmove",this.onDragMove,{capture:!0}),Ee.invoke("vibrateShort",{style:"medium"})},onMoveUnchoose(){this.dragMoving=!1},onMoveStart(e){this.dragMoving=!0,this.__dragStartY=e.originalEvent.pageY,this.transitionDis=0,this.transitionGapByScroll=0},onDragMove(e){const t=((e.touches&&e.touches[0]||{}).pageY||0)-this.__dragStartY;this.transitionDis=t+(Ae.isIOS?this.transitionGapByScroll:0),e.preventDefault()},onMoveDone(){this.dragMoving=!1,document.removeEventListener("touchmove",this.onDragMove)},onMoveUpdate(e){this.dragMoving=!1,this.__disableTransitionTimeout&&(clearTimeout(this.__disableTransitionTimeout),this.__disableTransitionTimeout=null),this.disableTransition=!0,this.__disableTransitionTimeout=setTimeout((()=>{this.disableTransition=!1}),500),uu({from:"star",listenId:e.data.listen_id||"",pos:this.undoneList.some((e=>e.listen_id===this.playingListenId))?e.newIndex+1:e.newIndex,...this.playingListenId?{currentListenId:this.playingListenId}:{},onSuccess:()=>this.notifyAppListChange()});const t=this.undoneList.findIndex((e=>e.listen_id===this.playingListenId)),i=e.oldIndex+(t>=0&&t<=e.oldIndex?1:0),n=e.newIndex+(t>=0&&t<=e.newIndex?1:0),o={...this.undoneList[i]||{}};let s=[...this.undoneList.slice(0,i),...this.undoneList.slice(i+1)];this.undoneList=[...s.slice(0,n),o,...s.slice(n)]},startCardTitleAnime(){var e;null==(e=this.$refs.cardTitle)||e.play()},pauseCardTitleAnime(){var e;null==(e=this.$refs.cardTitle)||e.pause()},finishCardTitleAnime(){var e;null==(e=this.$refs.cardTitle)||e.finish()},async onPullupLoad(){this.undoneListHasNext&&await this.getUndoneList(),this.$refs.bottomModal.finishPullUpLoad()},getUndoneList(e=!0){return new Promise((t=>{this.getUndoneListLoading||!this.undoneListHasNext&&e?t():(this.getUndoneListLoading=!0,(({buffer:e,onSuccess:t,onError:i,onComplete:n})=>{ye({url:"/mp/listenplayerv2?action=get_playlist",type:"POST",data:{last_listen_id:e?du:"",count:20,playlist_type:2,session_buffer:e||""},async:!0,dataType:"json",success:e=>{if(e&&e.base_resp&&0===e.base_resp.ret){if("function"==typeof t&&t(e),e&&e.results&&e.results.length){const t=e.results[e.results.length-1];du=t&&t.listen_id||""}}else"function"==typeof i&&i(e)},error:()=>{"function"==typeof i&&i()},complete:()=>{"function"==typeof n&&n()}})})({buffer:e?this.undoneListBuffer:"",onSuccess:i=>{var n,o;const s=null==(o=null==(n=i.results)?void 0:n.filter((e=>null==e?void 0:e.listen_item)))?void 0:o.map((e=>{var t,n;return{...e,listen_item:{...e.listen_item,tts_model_type:(null==(n=null==(t=i.listen_item_ext)?void 0:t.find((t=>(null==t?void 0:t.listen_id)===e.listen_id)))?void 0:n.tts_model_type)||1}}}));this.undoneList=e?[...this.undoneList,...s].filter((e=>null==e?void 0:e.listen_item)).filter(yt("listen_id")):[...s].filter((e=>null==e?void 0:e.listen_item)).filter(yt("listen_id")),this.showList=this.undoneList.filter((e=>(null==e?void 0:e.listen_id)!==this.playingListenId)),this.undoneListHasNext=i.has_more,this.base64=i.merge_playlist_info_base64||"",this.undoneListBuffer=i.session_buffer||"",this.getPlayFinishedState(s.map((e=>e.listen_id)),!0),this.getUndoneListLoading=!1,t()},onError:()=>{this.undoneListError=!0,this.getUndoneListLoading=!1,this.undoneListHasNext=!1,t()}}))}))},doCombineListRaw(e){this.doingCombine?this.needDoCombine=!0:(this.doingCombine=!0,this.needDoCombine=!1,(({listenId:e,pos:t,onSuccess:i,onError:n,onComplete:o})=>{ye({url:"/mp/listenplayerv2?action=refresh",type:"POST",data:{listen_id:e||"",target_pos:t||0,playlist_type:3},async:!0,dataType:"json",success:e=>{e&&e.base_resp&&0===e.base_resp.ret?"function"==typeof i&&i(e):"function"==typeof n&&n(e)},error:()=>{"function"==typeof n&&n()},complete:()=>{"function"==typeof o&&o()}})})({listenId:e||this.playInfo.listen_id,pos:0,onSuccess:()=>{this.doingCombine=!1,this.notifyAppListChange(),this.needDoCombine&&this.doCombineList()},onError:()=>{this.doingCombine=!1}}))},setPlay(e,t="star",i,n){if(!(null==e?void 0:e.listen_id))return;if(this.isPlaying&&this.playingListenId===(null==e?void 0:e.listen_id))return void this.pause(!0);const o=this.undoneList.find((t=>t.listen_id===e.listen_id));("tts"!==t||o)&&(uu({from:"tts"===t?o?"star":"done":t,listenId:e.listen_id,...this.playingListenId?{currentListenId:this.playingListenId}:{},onSuccess:()=>this.notifyAppListChange()}),"function"==typeof n?n():this.undoneList=[{...e},...this.undoneList].filter((e=>null==e?void 0:e.listen_item)).filter(yt("listen_id"))),this.fromType=t,this.play(e.listen_item,!0),"show"!==i&&(this.showBackWrp=!1)},setPlayNextNew(e,t="star"){var i,n;const o={...e};this.playingListenId&&this.playingListenId===(null==(n=null==(i=this.undoneList)?void 0:i[0])?void 0:n.listen_id)?(this.undoneList=[this.undoneList[0],o,...this.undoneList.slice(1)||[]].filter((e=>null==e?void 0:e.listen_item)).filter(yt("listen_id")),this.showList=this.undoneList.filter((e=>e.listen_id!==this.playingListenId)),uu({from:t,listenId:e.listen_id,pos:1,...this.playingListenId?{currentListenId:this.playingListenId}:{},onSuccess:()=>this.notifyAppListChange()})):(this.undoneList=[o,...this.undoneList].filter((e=>null==e?void 0:e.listen_item)).filter(yt("listen_id")),this.showList=this.undoneList.filter((e=>e.listen_id!==this.playingListenId)),uu({from:t,listenId:e.listen_id,pos:0,...this.playingListenId?{currentListenId:this.playingListenId}:{},onSuccess:()=>this.notifyAppListChange()}))},setPlayDone(e){pu({listenId:e}),this.undoneList=this.undoneList.filter((t=>t.listen_id!==e)),this.showList=this.undoneList.filter(x.listen_id!==this.playingListenId)},getStarStatus(){(({listenId:e,onSuccess:t,onError:i,onComplete:n})=>{ye({url:"/mp/listenplayerv2?action=check_star",type:"POST",data:{listen_id:e},async:!0,dataType:"json",success:e=>{e&&e.base_resp&&0===e.base_resp.ret?"function"==typeof t&&t(e):"function"==typeof i&&i(e)},error:()=>{"function"==typeof i&&i()},complete:()=>{"function"==typeof n&&n()}})})({listenId:this.playInfo.listen_id,onSuccess:e=>this.hasStar=e.star})},setStar(e,t){e.listen_id===this.playInfo.listen_id?Ee.invoke("operateStar",{opType:"addStar"},(()=>{this.hasStar=!0,this.getUndoneList(!1).then((()=>this.doCombineList())),"function"==typeof t&&t()})):(cu({listenId:e.listen_id,onSuccess:()=>this.doCombineList()}),this.hasStar=!0,this.undoneList=[e,...this.undoneList].filter((e=>null==e?void 0:e.listen_item)).filter(yt("listen_id")))},cancelStar(e){this.undoneList=this.undoneList.filter((t=>t.listen_id!==e.listen_id)),this.showList=this.undoneList.filter(x.listen_id!==this.playingListenId),e.listen_id===this.playInfo.listen_id&&(this.hasStar=!1),(({listenId:e,from:t,onSuccess:i,onError:n,onComplete:o})=>{ye({url:"/mp/listenplayerv2?action=rm_from_playlist",type:"POST",data:{playlist_type:"star"===t?2:4,listen_id:e},async:!0,dataType:"json",success:e=>{e&&e.base_resp&&0===e.base_resp.ret?"function"==typeof i&&i(e):"function"==typeof n&&n(e)},error:()=>{"function"==typeof n&&n()},complete:()=>{"function"==typeof o&&o()}})})({listenId:e.listen_id,from:"star",onSuccess:()=>this.doCombineList()})},handleClickFullscreen(){this.play(this.playingInfo.listen_item,!0,0,!0),this.hide()},onClickStar(e){this.setStar(e)},onClickBack(){const e=this.tempStorePlayInfo,t=this.getTempListenItem(e),i=this.undoneList.findIndex((e=>e.listen_id===this.tempStorePlayInfo.listenId))>-1;this.setPlay({listen_id:this.tempStorePlayInfo.listenId,listen_item:t},i?"star":"tts"),this.showBackWrp=!1},getTempListenItem:e=>e?{...e,listen_id:e.listenId,url:e.webUrl||"",...e.mpInfo?{author_info:{username:e.mpInfo.username,nickname:e.mpInfo.name},article_info:{bizuin:e.mpInfo.bizUin,url:e.webUrl,audio_id:e.mpInfo.audioId}}:{}}:{}}},(function(){var e,t,i,n,o,s,a,r=this,l=r._self._c;return l("div",{ref:"container"},[l("mp-bottom-modal",{ref:"bottomModal",attrs:{"close-btn-type":"fold","ext-class":"audio-panel-modal audio-panel-modal-for-star ".concat(r.slideMoving?"audio-panel-disable-touch-action":""," type-fullscreen"),top:r.modalTop,"need-head-line":!1,"hide-when-sideslip":!r.dragMoving,"hide-when-scroll-down":!r.dragMoving,"header-type":"custom"},on:{show:r.onShow,hide:r.onHide,"click-slide-btn":r.hide,"show-after-animation":r.startCardTitleAnime,"pullup-load":r.onPullupLoad}},[l("Header",{attrs:{slot:"header","show-border":r.showBorder,"show-title":r.showPlayingBar&&(null==(e=r.playingInfo)?void 0:e.listen_item)&&(r.isPlaying||r.playLoading||r.playChanging),title:"播放中: ".concat(r.showTitle)},on:{close:r.hide,click:r.onClickPlayingBar,fullscreen:r.handleClickFullscreen},slot:"header"}),l("div",{ref:"wrp",staticClass:"audio-panel__wrp"},[r.firstScreenDataReady||r.firstScreenDataError?!r.firstScreenDataReady&&r.firstScreenDataError?l("div",{ref:"playWrp",staticClass:"audio-panel__screen error",on:{click:r.getFirstScreenData}},[l("div",{staticClass:"weui-loadmore"},[l("div",{staticClass:"weui-loadmore__tips"},[r._v("加载失败，请点击重试")])])]):[l("Intersect",{attrs:{threshold:[0]},on:{enter:r.onPlayScreenExpose,leave:r.onPlayScreenLeave}},[l("div",{ref:"playWrp",staticClass:"audio-panel__screen info-screen"},[l("div",{staticClass:"audio-panel__play-area",class:{"show-progress":r.showProgress}},[l("div",{ref:"playerCover",staticClass:"audio-panel__play-area__cover",style:"background-image: url(".concat(r.playingListenItem&&r.playingListenItem.cover,")")}),l("div",{staticClass:"audio-panel__play-area__right"},[l("div",{staticClass:"audio-panel__play-area__info"},[l("TextMarquee",{ref:"cardTitle",staticClass:"info-title__wrp",attrs:{title:r.showTitle}}),l("div",{staticClass:"info-desc"},[l("span",{staticClass:"info-desc__author",attrs:{id:"info-desc__author"}},[r._v(r._s(r.playingListenItem.author))]),2===r.playingListenItem.tts_model_type?l("span",[r._v("作者音色朗读")]):2!==r.playingListenItem.type?l("span",{staticClass:"info-desc__duration"},[r._v("音频由作者上传")]):r._e(),l("span",{directives:[{name:"show",rawName:"v-show",value:r.playInfo.listen_id===r.playingListenId,expression:"playInfo.listen_id === playingListenId"}],staticClass:"star-wrp",on:{click:function(e){return r.onClickStar(r.playingListenItem)}}},[l("i",{staticClass:"icon-star"}),l("span",[r._v("星标")])])])],1)])]),l("Intersect",{attrs:{threshold:[.5]},on:{enter:r.onProgressExpose,leave:r.onProgressLeave}},[l("div",{staticClass:"audio-panel__operate-area-wrp"},[l("Progress",{key:"progress",attrs:{"play-rate":+r.playRate,"is-playing":r.isPlaying||r.playLoading,"current-time":Math.min((null==(t=r.playingInfo)?void 0:t.currentTime)||0,(null==(n=null==(i=r.playingInfo)?void 0:i.listen_item)?void 0:n.duration)||0),"has-set-shut-down":"none"!==r.shutdownType,duration:(null==(s=null==(o=r.playingInfo)?void 0:o.listen_item)?void 0:s.duration)||0},on:{"change-rate":function(e){return r.onChangeRate()},"set-shutdown":r.callShutdownPanel,forward:function(e){return r.onForward(30,0)},backward:function(e){return r.onBackward(15,0)},"toggle-play":function(e){return r.setPlay(r.playingInfo,r.fromType)},seeked:e=>r.onSeeked(e,0),seeking:e=>r.onSeeking(e,0)}})],1)])],1)]),l("Intersect",{attrs:{threshold:[0]},on:{enter:r.onListScreenExpose}},[l("div",{ref:"listScreen",staticClass:"audio-panel__screen list-screen"},[l("transition",{attrs:{name:"collapse"}},[r.showBackWrp?l("div",{staticClass:"back-wrp",on:{click:r.onClickBack}},[l("i",{staticClass:"icon-back"}),l("span",{staticClass:"back-wrp__title"},[r._v("继续播放")]),l("span",[r._v(r._s((null==(a=r.tempStorePlayInfo)?void 0:a.title)||""))])]):r._e()]),l("div",{staticClass:"audio-panel__list-area",style:"--drag-ghost-transition-dis: ".concat(r.transitionDis,"px;")},[l("div",{ref:"listSubTitle",staticClass:"sub-title"},[r._v("待播列表")]),l("div",{directives:[{name:"show",rawName:"v-show",value:r.undoneList.length,expression:"undoneList.length"}],ref:"listSubTitle",staticClass:"sub-desc"},[r._v("内容来源于星标")]),l("mp-slide-view-group",{ref:"slideGroup"},[l("VueDraggable",{attrs:{delay:300,scroll:!0,"bubble-scroll":!1,"scroll-fn":r.onDragScroll,"touch-start-threshold":5,disabled:!r.supportDynamicPlayList&&!r.slideMoving,target:".audio-list-sort-wrp"},on:{end:r.onMoveDone,start:r.onMoveStart,update:r.onMoveUpdate,choose:r.onMoveChosen,unchoose:r.onMoveUnchoose},model:{value:r.showList,callback:function(e){r.showList=e},expression:"showList"}},[l("transition-group",{staticClass:"audio-list-sort-wrp",attrs:{name:"audio-list"}},r._l(r.showList,(function(e,t){return l("mp-slide-view",{key:"slide-item-".concat(e.listen_id),attrs:{disabled:!r.supportDynamicPlayList&&!r.dragMoving,"extra-class":["audio-list__item-slide-wrp","pos-".concat(t),r.playingListenId===e.listen_id?"now-playing":"",r.disableTransition?"disable-transition":""]},on:{end:r.onSlideEnd,start:r.onSlideStart},scopedSlots:r._u([{key:"btns",fn:function(){return[l("mp-slide-item",{attrs:{"not-last":t>=1},on:{click:function(t){return r.cancelStar(e)}}},[r._v("删除")]),t>=1?l("mp-slide-item",{directives:[{name:"show",rawName:"v-show",value:!r.dragMoving,expression:"!dragMoving"}],attrs:{"extra-class":"slide-item-warn"},on:{click:t=>r.setPlayNextNew(e,"star")}},[r._v("下一个播放")]):r._e()]},proxy:!0}],null,!0)},[l("Intersect",{attrs:{threshold:[0]},on:{enter:e=>r.onListItemExpose(e,t),leave:e=>r.onListItemLeave(e,t)}},[l("audio-list-item",{key:"audio-".concat(e.listen_id),ref:"audioItem",refInFor:!0,attrs:{info:e,version:r.version,"play-rate":+r.playRate,"need-finish-state":!1,"is-playing":r.isPlaying||r.playLoading,playing:r.playingListenId===e.listen_id,"has-set-shut-down":"none"!==r.shutdownType},on:{pause:function(e){return r.pause(!1)},"change-rate":function(e){return r.onChangeRate()},"set-shutdown":r.callShutdownPanel,forward:function(e){return r.onForward(30,t)},backward:function(e){return r.onBackward(15,t)},click:function(t){return r.onClickListenItem(e)},seeked:e=>r.onSeeked(e,t),seeking:e=>r.onSeeking(e,t)}})],1)],1)})),1)],1)],1),l("div",{directives:[{name:"show",rawName:"v-show",value:!r.getUndoneListLoading&&!r.undoneListHasNext&&!r.undoneList.length,expression:"!getUndoneListLoading && !undoneListHasNext && !undoneList.length"}],staticClass:"weui-loadmore empty"},[l("span",{staticClass:"weui-loadmore__tips"},[r._v("暂无星标内容,")]),l("span",{staticClass:"weui-loadmore__tips"},[r._v("加入的星标内容将在这里")])]),l("div",{directives:[{name:"show",rawName:"v-show",value:r.getUndoneListLoading,expression:"getUndoneListLoading"}],staticClass:"weui-loadmore"},[l("div",{staticClass:"weui-loadmore__tips"},[l("i",{staticClass:"weui-loading"})])]),l("div",{directives:[{name:"show",rawName:"v-show",value:!r.getUndoneListLoading&&!r.undoneListHasNext&&r.undoneList.length,expression:"!getUndoneListLoading && !undoneListHasNext && undoneList.length"}],staticClass:"weui-loadmore weui-loadmore_line weui-loadmore_dot"},[l("span",{staticClass:"weui-loadmore__tips"})])],1)],1)])]:l("div",{ref:"playWrp",staticClass:"audio-panel__screen empty"},[l("div",{staticClass:"weui-loadmore"},[l("div",{staticClass:"weui-loadmore__tips"},[l("i",{staticClass:"weui-loading"})])])]),l("div",{staticClass:"audio-panel__modal-bottom-mask",on:{touchstart:function(e){e.stopPropagation(),e.preventDefault()},touchmove:function(e){e.stopPropagation(),e.preventDefault()},touchend:function(e){e.stopPropagation(),e.preventDefault()}}})],2)],1),l("Teleport",{attrs:{to:"body"}},[l("Tips",{attrs:{"tips-wording":r.tipsWording},model:{value:r.tipsShow,callback:function(e){r.tipsShow=e},expression:"tipsShow"}}),l("OptionMenu",{attrs:{"active-key":r.shutdownType,"wrp-style":r.shutdownPanelPosition,options:r.shutdownOptions},on:{select:r.onSetShutdown},model:{value:r.shutdownPanelShow,callback:function(e){r.shutdownPanelShow=e},expression:"shutdownPanelShow"}})],1)],1)}),[],!1,null,"fac311f8",null,null).exports,_u=window.Vue,fu=window.frontend_exp_list&&window.frontend_exp_list.reduce(((e,t)=>("listenplayer_tmp"===t.key&&(e="1"===t.value),e)),!1);function gu(e,t){const i=document.querySelector('mp-common-claudio[listen_id="'.concat(e,'"]')),n=document.querySelector('mp-common-mpaudio[listen_id="'.concat(e,'"]'));i&&i.setAttribute("has-added-listen-later",t),n&&n.setAttribute("has-added-listen-later",t),window.musicList&&Object.keys(window.musicList).forEach((i=>{const n=window.musicList[i];n.listenId===e&&n.player&&(n.player._o.hasAddedListenLater=t)}))}if(window.localStorage&&window.localStorage.getItem){const e=4500,t="loadSec-"+window.biz+"-"+window.mid+"-"+window.idx;let i=window.localStorage.getItem(t);i&&window.write_sceen_time-parseInt(i,10)>e&&(we.report(20801,{Bizuin:window.biz,MsgId:1*window.mid,ItemIdx:1*window.idx,Url:window.msg_source_url||"",Title:window.msg_title||""}),window.localStorage.removeItem(t))}const yu=function(){let e=window.location.href.split("?")[1];if(e){let t=e.split("&");for(let e=0;e<t.length;e++){const[i,n]=t[e].split("=");if("imageIndex"===i)return parseInt(n,10)}return""}return""}();function wu(e){return e&&e.getBoundingClientRect?e.getBoundingClientRect().top+function(){let e=0;return void 0!==window.pageXOffset?e=window.pageXOffset:void 0!==document.compatMode&&"BackCompat"!==document.compatMode?e=document.documentElement.scrollTop:void 0!==document.body&&(e=document.body.scrollTop),e}():0}function vu(){if(""===yu)return;const e=function(){const e=[],t=document.getElementsByTagName("img");for(let i=0,n=t.length;i<n;i++){const n=t.item(i);n.getAttribute("data-src")&&e.push(n)}return e}();if(yu>e.length)return;const t=wu(e[yu]);window.scroll(0,t)}function bu(){let e=!1,t=window.performance||window.msPerformance||window.webkitPerformance;if(!(t&&t.timing&&t.timing.navigationStart))return!1;e=t.timing.navigationStart,function(){let t=window.performance&&window.performance.timing,i=window.write_sceen_time-e,n=window.first_sceen__time-e,o=window.page_endtime-e,s=(window.onload_endtime||+new Date)-e;-1!=navigator.userAgent.indexOf("MicroMessenger")&&(i=real_show_page_time-e,n=real_show_page_time-e);let a=window.logs.jsapi_ready_time?window.logs.jsapi_ready_time-e:void 0,r=window.logs.a8key_ready_time?window.logs.a8key_ready_time-e:void 0,l=t&&t.connectEnd-t.connectStart,d=t&&t.secureConnectionStart&&t.connectEnd-t.secureConnectionStart,c=t&&t.domainLookupEnd&&t.domainLookupStart&&t.domainLookupEnd-t.domainLookupStart;if(window.logs.pagetime.wtime=i,window.logs.pagetime.ftime=n,window.logs.pagetime.ptime=o,window.logs.pagetime.onload_time=s,window.logs.pagetime.jsapi_ready_time=a,window.logs.pagetime.a8key_ready_time=r,need_report_cost?ye({url:"/mp/report_cost",type:"post",data:{id_key_list:["1|1|"+o,"1|2|"+n,"1|3|"+s,"1|4|"+a,"1|5|"+r,"1|6|"+l,"1|7|"+d,"1|8|"+c].join(";")}}):Math.random()<.01&&ye({url:"/mp/report_cost",type:"post",data:{id_key_list:["#1|1|"+o,"1|2|"+n,"1|3|"+s,"1|4|"+a,"1|5|"+r,"1|6|"+l,"1|7|"+d,"1|8|"+c].join(";")}}),need_report_cost&&n>3e3){let e=new Image,t=(new Date).getTime();e.onload=function(){let e=(new Date).getTime()-t,i=(new Date).getTime(),n=new Image;n.onload=function(){let t=(new Date).getTime()-i;ye({url:"/mp/report_cost",type:"post",data:{id_key_list:["^2|1|"+e,"2|2|"+t].join(";")}})},n.src="http://ugc.qpic.cn/adapt/0/7d8963bb-aace-df23-0569-f8a4e388eacb/100?r="+Math.random()},e.src="http://ugc.qpic.cn/adapt/0/7d8963bb-aace-df23-0569-f8a4e388eacb/100?r="+Math.random()}function u(){if(-1==navigator.userAgent.indexOf("NetType/"))return!1;let e=["2G","cmwap","cmnet","uninet","uniwap","ctwap","ctnet"];for(let t=0,i=e.length;t<i;++t)if(-1!=navigator.userAgent.indexOf(e[t]))return!0;return!1}Math.random()>.2||s<0||i<0||n<0||o<0||(a&&ge.setAvg(27822,15,a),r&&ge.setAvg(27822,17,r),o>=15e3?ge.setAvg(27822,29,o):(ge.setAvg(27822,1,o).setAvg(27822,3,s).setAvg(27822,5,n),window.isWeixinCached&&ge.setAvg(27822,19,o),u()?(ge.setAvg(27822,9,o),window.isWeixinCached&&ge.setAvg(27822,23,o)):"wifi"==networkType?(ge.setAvg(27822,7,o),window.isWeixinCached&&ge.setAvg(27822,21,o)):"2g/3g"==networkType?(ge.setAvg(27822,11,o),window.isWeixinCached&&ge.setAvg(27822,25,o)):"4g"==networkType?(ge.setAvg(27822,14,o),window.isWeixinCached&&ge.setAvg(27822,26,o)):(ge.setAvg(27822,13,o),window.isWeixinCached&&ge.setAvg(27822,28,o)),window.moon&&moon.clearSample&&(ge.setAvg(27822,71,o),u()?ge.setAvg(27822,73,o):"wifi"==networkType?ge.setAvg(27822,75,o):"2g/3g"==networkType?ge.setAvg(27822,77,o):"4g"==networkType?ge.setAvg(27822,78,o):ge.setAvg(27822,79,o)),l&&ge.setAvg(27822,65,l),d&&ge.setAvg(27822,67,d),c&&ge.setAvg(27822,69,c)))}(),window.logs.jsapi_ready_fail&&ge.setSum(24729,55,window.logs.jsapi_ready_fail),function(){const e=document.getElementById("page-content");if(!e||Math.random()>.1)return;const i=function(){const n=document.getElementById("js_content_end"),o=window.pageYOffset||document.documentElement.scrollTop,s=n.offsetTop;if(o+We.getInnerHeight()>=s){let n,o,s=e.getElementsByTagName("img"),a={},r=[],l=0,d=0,c=0;for(let e=0,t=s.length;e<t;++e){let t=s[e];n=t.getAttribute("data-src")||t.getAttribute("src"),o=t.getAttribute("src"),n&&(n.isCDN()?d++:c++,l++,a[o]={})}if(r.push("1="+1e3*l),r.push("2="+1e3*d),r.push("3="+1e3*c),t.getEntries){let e=t.getEntries(),i=window.logs&&window.logs.img&&window.logs.img.download;if(!i)return;let n=[0,0,0],o=[0,0,0];l=d=0;for(let t=0,r=e.length;t<r;++t){let i=e[t],s=i.name;s&&"img"==i.initiatorType&&a[s]&&(s.isCDN()&&(o[0]+=i.duration,d++),n[0]+=i.duration,l++,a[s]={startTime:i.startTime,responseEnd:i.responseEnd})}n[0]>0&&l>0&&(n[2]=n[0]/l),o[0]>0&&d>0&&(o[2]=o[0]/d);for(let t in i)if(i.hasOwnProperty(t)){let e=i[t],s=0,r=0,l=0,d=0;for(let t=0,i=e.length;t<i;++t){let i=e[t];if(a[i]&&a[i].startTime&&a[i].responseEnd){let e=a[i].startTime,t=a[i].responseEnd;s=Math.max(s,t),r=r?Math.min(r,e):e,i.isCDN()&&(l=Math.max(s,t),d=r?Math.min(r,e):e)}}n[1]+=Math.round(s-r),o[1]+=Math.round(l-d)}let s=4,c=7;for(let t=0;t<3;t++)n[t]=Math.round(n[t]),o[t]=Math.round(o[t]),n[t]>0&&(r.push(s+t+"="+n[t]),"wifi"==networkType?r.push(s+t+6+"="+n[t]):"2g/3g"!=networkType&&"4g"!=networkType||r.push(s+t+12+"="+n[t])),o[t]>0&&(r.push(c+t+"="+o[t]),"wifi"==networkType?r.push(c+t+6+"="+o[t]):"2g/3g"!=networkType&&"4g"!=networkType||r.push(c+t+12+"="+o[t]))}Ne.off(window,"scroll",i,!1)}};Ne.on(window,"scroll",i,!1)}(),function(){if(Math.random()>.001)return;const e=document.createElement("iframe"),t=Math.ceil(10*Math.random())-1,i=uin+mid+idx+Math.ceil(1e3*Math.random())+(new Date).getTime();e.style.display="none",e.id="js_ajax",e.setAttribute("data-time",t),e.src="/mp/iframetest?action=page&traceid="+i+"&devicetype="+devicetype+"&timeout="+[600,800,1e3,1200,1500,2e3,3e3,5e3,1e4,18e3][t];document.getElementById("js_article").appendChild(e)}()}""!==yu&&"scrollRestoration"in history&&(history.scrollRestoration="manual"),"loading"!==document.readyState?vu():window.addEventListener("DOMContentLoaded",(function(){vu()})),Ne.on(window,"load",(function(){if(""==networkType&&window.isInWeixinApp()){let e={"network_type:fail":"fail","network_type:edge":"2g/3g","network_type:wwan":"2g/3g","network_type:wifi":"wifi"};JSAPI.invoke("getNetworkType",{},(function(t){networkType=e[t.err_msg],"network_type:edge"!=t.err_msg&&"network_type:wwan"!=t.err_msg||(t.detailtype&&"4g"==t.detailtype||t.subtype&&"4g"==t.subtype)&&(networkType="4g"),bu()}))}else bu()}),!1),window.page_endtime=+new Date;const Su="https://mp.weixin.qq.com/s/bpYquVzmjFzY_IrmCsxniQ",Iu=Ae.isWp||Ae.isIOS||Ae.isAndroid;const xu=xt({components:{[w.name]:w},data:()=>({isNavShow:!0}),mounted(){document.addEventListener("visibilitychange",(()=>{var e;!this.isNavShow&&!document.hidden&&(null==(e=this.secControl)?void 0:e.ad_violation_middle_page)>0&&(this.isNavShow=!0,n.hide(),n.show({alpha:.6}))}))},computed:{...h({secControl:e=>e.extRes.sec_control})},watch:{secControl:{handler(e){(null==e?void 0:e.ad_violation_middle_page)>0&&this.$nextTick((()=>{Iu?this.show():(document.body.parentNode.style.overflow="hidden",window.weui.dialog({content:"当前内容可能存在未经审核的第三方商业营销信息，请确认是否继续访问。",buttons:[{label:"继续访问",type:"default",onClick:()=>{this.report(1),document.body.parentNode.style.overflow="auto"}},{label:"取消",type:"primary",onClick:()=>{this.closePage()}}],isAndroid:Ae.isAndroid}))}))},immediate:!0}},methods:{show(){this.$refs.bottomModal.show()},hide(){this.report(1),this.$refs.bottomModal.hide(),this.isNavShow&&n.hide()},closePage(){this.report(2),Ae.isWechat?Ee.invoke("closeWindow",(e=>{-1===e.err_msg.indexOf("ok")&&(window.close(),window.open("about:blank","_top").close())})):(window.close(),window.open("about:blank","_top").close())},onTermClick(e){e.preventDefault(),"A"===e.target.tagName&&(Ae.isWechat?Ee.invoke("openUrlWithExtraWebview",{url:Su,openType:1},(e=>{-1===e.err_msg.indexOf("ok")?location.href=Su:this.isNavShow=!1})):location.href=Su)},report(e){we.report(30608,{action:e,scene:1,url:location.href,mid:1*window.mid||0,idx:1*window.idx||0,bizuin:window.biz&&1*window.atob(window.biz)||0})}}},(function(){var e=this,t=e._self._c;return t("mp-bottom-modal",{ref:"bottomModal",attrs:{"auto-height":"","has-header":!1,"hide-when-mask-click":!1},scopedSlots:e._u([{key:"footer",fn:function(){return[t("div",{staticClass:"weui-half-screen-dialog__btn-area"},[t("a",{staticClass:"weui-btn weui-btn_default",attrs:{href:"javascript:","wah-hotarea":"click"},on:{click:e.hide}},[e._v("继续访问")]),t("a",{staticClass:"weui-btn weui-btn_primary",attrs:{href:"javascript:","wah-hotarea":"click"},on:{click:e.closePage}},[e._v("取消")])]),t("div",{staticClass:"weui-half-screen-dialog__attachment-area",on:{click:e.onTermClick}},[t("a",{staticClass:"weui-link",attrs:{href:"javacript:;"}},[e._v("微信公众平台广告规范指引")])])]},proxy:!0}])},[t("p",{staticClass:"ad_control-tips"},[e._v("当前内容可能存在未经审核的第三方商业营销信息，请确认是否继续访问。")])])}),[],!1,null,"dc5d0372",null,null).exports;let ku,Tu="";function Cu(){try{if(!window.ad_keywords||"true"!==window.show_ad_keyword)return;const e=window.ad_keywords,t=document.querySelectorAll(".".concat(He)).length,i=e.map((e=>e.keyword)).join(";");Tu=i,ku=0;if(it({adKeywordsList:e,maxRenderNum:5,existingCount:t})){const t=nt(e,{groupId:ku,msgKeyWords:i});document.querySelectorAll(".".concat(He)).forEach((e=>{var i;(null==(i=e._adinfo)?void 0:i.data)&&(t.observe(e),function(e,t){e.addEventListener("click",(e=>{e.stopPropagation(),tt({keyword:t.keyword,eventType:2,msgKeyWords:Tu,groupId:ku}),c.commit("mp-adv-keyword/setAdKeywordItem",t),c.commit("mp-adv-keyword/setReportData",{groupId:ku,msgKeyWords:Tu}),c.commit("mp-adv-keyword/setShow",!0)}),!0)}(e,e._adinfo.data))})),tt({keyword:"",eventType:0,groupId:ku,msgKeyWords:i})}}catch(Nu){console.error("initAdvKeywords",Nu)}}const Au={bizuin:"1034280761,1431142721,1559284381,1593467941,1643294701,2276745981,2390281185,2390287897,2390403755,2390428640,2390553873,2390609440,2390856064,2390957431,2391111309,2391164500,2391199416,2391247334,2391375304,2391496567,2391844653,2392014380,2392031944,2392040960,2392068072,2392082080,2392154590,2392213146,2392718635,2392856453,2392897401,2393278785,2393306340,2393688720,2393702823,2393896961,2394032960,2394131000,2394134267,2394291820,2394889101,2394892111,2395111601,2395124745,2395159421,2395164392,2395212841,2395462792,2396123612,2396268083,2396283012,2396356952,2396388401,2396456681,2396639940,2396676120,2396822627,2396829423,2396942001,2397165860,2397251641,2397274880,2397329668,2397341623,2397343481,2397372552,2397491920,2397526740,2397536160,2398089220,2398191832,2398264303,2398285141,2398299140,2398330323,2398339600,2398552775,2398694681,2398838963,2399230362,2399354541,2399585921,2399587742,2399590682,2399627020,2399777220,2399984042,2786833600,3001648390,3002542227,3003037429,3003116648,3007158068,3009185121,3010540601,3012272362,3012301452,3013338725,3015508367,3016277592,3016752164,3070024236,3070196162,3070365200,3070494630,3071396719,3072501450,3073249188,3073254928,3073674128,3074001907,3074502309,3075409771,3076802329,3078365435,3079351773,3079981327,3080543482,3080796821,3081448106,3082446799,3083052239,3083282110,3086716937,3089340324,3089461010,3089474939,3090044084,3090136400,3090588715,3092634507,3092876047,3093258134,3093286307,3093485357,3093635076,3095301145,3095693511,3096421576,3096422132,3098395705,3098741504,3099311533,3200455571,3208460593,3239033926,3239724132,3240168687,3242247792,3251670823,3255036745,3256388201,3258413158,3265775647,3269032708,3269176942,3271158630,3271436617,3271443368,3274292289,3274590163,3286126582,3288868675,3292158393,3294233713,3294751423,3518062346,3521090753,3525800276,3537480573,3553935523,3558818400,3559619275,3560409763,3562893285,3563439857,3564573611,3570795545,3572825035,3588055360,3588502049,3591941043,3597585164,3598836122,3862092748,3863661346,3870597774,3872851260,3890467628,3890744878,3890769148,3890964029,3891717967,3892555190,3893127105,3898707519,3898741980,3898909364,3899903346,3907314219,3909716943,3910251662,3914274522,3925310299,3926248961,3928602515,3944000110,3948180278,699115,4393255,962494081,1212133741,1240574601,1275451641,1375135921,1444391061,1628309301,1791575621,1952208001,2095329301,2390095621,2390185980,2390204122,2390216734,2390302080,2390471121,2390642694,2390731784,2390870601,2391039495,2391150242,2391246920,2391567054,2391771880,2391844323,2392049500,2392135301,2392458732,2392727558,2393013234,2393041860,2393238864,2393256753,2393295571,2393468372,2393698380,2394260794,2394349740,2394595381,2395056175,2395148767,2395155740,2395347320,2395771800,2396006101,2396892002,2397224253,2397755480,2397783483,2398112841,2398177561,2398342156,2398377244,2398539040,2398632600,2398847601,2398982052,2399112600,2399178100,2399179801,2399272251,2399311780,2399488342,2399593722,2399828201,2399865442,2399899102,2399903782,2399991836,2560685080,2940696320,3000521703,3001008593,3003310516,3004961517,3008522239,3009401635,3009790978,3010170184,3012249769,3012326877,3012558019,3012729257,3014000347,3014173967,3014836707,3016397069,3017159050,3019157166,3071373728,3071712628,3071782930,3072030302,3072107639,3073731004,3075193232,3075325238,3076292503,3076392209,3077316430,3077322513,3077423712,3077572710,3078245224,3078852525,3079423800,3079476127,3079958145,3080043700,3080464616,3080580668,3080976631,3081200029,3081915473,3082416430,3082493215,3082539519,3084276724,3084405827,3084418087,3084639036,3084917558,3085157003,3086263435,3087030803,3087036607,3088308533,3089222529,3090060408,3090321411,3093197108,3093232206,3094160674,3094358118,3095437037,3096111432,3097079126,3097189780,3097498138,3099000336,3099068632,3200251369,3203815843,3204674323,3207173165,3209033201,3212096040,3214041112,3215656497,3217555405,3220101605,3222004532,3235111899,3236088154,3236259213,3237753356,3239235368,3243884694,3244599030,3255030554,3255918706,3259480365,3262231420,3263009825,3268117899,3269523047,3270637292,3271638842,3272710521,3280796249,3283053842,3284089266,3288495941,3294290460,3517426927,3522532562,3529012635,3531389974,3535085610,3548031541,3556007534,3557594538,3559352214,3563068977,3564760843,3567698492,3568878114,3569830872,3572699929,3578502418,3584493905,3589897120,3590745740,3592823583,3861638209,3864086737,3864811637,3865848828,3866756856,3867740377,3869559570,3871854925,3875092925,3879808364,3881127782,3885902745,3886703252,3889147671,3890135424,3893597889,3894866322,3902206426,3902301003,3902720236,3907694243,3911517477,3912441527,3918223942,3922186273,3922691457,3926241941,3931289542,699115,4393255,962494081,1212133741,1240574601,1275451641,1375135921,1444391061,1628309301,1791575621,1952208001,2095329301,2390095621,2390185980,2390204122,2390216734,2390302080,2390471121,2390642694,2390731784,2390870601,2391039495,2391150242,2391246920,2391567054,2391771880,2391844323,2392049500,2392135301,2392458732,2392727558,2393013234,2393041860,2393238864,2393256753,2393295571,2393468372,2393698380,2394260794,2394349740,2394595381,2395056175,2395148767,2395155740,2395347320,2395771800,2396006101,2396892002,2397224253,2397755480,2397783483,2398112841,2398177561,2398342156,2398377244,2398539040,2398632600,2398847601,2398982052,2399112600,2399178100,2399179801,2399272251,2399311780,2399488342,2399593722,2399828201,2399865442,2399899102,2399903782,2399991836,2560685080,2940696320,3000521703,3001008593,3003310516,3004961517,3008522239,3009401635,3009790978,3010170184,3012249769,3012326877,3012558019,3012729257,3014000347,3014173967,3014836707,3016397069,3017159050,3019157166,3071373728,3071712628,3071782930,3072030302,3072107639,3073731004,3075193232,3075325238,3076292503,3076392209,3077316430,3077322513,3077423712,3077572710,3078245224,3078852525,3079423800,3079476127,3079958145,3080043700,3080464616,3080580668,3080976631,3081200029,3081915473,3082416430,3082493215,3082539519,3084276724,3084405827,3084418087,3084639036,3084917558,3085157003,3086263435,3087030803,3087036607,3088308533,3089222529,3090060408,3090321411,3093197108,3093232206,3094160674,3094358118,3095437037,3096111432,3097079126,3097189780,3097498138,3099000336,3099068632,3200251369,3203815843,3204674323,3207173165,3209033201,3212096040,3214041112,3215656497,3217555405,3220101605,3222004532,3235111899,3236088154,3236259213,3237753356,3239235368,3243884694,3244599030,3255030554,3255918706,3259480365,3262231420,3263009825,3268117899,3269523047,3270637292,3271638842,3272710521,3280796249,3283053842,3284089266,3288495941,3294290460,3517426927,3522532562,3529012635,3531389974,3535085610,3548031541,3556007534,3557594538,3559352214,3563068977,3564760843,3567698492,3568878114,3569830872,3572699929,3578502418,3584493905,3589897120,3590745740,3592823583,3861638209,3864086737,3864811637,3865848828,3866756856,3867740377,3869559570,3871854925,3875092925,3879808364,3881127782,3885902745,3886703252,3889147671,3890135424,3893597889,3894866322,3902206426,3902301003,3902720236,3907694243,3911517477,3912441527,3918223942,3922186273,3922691457,3926241941,3931289542,1034280761,1431142721,1559284381,1593467941,1643294701,2276745981,2390281185,2390287897,2390403755,2390428640,2390553873,2390609440,2390856064,2390957431,2391111309,2391164500,2391199416,2391247334,2391375304,2391496567,2391844653,2392014380,2392031944,2392040960,2392068072,2392082080,2392154590,2392213146,2392718635,2392856453,2392897401,2393278785,2393306340,2393688720,2393702823,2393896961,2394032960,2394131000,2394134267,2394291820,2394889101,2394892111,2395111601,2395124745,2395159421,2395164392,2395212841,2395462792,2396123612,2396268083,2396283012,2396356952,2396388401,2396456681,2396639940,2396676120,2396822627,2396829423,2396942001,2397165860,2397251641,2397274880,2397329668,2397341623,2397343481,2397372552,2397491920,2397526740,2397536160,2398089220,2398191832,2398264303,2398285141,2398299140,2398330323,2398339600,2398552775,2398694681,2398838963,2399230362,2399354541,2399585921,2399587742,2399590682,2399627020,2399777220,2399984042,2786833600,3001648390,3002542227,3003037429,3003116648,3007158068,3009185121,3010540601,3012272362,3012301452,3013338725,3015508367,3016277592,3016752164,3070024236,3070196162,3070365200,3070494630,3071396719,3072501450,3073249188,3073254928,3073674128,3074001907,3074502309,3075409771,3076802329,3078365435,3079351773,3079981327,3080543482,3080796821,3081448106,3082446799,3083052239,3083282110,3086716937,3089340324,3089461010,3089474939,3090044084,3090136400,3090588715,3092634507,3092876047,3093258134,3093286307,3093485357,3093635076,3095301145,3095693511,3096421576,3096422132,3098395705,3098741504,3099311533,3200455571,3208460593,3239033926,3239724132,3240168687,3242247792,3251670823,3255036745,3256388201,3258413158,3265775647,3269032708,3269176942,3271158630,3271436617,3271443368,3274292289,3274590163,3286126582,3288868675,3292158393,3294233713,3294751423,3518062346,3521090753,3525800276,3537480573,3553935523,3558818400,3559619275,3560409763,3562893285,3563439857,3564573611,3570795545,3572825035,3588055360,3588502049,3591941043,3597585164,3598836122,3862092748,3863661346,3870597774,3872851260,3890467628,3890744878,3890769148,3890964029,3891717967,3892555190,3893127105,3898707519,3898741980,3898909364,3899903346,3907314219,3909716943,3910251662,3914274522,3925310299,3926248961,3928602515,3944000110,3948180278,699115,1034280761,1240574601,1431142721,1444391061,1593467941,1791575621,1952208001,2095329301,2276745981,2390216734,2390281185,2390553873,2390609440,2390870601,2391039495,2391246920,2391496567,2391844653,2392031944,2392040960,2392049500,2392068072,2392082080,2393013234,2393041860,2393238864,2393256753,2393295571,2393468372,2394032960,2394134267,2394260794,2394595381,2395111601,2395212841,2396456681,2396892002,2397343481,2397755480,2398177561,2398342156,2399178100,2399179801,2399272251,2399488342,2399587742,2399590682,2399627020,2399828201,2399899102,2399984042,3000521703,3001008593,3002542227,3003116648,3003310516,3004961517,3007158068,3009401635,3014000347,3014836707,3015508367,3070024236,3070365200,3071396719,3071712628,3072501450,3073731004,3075409771,3076292503,3076802329,3077322513,3080796821,3081915473,3082416430,3082539519,3084276724,3084639036,3086263435,3089474939,3090321411,3093258134,3093635076,3096421576,3097079126,3098741504,3099311533,3200455571,3208460593,3237753356,3239033926,3239235368,3239724132,3240168687,3242247792,3251670823,3256388201,3258413158,3262231420,3265775647,3271158630,3271436617,3271443368,3271638842,3274590163,3283053842,3284089266,3294290460,3517426927,3522532562,3529012635,3531389974,3535085610,3537480573,3557594538,3559619275,3560409763,3564573611,3568878114,3569830872,3570795545,3572699929,3578502418,3588055360,3589897120,3591941043,3597585164,3861638209,3863661346,3864086737,3867740377,3871854925,3881127782,3885902745,3890744878,3893597889,3898741980,3902301003,3907694243,3911517477,3918223942,3922186273,1212133741,1275451641,1375135921,2390204122,2390302080,2390428640,2390642694,2390856064,2390957431,2391150242,2391199416,2391247334,2391375304,2391567054,2392014380,2392135301,2392727558,2393688720,2393698380,2393702823,2393896961,2394131000,2394349740,2394889101,2394892111,2395056175,2395124745,2395155740,2396006101,2396123612,2396639940,2396829423,2396942001,2397165860,2397224253,2397274880,2397491920,2398089220,2398112841,2398299140,2398330323,2398377244,2398694681,2398847601,2398982052,2399230362,2399354541,2399865442,2399903782,2940696320,3001648390,3003037429,3009185121,3009790978,3010170184,3010540601,3012272362,3012326877,3012558019,3012729257,3014173967,3016277592,3017159050,3019157166,3070494630,3071373728,3073249188,3073254928,3074001907,3075193232,3078365435,3078852525,3080543482,3080580668,3080976631,3081200029,3081448106,3082493215,3083282110,3085157003,3087036607,3089340324,3089461010,3090044084,3090136400,3092876047,3093232206,3093286307,3094358118,3095301145,3095437037,3095693511,3096111432,3096422132,3097498138,3099068632,3200251369,3207173165,3220101605,3235111899,3243884694,3255030554,3255036745,3255918706,3259480365,3263009825,3268117899,3269176942,3270637292,3272710521,3280796249,3288495941,3288868675,3292158393,3294233713,3518062346,3548031541,3553935523,3558818400,3559352214,3562893285,3563068977,3564760843,3584493905,3588502049,3592823583,3598836122,3869559570,3872851260,3889147671,3890467628,3891717967,3899903346,3902206426,3910251662,3922691457,3925310299,3931289542,4393255,962494081,1559284381,1628309301,1643294701,2390095621,2390185980,2390287897,2390403755,2390471121,2390731784,2391111309,2391164500,2391771880,2391844323,2392154590,2392213146,2392458732,2392718635,2392856453,2392897401,2393278785,2393306340,2394291820,2395148767,2395159421,2395164392,2395347320,2395462792,2395771800,2396268083,2396283012,2396356952,2396388401,2396676120,2396822627,2397251641,2397329668,2397341623,2397372552,2397526740,2397536160,2397783483,2398191832,2398264303,2398285141,2398339600,2398539040,2398552775,2398632600,2398838963,2399112600,2399311780,2399585921,2399593722,2399777220,2399991836,2560685080,2786833600,3008522239,3012249769,3012301452,3013338725,3016397069,3016752164,3070196162,3071782930,3072030302,3072107639,3073674128,3074502309,3075325238,3076392209,3077316430,3077423712,3077572710,3078245224,3079351773,3079423800,3079476127,3079958145,3079981327,3080043700,3080464616,3082446799,3083052239,3084405827,3084418087,3084917558,3086716937,3087030803,3088308533,3089222529,3090060408,3090588715,3092634507,3093197108,3093485357,3094160674,3097189780,3098395705,3099000336,3203815843,3204674323,3209033201,3212096040,3214041112,3215656497,3217555405,3222004532,3236088154,3236259213,3244599030,3269032708,3269523047,3274292289,3286126582,3294751423,3521090753,3525800276,3556007534,3563439857,3567698492,3572825035,3590745740,3862092748,3864811637,3865848828,3866756856,3870597774,3875092925,3879808364,3886703252,3890135424,3890769148,3890964029,3892555190,3893127105,3894866322,3898707519,3898909364,3902720236,3907314219,3909716943,3912441527,3914274522,3926241941,3926248961,3928602515,3944000110,3948180278,699115,4393255,962494081,1212133741,1240574601,1275451641,1375135921,1444391061,1628309301,1791575621,1952208001,2095329301,2390095621,2390185980,2390204122,2390216734,2390302080,2390471121,2390642694,2390731784,2390870601,2391039495,2391150242,2391246920,2391567054,2391771880,2391844323,2392049500,2392135301,2392458732,2392727558,2393013234,2393041860,2393238864,2393256753,2393295571,2393468372,2393698380,2394260794,2394349740,2394595381,2395056175,2395148767,2395155740,2395347320,2395771800,2396006101,2396892002,2397224253,2397755480,2397783483,2398112841,2398177561,2398342156,2398377244,2398539040,2398632600,2398847601,2398982052,2399112600,2399178100,2399179801,2399272251,2399311780,2399488342,2399593722,2399828201,2399865442,2399899102,2399903782,2399991836,2560685080,2940696320,3000521703,3001008593,3003310516,3004961517,3008522239,3009401635,3009790978,3010170184,3012249769,3012326877,3012558019,3012729257,3014000347,3014173967,3014836707,3016397069,3017159050,3019157166,3071373728,3071712628,3071782930,3072030302,3072107639,3073731004,3075193232,3075325238,3076292503,3076392209,3077316430,3077322513,3077423712,3077572710,3078245224,3078852525,3079423800,3079476127,3079958145,3080043700,3080464616,3080580668,3080976631,3081200029,3081915473,3082416430,3082493215,3082539519,3084276724,3084405827,3084418087,3084639036,3084917558,3085157003,3086263435,3087030803,3087036607,3088308533,3089222529,3090060408,3090321411,3093197108,3093232206,3094160674,3094358118,3095437037,3096111432,3097079126,3097189780,3097498138,3099000336,3099068632,3200251369,3203815843,3204674323,3207173165,3209033201,3212096040,3214041112,3215656497,3217555405,3220101605,3222004532,3235111899,3236088154,3236259213,3237753356,3239235368,3243884694,3244599030,3255030554,3255918706,3259480365,3262231420,3263009825,3268117899,3269523047,3270637292,3271638842,3272710521,3280796249,3283053842,3284089266,3288495941,3294290460,3517426927,3522532562,3529012635,3531389974,3535085610,3548031541,3556007534,3557594538,3559352214,3563068977,3564760843,3567698492,3568878114,3569830872,3572699929,3578502418,3584493905,3589897120,3590745740,3592823583,3861638209,3864086737,3864811637,3865848828,3866756856,3867740377,3869559570,3871854925,3875092925,3879808364,3881127782,3885902745,3886703252,3889147671,3890135424,3893597889,3894866322,3902206426,3902301003,3902720236,3907694243,3911517477,3912441527,3918223942,3922186273,3922691457,3926241941,3931289542,1034280761,1431142721,1559284381,1593467941,1643294701,2276745981,2390281185,2390287897,2390403755,2390428640,2390553873,2390609440,2390856064,2390957431,2391111309,2391164500,2391199416,2391247334,2391375304,2391496567,2391844653,2392014380,2392031944,2392040960,2392068072,2392082080,2392154590,2392213146,2392718635,2392856453,2392897401,2393278785,2393306340,2393688720,2393702823,2393896961,2394032960,2394131000,2394134267,2394291820,2394889101,2394892111,2395111601,2395124745,2395159421,2395164392,2395212841,2395462792,2396123612,2396268083,2396283012,2396356952,2396388401,2396456681,2396639940,2396676120,2396822627,2396829423,2396942001,2397165860,2397251641,2397274880,2397329668,2397341623,2397343481,2397372552,2397491920,2397526740,2397536160,2398089220,2398191832,2398264303,2398285141,2398299140,2398330323,2398339600,2398552775,2398694681,2398838963,2399230362,2399354541,2399585921,2399587742,2399590682,2399627020,2399777220,2399984042,2786833600,3001648390,3002542227,3003037429,3003116648,3007158068,3009185121,3010540601,3012272362,3012301452,3013338725,3015508367,3016277592,3016752164,3070024236,3070196162,3070365200,3070494630,3071396719,3072501450,3073249188,3073254928,3073674128,3074001907,3074502309,3075409771,3076802329,3078365435,3079351773,3079981327,3080543482,3080796821,3081448106,3082446799,3083052239,3083282110,3086716937,3089340324,3089461010,3089474939,3090044084,3090136400,3090588715,3092634507,3092876047,3093258134,3093286307,3093485357,3093635076,3095301145,3095693511,3096421576,3096422132,3098395705,3098741504,3099311533,3200455571,3208460593,3239033926,3239724132,3240168687,3242247792,3251670823,3255036745,3256388201,3258413158,3265775647,3269032708,3269176942,3271158630,3271436617,3271443368,3274292289,3274590163,3286126582,3288868675,3292158393,3294233713,3294751423,3518062346,3521090753,3525800276,3537480573,3553935523,3558818400,3559619275,3560409763,3562893285,3563439857,3564573611,3570795545,3572825035,3588055360,3588502049,3591941043,3597585164,3598836122,3862092748,3863661346,3870597774,3872851260,3890467628,3890744878,3890769148,3890964029,3891717967,3892555190,3893127105,3898707519,3898741980,3898909364,3899903346,3907314219,3909716943,3910251662,3914274522,3925310299,3926248961,3928602515,3944000110,3948180278,1034280761,1431142721,1559284381,1593467941,1643294701,2276745981,2390281185,2390287897,2390403755,2390428640,2390553873,2390609440,2390856064,2390957431,2391111309,2391164500,2391199416,2391247334,2391375304,2391496567,2391844653,2392014380,2392031944,2392040960,2392068072,2392082080,2392154590,2392213146,2392718635,2392856453,2392897401,2393278785,2393306340,2393688720,2393702823,2393896961,2394032960,2394131000,2394134267,2394291820,2394889101,2394892111,2395111601,2395124745,2395159421,2395164392,2395212841,2395462792,2396123612,2396268083,2396283012,2396356952,2396388401,2396456681,2396639940,2396676120,2396822627,2396829423,2396942001,2397165860,2397251641,2397274880,2397329668,2397341623,2397343481,2397372552,2397491920,2397526740,2397536160,2398089220,2398191832,2398264303,2398285141,2398299140,2398330323,2398339600,2398552775,2398694681,2398838963,2399230362,2399354541,2399585921,2399587742,2399590682,2399627020,2399777220,2399984042,2786833600,3001648390,3002542227,3003037429,3003116648,3007158068,3009185121,3010540601,3012272362,3012301452,3013338725,3015508367,3016277592,3016752164,3070024236,3070196162,3070365200,3070494630,3071396719,3072501450,3073249188,3073254928,3073674128,3074001907,3074502309,3075409771,3076802329,3078365435,3079351773,3079981327,3080543482,3080796821,3081448106,3082446799,3083052239,3083282110,3086716937,3089340324,3089461010,3089474939,3090044084,3090136400,3090588715,3092634507,3092876047,3093258134,3093286307,3093485357,3093635076,3095301145,3095693511,3096421576,3096422132,3098395705,3098741504,3099311533,3200455571,3208460593,3239033926,3239724132,3240168687,3242247792,3251670823,3255036745,3256388201,3258413158,3265775647,3269032708,3269176942,3271158630,3271436617,3271443368,3274292289,3274590163,3286126582,3288868675,3292158393,3294233713,3294751423,3518062346,3521090753,3525800276,3537480573,3553935523,3558818400,3559619275,3560409763,3562893285,3563439857,3564573611,3570795545,3572825035,3588055360,3588502049,3591941043,3597585164,3598836122,3862092748,3863661346,3870597774,3872851260,3890467628,3890744878,3890769148,3890964029,3891717967,3892555190,3893127105,3898707519,3898741980,3898909364,3899903346,3907314219,3909716943,3910251662,3914274522,3925310299,3926248961,3928602515,3944000110,3948180278,699115,4393255,962494081,1212133741,1240574601,1275451641,1375135921,1444391061,1628309301,1791575621,1952208001,2095329301,2390095621,2390185980,2390204122,2390216734,2390302080,2390471121,2390642694,2390731784,2390870601,2391039495,2391150242,2391246920,2391567054,2391771880,2391844323,2392049500,2392135301,2392458732,2392727558,2393013234,2393041860,2393238864,2393256753,2393295571,2393468372,2393698380,2394260794,2394349740,2394595381,2395056175,2395148767,2395155740,2395347320,2395771800,2396006101,2396892002,2397224253,2397755480,2397783483,2398112841,2398177561,2398342156,2398377244,2398539040,2398632600,2398847601,2398982052,2399112600,2399178100,2399179801,2399272251,2399311780,2399488342,2399593722,2399828201,2399865442,2399899102,2399903782,2399991836,2560685080,2940696320,3000521703,3001008593,3003310516,3004961517,3008522239,3009401635,3009790978,3010170184,3012249769,3012326877,3012558019,3012729257,3014000347,3014173967,3014836707,3016397069,3017159050,3019157166,3071373728,3071712628,3071782930,3072030302,3072107639,3073731004,3075193232,3075325238,3076292503,3076392209,3077316430,3077322513,3077423712,3077572710,3078245224,3078852525,3079423800,3079476127,3079958145,3080043700,3080464616,3080580668,3080976631,3081200029,3081915473,3082416430,3082493215,3082539519,3084276724,3084405827,3084418087,3084639036,3084917558,3085157003,3086263435,3087030803,3087036607,3088308533,3089222529,3090060408,3090321411,3093197108,3093232206,3094160674,3094358118,3095437037,3096111432,3097079126,3097189780,3097498138,3099000336,3099068632,3200251369,3203815843,3204674323,3207173165,3209033201,3212096040,3214041112,3215656497,3217555405,3220101605,3222004532,3235111899,3236088154,3236259213,3237753356,3239235368,3243884694,3244599030,3255030554,3255918706,3259480365,3262231420,3263009825,3268117899,3269523047,3270637292,3271638842,3272710521,3280796249,3283053842,3284089266,3288495941,3294290460,3517426927,3522532562,3529012635,3531389974,3535085610,3548031541,3556007534,3557594538,3559352214,3563068977,3564760843,3567698492,3568878114,3569830872,3572699929,3578502418,3584493905,3589897120,3590745740,3592823583,3861638209,3864086737,3864811637,3865848828,3866756856,3867740377,3869559570,3871854925,3875092925,3879808364,3881127782,3885902745,3886703252,3889147671,3890135424,3893597889,3894866322,3902206426,3902301003,3902720236,3907694243,3911517477,3912441527,3918223942,3922186273,3922691457,3926241941,3931289542,699115,4393255,962494081,1212133741,1240574601,1275451641,1375135921,1444391061,1628309301,1791575621,1952208001,2095329301,2390095621,2390185980,2390204122,2390216734,2390302080,2390471121,2390642694,2390731784,2390870601,2391039495,2391150242,2391246920,2391567054,2391771880,2391844323,2392049500,2392135301,2392458732,2392727558,2393013234,2393041860,2393238864,2393256753,2393295571,2393468372,2393698380,2394260794,2394349740,2394595381,2395056175,2395148767,2395155740,2395347320,2395771800,2396006101,2396892002,2397224253,2397755480,2397783483,2398112841,2398177561,2398342156,2398377244,2398539040,2398632600,2398847601,2398982052,2399112600,2399178100,2399179801,2399272251,2399311780,2399488342,2399593722,2399828201,2399865442,2399899102,2399903782,2399991836,2560685080,2940696320,3000521703,3001008593,3003310516,3004961517,3008522239,3008522239,3009401635,3009790978,3010170184,3012249769,3012326877,3012558019,3012729257,3014000347,3014173967,3014836707,3016397069,3017159050,3019157166,3071373728,3071712628,3071782930,3072030302,3072107639,3073731004,3075193232,3075325238,3076292503,3076392209,3077316430,3077322513,3077423712,3077572710,3078245224,3078852525,3079423800,3079476127,3079958145,3080043700,3080464616,3080580668,3080976631,3081200029,3081915473,3082416430,3082493215,3082539519,3084276724,3084405827,3084418087,3084639036,3084917558,3085157003,3086263435,3087030803,3087036607,3088308533,3089222529,3090060408,3090321411,3093197108,3093232206,3094160674,3094358118,3095437037,3096111432,3097079126,3097189780,3097498138,3099000336,3099068632,3200251369,3203815843,3204674323,3207173165,3209033201,3212096040,3214041112,3215656497,3217555405,3220101605,3222004532,3235111899,3236088154,3236259213,3237753356,3239235368,3243884694,3244599030,3255030554,3255918706,3259480365,3262231420,3263009825,3268117899,3269523047,3270637292,3271638842,3272710521,3280796249,3283053842,3284089266,3288495941,3294290460,3517426927,3522532562,3529012635,3531389974,3535085610,3548031541,3556007534,3557594538,3559352214,3563068977,3564760843,3567698492,3568878114,3569830872,3572699929,3578502418,3584493905,3589897120,3590745740,3592823583,3861638209,3864086737,3864811637,3865848828,3866756856,3867740377,3869559570,3871854925,3875092925,3879808364,3881127782,3885902745,3886703252,3889147671,3890135424,3893597889,3894866322,3902206426,3902301003,3902720236,3907694243,3911517477,3912441527,3918223942,3922186273,3922691457,3926241941,3931289542,1034280761,1431142721,1559284381,1593467941,1643294701,2276745981,2390281185,2390287897,2390403755,2390428640,2390553873,2390609440,2390856064,2390957431,2391111309,2391164500,2391199416,2391247334,2391375304,2391496567,2391844653,2392014380,2392031944,2392040960,2392068072,2392082080,2392154590,2392213146,2392718635,2392856453,2392897401,2393278785,2393306340,2393688720,2393702823,2393896961,2394032960,2394131000,2394134267,2394291820,2394889101,2394892111,2395111601,2395124745,2395159421,2395164392,2395212841,2395462792,2396123612,2396268083,2396283012,2396356952,2396388401,2396456681,2396639940,2396676120,2396822627,2396829423,2396942001,2397165860,2397251641,2397274880,2397329668,2397341623,2397343481,2397372552,2397491920,2397526740,2397536160,2398089220,2398191832,2398264303,2398285141,2398299140,2398330323,2398339600,2398552775,2398694681,2398838963,2399230362,2399354541,2399585921,2399587742,2399590682,2399627020,2399777220,2399984042,2786833600,3001648390,3002542227,3003037429,3003116648,3007158068,3009185121,3010540601,3012272362,3012301452,3013338725,3015508367,3016277592,3016752164,3070024236,3070196162,3070365200,3070494630,3071396719,3072501450,3073249188,3073254928,3073674128,3074001907,3074502309,3075409771,3076802329,3078365435,3079351773,3079981327,3080543482,3080796821,3081448106,3082446799,3083052239,3083282110,3086716937,3089340324,3089461010,3089474939,3090044084,3090136400,3090588715,3092634507,3092876047,3093258134,3093286307,3093485357,3093635076,3095301145,3095693511,3096421576,3096422132,3098395705,3098741504,3099311533,3200455571,3208460593,3239033926,3239724132,3240168687,3242247792,3251670823,3255036745,3256388201,3258413158,3265775647,3269032708,3269176942,3271158630,3271436617,3271443368,3274292289,3274590163,3286126582,3288868675,3292158393,3294233713,3294751423,3518062346,3521090753,3525800276,3537480573,3553935523,3558818400,3559619275,3560409763,3562893285,3563439857,3564573611,3570795545,3572825035,3588055360,3588502049,3591941043,3597585164,3598836122,3862092748,3863661346,3870597774,3872851260,3890467628,3890744878,3890769148,3890964029,3891717967,3892555190,3893127105,3898707519,3898741980,3898909364,3899903346,3907314219,3909716943,3910251662,3914274522,3925310299,3926248961,3928602515,3944000110,3948180278,699115,1034280761,1240574601,1431142721,1444391061,1593467941,1791575621,1952208001,2095329301,2276745981,2390216734,2390281185,2390553873,2390609440,2390870601,2391039495,2391246920,2391496567,2391844653,2392031944,2392040960,2392049500,2392068072,2392082080,2393013234,2393041860,2393238864,2393256753,2393295571,2393468372,2394032960,2394134267,2394260794,2394595381,2395111601,2395212841,2396456681,2396892002,2397343481,2397755480,2398177561,2398342156,2399178100,2399179801,2399272251,2399488342,2399587742,2399590682,2399627020,2399828201,2399899102,2399984042,3000521703,3001008593,3002542227,3003116648,3003310516,3004961517,3007158068,3009401635,3014000347,3014836707,3015508367,3070024236,3070365200,3071396719,3071712628,3072501450,3073731004,3075409771,3076292503,3076802329,3077322513,3080796821,3081915473,3082416430,3082539519,3084276724,3084639036,3086263435,3089474939,3090321411,3093258134,3093635076,3096421576,3097079126,3098741504,3099311533,3200455571,3208460593,3237753356,3239033926,3239235368,3239724132,3240168687,3242247792,3251670823,3256388201,3258413158,3262231420,3265775647,3271158630,3271436617,3271443368,3271638842,3274590163,3283053842,3284089266,3294290460,3517426927,3522532562,3529012635,3531389974,3535085610,3537480573,3557594538,3559619275,3560409763,3564573611,3568878114,3569830872,3570795545,3572699929,3578502418,3588055360,3589897120,3591941043,3597585164,3861638209,3863661346,3864086737,3867740377,3871854925,3881127782,3885902745,3890744878,3893597889,3898741980,3902301003,3907694243,3911517477,3918223942,3922186273,1212133741,1275451641,1375135921,2390204122,2390302080,2390428640,2390642694,2390856064,2390957431,2391150242,2391199416,2391247334,2391375304,2391375304,2391567054,2392014380,2392135301,2392727558,2393688720,2393698380,2393702823,2393896961,2394131000,2394349740,2394889101,2394892111,2395056175,2395124745,2395155740,2396006101,2396123612,2396639940,2396829423,2396942001,2397165860,2397224253,2397274880,2397491920,2398089220,2398112841,2398299140,2398330323,2398377244,2398694681,2398847601,2398982052,2399230362,2399354541,2399865442,2399903782,2940696320,3001648390,3003037429,3009185121,3009790978,3010170184,3010540601,3012272362,3012326877,3012558019,3012729257,3014173967,3016277592,3017159050,3019157166,3070494630,3071373728,3073249188,3073254928,3074001907,3075193232,3078365435,3078852525,3080543482,3080580668,3080976631,3081200029,3081448106,3082493215,3083282110,3085157003,3087036607,3089340324,3089461010,3090044084,3090136400,3092876047,3093232206,3093286307,3094358118,3095301145,3095437037,3095693511,3096111432,3096422132,3097498138,3099068632,3200251369,3207173165,3220101605,3235111899,3243884694,3255030554,3255036745,3255918706,3259480365,3263009825,3268117899,3269176942,3270637292,3272710521,3280796249,3288495941,3288868675,3292158393,3294233713,3518062346,3548031541,3553935523,3558818400,3559352214,3562893285,3563068977,3564760843,3584493905,3588502049,3592823583,3598836122,3869559570,3872851260,3889147671,3890467628,3891717967,3899903346,3902206426,3910251662,3922691457,3925310299,3931289542,4393255,962494081,1559284381,1628309301,1643294701,2390095621,2390185980,2390287897,2390403755,2390471121,2390731784,2391111309,2391164500,2391771880,2391844323,2392154590,2392213146,2392458732,2392718635,2392856453,2392897401,2393278785,2393306340,2394291820,2395148767,2395159421,2395164392,2395347320,2395462792,2395771800,2396268083,2396283012,2396356952,2396388401,2396676120,2396822627,2397251641,2397329668,2397341623,2397372552,2397526740,2397536160,2397783483,2398191832,2398264303,2398285141,2398339600,2398539040,2398552775,2398632600,2398838963,2399112600,2399311780,2399585921,2399593722,2399777220,2399991836,2560685080,2786833600,3008522239,3012249769,3012301452,3013338725,3016397069,3016752164,3070196162,3071782930,3072030302,3072107639,3073674128,3074502309,3075325238,3076392209,3077316430,3077423712,3077572710,3078245224,3079351773,3079423800,3079476127,3079958145,3079981327,3080043700,3080464616,3082446799,3083052239,3084405827,3084418087,3084917558,3086716937,3087030803,3088308533,3089222529,3090060408,3090588715,3092634507,3093197108,3093485357,3094160674,3097189780,3098395705,3099000336,3203815843,3204674323,3209033201,3212096040,3214041112,3215656497,3217555405,3222004532,3236088154,3236259213,3244599030,3269032708,3269523047,3274292289,3286126582,3294751423,3521090753,3525800276,3556007534,3563439857,3567698492,3572825035,3590745740,3862092748,3864811637,3865848828,3866756856,3870597774,3875092925,3879808364,3886703252,3890135424,3890769148,3890964029,3892555190,3893127105,3894866322,3898707519,3898909364,3902720236,3907314219,3909716943,3912441527,3914274522,3926241941,3926248961,3928602515,3944000110,3948180278"};setTimeout((()=>{const e=document.getElementById("js_content");if(!e)return;[{name:"mp-common-miniprogram",idkey:2,detectName:"miniprogramCoverDetect"},{name:"mp-common-profile",idkey:3,detectName:"profileCoverDetect"},{name:"mp-common-videosnap",idkey:4,detectName:"videoSnapCoverDetect"},{name:"mp-common-search",idkey:5,detectName:"searchCoverDetect"},{name:"mp-common-subscribe",idkey:6,detectName:"subscribeCoverDetect"},{name:"mp-common-sticker",idkey:7,detectName:"stickerCoverDetect"},{name:"mp-common-poi",idkey:8,detectName:"poiCoverDetect"},{name:"mp-common-redpacket",idkey:9,detectName:"redpacketCoverDetect"},{name:"mp-common-cpslink",idkey:10,detectName:"cpslinkCoverDetect"},{name:"mp-common-cpsad",idkey:11,detectName:"cpsadCoverDetect"},{name:"mp-common-claudio",idkey:12,detectName:"claudioCoverDetect"},{name:"mp-common-mpaudio",idkey:13,detectName:"mpaudioCoverDetect"},{name:"mp-common-vote",idkey:14,detectName:"voteCoverDetect"},{name:"mp-common-qqmusic",idkey:15,detectName:"qqmusicCoverDetect"},{name:"mp-common-clmusic",idkey:16,detectName:"clmusicCoverDetect"},{name:"mp-common-answer",idkey:17,detectName:"answerCoverDetect"}].forEach((t=>{const{name:i,idkey:n,detectName:o}=t;Array.from(document.getElementsByTagName(i)).forEach((t=>{const i=oe({startElem:t,endElem:e},{rules:["CSS[Opacity<1]","CSS[Height=0]"]});if(i.length>0){ge.setSum(299174,n,1);const e="biz=".concat(window.biz,"&mid=").concat(window.mid,"&idx=").concat(window.idx);window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.report("".concat(o),"".concat(e),{mid:"mmbizwap:appmsg_covertest",view:"wap_business",_info:{url:location.href,hitArr:i}})}}))}))}),1e4);const Eu=window.Vue;se(c);const{isIOS:Pu,getInner:Lu,isAndroid:Du}=Ae,Ru=!!window.is_login,Bu=Te("disable_share");!Bu&&(Ee.on("menu:share:appmessage",(function(e){let t=kt(window.user_uin+"_"+Date.now());if(window.is_wash)Bt({img_url:oo,img_width:"640",img_height:"640",link:Gn(eo,type,t),desc:"你可以阅读以下原创作者的内容",title:"原文存在洗稿行为"},(function(i){io(eo,fakeid,type,t,e.shareScene)}));else{let i=1,n=no(Qn,"1");if(e&&"favorite"==e.scene&&(i=24,n=no(Qn,"4"),c.commit("mp-related-article/setSources",["favorite"]),Ae.isWindowsWechat&&"207"===be.getQuery("subscene"))){const e=Ae.getWindows();if(e&&parseInt(e,16)>=parseInt("0x63090500",16)&&parseInt(e,16)<=parseInt("0x630905FF",16))return void Ee.invoke("handleMPPageAction",{action:"doFavorite"},(function(e){e.err_msg&&e.err_msg.indexOf("ok")>0?weui.toast("已收藏"):weui.toast("收藏失败")}))}1==malicious_content_type&&(n="https://mmbiz.qlogo.cn/mmbiz_png/cVgP5bCElFiayFgbgEB9iaDt7hLicfz9RrXGM0LpaQ0TUic2gP7lbbqU3jCD8ibonicgIa3p99yjx1f1P26HChraeRUg/0?wx_fmt=png");let o={appid:Yn,img_url:n,img_width:"640",img_height:"640",link:eo,desc:to,title:Xn};if(window.customShareInfo&&"object"==typeof window.customShareInfo&&Object.assign(o,window.customShareInfo),"string"==typeof o.forbid_msg){let t=o.forbid_msg.replace("#op#","favorite"===e.scene?"收藏":"分享");return void(window.weui||window).alert(t)}o.link=Gn(o.link,i,t),Bt(o,(function(e){io(eo,fakeid,i,t,0),c.commit("mp-related-article/setSources",[24===i?"favorite":"share"]),o.vid&&(Jn=Object.assign(Jn,{vid:o.vid,share_type:2}),u.reportKanData(Jn))}))}})),Ee.on("menu:share:timeline",(function(e){let t=kt(window.user_uin+"_"+Date.now());if(window.is_wash)Ot({img_url:oo,img_width:"640",img_height:"640",link:Gn(eo,2,t),desc:"",title:"原文存在洗稿行为，你可以阅读以下原创作者的内容"},(function(i){io(eo,fakeid,2,t,e.shareScene)}));else{let i=Qn;Ae.isIOS||(i=no(Qn,"2"));let n={img_url:i,img_width:"640",img_height:"640",link:eo,desc:to,title:Xn};if(window.customShareInfo&&"object"==typeof window.customShareInfo&&Object.assign(n,window.customShareInfo),"string"==typeof n.forbid_msg){let e=n.forbid_msg.replace("#op#","分享");return void(window.weui||window).alert(e)}n.link=Gn(n.link,2,t),Ot(n,(function(i){io(eo,fakeid,2,t,e.shareScene),c.commit("mp-related-article/setSources",["share"]),n.vid&&(Jn=Object.assign(Jn,{vid:n.vid,share_type:1}),u.reportKanData(Jn))}))}})),Ee.on("menu:share:weiboApp",(function(e){let t=kt(window.user_uin+"_"+Date.now());Ee.invoke("shareWeiboApp",{img_url:Qn,link:Gn(eo,3,t),title:Xn},(function(e){io(eo,fakeid,3,t)}))})),Ee.on("menu:share:facebook",(function(e){let t=kt(window.user_uin+"_"+Date.now());io(eo,fakeid,7,t),Ee.invoke("shareFB",{img_url:Zn,img_width:"640",img_height:"640",link:Gn(eo,43,t),desc:to,title:Xn},(function(e){}))})),Ee.on("menu:share:QZone",(function(e){let t=no(Qn,"6"),i=kt(window.user_uin+"_"+Date.now());io(eo,fakeid,5,i),Ee.invoke("shareQZone",{img_url:t,img_width:"640",img_height:"640",link:Gn(eo,22,i),desc:to,title:Xn},(function(e){}))})),Ee.on("menu:share:qq",(function(e){let t=no(Qn,"7"),i=kt(window.user_uin+"_"+Date.now());io(eo,fakeid,5,i),Ee.invoke("shareQQ",{img_url:t,img_width:"640",img_height:"640",link:Gn(eo,23,i),desc:to,title:Xn},(function(e){}))})),Ee.on("menu:share:email",(function(e){let t=kt(window.user_uin+"_"+Date.now());io(eo,fakeid,5,t),Ee.invoke("sendEmail",{content:Gn(eo,5,t),title:Xn},(function(e){}))})),Ee.on("sys:record",(function(e){Ee.invoke("recordHistory",{link:eo,title:Xn,source:nickname,img_url:Qn},(function(e){}))}))),gi(0),ae(c),(window.user_uin||Nt())&&Zt(c,ao),window.is_login||!document.getElementById("js_profile_card")||Ae.isWxWork||Nt()&&document.getElementById("js_profile_card_modal")||new Es({render:e=>e(As)}).$mount("#js_profile_card");try{ve.os.ios&&ve.os.getNumVersion()>=16&&(ge.setSum(110809,78,1),ve.isLockdownMode()&&ge.setSum(110809,79,1)),window.customElements?ge.setSum(110809,70,1):ge.setSum(110809,71,1),document.head.createShadowRoot||document.head.attachShadow?ge.setSum(110809,72,1):ge.setSum(110809,73,1)}catch(qu){console.log(qu)}window.canUseStar=Pu&&Lu()>="18003623"||Du&&Lu()>="28003630",setTimeout((()=>{window.canUseStar&&Ee.invoke("operateStar",{opType:"getSwitch"},(e=>{console.info("handleMPPageAction getOperateStar11111",e),window.getSwitchRes=e,/:ok$/.test(e.err_msg)&&e.switch?localStorage.setItem("mp_star_switch",!0):localStorage.setItem("mp_star_switch",!1)}))})),function(){const e=112287,t=document.getElementById("js_content"),i=document.getElementsByTagName("tbody");if(t.innerHTML.length>1048576&&(ge.setSum(e,44,1),t.innerText.length<5e3&&t.scrollHeight<1e4)){ge.setSum(e,45,1);const t={Url:location.href,Reason:3,Title:window.msg_title,Createtime:window.create_time,SendTime:window.svr_time};if(we.report(31768,t),0===i.length){ge.setSum(e,46,1);const t={Url:location.href,Reason:4,Title:window.msg_title,Createtime:window.create_time,SendTime:window.svr_time};we.report(31768,t)}}}(),function(){const e=112287,t=parseInt(window.atob(window.biz)),i=Au.bizuin.includes(t),n=document.getElementById("js_content").innerHTML;let o="mpEditor";if(n){n.match(/powered-by="(\S*)"/)?o=n.match(/powered-by="(\S*)"/)[1]:n.match(/data-tools="(\S*)"/)?o=n.match(/data-tools="(\S*)"/)[1]:0==n.indexOf("西瓜插件")?o="西瓜插件":n.match(/[P|p]owered by "(\S*)"/)?o=n.match(/[P|p]owered by "(\S*)"/)[1]:n.includes("_mbEditor")&&(o="美编助手");.5<Math.random()<.6&&window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.report("type: ".concat(o," | url: ").concat(location.href),"type: ".concat(o),{mid:"mmbizwap:editor_report",view:"wap_business"}),i&&window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.report("type: ".concat(o," | url: ").concat(location.href),"type: ".concat(o),{mid:"mmbizwap:editor_media_report",view:"wap_business"})}n&&(n.match(/powered-by="(\S*)"/)||n.match(/data-tools="(\S*)"/)||0==n.indexOf("西瓜插件")||n.match(/[P|p]owered by "(\S*)"/)||n.includes("_mbEditor")?(i&&ge.setSum(e,49,1),ge.setSum(e,47,1)):(i&&ge.setSum(e,50,1),ge.setSum(e,48,1)))}(),et.setGvar({payType:0,pageType:0,albumId:window.appmsg_album_info.id||""}),Eu.config.errorHandler=(e,t,i)=>{e._info=i,window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.onError(e),console.error("Vue errorHandler",i,e)},console.info("[图文信息] 三元组:",window.biz,window.mid,window.idx),console.info("[用户信息] 设备信息: 是否安卓",ve.os.android,"是否IOS",ve.os.ios,"是否秒开场景",window.__second_open__,"系统版本",ve.os.version,"用户uin",window.user_uin,"是否小程序内打开",Ae.isInMiniProgram),window.__immersiveListMode&&Ee.invoke("disableBounceScroll",{place:["top","bottom"]}),G.initHtmlMinHeight(),window.__second_open__||window.ext_complete||fe.setExtLoadDom(),je.on("ext-complete",(()=>{window.requestAnimationFrame(fe.removeExtLoadDom)})),je.on("interact-ext-complete",(()=>{window.requestAnimationFrame(fe.removeExtLoadDom)}));let Ou=-1,ju=!1;if(window.logs.pagetime.jsapi_ready_time=+new Date,window.logs.idkeys={},Se.log("[Appmsg] start run index.js init"),function(){const e=(new Date).getHours(),t=function(e,t){t=t||"",window.isSg?(t=["uin:sougou","resp:".concat(t)].join("|"),ge.setLogs({id:24729,key:e,value:1,log:t})):(t=["uin:".concat(window.user_uin),"resp:".concat(t)].join("|"),ge.setLogs({id:24729,key:e,value:1,log:t}))},i=e>=11&&e<=17&&Math.random()<1;window.__report=t,window.__commonVideoReport=function(e,n){i&&t(e,n)},window.__addIdKeyReport=function(e,t,i){const n=e+"_"+t;i=i||1,window.logs.idkeys[n]||(window.logs.idkeys[n]={val:0}),window.logs.idkeys[n].val+=i}}(),We.initWebCompt(["wxOpen"],(e=>{window.__is_support_wxOpen=e.err_msg&&e.err_msg.indexOf(":ok")>-1,(document.getElementsByTagName("mpsubscribe")&&document.getElementsByTagName("mpsubscribe").length||document.getElementsByTagName("mp-common-subscribe")&&document.getElementsByTagName("mp-common-subscribe").length)&&Wa()})),function(){setTimeout((()=>{let e=document.getElementsByClassName("wx-edui-video_source_link");e=Array.prototype.slice.call(e),e.forEach((e=>{e&&e.addEventListener("click",(()=>{const t=e.dataset.hitUsername,i=e.dataset.hitBiz;Pe.goProfile({biz:i},{username:t})}))}))}),500);let e=!1;if((()=>{try{const t=We.getParam("anchor_list");let i=!1;if(t&&2!==window.copyright_stat){e=!0;const n=document.getElementById("js_content"),o=Ve(n,{ignoreNotWriteableChildren:!0});let s=decodeURIComponent(t).split("#");for(let e=0;e<s.length;e++){let t=s[e].split(",");if(t&&3===t.length){let e=o[t[0]],n=1*t[1],s=1*t[2];window.__addIdKeyReport("306353","3");const a=Ke(e,n,s);i||(window.__addIdKeyReport("306353","1"),window.scrollTo(0,a.getBoundingClientRect().top+We.getScrollTop()-68),i=!0)}}}}catch(Nu){window.__addIdKeyReport("306353","2"),console.error(Nu)}})(),function(){window.is_teenager?ge.setSum(286024,0,1):tl()}(),br.init(),window.is_new_msg&&-1!=navigator.userAgent.indexOf("MicroMessenger")){window.title&&(window.title=window.title.replace(/&#39;/g,"'").replace(/&nbsp;/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&amp;/g,"&")),window.msg_title&&(window.msg_title=window.msg_title.replace(/&#39;/g,"'").replace(/&nbsp;/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&amp;/g,"&")),hd_head_img||a.jsmonitor({id:115849,key:26,value:1}),Ru&&!window.show_comment_bar&&_e(!1);const e=document.querySelectorAll("mp-common-product, mp-common-videosnap"),t={userName:window.user_name,bizNickName:window.nickname,bizNickNameBackup:window.title,cover:"",title:window.msg_title,headImg:window.hd_head_img,roundHeadImg:window.round_head_img,digest:window.msg_desc,reportData:{BizUin:window.biz,AppMsgID:1*window.mid,ItemIndex:1*window.idx,Scene:1*window.source,SubScene:1*window.subscene,EnterId:1*window.enterid,SessionId:window.sessionid,ItemShowType:1*window.item_show_type},hasFinderElement:e.length>0?1:0,canReadArticle:!window.tempkey&&window.tts_is_show&&ri(document.querySelector("#js_content"))>100};if(!Bu)if(Ae.isAndroid){t.cover="",me.init(t);const e=window.cdn_url_1_1||window.cdn_url_235_1||"",i=new Image;e&&(i.src=e,i.onload=()=>{i.width<2048&&i.height<2048&&(t.cover=e,me.init(t)),window.topbarInited=!0},i.onerror=()=>{window.topbarInited=!0})}else t.cover=window.cdn_url_1_1||window.cdn_url_235_1||window.msg_cdn_url,me.init(t);Ne.on(window,"scroll",(()=>{ju||Ae.isAndroid&&!window.topbarInited||(at(0),ju=!0)})),Ee.invoke("createWebViewForFastLoad",{scene:1},(e=>{console.log(e)}))}let t=document.getElementsByTagName("body");if(!t||!t[0])return!1;t=t[0];(function(){const e=[],t=document.getElementById("js_content").getElementsByTagName("a");for(let a=0;a<t.length;a++)null!==t[a].getAttribute("data-itemshowtype")&&e.push(t[a]);const i=[];Array.prototype.map.call(document.getElementById("js_content").getElementsByClassName("h5_image_link"),(e=>{e.parentNode.getAttribute("href")&&e.parentNode.getAttribute("href").length>0&&i.push(e)}));const n=[];Array.prototype.map.call(document.getElementById("js_content").getElementsByClassName("weapp_image_link"),(e=>{n.push(e)}));const o=window.innerHeight||document.documentElement.clientHeight;function s(){!function(){if(e.length){const t=document.documentElement.scrollTop||document.body.scrollTop;for(let i=0;i<e.length;i++)if(1!=e[i].getAttribute("hasload")){const n=e[i].getBoundingClientRect();(n.top<o+t&&n.top>t||n.top+n.height>t&&n.top+n.height<o+t)&&e[i].getAttribute("href").length>0&&(e[i].setAttribute("hasload",1),Ee.invoke("downloadPageDataForFastLoad",{itemList:[{item_show_type:e[i].getAttribute("data-itemshowtype"),url:e[i].getAttribute("href")}]},(e=>{console.log(e)})),e.splice(i,1),i--)}}}(),function(){for(let e=0;e<i.length;e++){const t=i[e],n=t.getBoundingClientRect();(n.top<=0&&n.top+n.height>=0||n.top>0&&n.top<o)&&(i.splice(e,1),e--,he.report([1,he.getRedirectType(t.parentNode.getAttribute("href")),"",window.img_popup?1:0,window.source,he.getUrlData(t.parentNode.getAttribute("href"))]))}for(let e=0;e<n.length;e++){const t=n[e],i=t.getBoundingClientRect();(i.top<=0&&i.top+i.height>=0||i.top>0&&i.top<o)&&(n.splice(e,1),e--,he.report([1,1,"",window.img_popup?1:0,window.source,t.getAttribute("data-miniprogram-appid")]))}}()}Ne.on(window,"scroll",s),s()})(),(async()=>{let e=null;const t=document.querySelector("#js_ting_heard");if(t){const i=It();i&&(ge.setSum(293511,18,1),2===i&&ge.setSum(293511,23,1),3===i&&ge.setSum(293511,24,1),e=await async function(e="#audio_panel_area",t=1){const i=new _u({store:c,version:t,...await mt()?mu:fu?lu:tu}).$mount(e);return i.$on("add-to-listen-later",(e=>gu(e,1))),i.$on("remove-from-listen-later",(e=>gu(e,0))),i.$on("list-base64-change",(e=>{window.musicList&&Object.keys(window.musicList).forEach((t=>{const i=window.musicList[t];i.listBase64=e,i.player&&(i.player._o.listBase64=e)}))})),i}("#audio_panel_area",i));let n=!0,o=!1;new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&(o||(o=!0,me.topbarReport(4),ge.setSum(293511,4,1)))}))}),{threshold:.5}).observe(t),window.frontend_exp_list&&window.frontend_exp_list.forEach((e=>{"tts_floating"===e.key&&(n=1!=+e.value)}));const s=(t=!0)=>{if(t&&(me.topbarReport(5),ge.setSum(293511,5,1)),e&&i){t&&we.report(32561,{BizUin:window.biz,MsgId:+window.mid,Idx:+window.idx,Scene:1*window.source,SubScene:1*window.subscene,ListenId:"",ListenType:0,Pos:0,EventType:13,EventTime:parseInt(Date.now()/1e3,10),SessionId:"".concat(window.sessionid),EnterId:+window.enterid,ExpVersion:"".concat(i||0),PlayRate:0,ListenTime:0,ShutDownType:"",ShutDownLeftTime:0,ListBase64:""});if(!1!==e.show())return;t&&ge.setSum(293511,22,1)}const o={openPlayerUI:n,itemList:[{type:2,startTime:0,duration:123,srcId:location.href,title:window.msg_title||"",webUrl:window.msg_link||location.href,author:window.nickname||window.cgiData.nick_name||"",cover:window.cdn_url_1_1||window.__appmsgCgiData.hd_head_img||"",mpInfo:{username:window.user_name||"",name:window.nickname||window.cgiData.nick_name||"",bizUin:window.biz?parseInt(window.atob(window.biz),10):0,webUrl:window.msg_link||location.href}}]};console.log("+++++++++++++++ tingReadOpt",o),Ee.invoke("setTingAudioState",o,(e=>{console.log("+++++++++++++++ tingReadRes",e),-1===e.err_msg.indexOf("ok")&&(window.weui.alert("暂无法朗读，请重试"),ge.setSum(293511,6,1),window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.report("t1t read fail","res: ".concat(JSON.stringify(e)," | url: ").concat(location.href),{mid:"mmbizwap:t1t_read_fail",view:"wap_business"}))}))};window.__hasClickedAudioPanelHandler&&t.removeEventListener("click",window.__hasClickedAudioPanelHandler),window.__hasClickedAudioPanel&&(s(),window.__hasClickedAudioPanel=!1),Ne.on(t,"click",(()=>s())),Ee.on("onTingEntryClick",(()=>{s(!1),ge.setSum(293511,34,1),we.report(32561,{BizUin:window.biz,MsgId:+window.mid,Idx:+window.idx,ListenId:"",ListenType:0,Scene:1*window.source,SubScene:1*window.subscene,Pos:0,EventType:22,EventTime:parseInt(Date.now()/1e3,10),SessionId:"".concat(window.sessionid),EnterId:+window.enterid,ExpVersion:"".concat(i||0),PlayRate:0,ListenTime:0,ShutDownType:"",ShutDownLeftTime:0,ListBase64:""})}))}let i=[];voiceList&&voiceList.voice_in_appmsg&&voiceList.voice_in_appmsg.length>0&&(i=voiceList.voice_in_appmsg),Sa(i,e)})();const i=/^http(s)?:\/\/mp\.weixin\.qq\.com\//g;try{if(top!=window&&(!top||top&&location.href&&i.test(location.href))&&!window.isSg)throw new Error("in iframe")}catch(Mu){const t="";ge.setLogs({id:24729,key:4,value:1,log:"biz:".concat(biz,",mid:").concat(mid,",uin:").concat(uin,",[key4]").concat(t).substring(0,1024)})}if(window.isInWeixinApp()&&/#rd$/.test(location.href)&&!window.isWeixinCached&&!window.__second_open__&&!Ae.isWxWork){const e=-1!=location.href.indexOf("?")?"&":"?";location.replace(location.href.replace(/#rd$/,e+"rd2werd=1#wechat_redirect"))}const n=!Ae.isWp&&-1==navigator.userAgent.indexOf("MicroMessenger"),o=Ae.isMpapp&&Ae.cpVersion("2.25.0",1,!0,"mpapp");if(window.__review_image__=!n||o||/wxwork\/([\d.]+)/i.test(navigator.userAgent)?new Qe({isHttpsRes:is_https_res}):null,function(){const e=document.getElementById("js_content");let t=!1;const i=e.getElementsByTagName("img");for(let n=0,o=i.length;n<o;n++){const e=i[n].getAttribute("data-src");if(e&&e.canHevc()){t=!0;break}}if(!t){const i=e.querySelectorAll("[data-lazy-bgimg]");for(let e=0,n=i.length;e<n;e++){const n=i[e].getAttribute("data-lazy-bgimg");if(n&&n.canHevc()){t=!0;break}}}t?Tt((e=>{Ct((t=>{ea(e,t)}))})):Ct((e=>{ea(!1,e)}))}(),window.__review_image__){const e=document.getElementById("js_cover");window.__review_image__.add({container:document.getElementById("js_content"),imgs:e?[e]:[]})}Xs(),new Yo({store:c,render:e=>e(Xo)}).$mount("#content_bottom_area"),new Ts({store:c,render:e=>e(ks)}).$mount("#page_bottom_area"),new Eu({store:c,render:e=>e(xu)}).$mount("#js_ad_control"),function(){const e=document.getElementById("profileBt"),t=document.getElementById("copyright_info"),i=[];if(e){let t="57";"28"==window.source&&(t="96"),"31"===window.source&&(t="103"),"30"===window.source&&(t="102"),"29"==window.source&&(t="39"),"15"==window.source&&(t="121"),i.push({dom:e,username:user_name,profileReportInfo:window.profileReportInfo||"",scene:t})}t&&source_encode_biz&&i.push({dom:t,source_encode_biz:source_encode_biz,scene:"161"});for(let n=0,o=i.length;n<o;n++)!function(e){Ne.on(e.dom,"click",(t=>{if("copyright_info"==e.dom.id&&source_encode_biz)Wn.card_click_report({scene:"0"}),Pe.goProfile({biz:e.source_encode_biz,scene:e.scene},{username:source_username,scene:e.scene+""});else{if(Se.log("[Appmsg] profile_click_before_loadprofile: username:"+e.username+", scene:"+e.scene),Le.profileReport({hotspotjson:JSON.stringify({hotspotinfolist:window.hotspotInfoList})}),profileReportInfo){const e=String(profileReportInfo).split("_");3==e.length&&ye({url:"/mp/ad_biz_info?action=report&__biz="+window.biz+"&report_type=2&aid="+e[1]+"&tid="+e[2],type:"GET",dataType:"json",async:!0,success(e){}})}Ae.isWxWork&&(Ae.isIOS||Ae.isAndroid)?Oe():1==isprofileblock?Ee.invoke("openUrlWithExtraWebview",{url:"https://mp.weixin.qq.com/mp/profileblock?__biz="+window.biz+"#wechat_redirect",openType:1},(e=>{-1==e.err_msg.indexOf("ok")&&(location.href="https://mp.weixin.qq.com/mp/profileblock?__biz="+window.biz+"#wechat_redirect")})):Ee.invoke("profile",{username:e.username,profileReportInfo:e.profileReportInfo||"",scene:e.scene+"",bizuin:window.biz&&1*window.atob(window.biz)||0},(t=>{window.__addIdKeyReport("28307","1"),Se.log("[Appmsg] profile_click_after_loadprofile: username:"+e.username+", scene:"+e.scene+", profileReportInfo:"+e.profileReportInfo+", res.err_msg:"+t.err_msg)}))}t.preventDefault()})),Ae.isWp&&e.dom.setAttribute("href","weixin://profile/"+e.username)}(i[n])}(),function(){function e(){const e=function(){if("hidden"in document)return"hidden";const e=["webkit","moz","ms","o"];for(let t=0;t<e.length;t++)return e[t]+"Hidden";return null}();return!!e&&document[e]}function t(t){if(e())for(let e=0;e<window.originalVideoAdFrames.length;e++)window.originalVideoAdFrames[e].contentWindow.postMessage({action:"pauseAd",value:""},"*");else window.originalVideoAdCurrentFrame&&window.originalVideoAdCurrentFrame.contentWindow.postMessage({action:"playAd"},"*")}document.webkitVisibilityState?document.addEventListener("webkitvisibilitychange",t,!1):document.msVisibilityState?document.addEventListener("msvisibilitychange",t,!1):document.visibilityState&&document.addEventListener("visibilitychange",t,!1)}();try{const e=document.getElementById("js_author_name");if(e){let t="";Ne.on(e,"click",(i=>!!Ce.hasClass(e,"rich_media_meta_link")&&(window.is_temp_url?(window.weui.alert("预览状态下不能操作"),!1):!qt("js_author_name")&&(!!e.getAttribute("data-rewardsn")&&(1==e.getAttribute("data-canreward")&&(t="https://mp.weixin.qq.com/mp/author?action=show&author_id="+author_id+"&rewardsn="+e.getAttribute("data-rewardsn")+"&timestamp="+e.getAttribute("data-timestamp")+"&__biz="+window.biz+"&appmsgid="+window.appmsgid+"&idx="+window.idx+"&scene=142&rscene=129&from_scene="+window.source+"&from_subscene="+window.subscene+"&from_enterid="+window.enterid+"&from_sessionid="+window.sessionid+"&is_fans="+window.isFans+"&is_paidarticle="+window.isPaySubscribe+"&author_from_scene=0#wechat_redirect",!Ae.isInMiniProgram&&void(-1!=navigator.userAgent.indexOf("MicroMessenger")&&(Ae.isIOS||Ae.isAndroid||Ae.isWp)?(window.__addIdKeyReport("110809","1"),Ee.invoke("openUrlWithExtraWebview",{url:t,openType:1},(e=>{-1==e.err_msg.indexOf("ok")&&(location.href=t)}))):window.open(t))))))))}}catch(Mu){}new re({container:document.getElementById("js_content"),changeHref(e,t,i){if(e=e.trim(),1===window.ban_jump_link.block_atag)return ban_jump_link.atag_intcp_url;if(!e||0!=e.indexOf("http://mp.weixin.qq.com/")&&0!=e.indexOf("https://mp.weixin.qq.com/")){if(18==ban_scene)return"/mp/ban?action=check&__biz="+biz+"&mid="+mid+"&idx="+idx+"&scene="+ban_scene+"#wechat_redirect";if(0!=e.indexOf("http://mp.weixinbridge.com/mp/wapredirect")&&0!=e.indexOf("https://mp.weixinbridge.com/mp/wapredirect")&&0!=e.indexOf("https://support.weixin.qq.com/cgi-bin/mmsupport-bin/showredpacket"))return"https://mp.weixinbridge.com/mp/wapredirect?url="+encodeURIComponent(e)+"&action=appmsg_redirect&uin="+uin+"&biz="+biz+"&mid="+mid+"&idx="+idx+"&type="+t+"&scene=0"}else{let t="&";-1==(e=(e=(e=e.replace(/#rd\s*$/,"")).replace(/#wechat_redirect\s*$/,"")).replace(/[\?&]scene=21/,"")).indexOf("?")&&(t="?"),e+=t+"scene=".concat(i?310:21,"#wechat_redirect")}return e}}),function(){if(!document.getElementsByClassName)return;let e=document.getElementsByClassName("js_product_section"),t=document.getElementsByClassName("js_product_a"),i=[];function n(e){let t=window.pageYOffset||document.documentElement.scrollTop;for(let n=0;n<i.length;++n){let e=i[n];if(!e.isReport){let i=e.offsetTop;t<=i&&t+We.getInnerHeight()>=i&&(e.isReport=!0,(new Image).src="/mp/appmsgreport?action=appmsg_recom&type=1&__biz="+biz+"&ascene="+(window.ascene||-1)+"&mid="+mid+"&idx="+idx+"&sn="+sn+"&product_id="+e.product_id+"&order="+e.order+"&r="+Math.random())}}}for(let o=0;o<e.length;++o){let t=e[o];t.dataset&&t.dataset.product_id&&t.dataset.order&&i.push({dom:t,offsetTop:t.offsetTop,product_id:t.dataset.product_id||"",order:t.dataset.order||"",isReport:!1})}i.length>0&&(Ne.on(window,"scroll",n),n());for(let o=0;o<t.length;++o)!function(e){Ne.on(e,"click",(function(t){let i=e.dataset||{};return(new Image).src="/mp/appmsgreport?action=appmsg_recom&type=2&__biz="+biz+"&ascene="+(window.ascene||-1)+"&mid="+mid+"&idx="+idx+"&sn="+sn+"&product_id="+(i.product_id||"")+"&order="+(i.order||"")+"&r="+Math.random(),!!i.href&&(setTimeout((function(){location.href="https://mp.weixinbridge.com/mp/wapredirect?url="+encodeURIComponent(i.href)+"&action=appmsg_redirect&uin="+uin+"&biz="+biz+"&mid="+mid+"&idx="+idx+"&scene=0"}),300),!1)}),!0)}(t[o])}(),window.originalVideoAdFrames=[],window.originalVideoAdCurrentFrame=null,window.originalVideoAdFramesUnsetList=[],window.addEventListener("message",(e=>{let t="";const i=document.getElementsByTagName("iframe");if(e.data&&"originalVideoAdNeedData"==e.data.action&&e.data.vid)if(window.originalVideoAdFramesAdData){window.originalVideoAdFramesAdData&&window.originalVideoAdFramesAdData[e.data.vid]&&(t=window.originalVideoAdFramesAdData[e.data.vid]);for(let n=0;n<i.length;n++)i[n].dataset&&i[n].dataset.mpvid==e.data.vid&&i[n].contentWindow.postMessage({action:"receiveOriginalVideoData",vid:e.data.vid,adData:t},"*")}else console.log(e.data.vid," has no ad data yet"),window.originalVideoAdFramesUnsetList.push(e.data.vid)})),Ze(),window.fromWeixinCached||Vs();le.getAdData(window.reportVid),function(){try{new aa}catch(qu){console.error("initMusic err",qu)}}(),Cu(),fi(),de(),(()=>{const e=document.querySelectorAll(Aa.oldTagName);for(let i=0;i<e.length;i++){const t=e[i],n=document.createElement("mp-common-search"),o=t.getAttribute("data-keywords");t.parentNode.appendChild(n),t.parentNode.removeChild(t),n.setAttribute("data-nickname",window.nickname),n.setAttribute("data-headImg",window.round_head_img),n.setAttribute("data-keywords",o)}const t=document.querySelectorAll(Aa.tagName);if(!(t.length<=0))for(let i=0,n=t.length;i<n;i++){const e=t[i];e.classList.add("js_wx_tap_highlight");let n=[];try{n=JSON.parse(window.decodeURIComponent(e.getAttribute("data-keywords")))}catch(Mu){ge.setSum(110809,50,1)}if(n.length){const t={nickname:window.nickname,avatar:window.round_head_img,keywords:n};Aa.keywords=n;const i=e.parentNode.querySelector('[data-preloadingid="mp-common-search"]');i&&i.parentNode.removeChild(i),Ea({dom:e,keywords:t.keywords})}}})(),(()=>{const e=document.querySelectorAll(xa.oldTagName);for(const n of e){const e=document.createElement(xa.tagName);n.parentNode.appendChild(e),n.parentNode.removeChild(n);const t=["pluginname","id","poiid","districtid","name","address","img","longitude","latitude","provice","city","hasreport","type"];for(const i of t){const t="data-".concat(i);e.setAttribute(t,n.getAttribute(t))}}const t=document.querySelectorAll(xa.tagName);for(let n=0,o=t.length;n<o;n++){const e=t[n];e.classList.add("js_wx_tap_highlight");const i={id:decodeURIComponent(e.getAttribute("data-id")||""),name:decodeURIComponent(e.getAttribute("data-name")||""),address:decodeURIComponent(e.getAttribute("data-address")||""),img:decodeURIComponent(e.getAttribute("data-img")||""),longitude:decodeURIComponent(e.getAttribute("data-longitude")||""),latitude:decodeURIComponent(e.getAttribute("data-latitude")||""),type:decodeURIComponent(e.getAttribute("data-type")||"")},o=e.parentNode.querySelector('[data-preloadingid="'+i.id+'"]');o&&o.parentNode.removeChild(o),xa.poiDom.push(e),Ta({poiInfo:i,dom:e})}const i=document.getElementsByClassName("js_poi_entry");for(let n=0;n<i.length;n++)(e=>{const t=i[e];Ce.removeClass(t,"ct_geography_loc_tip"),Ce.addClass(t,"wx_poi_link"),Ce.addClass(t,"js_wx_tap_highlight"),Ce.addClass(t,"wx_tap_link"),xa.poiDom.push(t),Ne.on(t,"click",(e=>{e.stopPropagation(),e.preventDefault();const i={id:decodeURIComponent(t.getAttribute("data-id")||""),name:decodeURIComponent(t.getAttribute("data-name")||""),address:decodeURIComponent(t.getAttribute("data-address")||""),img:decodeURIComponent(t.getAttribute("data-img")||""),longitude:decodeURIComponent(t.getAttribute("data-longitude")||""),latitude:decodeURIComponent(t.getAttribute("data-latitude")||""),type:decodeURIComponent(t.getAttribute("data-type")||"")};return i.longitude&&i.latitude&&i.name&&i.address&&(we.report(19937,Object.assign({},xa.commonReportData,{type:1,actiontype:2})),ge.setSum(110809,57,1),ka(i)),!1}),!0)})(n);Ca(),Ne.on(window,"scroll",Ca)})(),zs.initCpslink(),J.init(),1===window.show_msg_voice&&(ta(),console.log("load voicemsg"));!window.__appmsgCgiData||1!=window.__appmsgCgiData.wxa_product&&1!=window.__appmsgCgiData.wxa_cps||La();ce.init(),document.getElementsByTagName("mp-qa").length&&Ln.renderQaCard({mid:window.mid,idx:window.idx,isLogin:!!window.is_login,userUin:window.user_uin,biz:window.biz,itemShowType:window.item_show_type,sessionId:window.sessionid,enterId:window.enterid,scene:window.source,subScene:window.subscene});const l=document.getElementsByTagName("mp-common-videosnap");(document.getElementsByTagName("mpvideosnap")&&document.getElementsByTagName("mpvideosnap").length||l&&l.length)&&ai();const d=document.getElementsByTagName("mp-common-profile");(document.getElementsByTagName("mpprofile")&&document.getElementsByTagName("mpprofile").length||d&&d.length)&&Ya();document.getElementsByTagName("mp-common-sticker")&&document.getElementsByTagName("mp-common-sticker").length&&sr();if(function(){lr&&lr.length&&yr()}(),document.getElementsByTagName("mp-wxaproduct").length){const e=window.__appmsgCgiData.minishopCardData?JSON.parse(decodeURIComponent(window.__appmsgCgiData.minishopCardData)):"";Ci({biz:window.biz,mid:window.mid,idx:window.idx,source:1*window.source,subscene:1*window.subscene,enterid:1*window.enterid,minishopCards:e})}function u(){const e=window.performance||window.msPerformance||window.webkitPerformance;if(e.timing){const t=e.timing;Se.log("[Appmsg] dns:"+(t.domainLookupEnd-t.domainLookupStart)+"^^^ ssl:"+(0==t.secureConnectionStart?0:t.connectEnd-t.secureConnectionStart)+"^^^ tcp:"+(t.connectEnd-t.connectStart)+"^^^ request:"+(t.responseStart-t.requestStart)+"^^^ getPackageTime:"+(t.responseEnd-t.responseStart)+"^^^ domCententLoaded:"+(t.domContentLoadedEventStart-t.domLoading)+"^^^ domComplete:"+(t.domComplete-t.domLoading)+"^^^ firstViewTime:"+(real_show_page_time-t.navigationStart)+"^^^ interactiveTime:"+(window.page_endtime-t.navigationStart)),window.navigator.userAgent,setTimeout((()=>{t.loadEventEnd&&Se.log("[Appmsg] onload:"+(t.loadEventEnd-t.loadEventStart))}),100)}"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),""==document.getElementById("js_content").innerHTML.trim()&&ge.setSum(24729,94,1);Math.random()<.001&&document.getElementById("js_read_area3")&&document.getElementById("js_read_area3").innerText&&document.getElementById("js_read_area3").innerText.indexOf("Pageview")>-1&&ge.setSum(24729,95,1),window.__wxjs_is_wkwebview&&ge.setSum(28307,67,1)}Ee.invoke("getNetworkType",{},(function(e){networkType=za[e.err_msg],"network_type:edge"!=e.err_msg&&"network_type:wwan"!=e.err_msg||(e.detailtype&&"4g"==e.detailtype||e.subtype&&"4g"==e.subtype)&&(networkType="4g"),Fa()})),void Ne.on(window,"load",Fa,!1),new Rn({biz:window.biz,isPaySubscribe:window.isPaySubscribe,container:document.getElementById("js_content"),logid:18504,baseData:["",window.biz,window.mid,window.idx,window.location.href,window.msg_title]}),setTimeout((()=>{Ne.tap(document.getElementById("copyright_logo"),(()=>{const e="http://kf.qq.com/touch/sappfaq/150211YfyMVj150326iquI3e.html";window.__second_open__?Ee.invoke("openUrlWithExtraWebview",{url:e,openType:1},(t=>{-1==t.err_msg.indexOf("ok")&&(location.href=e)})):location.href=e})),wi(),ue.init({dom:document.getElementById("js_report_article3"),title:window.msg_title.htmlDecode(),link:window.msg_link}),function(){if(n&&!window.cps_article_data){document.title=window.msg_title.htmlDecode(),Ce.addClass(t,"not_in_mm");const e=document.getElementById("js_pc_qr_code_img");if(e){let t=10000004;const i=document.referrer;if(0==i.indexOf("http://weixin.sogou.com")?t=10000001:0==i.indexOf("https://wx.qq.com")&&(t=10000003),window.isSg)e.setAttribute("src",sg_qr_code.htmlDecode());else{e.setAttribute("src","/mp/qrcode?scene="+t+"&size=102&__biz="+biz+"&mid="+mid+"&idx="+idx+"&sn="+sn+"&send_time="+send_time);(new Image).src="/mp/report?action=pcclick&__biz="+biz+"&uin="+uin+"&scene="+t+"&r="+Math.random()}document.getElementById("js_pc_qr_code").style.display="block"}}else{const e=document.getElementById("js_report_article3");e&&(e.style.display="")}}();const e=document.getElementsByTagName("map");for(let t=0,n=e.length;t<n;++t)e[t].parentNode.removeChild(e[t]);if(Wn.card_pv_report(),Math.random()<.01)try{const e="https://js.aq.qq.com/js/aq_common.js",t=document.createElement("script");t.src=e;document.getElementsByTagName("head")[0].appendChild(t)}catch(Mu){}const i=document.getElementById("js_close_temp");Ne.on(i,"click",(()=>{i.parentNode.parentNode.removeChild(i.parentNode),Ce.removeClass(document.getElementById("js_article"),"preview_appmsg")}))}),1e3),function(){if(!ve.os.ios||!("onorientationchange"in window))return;const e=[],t="onorientationchange"in window?"orientationchange":"resize";let i=!1;const n=function(){return 90===Math.abs(window.orientation)?1:2};1!==n()||i||(et.report110809(63),window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.report("horizontal screen report","biz: ".concat("function"==typeof window.atob&&window.biz?window.atob(window.biz):window.biz," | mid: ").concat(window.mid," | idx: ").concat(window.idx," | url: ").concat(location.href),{mid:"mmbizwap:horizontal_screen",view:"wap_business"}),i=!0),e.push({ori:n(),scroll:window.pageYOffset||document.documentElement.scrollTop,istouchmove:!1});const o=(new Date).getHours();Ne.on(window,t,(()=>{const t=e.length-2,s=n();if(Ou=+new Date,t>=0){const i=e[t];e[e.length-1].istouchmove||(o>=11&&o<=17&&window.__report(63),setTimeout((()=>{window.scrollTo(0,i.scroll)}),100))}e.push({ori:s,scroll:window.pageYOffset||document.documentElement.scrollTop,istouchmove:!1}),1!==s||i||(et.report110809(63),window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.report("horizontal screen report","biz: ".concat("function"==typeof window.atob&&window.biz?window.atob(window.biz):window.biz," | mid: ").concat(window.mid," | idx: ").concat(window.idx," | url: ").concat(location.href),{mid:"mmbizwap:horizontal_screen",view:"wap_business"}),i=!0)})),Ne.on(window,"scroll",(()=>{const t=e.length-1,i=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,o=Date.now();if(-1!=Ou){if(console.log("[横屏滚动检测]",o-Ou),o-Ou<500)return void(Ou=-1)}else Ou=-1;e[t].ori==n()&&(e[t].scroll=i,e[t].istouchmove=!0)}))}(),Se.log("[Appmsg] href:"+location.href+"^^^ ua:"+window.navigator.userAgent),window.addEventListener?window.addEventListener("load",u,!1):window.attachEvent&&window.attachEvent("onload",u);void(window.addEventListener&&document.getElementsByTagName("body")[0].addEventListener("copy",(()=>{ge.setSum(28307,18,1),Ae.isIOS&&ge.setSum(28307,19,1),Ae.isAndroid&&ge.setSum(28307,20,1)}),!1)),window.__observer&&window.__observer_data&&il();"undefined"!=typeof isSg&&function(){if(document.getElementById("js_report_article3")&&(document.getElementById("js_report_article3").style.display="none"),document.getElementById("js_content_end")&&(document.getElementById("js_content_end").style.display="none"),function(){const e=document.createElement("div");e&&(e.innerHTML=qe.tmpl(Ia,{}),document.body.appendChild(e))}(),new s.Emotion({emotionPanel:r("#js_emotion_panel"),inputArea:r("#js_cmt_input"),emotionPanelArrowWrp:r("#js_emotion_panel_arrow_wrp"),emotionSwitcher:r("#js_emotion_switch"),emotionSlideWrapper:r("#js_slide_wrapper"),emotionNavBar:r("#js_navbar"),submitBtn:r("#js_cmt_submit")}),navigator.userAgent.toLowerCase().match(/ios/)){const t=navigator.userAgent.toLowerCase().match(/(?:sogousearch\/ios\/)(.*)/);if(t&&t[1]){const i=t[1].replace(/\./g,"");parseInt(i)>422&&e("ios")}}else e("android");function e(e){const t=document.getElementById("js_cover"),i=[];t&&i.push(t);const n=document.getElementById("js_content");if(n){const e=n.getElementsByTagName("img")||[];for(let t=0,n=e.length;t<n;t++)i.push(e.item(t))}const o=[];for(let s=0,a=i.length;s<a;s++){const t=i[s],n=t.getAttribute("data-src")||t.getAttribute("src");n&&(o.push(n),function(i){Ne.on(t,"click",(function(t){return"ios"==e?window.JSInvoker&&window.JSInvoker.openImageList&&window.JSInvoker.openImageList(JSON.stringify({index:i,array:o})):window.JSInvoker&&window.JSInvoker.weixin_openImageList&&window.JSInvoker.weixin_openImageList(JSON.stringify({index:i,array:o})),!1}))}(s))}}window.onerror=function(e){ge.setLogs({id:24729,key:86,value:1,log:e})}}();setTimeout((()=>{const e=function(){ge.setLogs({id:28307,key:49,value:1,log:"[28307_49_appmsg_fe_filter]"+encodeURIComponent(location.href)})},t=(window.appmsg_fe_filter||"").split(","),i=function(t,i){try{if(!t)return;if(t.querySelectorAll){const n=t.querySelectorAll("*["+i+"]");if(n&&n.length>0){e();for(let e=0;e<n.length;++e)n[e]&&n[e].removeAttribute&&n[e].removeAttribute(i)}return}const n=t.childNodes;if(t.hasAttribute&&t.hasAttribute(i)&&e(),t.removeAttribute&&t.removeAttribute(i),n&&n.length)for(let e=0;e<n.length;++e)filterContenteditable(n[e])}catch(Mu){}},n=document.getElementById("js_content");for(let o=0;o<t.length;++o)t[o]&&i(n,t[o])}),0),setTimeout((()=>{const e="//mmbiz.qpic.cn/mmbiz_png/7lG1x2vpicdic0p5bBthpD9lsJcINicsSzd6uKQQJyoj5oTl8lFIs9K0fIibgxCzms0enDLTRxTHLpDPCLpSvIExiag/640",t=(new Date).getHours();if(t<11||t>16||Math.random()<.99)return;const i=new Image;i.onload=function(){const e=i.naturalWidth||i.width,t=i.naturalHeight||i.height;640===e&&407===t||window.__addIdKeyReport("28307","wifi"===window.networkType?120:123),window.__addIdKeyReport("28307","wifi"===window.networkType?121:124)},i.src="http:"+e;const n=new Image;n.onload=function(){const e=n.naturalWidth||n.width,t=n.naturalHeight||n.height;640===e&&407===t||window.__addIdKeyReport("28307",126),window.__addIdKeyReport("28307",127)},n.src="https:"+e}),3e3);if(Math.random()<2e-4)try{const e=document.getElementsByTagName("img"),t=window.screen.height,i=window.screen.width,n=window.devicePixelRatio;let o="";for(let s=0,a=e.length;s<a;s++){const a=e[s].getAttribute("data-src");if(a){const r=e[s].getBoundingClientRect();o+=i+"|"+t+"|"+r.left.toFixed(2)+"|"+(i-r.right).toFixed(2)+"|"+r.width.toFixed(2)+"|"+n.toFixed(2)+"|"+a+";"}}ye({url:"/mp/wapreport?action=img_display_report",data:{key:o},type:"POST",dataType:"json",async:!0})}catch(Mu){}setTimeout((()=>{On&&On("updatePageHeight")}),2e3),Ae.isIOS&&location.href.match(/fontScale=\d+/)&&pe.isIPadOS13&&setTimeout((()=>{if(window.ipados13_font_scale)return;const e=location.href.match(/fontScale=(\d+)/);window.ipados13_font_scale=parseFloat(e[1]),pe.setFontSize(document.getElementsByTagName("html").item(0),window.ipados13_font_scale/100)}),500);const p=!isNaN(parseInt(Te("start")))&&!isNaN(parseInt(Te("end"))),h=!!window.goContentId;Se.log("[PagePos] init entry"),console.log("[PagePos] init entry"),G.init({hasSpAd:!0,disableScroll:window.isPaySubscribe&&!window.isPaid&&window.jump2pay||p||h||e}),window.__main_process_finish__=!0,Pe.elementVisibleController(),document.querySelector(".refuted_appmsg_card")&&document.querySelector(".refuted_appmsg_card").addEventListener("click",(()=>{Ge(xe(document.querySelector(".refuted_appmsg_card").getAttribute("data-url"),"norumor",1))}))}(),window.can_feedback&&!ve.os.pc){document.getElementById("js_problem_feedback")&&new Rs({render:e=>e(Ds)}).$mount("#js_problem_feedback")}if(!window.__second_open__){const e=window.performance||window.msPerformance||window.webkitPerformance;if(e&&e.timing){const t=window.location.protocol;a.saveSpeeds({uin:window.uin,pid:"https:"==t?462:417,speeds:{sid:34,time:Date.now()-e.timing.navigationStart}}),a.send()}ot({isPaySubscribe:window.isPaySubscribe})}export{e as __vite_legacy_guard};
